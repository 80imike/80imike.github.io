{"title":"如何优雅的给 Docker 配置网络代理","id":"posts/32693.html","date_published":"03/15/2021","summary":"有时因为网络原因，比如公司 NAT，或其它啥的，需要使用代理。 Docker 的代理配置，略显复杂，因为有三种场景。 但基本原理都是一致的，都是利用 Linux 的 http_proxy 等环境变量。\nDockerd 代理\n在执行docker pull时，是由守护进程dockerd来执行。 因此，代理需要配在dockerd的环境中。 而这个环境，则是受systemd所管控，因此实际是systemd的配置。\n12sudo mkdir -p /etc/systemd/system/docker.service.dsudo touch /etc/systemd/system/docker.service.d/proxy.conf\n在这个proxy.conf文件（可以是任意*.conf的形式）中，添加以下内容：\n1234[Service]Environment=\"HTTP_PROXY=http://proxy.example.com:8080/\"Environment=\"HTTPS_PROXY=http://proxy.example.com:8080/\"Environment=\"NO_PROXY=localhost,127.0.0.1,.example.com\"\n其中，proxy.example.com:8080 要换成可用的免密代理。 通常使用 cntlm 在本机自建免密代理，去对接公司的代理。 可参考《Linux下安装配置Cntlm代理》。","url":"https://www.hi-linux.com/posts/32693.html","tags":["技巧","Linux","Docker"],"categories":["Docker"]}