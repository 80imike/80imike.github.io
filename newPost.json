{"title":"两个 99% 的人都遇到过的 Kubernetes 故障处理技巧","id":"posts/19507.html","date_published":"08/30/2021","summary":"随着微服务的不断推进，使用 k8s 集群越来越多，越来越深入，随之而来会遇到一系列的问题，本文向大家介绍实际使用 k8s 遇到的一些问题以及解决方法。\n问题一：修复 K8S 内存泄露问题\n问题描述\n\n当 k8s 集群运行日久以后，有的 node 无法再新建 pod，并且出现如下错误，当重启服务器之后，才可以恢复正常使用。查看 pod 状态的时候会出现以下报错。\n\n1applying cgroup … caused: mkdir …no space left on device\n或者在 describe pod 的时候出现 cannot allocate memory。\n这时候你的 k8s 集群可能就存在内存泄露的问题了，当创建的 pod 越多的时候内存会泄露的越多，越快。\n\n具体查看是否存在内存泄露\n\n1$ cat &#x2F;sys&#x2F;fs&#x2F;cgroup&#x2F;memory&#x2F;kubepods&#x2F;memory.kmem.slabinfo\n当出现 cat: /sys/fs/cgroup/memory/kubepods/memory.kmem.slabinfo: Input/output error 则说明不存在内存泄露的情况 如果存在内存泄露会出现\n12slabinfo - version: 2.1# name            &lt;active_objs&gt; &lt;num_objs&gt; &lt;objsize&gt; &lt;objperslab&gt; &lt;pagesperslab&gt; : tunables &lt;limit&gt; &lt;batchcount&gt; &lt;sharedfactor&gt; : slabdata &lt;active_slabs&gt; &lt;num_slabs&gt; &lt;sharedavail&gt;","url":"https://www.hi-linux.com/posts/19507.html","tags":["技巧","Linux","Kubernetes"],"categories":["Kubernetes"]}