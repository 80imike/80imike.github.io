{"title":"使用 AutoSSH 工具实现自动化跨网络访问","id":"posts/33293.html","date_published":"03/02/2021","summary":"\nAutoSSH 是一种用以对 SSH 登录进行安全地自动化的软件。！\n\n比如我们在 host2 机器上面部署了很多服务，但是由于某种原因导致我们无法直接 ssh 访问该服务器已经其上服务的对应端口，但是 host3 服务器，既能够访问 host2 服务器，又可以访问我们的 host1 服务器。这是，我们可以通过设置 ssh 来进行服务的访问。但是还有两个问题：你需要保持终端开启防止 SSH 进程被关闭；由于网络故障/波动导致 SSH 终断时无法自动重连。\n前者可以使用 tmux 等第三方工具来解决，后者需要 supervisor 等第三方监控工具，不过我们还有一个更常用的选择方案，那就是使用 autossh 工具。\n\nautossh 使用参考\nSSH 服务原理和使用技巧\n\n1. 工具介绍\n\n该工具的起初灵感和机制来自于 rstunnel!\n\nautossh 工具是一个用来启动 ssh 服务并进行监控的命令行应用程序，可以在程序问题或者是网络问题的时候，重启 ssh 服务。\n\n在 autossh 1.2 的时候，其方法已经改变了：autossh 使用 ssh 来构造一个 ssh 重定向循环(本地到远程和远程到本地)，然后发送测试数据并获得返回结果。\n在 autossh 1.3 增加了一个新的方法：可指定远程 echo 服务的端口用于返回测试数据发送结果。这个避免握手阶段以及所有远程机器端口的冲突问题，而老的 loop-of-forwardings 方法依然可用。\n\n内网主机主动连接到外网主机，又被称作反向连接(Reverse Connection)，这样 NAT 路由/防火墙就会在内网主机和外网主机之间建立映射即可相互通信了。但这种映射是路由网关自动维持的，不会持续下去，如果连接断开或者网络不稳定都会导致通信失败，这时内网主机需要自动重连机制了。\n123# 安装方式$ yum install autossh$ apt install autossh","url":"https://www.hi-linux.com/posts/33293.html","tags":["Linux","SSH","AutoSSH"],"categories":["SSH"]}