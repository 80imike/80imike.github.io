{"title":"5 分钟学会写一个自己的 Prometheus Exporter","id":"posts/10846.html","date_published":"05/23/2020","summary":"去年底我写了一个阿里云云监控的 Prometheus Exporter, 后续迭代的过程中有一些经验总结, 这篇文章就将它们串联起来做一个汇总, 讲讲为什么要写 Exporter 以及怎么写一个好用的 Exporter?\n何为 Prometheus Exporter?\nPrometheus 监控基于一个很简单的模型: 主动抓取目标的指标接口(HTTP 协议)获取监控指标, 再存储到本地或远端的时序数据库. Prometheus 对于指标接口有一套固定的格式要求, 格式大致如下:\n1234# HELP http_requests_total The total number of HTTP requests.# TYPE http_requests_total counterhttp_requests_total&#123;method&#x3D;&quot;post&quot;,code&#x3D;&quot;200&quot;&#125; 1027http_requests_total&#123;method&#x3D;&quot;post&quot;,code&#x3D;&quot;400&quot;&#125;    3\n对于自己写的代码, 我们当然可以使用 Prometheus 的 SDK 暴露出上述格式的指标. 但对于大量现有服务, 系统甚至硬件, 它们并不会暴露 Prometheus 格式的指标. 比如说:\n\nLinux 的很多指标信息以文件形式记录在 /proc/ 下的各个目录中, 如 /proc/meminfo 里记录内存信息, /proc/stat 里记录 CPU 信息;\nRedis 的监控信息需要通过 INFO 命令获取;\n路由器等硬件的监控信息需要通过 `SNMP** 协议获取;\n…\n","url":"https://www.hi-linux.com/posts/10846.html","tags":["Linux","技巧","Prometheus"],"categories":["Prometheus"]}