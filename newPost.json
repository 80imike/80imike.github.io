{"title":"两个助你高效编写 Kubernetes YAML 文件的神技","id":"posts/52035.html","date_published":"07/30/2020","summary":"我们在编写 Kubernetes 资源清单的时候可能会经常会忘记要创建的资源名称，即使知道了可能也不记得该资源对象有哪些属性可以使用了，特别是对于那些名称很长的资源或者属性，即使死记硬背下来隔一段时间又会忘记了。\n比如现在我们要创建一个 validating 的 admission webhook，我们就需要定义一个 ValidatingWebhookConfiguration 的资源对象，但是可能我们不记得它的全名了。这个时候我们可以使用 kubectl api-resources 命令来找到我们需要的 API 资源。找到了正确的资源名称之后，就需要了解如何编写正确的 YAML 资源清单文件了，但是 Kubernetes 中资源对象实在是太多了，而且每一个资源对象中配置属性也是非常多的，我们不可能都能完全记住，这个时候我们也可以借助 kubectl explain 命令来找到完整的结构，这对于我们编写 YAML 资源清单文件非常有帮助。\nkubectl api-resources 命令\nkubectl api-resources 命令可以打印所有已经注册的 API 资源，如下所示：\n1234567891011$ Kubectl api-resourcesNAME                              SHORTNAMES                                   APIGROUP                       NAMESPACED   KINDbindings                                                                                                      true         Bindingcomponentstatuses                 cs                                                                          false        ComponentStatusconfigmaps                        cm                                                                          true         ConfigMapendpoints                         ep                                                                          true         Endpointsevents                            ev                                                                          true         Eventlimitranges                       limits                                                                      true         LimitRangenamespaces                        ns                                                                          false        Namespacenodes                             no                                                                          false        Node......\n其中也会包含上面提到的 ValidatingWebhookConfiguration 资源：\n1234mutatingwebhookconfigurations                                                  admissionregistration.k8s.io   false        MutatingWebhookConfigurationvalidatingwebhookconfigurations                                                admissionregistration.k8s.io   false        ValidatingWebhookConfigurationcustomresourcedefinitions         crd,crds                                     apiextensions.k8s.io           false        CustomResourceDefinitionapiservices                                                                    apiregistration.k8s.io         false        APIService\n由于 Kubernetes 中已经注册的资源对象非常多，所以如果我们知道我们要查找的资源名称包含一些关键词的话，可以用 grep 来过滤:\n12$ kubectl api-resources |grep validatingvalidatingwebhookconfigurations                                                admissionregistration.k8s.io   false        ValidatingWebhookConfiguration\n这样就可以更精确的搜索到需要使用的资源名称了，比如我们这里就是 ValidatingWebhookConfiguration ，现在知道了资源对象的名称，然后可以使用 kubectl explain 命令来查找资源对象的属性。","url":"https://www.hi-linux.com/posts/52035.html","tags":["Linux","Kubernetes","YAML"],"categories":["Kubernetes"]}