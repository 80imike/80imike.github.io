{"title":"实战 Kubernetes 的 hostNetwork 和 NetworkPolicy (网络策略)","id":"posts/42597.html","date_published":"01/11/2023","summary":"1. hostNetwork 介绍\n\n在 k8s 中，若 pod 使用主机网络，也就是hostNetwork=true。则该pod会使用主机的dns以及所有网络配置，默认情况下是无法使用 k8s 自带的 dns 解析服务，但是可以修改 DNS 策略或者修改主机上的域名解析（/etc/resolv.conf），使主机可以用 k8s 自身的 dns 服务。一般通过 DNS 策略（ClusterFirstWithHostNet）来使用 k8s DNS 内部域名解析，k8s DNS 策略如下：\n\n\nDefault： 继承 Pod 所在宿主机的 DNS 设置，hostNetwork 的默认策略。\nClusterFirst（默认DNS策略）：优先使用 kubernetes 环境的 dns 服务，将无法解析的域名转发到从宿主机继承的 dns 服务器。\nClusterFirstWithHostNet：和 ClusterFirst 类似，对于以 hostNetwork 模式运行的 Pod 应明确知道使用该策略。也是可以同时解析内部和外部的域名。\nNone： 忽略 kubernetes 环境的 dns 配置，通过 spec.dnsConfig 自定义 DNS 配置。\n","url":"https://www.hi-linux.com/posts/42597.html","tags":["Linux","Docker","Kubernetes"],"categories":["Linux"]}