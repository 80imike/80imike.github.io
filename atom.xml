<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>è¿ç»´ä¹‹ç¾</title>
  
  <subtitle>ç§ä¸€æ£µæ ‘æœ€å¥½çš„æ—¶é—´æ˜¯åå¹´å‰ï¼Œå…¶æ¬¡æ˜¯ç°åœ¨ã€‚</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.hi-linux.com/"/>
  <updated>2020-05-15T04:57:12.030Z</updated>
  <id>https://www.hi-linux.com/</id>
  
  <author>
    <name>Mike</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>æ¨èä¸€æ¬¾æ— éœ€å®‰è£…ï¼Œä»…éœ€ 1 æ¡æŒ‡ä»¤ï¼Œç§’å®ç°å†…ç½‘ç©¿é€çš„ç¥å™¨ Serveo</title>
    <link href="https://www.hi-linux.com/posts/56863.html"/>
    <id>https://www.hi-linux.com/posts/56863.html</id>
    <published>2020-05-15T01:00:00.000Z</published>
    <updated>2020-05-15T04:57:12.030Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><h2 id="ä»€ä¹ˆæ˜¯-serveo">ä»€ä¹ˆæ˜¯ Serveo</h2><p><code>Serveo</code> æ˜¯ä¸€ä¸ªå…è´¹çš„å†…ç½‘ç©¿é€æœåŠ¡ï¼Œ<code>Serveo</code> å¯ä»¥å°†æœ¬åœ°è®¡ç®—æœºæš´éœ²åœ¨äº’è”ç½‘ä¸Šï¼Œå®˜æ–¹å£°ç§°å…¶ä¸º <code>Ngrok</code> çš„ç»ä½³æ›¿ä»£å“ã€‚</p><p><code>Serveo</code> å…¶æœ€å¤§ä¼˜ç‚¹æ˜¯ä½¿ç”¨ç°æœ‰çš„ <code>SSH</code> å®¢æˆ·ç«¯ï¼Œæ— éœ€å®‰è£…ä»»ä½•å®¢æˆ·ç«¯è½¯ä»¶ï¼Œå³å¯å®Œæˆç«¯å£è½¬å‘ã€‚</p><p><img src="https://www.hi-linux.com/img/linux/serveo.png" alt=""></p><p><code>Serveo</code> å·¥ä½œåŸç†å¾ˆç®€å•ï¼šå½“ç”¨æˆ·é€šè¿‡ <code>SSH</code> è¿æ¥åˆ° <code>Serveo</code> æ—¶ä¼šä¸è¯¥ç½‘ç«™å»ºç«‹ä¸€ä¸ªè¿œç¨‹ä»£ç†ï¼Œ<code>Serveo</code> éšåä¼šç”Ÿæˆä¸€ä¸ª å…¬å…± <code>URL</code>ï¼Œä»»ä½•äººéƒ½å¯ä»¥é€šè¿‡è¿™ä¸ª <code>URL</code> è®¿é—®ä½ çš„æœ¬åœ°è®¡ç®—æœºã€‚</p><blockquote><p>é¡¹ç›®åœ°å€: <a href="https://serveo.net" target="_blank" rel="noopener">https://serveo.net</a></p></blockquote><a id="more"></a><h2 id="ä½¿ç”¨-serveo">ä½¿ç”¨ Serveo</h2><p><code>Serveo</code> çš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œåªéœ€è¦å¯ä»¥ä½¿ç”¨ <code>SSH</code> å®¢æˆ·ç«¯å¹¶ä¸”èƒ½è¿æ¥åˆ°äº’è”ç½‘çš„ä»»æ„ç³»ç»Ÿéƒ½è¡Œã€‚æ¯”å¦‚ï¼š<code>Linux</code>ã€<code>Windows</code>ã€<code>MacOS</code> ç­‰ç³»ç»Ÿï¼Œå°±ç®—æ˜¯ <code>Android</code>ã€<code>iOS</code> ä¹ŸåŒæ ·æ²¡é—®é¢˜ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªæœ€å¸¸ç”¨çš„ä½¿ç”¨å®ä¾‹ï¼š</p><ol><li>å¼€æ”¾æœ¬åœ°æœåŠ¡åˆ°å…¬ç½‘</li></ol><p>å°†ä¸€ä¸ªæœ¬åœ°åº”ç”¨çš„ 8080 ç«¯å£æ˜ å°„åˆ°å…¬ç½‘ä¸­ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># å¦‚æœè¦è½¬å‘å…¶å®ƒç«¯å£ï¼Œåªéœ€æ›¿æ¢ç«¯å£ä¸ºå…¶å®ƒå°±å¯ä»¥äº†</span><br><span class="line">$ ssh -R 80:localhost:8080 serveo.net</span><br><span class="line">Hi there</span><br><span class="line">Forwarding HTTP traffic from https:&#x2F;&#x2F;heryum.serveo.net</span><br><span class="line">Press g to start a GUI session and ctrl-c to quit.</span><br></pre></td></tr></table></figure><p><code>SSH</code> è¿æ¥æˆåŠŸåï¼Œä¼šéšæœºç”Ÿæˆä¸€ä¸ª <code>serveo.net</code> äºŒçº§åŸŸåã€‚éšåä½ å°±å¯ä»¥ä½¿ç”¨æµè§ˆå™¨è®¿é—®è¿™ä¸ªéšæœºç”Ÿæˆçš„äºŒçº§åŸŸå <code>heryum.serveo.net</code> é—´æ¥è®¿é—®åˆ°æœ¬åœ°è®¡ç®—æœº 8080 ç«¯å£ä¸Šçš„æœåŠ¡äº†ã€‚</p><blockquote><p><code>SSH</code> åˆæ¬¡å’Œä¸€ä¸ªæ–°æœåŠ¡å™¨å»ºç«‹è¿æ¥æ—¶ä¼šæœ‰æç¤ºï¼Œç›´æ¥é€‰æ‹© yes å³å¯ã€‚</p></blockquote><p>å¦‚æœä½ ä¸æƒ³ä½¿ç”¨éšæœºåŸŸåï¼Œæƒ³æŒ‡å®šä¸€ä¸ªå›ºå®šçš„äºŒçº§åŸŸåä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># è¿™é‡ŒæŒ‡å®šä¸º ywzm.serveo.netï¼Œå¯ä»¥æ ¹æ®è‡ªèº«æƒ…å†µè¿›è¡Œæ›¿æ¢</span><br><span class="line">$ ssh -R ywzm:80:localhost:8080 serveo.net</span><br><span class="line">Hi there</span><br><span class="line">Forwarding HTTP traffic from https:&#x2F;&#x2F;ywzm.serveo.net</span><br><span class="line">Press g to start a GUI session and ctrl-c to quit.</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"># ä¸Šé¢çš„åŸŸåæ˜¯ç®€å†™çš„ï¼Œä½ ä¹Ÿå¯ä»¥å†™å‡ºå®Œæ•´çš„åŸŸåã€‚</span><br><span class="line">$ ssh -R ywzm.serveo.net:80:localhost:8080 serveo.net</span><br></pre></td></tr></table></figure><p><code>SSH</code> è¿æ¥æˆåŠŸåï¼Œæ­¤æ—¶å°±å¯ä»¥åœ¨å…¬ç½‘ä¸Šä½¿ç”¨ <code>ywzm.serveo.net</code> è®¿é—®åˆ°ä½ æœ¬åœ°è®¡ç®—æœº 8080 ç«¯å£çš„æœåŠ¡äº†ã€‚</p><p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è½¬å‘çš„æ˜¯ <code>HTTP</code> æœåŠ¡ã€‚å¦‚æœä½ éœ€è¦è½¬å‘çš„æ˜¯ <code>TCP</code> æœåŠ¡ï¼Œåˆåº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿå…¶å®æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼ŒåŒæ ·åªéœ€è®¾ç½®å…¬ç½‘çš„è½¬å‘ç«¯å£å’Œæœ¬åœ°ç«¯å£å°±å¯ä»¥äº†ã€‚ä¾‹å¦‚ï¼šæˆ‘ä»¬éœ€è¦å°†æœ¬åœ° 3306 ç«¯å£è½¬å‘åˆ°å…¬ç½‘ä¸­ï¼Œä½¿ç”¨ä¸‹é¢å‘½ä»¤å³å¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># å¯ä»¥è‡ªè¡Œè®¾ç½®å…¬ç½‘ç«¯å£ï¼Œè¿™é‡Œè®¾ç½®ä¸º 1492</span><br><span class="line">$ ssh -R 1492:localhost:3306 serveo.net</span><br><span class="line"></span><br><span class="line"># å¦‚æœå…¬ç½‘ç«¯å£è®¾ç½®ä¸º 0ï¼Œå°±ä¼šé‡‡ç”¨ä¸€ä¸ªéšæœºç«¯å£è¿›è¡Œè½¬å‘</span><br><span class="line">$ ssh -R 0:localhost:3306 serveo.net</span><br></pre></td></tr></table></figure><ol start="2"><li>å°†æœ¬åœ° SSH é‡å®šå‘åˆ°å…¬ç½‘</li></ol><p>åœ¨å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦è¿œç¨‹è®¿é—®åˆ°æœ¬åœ°è®¡ç®—æœºçš„ <code>SSH</code> æœåŠ¡ã€‚è¦å®ç°è¿™æ ·çš„éœ€æ±‚ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># åç§°ä¸ºè‡ªå®šä¹‰çš„ï¼Œè¿™é‡Œè®¾ç½®ä¸º myhost</span><br><span class="line">$ ssh -R myhost:22:localhost:22 serveo.net</span><br><span class="line">Hi there</span><br><span class="line">Forwarding SSH traffic from alias &quot;myhost&quot;</span><br><span class="line">Press g to start a GUI session and ctrl-c to quit.</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>è¿æ¥æˆåŠŸåï¼Œæ¥ä¸‹æ¥ä½ å°±å¯ä»¥ä»å…¬ç½‘ä¸Šå¯¹è¿™ä¸ªå†…ç½‘è®¡ç®—æœºçš„ <code>SSH</code> è¿›è¡Œè®¿é—®äº†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -J serveo.net myuser@myhost</span><br><span class="line">Hi there</span><br><span class="line">myuser@myhost&#39;s password:</span><br><span class="line">Last login: Mon Dec 24 21:00:32 2019 from 127.0.0.1</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p><code>-J</code> é€‰é¡¹æ˜¯åœ¨ <code>OpenSSH 7.3</code> ç‰ˆæœ¬æ‰å¼•å…¥çš„ï¼Œå¦‚æœä½ ä½¿ç”¨çš„ <code>SSH</code> å®¢æˆ·ç«¯ç‰ˆæœ¬è¾ƒæ—§ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ <code>ProxyCommand</code> é€‰é¡¹æ¥æ›¿ä»£ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -o ProxyCommand&#x3D;&quot;ssh -W myhost:22 serveo.net&quot; user@myhost</span><br></pre></td></tr></table></figure><h2 id="ä¸€äº›å…¶å®ƒæŠ€å·§">ä¸€äº›å…¶å®ƒæŠ€å·§</h2><ol><li>ä¿æŒ SSH è¿æ¥ä¸è¶…æ—¶</li></ol><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œ<code>SSH</code> è¿æ¥ä¸€æ—¦è¶…æ—¶å°±ä¼šè‡ªåŠ¨æ–­å¼€ï¼Œè¿™æ ·å°±å¾ˆå®¹æ˜“é€ æˆæœåŠ¡ä¸­æ–­ã€‚è¿™é‡Œæˆ‘ä»¬åªéœ€ç»™ <code>SSH</code> è¿æ¥å¢åŠ ä¸€ä¸ªä¿æ´»å‚æ•° <code>-o ServerAliveInterval=60</code> å°±å¯ä»¥äº†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æ¯éš” 60 ç§’åšä¸€æ¬¡è¿æ¥ä¿æ´»</span><br><span class="line">$ ssh -o ServerAliveInterval&#x3D;60 -R 80:localhost:8080 serveo.net</span><br></pre></td></tr></table></figure><ol start="2"><li>å¯¹ SSH è¿æ¥è¿›è¡Œå®ˆæŠ¤</li></ol><p>ä¸Šé¢çš„æ–¹æ³•è™½ç„¶å¯ä»¥è§£å†³è¶…æ—¶çš„é—®é¢˜ï¼Œä½†è¿›ç¨‹å§‹ç»ˆæ˜¯åœ¨å‰å°è¿è¡Œçš„ã€‚ä¸ºäº†å½»åº•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®˜æ–¹æ¨èä½¿ç”¨ <code>AutoSSH</code> æ¥è¿›è¡Œè¿›ç¨‹å®ˆæŠ¤ã€‚</p><blockquote><p><code>AutoSSH</code> æ˜¯ä¸€ä¸ªç”¨æ¥å¯¹ <code>SSH</code> è¿æ¥è¿›è¡Œç›‘æ§çš„ç¨‹åºï¼Œå¯åœ¨é‡åˆ°ç¨‹åºé—®é¢˜æˆ–è€…æ˜¯ç½‘ç»œé—®é¢˜æ—¶è‡ªåŠ¨è¿›è¡Œé‡è¿ï¼Œä»¥è¾¾åˆ°é•¿æœŸä¿æŒ <code>SSH</code> ç¨³å®šè¿æ¥çš„ç›®çš„ ã€‚</p></blockquote><ul><li>å®‰è£… AutoSSH</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Debian &#x2F; Ubuntu ç³»ç»Ÿ</span><br><span class="line">$ apt install autossh -y</span><br><span class="line"></span><br><span class="line"># CentOS &#x2F; RHEL ç³»ç»Ÿ</span><br><span class="line">$ yum install autossh -y</span><br></pre></td></tr></table></figure><ul><li>å°† AutoSSH åŠ å…¥åˆ°ç³»ç»ŸæœåŠ¡</li></ul><p>è¿™é‡Œä»¥åŠ å…¥åˆ° <code>Systemd</code> ç³»ç»ŸæœåŠ¡ä¸ºä¾‹ï¼Œæ­¤æ–¹æ³•é€‚ç”¨äº <code>CentOS 7</code>ã€<code>Debian 8</code>ã€<code>Ubuntu 16</code> åŠä»¥ä¸Šç³»ç»Ÿç‰ˆæœ¬ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª AutoSSH çš„ Systemd æœåŠ¡ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ cat &gt; &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;autossh.service &lt;&lt;EOF</span><br><span class="line">[Unit]</span><br><span class="line">Description&#x3D;autossh</span><br><span class="line">After&#x3D;network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type&#x3D;simple</span><br><span class="line">Environment&#x3D;&quot;AUTOSSH_GATETIME&#x3D;0&quot;</span><br><span class="line">ExecStart&#x3D;$(command -v autossh) -M 0 -o &quot;ServerAliveInterval 60&quot; -o &quot;ServerAliveCountMax 3&quot; -R 80:localhost:8080 serveo.net</span><br><span class="line">Restart&#x3D;on-abort</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy&#x3D;multi-user.target</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><blockquote><p><code>AutoSSH</code> çš„ <code>-M</code> å‚æ•°ä¸»è¦ç”¨äºæŒ‡å®šä¸€ä¸ªç›‘å¬ç«¯å£æ¥ç›‘è§† <code>SSH</code> è¿æ¥çŠ¶æ€ï¼Œè¿™é‡ŒæŒ‡å®šä¸º 0 çš„ä¸»è¦ç›®çš„æ˜¯ç¦ç”¨ <code>AutoSSH</code> çš„ç›‘æ§ç«¯å£ã€‚ä¿æ´»ä¾ç„¶ä½¿ç”¨ <code>SSH</code> è‡ªå·±çš„ <code>ServerAliveInterval</code> å’Œ <code>ServerAliveCountMax</code> é€‰é¡¹æ¥å®Œæˆã€‚</p></blockquote><p>å…¶æ¬¡ï¼Œ<code>Systemd</code> ç³»ç»ŸæœåŠ¡åˆ›å»ºå®Œæˆåï¼Œæˆ‘ä»¬å¯åŠ¨è¿™ä¸ª <code>AutoSSH</code> çš„æœåŠ¡å¹¶è®¾ç½®ä¸ºå¼€æœºè‡ªå¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl start autossh</span><br><span class="line">$ systemctl enable autossh</span><br></pre></td></tr></table></figure><ol start="3"><li>å¦‚æœä½ æ— æ³•é€šè¿‡ 22 ç«¯å£è¿æ¥åˆ° Serveoï¼Œå®˜æ–¹è¿˜é¢„ç•™äº† 443 ç«¯å£ç»™ä½ ä½¿ç”¨</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -p 443 -R 80:localhost:8080 serveo.net</span><br></pre></td></tr></table></figure><ol start="4"><li>ä½¿ç”¨è‡ªå®šä¹‰çš„åŸŸå / å­åŸŸå</li></ol><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨çš„ <code>Serveo</code> ç”Ÿæˆçš„äºŒçº§åŸŸåè¿›è¡Œè¿æ¥çš„ã€‚å¦‚æœä½ æƒ³ä½¿ç”¨è‡ªå·±çš„åŸŸåä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæ–¹æ³•éå¸¸ç®€å•ã€‚åªéœ€è¦åœ¨ä½ çš„åŸŸåæ‰€åœ¨ DNS ä¸­æ·»åŠ ä¸€æ¡ A è®°å½•å’Œä¸€æ¡ TXT è®°å½•å°±å¯å®ç°ã€‚</p><p>4.1 æ·»åŠ ä¸€æ¡ A è®°å½•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A | serveo | 159.89.214.31</span><br></pre></td></tr></table></figure><p>4.2 æ·»åŠ ä¸€æ¡ TXT è®°å½•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TXT | serveo | authkeyfp&#x3D;SHA256:pmc7ZRv7ymCmghUwHoJWEm5ToSTd33ryeDeps5RnfRY</span><br></pre></td></tr></table></figure><blockquote><p><code>authkeyfp</code> åé¢è·Ÿçš„é‚£ä¸€ä¸²å­—ç¬¦æ˜¯ <code>RSA</code> å¯†é’¥æŒ‡çº¹ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>ssh-keygen -l</code> å‘½ä»¤è¿›è¡ŒæŸ¥çœ‹ã€‚</p></blockquote><p>DNS è§£æè®°å½•å¢åŠ å¥½åï¼Œä½ å°±å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰åŸŸåè¿›è¡Œè¿æ¥äº†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -R serveo.ywzm.org:80:localhost:3000 serveo.net</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œ<code>Serveo</code> çš„åŸºæœ¬ç”¨æ³•å°±ä»‹ç»å®Œäº†ã€‚å¦‚æœä½ å¯¹å®ƒæœ‰æ›´å¤šçš„å…´è¶£ï¼Œæ¬¢è¿å»å®˜ç½‘è¿›è¡Œæ¢ç´¢ã€‚</p><h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2><ol><li><p>https:/www.google.com</p></li><li><p><a href="https://www.moerats.com/archives/990/" target="_blank" rel="noopener">https://www.moerats.com/archives/990/</a></p></li><li><p><a href="https://blog.rxliuli.com/p/5ad7fa84/" target="_blank" rel="noopener">https://blog.rxliuli.com/p/5ad7fa84/</a></p></li><li><p><a href="https://www.jianshu.com/p/d0b3991a9ce1" target="_blank" rel="noopener">https://www.jianshu.com/p/d0b3991a9ce1</a></p></li><li><p><a href="https://blog.csdn.net/kongxx/article/details/86178364" target="_blank" rel="noopener">https://blog.csdn.net/kongxx/article/details/86178364</a></p></li><li><p><a href="https://www.everythingcli.org/ssh-tunnelling-for-fun-and-profit-autossh/" target="_blank" rel="noopener">https://www.everythingcli.org/ssh-tunnelling-for-fun-and-profit-autossh/</a></p></li></ol></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä»€ä¹ˆæ˜¯-Serveo&quot;&gt;ä»€ä¹ˆæ˜¯ Serveo&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Serveo&lt;/code&gt; æ˜¯ä¸€ä¸ªå…è´¹çš„å†…ç½‘ç©¿é€æœåŠ¡ï¼Œ&lt;code&gt;Serveo&lt;/code&gt; å¯ä»¥å°†æœ¬åœ°è®¡ç®—æœºæš´éœ²åœ¨äº’è”ç½‘ä¸Šï¼Œå®˜æ–¹å£°ç§°å…¶ä¸º &lt;code&gt;Ngrok&lt;/code&gt; çš„ç»ä½³æ›¿ä»£å“ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Serveo&lt;/code&gt; å…¶æœ€å¤§ä¼˜ç‚¹æ˜¯ä½¿ç”¨ç°æœ‰çš„ &lt;code&gt;SSH&lt;/code&gt; å®¢æˆ·ç«¯ï¼Œæ— éœ€å®‰è£…ä»»ä½•å®¢æˆ·ç«¯è½¯ä»¶ï¼Œå³å¯å®Œæˆç«¯å£è½¬å‘ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.hi-linux.com/img/linux/serveo.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Serveo&lt;/code&gt; å·¥ä½œåŸç†å¾ˆç®€å•ï¼šå½“ç”¨æˆ·é€šè¿‡ &lt;code&gt;SSH&lt;/code&gt; è¿æ¥åˆ° &lt;code&gt;Serveo&lt;/code&gt; æ—¶ä¼šä¸è¯¥ç½‘ç«™å»ºç«‹ä¸€ä¸ªè¿œç¨‹ä»£ç†ï¼Œ&lt;code&gt;Serveo&lt;/code&gt; éšåä¼šç”Ÿæˆä¸€ä¸ª å…¬å…± &lt;code&gt;URL&lt;/code&gt;ï¼Œä»»ä½•äººéƒ½å¯ä»¥é€šè¿‡è¿™ä¸ª &lt;code&gt;URL&lt;/code&gt; è®¿é—®ä½ çš„æœ¬åœ°è®¡ç®—æœºã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¡¹ç›®åœ°å€: &lt;a href=&quot;https://serveo.net&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://serveo.net&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/categories/Linux/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="æŠ€å·§" scheme="https://www.hi-linux.com/tags/%E6%8A%80%E5%B7%A7/"/>
    
      <category term="å†…ç½‘ç©¿é€" scheme="https://www.hi-linux.com/tags/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ Kind åœ¨ 5 åˆ†é’Ÿå†…å¿«é€Ÿéƒ¨ç½²ä¸€ä¸ª Kubernetes é«˜å¯ç”¨é›†ç¾¤</title>
    <link href="https://www.hi-linux.com/posts/42332.html"/>
    <id>https://www.hi-linux.com/posts/42332.html</id>
    <published>2020-05-14T01:00:00.000Z</published>
    <updated>2020-05-14T05:17:15.652Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><h2 id="ä»€ä¹ˆæ˜¯-kind">ä»€ä¹ˆæ˜¯ Kind</h2><p><code>Kind</code>ï¼ˆKubernetes in Dockerï¼‰ æ˜¯ä¸€ä¸ª <code>Kubernetes</code> å­µåŒ–é¡¹ç›®ï¼Œ<code>Kind</code> æ˜¯ä¸€å¥—å¼€ç®±å³ç”¨çš„ <code>Kubernetes</code> ç¯å¢ƒæ­å»ºæ–¹æ¡ˆã€‚é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å°† <code>Kubernetes</code> æ‰€éœ€è¦çš„æ‰€æœ‰ç»„ä»¶ï¼Œå…¨éƒ¨éƒ¨ç½²åœ¨ä¸€ä¸ª <code>Docker</code> å®¹å™¨ä¸­ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„æ­å»º <code>Kubernetes</code> é›†ç¾¤ã€‚</p><p><code>Kind</code> å·²ç»å¹¿æ³›çš„åº”ç”¨äº <code>Kubernetes</code> ä¸Šæ¸¸åŠç›¸å…³é¡¹ç›®çš„ <code>CI</code> ç¯å¢ƒä¸­ï¼Œå®˜æ–¹æ–‡æ¡£ä¸­ä¹ŸæŠŠ <code>Kind</code> ä½œä¸ºä¸€ç§æœ¬åœ°é›†ç¾¤æ­å»ºçš„å·¥å…·æ¨èç»™å¤§å®¶ã€‚</p><blockquote><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/kubernetes-sigs/kind" target="_blank" rel="noopener">https://github.com/kubernetes-sigs/kind</a></p></blockquote><p><strong>Kind å¯ä»¥åšä»€ä¹ˆï¼Ÿ</strong></p><ol><li><p>å¿«é€Ÿåˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ª <code>Kubernetes</code> é›†ç¾¤</p></li><li><p>æ”¯æŒéƒ¨ç½²é«˜å¯ç”¨çš„ <code>Kubernetes</code> é›†ç¾¤</p></li><li><p>æ”¯æŒä»æºç æ„å»ºå¹¶éƒ¨ç½²ä¸€ä¸ª <code>Kubernetes</code> é›†ç¾¤</p></li><li><p>å¯ä»¥å¿«é€Ÿä½æˆæœ¬ä½“éªŒä¸€ä¸ªæœ€æ–°çš„ <code>Kubernetes</code> é›†ç¾¤ï¼Œå¹¶æ”¯æŒ <code>Kubernetes</code> çš„ç»å¤§éƒ¨åˆ†åŠŸèƒ½</p></li><li><p>æ”¯æŒæœ¬åœ°ç¦»çº¿è¿è¡Œä¸€ä¸ªå¤šèŠ‚ç‚¹é›†ç¾¤</p></li></ol><p><strong>Kind æœ‰å“ªäº›ä¼˜åŠ¿ï¼Ÿ</strong></p><ol><li><p>æœ€å°çš„å®‰è£…ä¾èµ–ï¼Œä»…éœ€è¦å®‰è£… <code>Docker</code> å³å¯</p></li><li><p>ä½¿ç”¨æ–¹æ³•ç®€å•ï¼Œåªéœ€ <code>Kind Cli</code> å·¥å…·å³å¯å¿«é€Ÿåˆ›å»ºé›†ç¾¤</p></li><li><p>ä½¿ç”¨å®¹å™¨æ¥æ¨¡ä¼¼ <code>Kubernetes</code> èŠ‚ç‚¹</p></li><li><p>å†…éƒ¨ä½¿ç”¨ <code>Kubeadm</code> çš„å®˜æ–¹ä¸»æµéƒ¨ç½²å·¥å…·</p></li><li><p>é€šè¿‡äº† <code>CNCF</code> å®˜æ–¹çš„ <code>K8S Conformance</code> æµ‹è¯•</p></li></ol><a id="more"></a><p><strong>Kind æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</strong></p><p><img src="https://www.hi-linux.com/img/linux/kind-demo.gif" alt=""></p><p><code>Kind</code> ä½¿ç”¨å®¹å™¨æ¥æ¨¡æ‹Ÿæ¯ä¸€ä¸ª <code>Kubernetes</code> èŠ‚ç‚¹ï¼Œå¹¶åœ¨å®¹å™¨é‡Œé¢è¿è¡Œ <code>Systemd</code>ã€‚ å®¹å™¨é‡Œçš„ <code>Systemd</code> æ‰˜ç®¡äº† <code>Kubelet</code> å’Œ <code>Containerd</code>ï¼Œç„¶åå®¹å™¨å†…éƒ¨çš„ <code>Kubelet</code> æŠŠå…¶å®ƒ <code>Kubernetes</code> ç»„ä»¶ï¼š<code>Kube-Apiserver</code>ã€<code>Etcd</code>ã€<code>CNI</code> ç­‰ç­‰ç»„ä»¶è¿è¡Œèµ·æ¥ã€‚</p><p><code>Kind</code> å†…éƒ¨ä½¿ç”¨äº† <code>Kubeadm</code> è¿™ä¸ªå·¥å…·æ¥åšé›†ç¾¤çš„éƒ¨ç½²ï¼ŒåŒ…æ‹¬é«˜å¯ç”¨é›†ç¾¤ä¹Ÿæ˜¯å€ŸåŠ© <code>Kubeadm</code> æä¾›çš„ç‰¹æ€§æ¥å®Œæˆçš„ã€‚åœ¨é«˜ç”¨é›†ç¾¤ä¸‹è¿˜ä¼šé¢å¤–éƒ¨ç½²äº†ä¸€ä¸ª <code>Nginx</code> æ¥æä¾›è´Ÿè½½å‡è¡¡ <code>VIP</code>ã€‚</p><h2 id="å®‰è£…-kind">å®‰è£… Kind</h2><h3 id="å®‰è£…-kind-ä¾èµ–ç»„ä»¶">å®‰è£… Kind ä¾èµ–ç»„ä»¶</h3><p><code>Kind</code> æŠŠéƒ¨ç½² <code>Kubernetes</code> ç¯å¢ƒçš„ä¾èµ–é™ä½åˆ°äº†æœ€å°ï¼Œä»…éœ€è¦æœºå™¨å®‰è£… <code>Docker</code> å³å¯ã€‚</p><ol><li>å®‰è£… Docker</li></ol><p>è¿™é‡Œä»¥ <code>Linux</code> ç³»ç»Ÿä¸ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl -sSL https:&#x2F;&#x2F;get.daocloud.io&#x2F;docker | sh</span><br></pre></td></tr></table></figure><p>æ›´å¤šå¹³å°çš„å®‰è£…æ–¹æ³•å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.docker.com/install/" target="_blank" rel="noopener">https://docs.docker.com/install/</a></p><ol start="2"><li>å®‰è£… Kubectl</li></ol><p>å¦‚æœä½ éœ€è¦é€šè¿‡å‘½ä»¤è¡Œç®¡ç†é›†ç¾¤ï¼Œåˆ™éœ€è¦å®‰è£… <code>Kubectl</code>ã€‚</p><p>è¿™é‡Œä»¥ <code>Linux</code> ç³»ç»Ÿä¸ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ curl -LO https:&#x2F;&#x2F;storage.googleapis.com&#x2F;kubernetes-release&#x2F;release&#x2F;v1.15.0&#x2F;bin&#x2F;linux&#x2F;amd64&#x2F;kubectl</span><br><span class="line">$ chmod +x .&#x2F;kubectl</span><br><span class="line">$ sudo mv .&#x2F;kubectl &#x2F;usr&#x2F;local&#x2F;bin&#x2F;kubectl</span><br></pre></td></tr></table></figure><p>æ›´å¤šå¹³å°çš„å®‰è£…æ–¹æ³•å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/#install-kubectl" target="_blank" rel="noopener">https://kubernetes.io/docs/tasks/tools/install-kubectl/#install-kubectl</a></p><h3 id="å®‰è£…-kind">å®‰è£… Kind</h3><p><code>Kind</code> ä½¿ç”¨ <code>Golang</code> è¿›è¡Œå¼€å‘ï¼ŒåŸç”Ÿæ”¯æŒè‰¯å¥½çš„è·¨å¹³å°ç‰¹æ€§ï¼Œé€šå¸¸åªéœ€è¦ç›´æ¥ä¸‹è½½æ„å»ºå¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶å°±å¯ä½¿ç”¨ã€‚</p><ol><li>é€šè¿‡äºŒè¿›åˆ¶å®‰è£…</li></ol><ul><li>Linux</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ curl -Lo .&#x2F;kind https:&#x2F;&#x2F;github.com&#x2F;kubernetes-sigs&#x2F;kind&#x2F;releases&#x2F;download&#x2F;v0.5.1&#x2F;kind-linux-amd64</span><br><span class="line">$ chmod +x .&#x2F;kind</span><br><span class="line">$ mv .&#x2F;kind &#x2F;usr&#x2F;local&#x2F;bin&#x2F;kind</span><br></pre></td></tr></table></figure><ul><li>Windows</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl.exe -Lo kind-windows-amd64.exe https:&#x2F;&#x2F;github.com&#x2F;kubernetes-sigs&#x2F;kind&#x2F;releases&#x2F;download&#x2F;v0.5.1&#x2F;kind-windows-amd64</span><br><span class="line">$ mv .\kind-windows-amd64.exe c:\kind.exe</span><br></pre></td></tr></table></figure><p>æ›´å¤šå¹³å°çš„å®‰è£…æ–¹æ³•å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://kind.sigs.k8s.io/docs/user/quick-start/" target="_blank" rel="noopener">https://kind.sigs.k8s.io/docs/user/quick-start/</a></p><ol start="2"><li>é€šè¿‡æºç å®‰è£…</li></ol><p>å¦‚æœæœ¬åœ°ç¯å¢ƒå·²ç»é…ç½®å¥½ Golang (1.11+)  çš„å¼€å‘ç¯å¢ƒï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡æºç è¿›è¡Œå®‰è£…ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ go get sigs.k8s.io&#x2F;kind@v0.5.1</span><br></pre></td></tr></table></figure><p>è¿è¡Œå®Œä¸Šè¿°å‘½ä»¤åï¼Œä¼šå°† <code>Kind</code> çš„å¯æ‰§è¡Œæ–‡ä»¶æ”¾åˆ° <code>$GOPATH/bin</code> ç›®å½•å†…ã€‚ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œä½ éœ€è¦å°†æ­¤ç›®å½•åŠ å…¥åˆ° <code>$PATH</code> ä¸­ã€‚</p><h2 id="ä½¿ç”¨-kind">ä½¿ç”¨ Kind</h2><p>å®‰è£…å®Œæˆä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æ¥çœ‹çœ‹ <code>Kind</code> æ”¯æŒå“ªäº›å‘½ä»¤è¡Œæ“ä½œã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ kind</span><br><span class="line">kind creates and manages local Kubernetes clusters using Docker container &#39;nodes&#39;</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  kind [command]</span><br><span class="line"></span><br><span class="line">Available Commands:</span><br><span class="line">  build       Build one of [base-image, node-image]</span><br><span class="line">  create      Creates one of [cluster]</span><br><span class="line">  delete      Deletes one of [cluster]</span><br><span class="line">  export      exports one of [logs]</span><br><span class="line">  get         Gets one of [clusters, nodes, kubeconfig-path]</span><br><span class="line">  help        Help about any command</span><br><span class="line">  load        Loads images into nodes</span><br><span class="line">  version     prints the kind CLI version</span><br><span class="line"></span><br><span class="line">Flags:</span><br><span class="line">  -h, --help              help for kind</span><br><span class="line">      --loglevel string   logrus log level [panic, fatal, error, warning, info, debug] (default &quot;warning&quot;)</span><br><span class="line">      --version           version for kind</span><br><span class="line"></span><br><span class="line">Use &quot;kind [command] --help&quot; for more information about a command.</span><br></pre></td></tr></table></figure><p>ç®€å•è¯´ä¸‹å‡ ä¸ªæ¯”è¾ƒå¸¸ç”¨é€‰é¡¹çš„å«ä¹‰ï¼š</p><ul><li><p><code>build</code>ï¼šç”¨æ¥ä» <code>Kubernetes</code> æºä»£ç æ„å»ºä¸€ä¸ªæ–°çš„é•œåƒã€‚</p></li><li><p><code>create</code>ï¼šåˆ›å»ºä¸€ä¸ª <code>Kubernetes</code> é›†ç¾¤ã€‚</p></li><li><p><code>delete</code>ï¼šåˆ é™¤ä¸€ä¸ª <code>Kubernetes</code> é›†ç¾¤ã€‚</p></li><li><p><code>get</code>ï¼š å¯ç”¨æ¥æŸ¥çœ‹å½“å‰é›†ç¾¤ã€èŠ‚ç‚¹ä¿¡æ¯ä»¥åŠ <code>Kubectl</code> é…ç½®æ–‡ä»¶çš„åœ°å€ã€‚</p></li><li><p><code>load</code>ï¼šä»å®¿ä¸»æœºå‘ <code>Kubernetes</code> èŠ‚ç‚¹å†…å¯¼å…¥é•œåƒã€‚</p></li></ul><h2 id="ä½¿ç”¨-kind-åˆ›å»º-kubernetes-é›†ç¾¤">ä½¿ç”¨ Kind åˆ›å»º Kubernetes é›†ç¾¤</h2><h3 id="æ­å»ºä¸€ä¸ªå•èŠ‚ç‚¹é›†ç¾¤">æ­å»ºä¸€ä¸ªå•èŠ‚ç‚¹é›†ç¾¤</h3><p>æ­å»ºå•èŠ‚ç‚¹é›†ç¾¤æ˜¯ <code>Kind</code> æœ€åŸºç¡€çš„åŠŸèƒ½ï¼Œå½“ç„¶ä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼Œä»…éœ€ä¸€æ¡æŒ‡ä»¤å³å¯å®Œæˆã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ kind create cluster --name my-cluster</span><br><span class="line">Creating cluster &quot;my-cluster&quot; ...</span><br><span class="line"> âœ“ Ensuring node image (kindest&#x2F;node:v1.15.3) ğŸ–¼</span><br><span class="line"> âœ“ Preparing nodes ğŸ“¦</span><br><span class="line"> âœ“ Creating kubeadm config ğŸ“œ</span><br><span class="line"> âœ“ Starting control-plane ğŸ•¹ï¸</span><br><span class="line">Cluster creation complete. You can now use the cluster with:</span><br><span class="line"></span><br><span class="line">export KUBECONFIG&#x3D;&quot;$(kind get kubeconfig-path --name&#x3D;&quot;my-cluster&quot;)&quot;</span><br><span class="line">kubectl cluster-info</span><br></pre></td></tr></table></figure><blockquote><p>ä»¥ä¸Šå‘½ä»¤ä¸­ <code>--name</code> æ˜¯å¯é€‰å‚æ•°ã€‚å¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤åˆ›å»ºå‡ºæ¥çš„é›†ç¾¤åå­—ä¸º <code>kind</code>ã€‚</p></blockquote><p>ä½¿ç”¨é»˜è®¤å®‰è£…çš„æ–¹å¼æ—¶ï¼Œæˆ‘ä»¬æ²¡æœ‰æŒ‡å®šä»»ä½•é…ç½®æ–‡ä»¶ã€‚ä»å®‰è£…è¿‡ç¨‹çš„è¾“å‡ºæ¥çœ‹ï¼Œä¸€å…±åˆ†ä¸º 4 æ­¥ï¼š</p><ul><li><p>æ£€æŸ¥æœ¬åœ°ç¯å¢ƒæ˜¯å¦å­˜åœ¨ä¸€ä¸ªåŸºç¡€çš„å®‰è£…é•œåƒï¼Œé»˜è®¤æ˜¯ <code>kindest/node:v1.15.3</code>ï¼Œè¯¥é•œåƒé‡Œé¢åŒ…å«äº†æ‰€æœ‰éœ€è¦å®‰è£…çš„ä¸œè¥¿ï¼ŒåŒ…æ‹¬ï¼š<code>kubectl</code>ã€<code>kubeadm</code>ã€<code>kubelet</code> çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä»¥åŠå®‰è£…å¯¹åº”ç‰ˆæœ¬ <code>Kubernetes</code> æ‰€éœ€è¦çš„é•œåƒã€‚</p></li><li><p>å‡†å¤‡ <code>Kubernetes</code> èŠ‚ç‚¹ï¼Œä¸»è¦å°±æ˜¯å¯åŠ¨å®¹å™¨ã€è§£å‹é•œåƒè¿™ç±»çš„æ“ä½œã€‚</p></li><li><p>å»ºç«‹å¯¹åº”çš„ <code>kubeadm</code> çš„é…ç½®ï¼Œå®Œæˆä¹‹åå°±é€šè¿‡ <code>kubeadm</code> è¿›è¡Œå®‰è£…ã€‚å®‰è£…å®Œæˆåè¿˜ä¼šåšä¸€äº›æ¸…ç†æ“ä½œï¼Œæ¯”å¦‚ï¼šåˆ æ‰ä¸»èŠ‚ç‚¹ä¸Šçš„æ±¡ç‚¹ï¼Œå¦åˆ™å¯¹äºæ²¡æœ‰å®¹å¿çš„ <code>Pod</code> æ— æ³•å®Œæˆéƒ¨ç½²ã€‚</p></li><li><p>ä¸Šé¢æ‰€æœ‰æ“ä½œéƒ½å®Œæˆåï¼Œå°±æˆåŠŸå¯åŠ¨äº†ä¸€ä¸ª <code>Kubernetes</code> é›†ç¾¤å¹¶è¾“å‡ºä¸€äº›æ“ä½œé›†ç¾¤çš„æç¤ºä¿¡æ¯ã€‚</p></li></ul><blockquote><ol><li><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>Kind</code> ä¼šå…ˆä¸‹è½½ <code>kindest/node:v1.15.3</code> é•œåƒã€‚å¦‚æœä½ æƒ³æŒ‡å®šä¸åŒç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ <code>--image</code> å‚æ•°ï¼Œç±»ä¼¼è¿™æ ·ï¼š<code>kind create cluster --image kindest/node:v1.15.3</code></p></li><li><p><code>kindest/node</code> è¿™ä¸ªé•œåƒç›®å‰æ‰˜ç®¡äº Docker Hub ä¸Šï¼Œä¸‹è½½æ—¶å¯èƒ½ä¼šè¾ƒæ…¢ã€‚åŒæ ·çš„é—®é¢˜ <code>Kind</code> è¿›è¡Œé›†ç¾¤çš„åˆ›å»ºä¹Ÿæ˜¯å­˜åœ¨çš„ï¼Œ<code>Kind</code> å®é™…ä½¿ç”¨ <code>Kubeadm</code> è¿›è¡Œé›†ç¾¤çš„åˆ›å»ºã€‚å¯¹ <code>Kubeadm</code> æœ‰æ‰€äº†è§£çš„åŒå­¦éƒ½çŸ¥é“å®ƒé»˜è®¤ä½¿ç”¨çš„é•œåƒåœ¨å›½å†…æ˜¯ä¸èƒ½è®¿é—®çš„ï¼Œæ‰€ä»¥ä¸€æ ·éœ€è¦è‡ªè¡Œè§£å†³ç½‘ç»œé—®é¢˜ã€‚</p></li><li><p>å¦‚æœä½ å­˜åœ¨ä¸Šé¢è¯´çš„ç½‘ç»œé—®é¢˜ï¼Œæœ€å¥½é…ç½®ä¸€ä¸ªå›½å†…çš„åŠ é€Ÿå™¨æˆ–è€…é•œåƒæºã€‚å¦‚æœä½ è¿˜ä¸çŸ¥é“å¦‚ä½•é…ç½®åŠ é€Ÿå™¨å’Œé•œåƒæºå¯ä»¥å‚è€ƒï¼šã€Œ<a href="https://mp.weixin.qq.com/s?__biz=MzI3MTI2NzkxMA==&amp;mid=2247488553&amp;idx=1&amp;sn=14cbe47bc50df50f536345efb4d10b5e&amp;chksm=eac53500ddb2bc16be6bbfe69917895d0feed7c4e85d40450a5adb931ff01257d9f546c58538&amp;token=687022088&amp;lang=zh_CN#rd" target="_blank" rel="noopener">Docker / Kubernetes é•œåƒæºä¸å¯ç”¨ï¼Œæ•™ä½ å‡ æ‹›æå®šå®ƒï¼</a>ã€å’Œ ã€Œ<a href="https://mp.weixin.qq.com/s?__biz=MzI3MTI2NzkxMA==&amp;mid=2247483698&amp;idx=1&amp;sn=dfb6edca74539a9a4d8228495d1c17a0&amp;chksm=eac5201bddb2a90d5f8e6d4733ed2d0ff9466474471933e4ea5d5fc1ef6be15b86470f50eccb&amp;token=21948731&amp;lang=zh_CN#rd" target="_blank" rel="noopener"> Docker ä¸‹ä½¿ç”¨ DaoCloud / é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿ</a>ã€ä¸¤ç¯‡æ–‡ç« ã€‚</p></li></ol></blockquote><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ ¹æ®ä¸Šé¢å‘½ä»¤æ‰§è¡Œå®Œåï¼Œè¾“å‡ºçš„æç¤ºä¿¡æ¯è¿›è¡Œæ“ä½œæ¥éªŒè¯ä¸€ä¸‹é›†ç¾¤æ˜¯å¦éƒ¨ç½²æˆåŠŸã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># è·å–æŒ‡å®šé›†ç¾¤çš„é…ç½®æ–‡ä»¶æ‰€åœ¨çš„è·¯å¾„</span><br><span class="line">$ export KUBECONFIG&#x3D;&quot;$(kind get kubeconfig-path --name&#x3D;&quot;my-cluster&quot;)&quot;</span><br><span class="line">$ kubectl cluster-info</span><br><span class="line">Kubernetes master is running at https:&#x2F;&#x2F;localhost:34458</span><br><span class="line">KubeDNS is running at https:&#x2F;&#x2F;localhost:34458&#x2F;api&#x2F;v1&#x2F;namespaces&#x2F;kube-system&#x2F;services&#x2F;kube-dns:dns&#x2F;proxy</span><br><span class="line">To further debug and diagnose cluster problems, use &#39;kubectl cluster-info dump&#39;.</span><br><span class="line"></span><br><span class="line">$ kubectl get nodes</span><br><span class="line">NAME                       STATUS    ROLES     AGE       VERSION</span><br><span class="line">my-cluster-control-plane   Ready     master    2m        v1.15.3</span><br><span class="line"></span><br><span class="line">$ kubectl get po -n kube-system</span><br><span class="line">NAME                                                  READY   STATUS    RESTARTS   AGE</span><br><span class="line">coredns-86c58d9df4-6g66f                              1&#x2F;1     Running   0          21m</span><br><span class="line">coredns-86c58d9df4-pqcc4                              1&#x2F;1     Running   0          21m</span><br><span class="line">etcd-my-cluster-control-plane                         1&#x2F;1     Running   0          20m</span><br><span class="line">kube-apiserver-my-cluster-control-plane               1&#x2F;1     Running   0          20m</span><br><span class="line">kube-controller-manager-my-cluster-control-plane      1&#x2F;1     Running   0          20m</span><br><span class="line">kube-proxy-cjgnt                                      1&#x2F;1     Running   0          21m</span><br><span class="line">kube-scheduler-my-cluster-control-plane               1&#x2F;1     Running   0          21m</span><br><span class="line">weave-net-ls2v8                                       2&#x2F;2     Running   1          21m</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„è¾“å‡ºç»“æœï¼Œå¯ä»¥çœ‹åˆ°å•èŠ‚ç‚¹çš„ <code>Kubernetes</code> å·²ç»æ­å»ºæˆåŠŸã€‚å•èŠ‚ç‚¹é›†ç¾¤é»˜è®¤æ–¹å¼å¯åŠ¨çš„èŠ‚ç‚¹ç±»å‹æ˜¯ <code>control-plane</code>ï¼Œè¯¥èŠ‚ç‚¹åŒ…å«äº†æ‰€æœ‰çš„ç»„ä»¶ã€‚è¿™äº›ç»„ä»¶åˆ†åˆ«æ˜¯ï¼š<code>2*Coredns</code>ã€<code>Etcd</code>ã€<code>Api-Server</code>ã€<code>Controller-Manager</code>ã€<code>Kube-Proxy</code>ã€<code>Sheduler</code> å’Œç½‘ç»œæ’ä»¶ <code>Weave</code>ï¼Œç›®å‰é»˜è®¤ä½¿ç”¨çš„ç½‘ç»œæ’ä»¶ä¹Ÿæ˜¯ <code>Weave</code>ã€‚</p><h3 id="åˆ›å»ºå¤šèŠ‚ç‚¹çš„é›†ç¾¤">åˆ›å»ºå¤šèŠ‚ç‚¹çš„é›†ç¾¤</h3><p>é»˜è®¤å®‰è£…çš„é›†ç¾¤åªéƒ¨ç½²äº†ä¸€ä¸ªæ§åˆ¶èŠ‚ç‚¹ï¼Œå¦‚æœéœ€è¦éƒ¨ç½²å¤šèŠ‚ç‚¹é›†ç¾¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶çš„æ–¹å¼æ¥åˆ›å»ºå¤šä¸ªå®¹å™¨ã€‚è¿™æ ·å°±å¯ä»¥è¾¾åˆ°æ¨¡æ‹Ÿå¤šä¸ªèŠ‚ç‚¹ç›®çš„ï¼Œå¹¶ä»¥è¿™äº›èŠ‚ç‚¹æ¥æ„å»ºä¸€ä¸ªå¤šèŠ‚ç‚¹çš„ <code>Kubernetes</code> é›†ç¾¤ã€‚</p><ol><li>åˆ›å»ºå¤šèŠ‚ç‚¹ Kubernetes é›†ç¾¤é…ç½®æ–‡ä»¶</li></ol><p><code>Kind</code> åœ¨åˆ›å»ºé›†ç¾¤çš„æ—¶å€™ï¼Œæ”¯æŒé€šè¿‡ <code>--config</code> å‚æ•°ä¼ é€’é…ç½®æ–‡ä»¶ç»™ <code>Kind</code>ï¼Œé…ç½®æ–‡ä»¶å¯ä¿®æ”¹çš„å†…å®¹ä¸»è¦æœ‰ role å’Œ èŠ‚ç‚¹ä½¿ç”¨çš„é•œåƒã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ vim my-cluster-multi-node.yaml</span><br><span class="line"># ä¸€å…±ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œä¸€ä¸ªä¸»èŠ‚ç‚¹ï¼Œä¸€ä¸ªä»èŠ‚ç‚¹ã€‚</span><br><span class="line">kind: Cluster</span><br><span class="line">apiVersion: kind.sigs.k8s.io&#x2F;v1alpha3</span><br><span class="line">nodes:</span><br><span class="line">- role: control-plane</span><br><span class="line">- role: worker</span><br></pre></td></tr></table></figure><ol start="2"><li>åˆ›å»ºå¤šèŠ‚ç‚¹ Kubernetes é›†ç¾¤</li></ol><p>é…ç½®æ–‡ä»¶åˆ›å»ºå®Œæˆåï¼Œå°±å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥å®Œæˆå¤šèŠ‚ç‚¹ <code>Kubernetes</code> é›†ç¾¤æ­å»ºã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ kind create cluster --config my-cluster-multi-node.yaml --name my-cluster-multi-node</span><br><span class="line">Creating cluster &quot;my-cluster-multi-node&quot; ...</span><br><span class="line"> âœ“ Ensuring node image (kindest&#x2F;node:v1.15.3) ğŸ–¼</span><br><span class="line"> âœ“ Preparing nodes ğŸ“¦ğŸ“¦ </span><br><span class="line"> âœ“ Creating kubeadm config ğŸ“œ </span><br><span class="line"> âœ“ Starting control-plane ğŸ•¹ï¸ </span><br><span class="line"> âœ“ Joining worker nodes ğŸšœ </span><br><span class="line">Cluster creation complete. You can now use the cluster with:</span><br><span class="line"></span><br><span class="line">export KUBECONFIG&#x3D;&quot;$(kind get kubeconfig-path --name&#x3D;&quot;my-cluster-multi-node&quot;)&quot;</span><br><span class="line">kubectl cluster-info</span><br></pre></td></tr></table></figure><p>å’Œä¸Šé¢åˆ›å»ºçš„å•èŠ‚ç‚¹é›†ç¾¤ä¸€æ ·ï¼Œæˆ‘ä»¬åŒæ ·æ ¹æ®ä¸Šé¢å‘½ä»¤æ‰§è¡Œå®Œåï¼Œè¾“å‡ºçš„æç¤ºä¿¡æ¯è¿›è¡Œæ“ä½œæ¥éªŒè¯ä¸€ä¸‹é›†ç¾¤æ˜¯å¦éƒ¨ç½²æˆåŠŸã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl get nodes</span><br><span class="line">NAME                                  STATUS   ROLES    AGE     VERSION</span><br><span class="line">my-cluster-multi-node-control-plane   Ready    master   3m20s   v1.15.3</span><br><span class="line">my-cluster-multi-node-worker          Ready    &lt;none&gt;   3m8s    v1.15.3</span><br><span class="line"></span><br><span class="line">$ kubectl get po -n kube-system</span><br><span class="line">NAME                                                          READY   STATUS    RESTARTS   AGE</span><br><span class="line">coredns-86c58d9df4-cnqhc                                      1&#x2F;1     Running   0          5m29s</span><br><span class="line">coredns-86c58d9df4-hn9mv                                      1&#x2F;1     Running   0          5m29s</span><br><span class="line">etcd-my-cluster-multi-node-control-plane                      1&#x2F;1     Running   0          4m24s</span><br><span class="line">kube-apiserver-my-cluster-multi-node-control-plane            1&#x2F;1     Running   0          4m17s</span><br><span class="line">kube-controller-manager-my-cluster-multi-node-control-plane   1&#x2F;1     Running   0          4m21s</span><br><span class="line">kube-proxy-8t4xt                                              1&#x2F;1     Running   0          5m27s</span><br><span class="line">kube-proxy-skd5v                                              1&#x2F;1     Running   0          5m29s</span><br><span class="line">kube-scheduler-my-cluster-multi-node-control-plane            1&#x2F;1     Running   0          4m18s</span><br><span class="line">weave-net-nmfq2                                               2&#x2F;2     Running   1          5m27s</span><br><span class="line">weave-net-srdfw                                               2&#x2F;2     Running   0          5m29s</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºé«˜å¯ç”¨-kubernetes-é›†ç¾¤">åˆ›å»ºé«˜å¯ç”¨ Kubernetes é›†ç¾¤</h3><p><code>Kind</code> ä¹Ÿæ”¯æŒæ­å»ºé«˜å¯ç”¨çš„ <code>Kubernetes</code> é›†ç¾¤ï¼Œåˆ›å»ºæ–¹å¼å’Œå¤šèŠ‚ç‚¹é›†ç¾¤ç±»ä¼¼ï¼Œä¹Ÿæ˜¯é€šè¿‡é…ç½®æ–‡ä»¶æ¥å®ç°ã€‚</p><ol><li>åˆ›å»ºé«˜å¯ç”¨ Kubernetes é›†ç¾¤é…ç½®æ–‡ä»¶</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">$ vim my-cluster-ha.yaml</span><br><span class="line"></span><br><span class="line"># ä¸€å…±å…­ä¸ªèŠ‚ç‚¹ï¼Œä¸‰ä¸ª control-plane èŠ‚ç‚¹ï¼Œä¸‰ä¸ª workers èŠ‚ç‚¹</span><br><span class="line">kind: Cluster</span><br><span class="line">apiVersion: kind.sigs.k8s.io&#x2F;v1alpha3</span><br><span class="line">kubeadmConfigPatches:</span><br><span class="line">- |</span><br><span class="line">  apiVersion: kubeadm.k8s.io&#x2F;v1beta2</span><br><span class="line">  kind: ClusterConfiguration</span><br><span class="line">  metadata:</span><br><span class="line">    name: config</span><br><span class="line">  networking:</span><br><span class="line">    serviceSubnet: 10.0.0.0&#x2F;16</span><br><span class="line">  imageRepository: registry.aliyuncs.com&#x2F;google_containers</span><br><span class="line">  nodeRegistration:</span><br><span class="line">    kubeletExtraArgs:</span><br><span class="line">      pod-infra-container-image: registry.aliyuncs.com&#x2F;google_containers&#x2F;pause:3.1</span><br><span class="line">- |</span><br><span class="line">  apiVersion: kubeadm.k8s.io&#x2F;v1beta2</span><br><span class="line">  kind: InitConfiguration</span><br><span class="line">  metadata:</span><br><span class="line">    name: config</span><br><span class="line">  networking:</span><br><span class="line">    serviceSubnet: 10.0.0.0&#x2F;16</span><br><span class="line">  imageRepository: registry.aliyuncs.com&#x2F;google_containers</span><br><span class="line">nodes:</span><br><span class="line">- role: control-plane</span><br><span class="line">- role: control-plane</span><br><span class="line">- role: control-plane</span><br><span class="line">- role: worker</span><br><span class="line">- role: worker</span><br><span class="line">- role: worker</span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡ç›´æ¥åœ¨é…ç½®æ–‡ä»¶é‡Œä½¿ç”¨å›½å†…å®¹å™¨é•œåƒæºçš„æ–¹å¼è§£å†³äº†å®˜æ–¹å®¹å™¨é•œåƒæºä¸å¯ç”¨çš„é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿè¾¾åˆ°äº†åŠ é€Ÿé›†ç¾¤åˆ›å»ºçš„ç›®çš„ã€‚</p></blockquote><ol start="2"><li>åˆ›å»ºé«˜å¯ç”¨ Kubernetes é›†ç¾¤</li></ol><p>é…ç½®æ–‡ä»¶åˆ›å»ºå®Œæˆåï¼Œå°±å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥å®Œæˆé«˜å¯ç”¨ <code>Kubernetes</code> é›†ç¾¤æ­å»ºã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$ kind create cluster --name my-cluster-ha --config my-cluster-ha.yaml</span><br><span class="line">Creating cluster &quot;my-cluster-ha&quot; ...</span><br><span class="line"> âœ“ Ensuring node image (kindest&#x2F;node:v1.15.3) ğŸ–¼</span><br><span class="line"> âœ“ Preparing nodes ğŸ“¦ğŸ“¦ğŸ“¦ğŸ“¦ğŸ“¦ğŸ“¦ğŸ“¦</span><br><span class="line"> âœ“ Starting the external load balancer âš–ï¸</span><br><span class="line"> âœ“ Creating kubeadm config ğŸ“œ</span><br><span class="line"> âœ“ Starting control-plane ğŸ•¹ï¸</span><br><span class="line"> âœ“ Joining more control-plane nodes ğŸ®</span><br><span class="line"> âœ“ Joining worker nodes ğŸšœ</span><br><span class="line">Cluster creation complete. You can now use the cluster with:</span><br><span class="line"></span><br><span class="line">export KUBECONFIG&#x3D;&quot;$(kind get kubeconfig-path --name&#x3D;&quot;my-cluster-ha&quot;)&quot;</span><br><span class="line">kubectl cluster-info</span><br><span class="line">master $ export KUBECONFIG&#x3D;&quot;$(kind get kubeconfig-path --name&#x3D;&quot;my-cluster-ha&quot;)&quot;</span><br><span class="line">master $ kubectl cluster-info</span><br><span class="line">Kubernetes master is running at https:&#x2F;&#x2F;localhost:44019</span><br><span class="line">KubeDNS is running at https:&#x2F;&#x2F;localhost:44019&#x2F;api&#x2F;v1&#x2F;namespaces&#x2F;kube-system&#x2F;services&#x2F;kube-dns:dns&#x2F;proxy</span><br><span class="line"></span><br><span class="line">To further debug and diagnose cluster problems, use &#39;kubectl cluster-info dump&#39;.</span><br></pre></td></tr></table></figure><p>åŒæ ·ï¼Œæˆ‘ä»¬æ ¹æ®ä¸Šé¢å‘½ä»¤æ‰§è¡Œå®Œåï¼Œè¾“å‡ºçš„æç¤ºä¿¡æ¯è¿›è¡Œæ“ä½œæ¥éªŒè¯ä¸€ä¸‹é›†ç¾¤æ˜¯å¦éƒ¨ç½²æˆåŠŸã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl get nodes</span><br><span class="line">NAME                           STATUS   ROLES    AGE     VERSION</span><br><span class="line">my-cluster-ha-control-plane    Ready    master   3m42s   v1.15.3</span><br><span class="line">my-cluster-ha-control-plane2   Ready    master   3m24s   v1.15.3</span><br><span class="line">my-cluster-ha-control-plane3   Ready    master   2m13s   v1.15.3</span><br><span class="line">my-cluster-ha-worker           Ready    &lt;none&gt;   96s     v1.15.3</span><br><span class="line">my-cluster-ha-worker2          Ready    &lt;none&gt;   98s     v1.15.3</span><br><span class="line">my-cluster-ha-worker3          Ready    &lt;none&gt;   95s     v1.15.3</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„è¾“å‡ºç»“æœï¼Œå¯ä»¥çœ‹åˆ°åŒ…å«äº†å¤šä¸ª master èŠ‚ç‚¹ï¼Œè¯´æ˜é«˜å¯ç”¨çš„ <code>Kubernetes</code> é›†ç¾¤å·²ç»æ­å»ºæˆåŠŸã€‚</p><h2 id="å…¶å®ƒç›¸å…³çŸ¥è¯†">å…¶å®ƒç›¸å…³çŸ¥è¯†</h2><h3 id="kind-çš„é•œåƒé‡Œçš„ç§˜å¯†">Kind çš„é•œåƒé‡Œçš„ç§˜å¯†</h3><p><code>Kind</code> é•œåƒä¸€å…±åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯ <code>Base</code> é•œåƒï¼Œå¦ä¸€ç±»æ˜¯ <code>Node</code> é•œåƒã€‚</p><ol><li>Base é•œåƒ</li></ol><p>Base é•œåƒç›®å‰ä½¿ç”¨äº† <code>ubuntu:19.04</code> ä½œä¸ºåŸºç¡€é•œåƒï¼Œå¹¶åšäº†ä¸‹é¢çš„è°ƒæ•´ï¼š</p><ul><li><p>å®‰è£… <code>Systemd</code> ç›¸å…³çš„åŒ…ï¼Œå¹¶è°ƒæ•´ä¸€äº›é…ç½®ä»¥é€‚åº”åœ¨å®¹å™¨å†…è¿è¡Œã€‚</p></li><li><p>å®‰è£… <code>Kubernetes</code> è¿è¡Œæ—¶çš„ä¾èµ–åŒ…ï¼Œæ¯”å¦‚: <code>Conntrack</code>ã€<code>Socat</code>ã€<code>CNI</code> ç­‰ã€‚</p></li><li><p>å®‰è£…å®¹å™¨è¿è¡Œç¯å¢ƒï¼Œæ¯”å¦‚: <code>Containerd</code>ã€<code>Crictl</code> ç­‰ã€‚</p></li><li><p>é…ç½®è‡ªå·±çš„ <code>ENTRYPOINT</code> è„šæœ¬ï¼Œä»¥é€‚åº”å’Œè°ƒæ•´å®¹å™¨å†…è¿è¡Œçš„é—®é¢˜ã€‚</p></li></ul><p>æ›´å¤šå…·ä½“çš„æ„å»ºé€»è¾‘å¯ä»¥å‚è€ƒï¼š<a href="https://github.com/kubernetes-sigs/kind/blob/master/images/base/Dockerfile" target="_blank" rel="noopener">https://github.com/kubernetes-sigs/kind/blob/master/images/base/Dockerfile</a></p><ol start="2"><li>Node é•œåƒ</li></ol><p><code>Node</code> é•œåƒçš„æ„å»ºæ¯”è¾ƒå¤æ‚ï¼Œç›®å‰æ˜¯é€šè¿‡è¿è¡Œ <code>Base</code> é•œåƒå¹¶åœ¨ <code>Base</code> é•œåƒå†…æ‰§è¡Œæ“ä½œï¼Œå†ä¿å­˜æ­¤å®¹å™¨å†…å®¹ä¸ºé•œåƒçš„æ–¹å¼æ¥æ„å»ºçš„ï¼ŒåŒ…å«çš„æ“ä½œæœ‰ï¼š</p><ul><li><p>æ„å»º <code>Kubernetes</code> ç›¸å…³èµ„æºï¼Œæ¯”å¦‚ï¼šäºŒè¿›åˆ¶æ–‡ä»¶å’Œé•œåƒã€‚</p></li><li><p>è¿è¡Œä¸€ä¸ªç”¨äºæ„å»ºçš„å®¹å™¨</p></li><li><p>æŠŠæ„å»ºçš„ <code>Kubernetes</code> ç›¸å…³èµ„æºå¤åˆ¶åˆ°å®¹å™¨é‡Œ</p></li><li><p>è°ƒæ•´éƒ¨åˆ†ç»„ä»¶é…ç½®å‚æ•°ï¼Œä»¥æ”¯æŒåœ¨å®¹å™¨å†…è¿è¡Œ</p></li><li><p>é¢„å…ˆæ‹‰å»è¿è¡Œç¯å¢ƒéœ€è¦çš„é•œåƒ</p></li><li><p>é€šè¿‡ <code>docker commit</code> æ–¹å¼ä¿å­˜å½“å‰çš„æ„å»ºå®¹å™¨ä¸º <code>Node</code> é•œåƒ</p></li></ul><h3 id="å¦‚ä½•å¿«é€Ÿåˆ é™¤ä¸€ä¸ªé›†ç¾¤">å¦‚ä½•å¿«é€Ÿåˆ é™¤ä¸€ä¸ªé›†ç¾¤</h3><p>å¦‚æœä½ ä¸éœ€è¦æœ¬åœ°çš„é›†ç¾¤ç¯å¢ƒï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿›è¡Œåˆ é™¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ kind delete  cluster --name my-cluster</span><br><span class="line">Deleting cluster &quot;my-cluster&quot; ...</span><br><span class="line">$KUBECONFIG is still set to use &#x2F;root&#x2F;.kube&#x2F;kind-config-my-cluster even though that file has been deleted, remember to unset it</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±æ¼”ç¤ºå®Œäº†å¦‚ä½•ä½¿ç”¨ <code>Kind</code> å¿«é€Ÿæ­å»ºä¸€ä¸ª <code>Kubernetes</code> é›†ç¾¤ã€‚ ä¸è¿‡æœ‰ä¸€ä¸ªä½ éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œ<code>Kind</code> æ­å»ºçš„é›†ç¾¤ä¸é€‚ç”¨äºç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ä½†æ˜¯å¦‚æœä½ æƒ³åœ¨æœ¬åœ°å¿«é€Ÿæ„å»ºä¸€ä¸ª <code>Kubernetes</code> é›†ç¾¤ç¯å¢ƒï¼Œå¹¶ä¸”ä¸æƒ³å ç”¨å¤ªå¤šçš„ç¡¬ä»¶èµ„æºï¼Œé‚£ä¹ˆ <code>Kind</code> ä¼šæ˜¯ä½ ä¸é”™çš„é€‰æ‹©ã€‚</p><h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2><ol><li><p><a href="https://www.google.com" target="_blank" rel="noopener">https://www.google.com</a></p></li><li><p><a href="http://t.cn/AiRVBwDS" target="_blank" rel="noopener">http://t.cn/AiRVBwDS</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/60464867" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/60464867</a></p></li><li><p><a href="https://yeya24.github.io/post/kind/" target="_blank" rel="noopener">https://yeya24.github.io/post/kind/</a></p></li><li><p><a href="http://dockerone.com/article/8974" target="_blank" rel="noopener">http://dockerone.com/article/8974</a></p></li><li><p><a href="https://kind.sigs.k8s.io/docs/user/quick-start/" target="_blank" rel="noopener">https://kind.sigs.k8s.io/docs/user/quick-start/</a></p></li></ol></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä»€ä¹ˆæ˜¯-Kind&quot;&gt;ä»€ä¹ˆæ˜¯ Kind&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Kind&lt;/code&gt;ï¼ˆKubernetes in Dockerï¼‰ æ˜¯ä¸€ä¸ª &lt;code&gt;Kubernetes&lt;/code&gt; å­µåŒ–é¡¹ç›®ï¼Œ&lt;code&gt;Kind&lt;/code&gt; æ˜¯ä¸€å¥—å¼€ç®±å³ç”¨çš„ &lt;code&gt;Kubernetes&lt;/code&gt; ç¯å¢ƒæ­å»ºæ–¹æ¡ˆã€‚é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å°† &lt;code&gt;Kubernetes&lt;/code&gt; æ‰€éœ€è¦çš„æ‰€æœ‰ç»„ä»¶ï¼Œå…¨éƒ¨éƒ¨ç½²åœ¨ä¸€ä¸ª &lt;code&gt;Docker&lt;/code&gt; å®¹å™¨ä¸­ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„æ­å»º &lt;code&gt;Kubernetes&lt;/code&gt; é›†ç¾¤ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Kind&lt;/code&gt; å·²ç»å¹¿æ³›çš„åº”ç”¨äº &lt;code&gt;Kubernetes&lt;/code&gt; ä¸Šæ¸¸åŠç›¸å…³é¡¹ç›®çš„ &lt;code&gt;CI&lt;/code&gt; ç¯å¢ƒä¸­ï¼Œå®˜æ–¹æ–‡æ¡£ä¸­ä¹ŸæŠŠ &lt;code&gt;Kind&lt;/code&gt; ä½œä¸ºä¸€ç§æœ¬åœ°é›†ç¾¤æ­å»ºçš„å·¥å…·æ¨èç»™å¤§å®¶ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¡¹ç›®åœ°å€ï¼š&lt;a href=&quot;https://github.com/kubernetes-sigs/kind&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/kubernetes-sigs/kind&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;Kind å¯ä»¥åšä»€ä¹ˆï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;å¿«é€Ÿåˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ª &lt;code&gt;Kubernetes&lt;/code&gt; é›†ç¾¤&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ”¯æŒéƒ¨ç½²é«˜å¯ç”¨çš„ &lt;code&gt;Kubernetes&lt;/code&gt; é›†ç¾¤&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ”¯æŒä»æºç æ„å»ºå¹¶éƒ¨ç½²ä¸€ä¸ª &lt;code&gt;Kubernetes&lt;/code&gt; é›†ç¾¤&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯ä»¥å¿«é€Ÿä½æˆæœ¬ä½“éªŒä¸€ä¸ªæœ€æ–°çš„ &lt;code&gt;Kubernetes&lt;/code&gt; é›†ç¾¤ï¼Œå¹¶æ”¯æŒ &lt;code&gt;Kubernetes&lt;/code&gt; çš„ç»å¤§éƒ¨åˆ†åŠŸèƒ½&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ”¯æŒæœ¬åœ°ç¦»çº¿è¿è¡Œä¸€ä¸ªå¤šèŠ‚ç‚¹é›†ç¾¤&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Kind æœ‰å“ªäº›ä¼˜åŠ¿ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æœ€å°çš„å®‰è£…ä¾èµ–ï¼Œä»…éœ€è¦å®‰è£… &lt;code&gt;Docker&lt;/code&gt; å³å¯&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨æ–¹æ³•ç®€å•ï¼Œåªéœ€ &lt;code&gt;Kind Cli&lt;/code&gt; å·¥å…·å³å¯å¿«é€Ÿåˆ›å»ºé›†ç¾¤&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨å®¹å™¨æ¥æ¨¡ä¼¼ &lt;code&gt;Kubernetes&lt;/code&gt; èŠ‚ç‚¹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å†…éƒ¨ä½¿ç”¨ &lt;code&gt;Kubeadm&lt;/code&gt; çš„å®˜æ–¹ä¸»æµéƒ¨ç½²å·¥å…·&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é€šè¿‡äº† &lt;code&gt;CNCF&lt;/code&gt; å®˜æ–¹çš„ &lt;code&gt;K8S Conformance&lt;/code&gt; æµ‹è¯•&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
    
      <category term="Kubernetes" scheme="https://www.hi-linux.com/categories/kubernetes/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="æŠ€å·§" scheme="https://www.hi-linux.com/tags/%E6%8A%80%E5%B7%A7/"/>
    
      <category term="Kubernetes" scheme="https://www.hi-linux.com/tags/Kubernetes/"/>
    
  </entry>
  
  <entry>
    <title>åˆ†äº«å‡ ä¸ªè®© Linux é Root ç”¨æˆ·è¿è¡Œçš„ç¨‹åºä½¿ç”¨ç‰¹æƒç«¯å£çš„æŠ€å·§</title>
    <link href="https://www.hi-linux.com/posts/26613.html"/>
    <id>https://www.hi-linux.com/posts/26613.html</id>
    <published>2020-05-13T01:00:00.000Z</published>
    <updated>2020-05-13T04:59:42.628Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨ <code>Linux</code> ç³»ç»Ÿä¸‹ï¼Œåªå…è®¸ <code>Root</code> ç”¨æˆ·è¿è¡Œçš„ç¨‹åºæ‰å¯ä»¥ä½¿ç”¨ç‰¹æƒç«¯å£ ( <code>1024</code> ä»¥ä¸‹çš„ç«¯å£ )ã€‚å¦‚æœåœ¨æ™®é€šç”¨æˆ·ä¸‹ä½¿ç”¨ç‰¹æƒç«¯å£å°†ä¼šæŠ¥é”™ã€‚</p><p>åœ¨ä¸€äº›ç‰¹å®šçš„ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½è€ƒè™‘åˆ°ç¨‹åºè¿è¡Œåœ¨ <code>Root</code> å¸æˆ·ä¸‹ï¼Œå¯èƒ½ä¼šç»™ <code>Linux</code> ç³»ç»Ÿå¸¦æ¥å®‰å…¨é£é™©ã€‚å¸Œæœ›èƒ½è®©æ™®é€šç”¨æˆ·å¯åŠ¨çš„ç¨‹åºè¿è¡Œåœ¨ç‰¹æƒç«¯å£ä¸Šï¼Œæ¯”å¦‚ï¼šWeb æœåŠ¡å™¨ã€‚</p><p>é‚£å¦‚ä½•èƒ½å¤Ÿè®©æ™®é€šç”¨æˆ·å¯åŠ¨çš„ç¨‹åºè¿è¡Œåœ¨ç‰¹æƒç«¯å£å‘¢ï¼Ÿæœ¬æ–‡å°†ä»‹ç»ä¸€äº›æ–¹æ³•ï¼Œè®©ä½ èƒ½å¤Ÿè§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h2 id="é€šè¿‡è®¾ç½®-cap_net_bind_service-å®ç°">é€šè¿‡è®¾ç½® CAP_NET_BIND_SERVICE å®ç°</h2><p><code>Linux</code> å†…æ ¸ä» 2.6.24 ç‰ˆæœ¬å¼€å§‹å°±æœ‰äº†èƒ½åŠ›çš„æ¦‚å¿µï¼Œè¿™ä½¿å¾—æ™®é€šç”¨æˆ·ä¹Ÿèƒ½å¤Ÿåšåªæœ‰è¶…çº§ç”¨æˆ·æ‰èƒ½å®Œæˆçš„å·¥ä½œã€‚</p><p>ä½¿ç”¨ <code>setcap</code> å‘½ä»¤è®©æŒ‡å®šç¨‹åºæ‹¥æœ‰ç»‘å®šç«¯å£çš„èƒ½åŠ›ï¼Œè¿™æ ·å³ä½¿ç¨‹åºè¿è¡Œåœ¨æ™®é€šç”¨æˆ·ä¸‹ï¼Œä¹Ÿèƒ½å¤Ÿç»‘å®šåˆ° 1024 ä»¥ä¸‹çš„ç‰¹æƒç«¯å£ä¸Šã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ç»™æŒ‡å®šç¨‹åºè®¾ç½® CAP_NET_BIND_SERVICE èƒ½åŠ›</span><br><span class="line">$ setcap cap_net_bind_service&#x3D;+eip &#x2F;path&#x2F;to&#x2F;application</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®ä¾‹ï¼Œä»¥ <code>Nginx</code> ä¸ºä¾‹ï¼š</p><p><img src="https://www.hi-linux.com/img/linux/setcap.jpg" alt=""></p><p>å¦‚æœä½ çš„ç¨‹åºä¸å†éœ€è¦ä½¿ç”¨è¿™ä¸ªèƒ½åŠ›ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ¸…é™¤ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ setcap -r &#x2F;path&#x2F;to&#x2F;application</span><br></pre></td></tr></table></figure><blockquote><ol><li><p>è¿™ä¸ªæ–¹æ³•å¹¶ä¸æ˜¯æ‰€æœ‰ <code>Linux</code> ç³»ç»Ÿé€šç”¨ï¼Œ<code>Linux</code> å†…æ ¸åœ¨ 2.6.24 ä¹‹å‰çš„å¹¶æ²¡æœ‰æä¾›æ­¤é¡¹èƒ½åŠ›ï¼Œå› æ­¤ä½ éœ€è¦æ£€æŸ¥è¦ä½¿ç”¨æ­¤æ–¹æ³•æ‰€åœ¨ç³»ç»Ÿæ˜¯å¦æ”¯æŒã€‚</p></li><li><p>å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè¦è¿è¡Œçš„ç¨‹åºæ˜¯ä¸€ä¸ªè„šæœ¬ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯æ²¡æœ‰åŠæ³•æ­£å¸¸å·¥ä½œçš„ã€‚</p></li></ol></blockquote><a id="more"></a><h2 id="é€šè¿‡ç«¯å£è½¬å‘å®ç°">é€šè¿‡ç«¯å£è½¬å‘å®ç°</h2><p>å¦‚æœè¦è¿è¡Œçš„ç¨‹åºæœ‰æƒé™ç›‘å¬å…¶ä»–ç«¯å£ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•æ˜¯å¯ä»¥ä½¿ç”¨çš„ã€‚é¦–å…ˆè®©ç¨‹åºè¿è¡Œåœ¨æ™®é€šç”¨æˆ·ä¸‹ï¼Œå¹¶ç»‘å®šé«˜äº 1024 çš„ç«¯å£ã€‚åœ¨ç¡®ä¿èƒ½æ­£å¸¸å·¥ä½œçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°†é€šè¿‡ç«¯å£è½¬å‘å°†ä½ç«¯å£çš„è¯·æ±‚è½¬åˆ°åº”ç”¨æ‰€åœ¨çš„é«˜ç«¯å£ï¼Œä»è€Œå®ç°æ™®é€šç”¨æˆ·å¯åŠ¨çš„ç¨‹åºç»‘å®šåˆ°ä½ç«¯å£ã€‚è¦ä½¿ç”¨æ­¤æ–¹æ³•å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼ã€‚</p><ol><li>é…ç½®å†…æ ¸å‚æ•°ä»¥å¯ç”¨è½¬å‘åŠŸèƒ½</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># Enable the IP FORWARD kernel parameter.</span><br><span class="line">$ sysctl -w net.ipv4.ip_forward&#x3D;1</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šæ–¹æ³•æ˜¯ä¸´æ—¶æ€§è®¾ç½®ï¼Œé‡å¯ä¹‹åå°†ä¼šè¢«é‡ç½®ã€‚å¦‚æœä½ æƒ³é•¿æœŸä¿å­˜ï¼Œéœ€è¦åœ¨ <code>/etc/sysctl.conf</code> æ–‡ä»¶å†…ä¿®æ”¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ vim  &#x2F;etc&#x2F;sysctl.conf</span><br><span class="line"></span><br><span class="line"># Default value is 0, need change to 1.</span><br><span class="line"># net.ipv4.ip_forward &#x3D; 0</span><br><span class="line">net.ipv4.ip_forward &#x3D; 1</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œä½¿ç”¨ <code>sysctl</code> å‘½ä»¤ä»æ–‡ä»¶ä¸­åŠ è½½æ–°çš„é…ç½®ï¼Œå¹¶ä½¿å…¶ç”Ÿæ•ˆã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># load new sysctl.conf</span><br><span class="line">$ sysctl -p &#x2F;etc&#x2F;sysctl.conf</span><br><span class="line"> </span><br><span class="line"># or sysctl -p</span><br><span class="line"># default filename is &#x2F;etc&#x2F;sysctl.conf</span><br></pre></td></tr></table></figure><ol start="2"><li>é…ç½®è½¬å‘è§„åˆ™</li></ol><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ <code>Iptables</code> æ¥é…ç½®çš„è½¬å‘è§„åˆ™ï¼Œä»¥å®ç°ç«¯å£è½¬å‘åˆ°ç¨‹åºæ‰€åœ¨çš„ç«¯å£ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># å°† 80 ç«¯å£è½¬å‘åˆ° 8088</span><br><span class="line">$ iptables -F -t nat</span><br><span class="line">$ iptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to:8088</span><br></pre></td></tr></table></figure><p>æ­¤ç§æ–¹æ³•èƒ½å¤Ÿæ¯”è¾ƒå¥½çš„è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ï¼Œæˆ‘ä»¬çš„ç¨‹åºå¯ä»¥é€šè¿‡æ™®é€šç”¨æˆ·æ¥è¿è¡Œï¼Œå¹¶èƒ½å¤Ÿå¯¹å¤–æä¾›ä½ç«¯å£å·çš„æœåŠ¡ã€‚</p><h2 id="é€šè¿‡-authbind-å®ç°">é€šè¿‡ authbind å®ç°</h2><p><code>authbind</code> æ˜¯ä¸€ä¸ªæ”¯æŒæ™®é€šç”¨æˆ·å°±èƒ½ç»‘å®šç³»ç»Ÿç‰¹æƒç«¯å£çš„ç¨‹åºï¼Œä½ åªéœ€è¦ä½¿ç”¨ <code>authbind</code> ç¨‹åºæ¥è°ƒç”¨éœ€è¦ä½¿ç”¨ç‰¹æƒç«¯å£çš„ç¨‹åºå°±å¯ä»¥äº†ã€‚</p><ol><li>å®‰è£… authbind</li></ol><ul><li>Debian / Ubuntu</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install authbind</span><br></pre></td></tr></table></figure><ul><li>CentOS / RHEL</li></ul><p>CentOS ç³»åˆ—çš„ç³»ç»Ÿå®‰è£…èµ·æ¥ç›¸å¯¹å°±è¦éº»çƒ¦ä¸€äº›ï¼Œå› ä¸ºå®˜æ–¹ä»“åº“å¹¶æ²¡æœ‰æä¾›ç¼–è¯‘å¥½çš„è½¯ä»¶åŒ…ã€‚ä¸è¿‡å¹¸è¿çš„æ˜¯ï¼Œå·²ç»æœ‰äººç¼–è¯‘å¥½äº†å¯¹åº”çš„è½¯ä»¶åŒ…ï¼Œæˆ‘ä»¬åªéœ€è¦ç›´æ¥å®‰è£…å°±å¯ä»¥äº†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo rpm -ivh https:&#x2F;&#x2F;s3.amazonaws.com&#x2F;aaronsilber&#x2F;public&#x2F;authbind-2.1.1-0.1.x86_64.rpm</span><br></pre></td></tr></table></figure><ol start="2"><li>é…ç½® authbind</li></ol><p><code>authbind</code> é»˜è®¤çš„é…ç½®æ–‡ä»¶åœ¨ <code>/etc/authbind</code> ç›®å½•ä¸‹ï¼Œé‡Œé¢æœ‰ä¸‰ä¸ªç›®å½•ï¼š<code>byport</code>ã€<code>byaddr</code>ã€<code>byuid</code>ã€‚</p><p>å‡å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ª test çš„æ™®é€šè´¦å·ï¼Œæƒ³è¿è¡Œä¸€ä¸ªç¨‹åºå¹¶ç»‘å®šåœ¨ 80 ç«¯å£ä¸Šã€‚æˆ‘ä»¬éœ€è¦é…ç½®ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># åœ¨ byport ç›®å½•ä¸‹å»ºç«‹ 80 æ–‡ä»¶</span><br><span class="line">$ sudo touch &#x2F;etc&#x2F;authbind&#x2F;byport&#x2F;80</span><br><span class="line"># è®¾ç½® test è´¦æˆ·æœ‰ 80 æ–‡ä»¶çš„ä½¿ç”¨æƒé™</span><br><span class="line">$ sudo chmod 755 &#x2F;etc&#x2F;authbind&#x2F;byport&#x2F;80</span><br><span class="line">$ sudo chown test.test &#x2F;etc&#x2F;authbind&#x2F;byport&#x2F;80</span><br></pre></td></tr></table></figure><ol start="3"><li>ä½¿ç”¨ authbind è¿è¡ŒæŒ‡å®šç¨‹åº</li></ol><p>åœ¨ä½ è¦å¯åŠ¨çš„å‘½ä»¤å‰åŠ ä¸Š <code>authbind --deep</code> å‘½ä»¤å³å¯ã€‚ä¾‹å¦‚ï¼šè¦ç”¨ test è¿™ä¸ªæ™®é€šç”¨æˆ·å¯åŠ¨ <code>Nginx</code> å¹¶ç»‘å®šåœ¨ 80 ç«¯å£ï¼Œåªéœ€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ authbind --deep &quot;&#x2F;usr&#x2F;bin&#x2F;nginx&quot; -c &quot;&#x2F;etc&#x2F;nginx&#x2F;nginx.conf&quot;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ IP åœ°å€ä¸Šç›´æ¥ç»‘å®šç«¯å£ï¼Œåªéœ€åœ¨ <code>byaddr</code> ç›®å½•ä¸‹å»ºç«‹ <code>ip:port</code> æ–‡ä»¶å°±å¯ä»¥äº†ã€‚</p><h2 id="é€šè¿‡-setuid-å®ç°">é€šè¿‡ SetUID å®ç°</h2><p><code>SetUID</code> è¿™ä¸€ç‰¹æ€§å¯ä»¥è®©åªæœ‰æ™®é€šç”¨æˆ·æƒé™çš„åº”ç”¨ç¨‹åºç”¨ Root æƒé™æ¥è¿è¡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç³»ç»Ÿä¸‹ <code>/usr/bin/passwd</code> è¿™ä¸ªæ–‡ä»¶ï¼Œå°±ä½¿ç”¨äº† <code>SetUID</code>ã€‚è¿™æ ·å°±ä½¿å¾—ç³»ç»Ÿçš„æ¯ä¸ªæ™®é€šç”¨æˆ·éƒ½èƒ½ç”¨ <code>passwd</code> æ¥ä¿®æ”¹å¯†ç ï¼Œå› ä¸ºä¿®æ”¹å¯†ç éœ€è¦æ›´æ”¹ <code>/etc/passwd</code> æ–‡ä»¶ï¼Œè€Œé»˜è®¤è¿™ä¸ªæ–‡ä»¶åªæœ‰ Root ç”¨æˆ·æ‰æœ‰æƒé™è®¿é—®ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># å°†ç¨‹åºçš„æ‰€æœ‰è€…æ›´æ”¹ä¸º root</span><br><span class="line">$ chown root.root &#x2F;path&#x2F;to&#x2F;application</span><br><span class="line"></span><br><span class="line"># ç»™ç¨‹åºè®¾ç½® SetUID</span><br><span class="line">$ chmod u+s &#x2F;path&#x2F;to&#x2F;application</span><br></pre></td></tr></table></figure><p>æ—¢ç„¶è¦ä½¿ç”¨æ™®é€šç”¨æˆ·è¿è¡Œç¨‹åºï¼Œç›®çš„å°±æ˜¯è¦é™ä½ç¨‹åºæœ¬èº«ç»™ç³»ç»Ÿå¸¦æ¥çš„å®‰å…¨é£é™©ã€‚å› æ­¤ï¼Œæœ¬æ–¹æ³•ä½¿ç”¨çš„æ—¶å€™éœ€è¦ç‰¹åˆ«è°¨æ…ï¼Œç‰¹åˆ«æ˜¯å½“è¦æ‰§è¡Œçš„ç¨‹åºæœ¬èº«å­˜åœ¨å®‰å…¨é£é™©ã€‚</p><h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2><ol><li><a href="https://www.cnblogs.com/chenjunjie12321/p/9226279.html" target="_blank" rel="noopener">https://www.cnblogs.com/chenjunjie12321/p/9226279.html</a></li><li><a href="https://blog.csdn.net/Becivells/article/details/52842019" target="_blank" rel="noopener">https://blog.csdn.net/Becivells/article/details/52842019</a></li><li><a href="https://my.oschina.net/guol/blog/186430" target="_blank" rel="noopener">https://my.oschina.net/guol/blog/186430</a></li><li><a href="https://github.com/tootedom/authbind-centos-rpm" target="_blank" rel="noopener">https://github.com/tootedom/authbind-centos-rpm</a></li><li><a href="https://dzone.com/articles/running-tomcat-port-80-user" target="_blank" rel="noopener">https://dzone.com/articles/running-tomcat-port-80-user</a></li><li><a href="http://blog.useasp.net/archive/2015/07/09/non-root-user-application-bind-to-ports-less-than-1024-without-root-access.aspx" target="_blank" rel="noopener">http://blog.useasp.net/archive/2015/07/09/non-root-user-application-bind-to-ports-less-than-1024-without-root-access.aspx</a></li><li><a href="https://stackoverflow.com/questions/413807/is-there-a-way-for-non-root-processes-to-bind-to-privileged-ports-on-linux" target="_blank" rel="noopener">https://stackoverflow.com/questions/413807/is-there-a-way-for-non-root-processes-to-bind-to-privileged-ports-on-linux</a></li><li><a href="https://aaronsilber.me/2016/04/24/install-authbind-on-centos-7-x86_64-download-the-rpm/" target="_blank" rel="noopener">https://aaronsilber.me/2016/04/24/install-authbind-on-centos-7-x86_64-download-the-rpm/</a></li><li><a href="https://blog.webhosting.net/how-to-get-tomcat-running-on-centos-7-2-using-privileged-ports-1024/" target="_blank" rel="noopener">https://blog.webhosting.net/how-to-get-tomcat-running-on-centos-7-2-using-privileged-ports-1024/</a></li></ol></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨ &lt;code&gt;Linux&lt;/code&gt; ç³»ç»Ÿä¸‹ï¼Œåªå…è®¸ &lt;code&gt;Root&lt;/code&gt; ç”¨æˆ·è¿è¡Œçš„ç¨‹åºæ‰å¯ä»¥ä½¿ç”¨ç‰¹æƒç«¯å£ ( &lt;code&gt;1024&lt;/code&gt; ä»¥ä¸‹çš„ç«¯å£ )ã€‚å¦‚æœåœ¨æ™®é€šç”¨æˆ·ä¸‹ä½¿ç”¨ç‰¹æƒç«¯å£å°†ä¼šæŠ¥é”™ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸€äº›ç‰¹å®šçš„ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½è€ƒè™‘åˆ°ç¨‹åºè¿è¡Œåœ¨ &lt;code&gt;Root&lt;/code&gt; å¸æˆ·ä¸‹ï¼Œå¯èƒ½ä¼šç»™ &lt;code&gt;Linux&lt;/code&gt; ç³»ç»Ÿå¸¦æ¥å®‰å…¨é£é™©ã€‚å¸Œæœ›èƒ½è®©æ™®é€šç”¨æˆ·å¯åŠ¨çš„ç¨‹åºè¿è¡Œåœ¨ç‰¹æƒç«¯å£ä¸Šï¼Œæ¯”å¦‚ï¼šWeb æœåŠ¡å™¨ã€‚&lt;/p&gt;
&lt;p&gt;é‚£å¦‚ä½•èƒ½å¤Ÿè®©æ™®é€šç”¨æˆ·å¯åŠ¨çš„ç¨‹åºè¿è¡Œåœ¨ç‰¹æƒç«¯å£å‘¢ï¼Ÿæœ¬æ–‡å°†ä»‹ç»ä¸€äº›æ–¹æ³•ï¼Œè®©ä½ èƒ½å¤Ÿè§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&quot;é€šè¿‡è®¾ç½®-CAP-NET-BIND-SERVICE-å®ç°&quot;&gt;é€šè¿‡è®¾ç½® CAP_NET_BIND_SERVICE å®ç°&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Linux&lt;/code&gt; å†…æ ¸ä» 2.6.24 ç‰ˆæœ¬å¼€å§‹å°±æœ‰äº†èƒ½åŠ›çš„æ¦‚å¿µï¼Œè¿™ä½¿å¾—æ™®é€šç”¨æˆ·ä¹Ÿèƒ½å¤Ÿåšåªæœ‰è¶…çº§ç”¨æˆ·æ‰èƒ½å®Œæˆçš„å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;setcap&lt;/code&gt; å‘½ä»¤è®©æŒ‡å®šç¨‹åºæ‹¥æœ‰ç»‘å®šç«¯å£çš„èƒ½åŠ›ï¼Œè¿™æ ·å³ä½¿ç¨‹åºè¿è¡Œåœ¨æ™®é€šç”¨æˆ·ä¸‹ï¼Œä¹Ÿèƒ½å¤Ÿç»‘å®šåˆ° 1024 ä»¥ä¸‹çš„ç‰¹æƒç«¯å£ä¸Šã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# ç»™æŒ‡å®šç¨‹åºè®¾ç½® CAP_NET_BIND_SERVICE èƒ½åŠ›&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ setcap cap_net_bind_service&amp;#x3D;+eip &amp;#x2F;path&amp;#x2F;to&amp;#x2F;application&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®ä¾‹ï¼Œä»¥ &lt;code&gt;Nginx&lt;/code&gt; ä¸ºä¾‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.hi-linux.com/img/linux/setcap.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ çš„ç¨‹åºä¸å†éœ€è¦ä½¿ç”¨è¿™ä¸ªèƒ½åŠ›ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ¸…é™¤ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ setcap -r &amp;#x2F;path&amp;#x2F;to&amp;#x2F;application&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;è¿™ä¸ªæ–¹æ³•å¹¶ä¸æ˜¯æ‰€æœ‰ &lt;code&gt;Linux&lt;/code&gt; ç³»ç»Ÿé€šç”¨ï¼Œ&lt;code&gt;Linux&lt;/code&gt; å†…æ ¸åœ¨ 2.6.24 ä¹‹å‰çš„å¹¶æ²¡æœ‰æä¾›æ­¤é¡¹èƒ½åŠ›ï¼Œå› æ­¤ä½ éœ€è¦æ£€æŸ¥è¦ä½¿ç”¨æ­¤æ–¹æ³•æ‰€åœ¨ç³»ç»Ÿæ˜¯å¦æ”¯æŒã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè¦è¿è¡Œçš„ç¨‹åºæ˜¯ä¸€ä¸ªè„šæœ¬ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯æ²¡æœ‰åŠæ³•æ­£å¸¸å·¥ä½œçš„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/categories/Linux/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="æŠ€å·§" scheme="https://www.hi-linux.com/tags/%E6%8A%80%E5%B7%A7/"/>
    
  </entry>
  
  <entry>
    <title>å·§ç”¨ GoTTY ä¼˜é›…çš„ç®¡ç† Docker å®¹å™¨æƒé™</title>
    <link href="https://www.hi-linux.com/posts/33412.html"/>
    <id>https://www.hi-linux.com/posts/33412.html</id>
    <published>2020-05-13T01:00:00.000Z</published>
    <updated>2020-05-13T05:23:34.054Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><p><code>GoTTY</code> æ˜¯ä¸€ä¸ªç®€å•çš„åŸºäº <code>Go</code> è¯­è¨€çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒå¯ä»¥å°†ä½ çš„ç»ˆç«¯ï¼ˆTTYï¼‰ä½œä¸º <code>Web</code> ç¨‹åºå…±äº«ã€‚<code>GoTTY</code> çš„æ¶æ„æ˜¯åŸºäº <code>Hterm</code> + <code>Web Socket</code> çš„ï¼Œå®ƒèƒ½åœ¨ <code>Web</code> æµè§ˆå™¨ä¸Šè¿è¡Œä¸€ä¸ªåŸºäº <code>JavaScript</code> çš„ç»ˆç«¯ï¼Œå¹¶æ”¯æŒé€šè¿‡ <code>HTTP</code> å’Œ <code>HTTPS</code> è®¿é—®ã€‚</p><blockquote><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/yudai/gotty" target="_blank" rel="noopener">https://github.com/yudai/gotty</a></p></blockquote><p><img src="https://raw.githubusercontent.com/yudai/gotty/master/screenshot.gif" alt=""></p><h2 id="å®‰è£…-gotty">å®‰è£… GoTTY</h2><p><code>GoTTY</code> åŸç”Ÿæ”¯æŒè‰¯å¥½çš„è·¨å¹³å°æ€§ï¼Œå¼€ç®±å³ç”¨ã€‚åªéœ€ä¸‹è½½å¯¹åº”å¹³å°çš„äºŒè¿›åˆ¶åŒ…å°±è¡Œäº†ï¼Œè¿™é‡Œä»¥ <code>Linux</code> å¹³å°ä¸ºä¾‹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># ä¸‹è½½å¹¶è§£å‹ GoTTY å®‰è£…åŒ…</span><br><span class="line">$ wget https:&#x2F;&#x2F;github.com&#x2F;yudai&#x2F;gotty&#x2F;releases&#x2F;download&#x2F;v1.0.1&#x2F;gotty_linux_amd64.tar.gz</span><br><span class="line">$ tar -xzvf gotty_linux_amd64.tar.gz</span><br><span class="line"></span><br><span class="line"># å¤åˆ¶å¯æ‰§è¡Œæ–‡ä»¶åˆ°æŒ‡å®šç›®å½•å¹¶èµ‹äºˆæ‰§è¡Œæƒé™</span><br><span class="line">$ sudo cp gotty &#x2F;usr&#x2F;local&#x2F;bin&#x2F;</span><br><span class="line">$ chmod +x &#x2F;usr&#x2F;local&#x2F;bin&#x2F;gotty</span><br></pre></td></tr></table></figure><p>æ›´å¤šå¹³å°çš„äºŒè¿›åˆ¶å®‰è£…åŒ…ï¼Œå¯è‡ªè¡Œåœ¨å®˜æ–¹é¡¹ç›®åœ°å€çš„ <a href="https://github.com/yudai/gotty/releases" target="_blank" rel="noopener">Releases</a> é¡µé¢è¿›è¡Œä¸‹è½½ã€‚</p><p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Macï¼Œä¹Ÿå¯ä»¥é€šè¿‡ <code>Homebrew</code> æ¥å®ç°ä¸€é”®å®‰è£…ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ brew install yudai&#x2F;gotty&#x2F;gotty</span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œæˆåï¼Œæ£€æŸ¥ä¸€ä¸‹ <code>Gotty</code> çš„ç‰ˆæœ¬ï¼Œä»¥éªŒè¯æ˜¯å¦å®‰è£…æ­£ç¡®ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ gotty -version</span><br><span class="line">gotty version 1.0.1</span><br></pre></td></tr></table></figure><a id="more"></a><h2 id="ä½¿ç”¨-gotty">ä½¿ç”¨ GoTTY</h2><p>ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•å‘½ä»¤æ¥ä½œä¸º <code>GoTTY</code> çš„å‚æ•°è¿è¡Œï¼Œä¾‹å¦‚ï¼š<code>gotty top</code>ã€‚</p><h3 id="gotty-è¯­æ³•">GoTTY è¯­æ³•</h3><ol><li>GoTTY å‘½ä»¤çš„å¸¸è§„è¯­æ³•</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Usage: gotty [options] &lt;command&gt; [&lt;arguments...&gt;]</span><br></pre></td></tr></table></figure><ol start="2"><li>GoTTY å‘½ä»¤çš„å¸¸ç”¨å‚æ•°</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">--address value, -a value     IP address to listen (default: &quot;0.0.0.0&quot;) [$GOTTY_ADDRESS]</span><br><span class="line">--port value, -p value        Port number to liten (default: &quot;8080&quot;) [$GOTTY_PORT]</span><br><span class="line">--permit-write, -w            Permit clients to write to the TTY (BE CAREFUL) [$GOTTY_PERMIT_WRITE]</span><br><span class="line">--credential value, -c value  Credential for Basic Authentication (ex: user:pass, default disabled) [$GOTTY_CREDENTIAL]</span><br><span class="line">--random-url, -r              Add a random string to the URL [$GOTTY_RANDOM_URL]</span><br><span class="line">--random-url-length value     Random URL length (default: 8) [$GOTTY_RANDOM_URL_LENGTH]</span><br><span class="line">--tls, -t                     Enable TLS&#x2F;SSL [$GOTTY_TLS]</span><br><span class="line">--tls-crt value               TLS&#x2F;SSL certificate file path (default: &quot;~&#x2F;.gotty.crt&quot;) [$GOTTY_TLS_CRT]</span><br><span class="line">--tls-key value               TLS&#x2F;SSL key file path (default: &quot;~&#x2F;.gotty.key&quot;) [$GOTTY_TLS_KEY]</span><br><span class="line">--tls-ca-crt value            TLS&#x2F;SSL CA certificate file for client certifications (default: &quot;~&#x2F;.gotty.ca.crt&quot;) [$GOTTY_TLS_CA_CRT]</span><br><span class="line">--index value                 Custom index.html file [$GOTTY_INDEX]</span><br><span class="line">--title-format value          Title format of browser window (default: &quot;&#123;&#123; .command &#125;&#125;@&#123;&#123; .hostname &#125;&#125;&quot;) [$GOTTY_TITLE_FORMAT]</span><br><span class="line">--reconnect                   Enable reconnection [$GOTTY_RECONNECT]</span><br><span class="line">--reconnect-time value        Time to reconnect (default: 10) [$GOTTY_RECONNECT_TIME]</span><br><span class="line">--max-connection value        Maximum connection to gotty (default: 0) [$GOTTY_MAX_CONNECTION]</span><br><span class="line">--once                        Accept only one client and exit on disconnection [$GOTTY_ONCE]</span><br><span class="line">--timeout value               Timeout seconds for waiting a client(0 to disable) (default: 0) [$GOTTY_TIMEOUT]</span><br><span class="line">--permit-arguments            Permit clients to send command line arguments in URL (e.g. http:&#x2F;&#x2F;example.com:8080&#x2F;?arg&#x3D;AAA&amp;arg&#x3D;BBB) [$GOTTY_PERMIT_ARGUMENTS]</span><br><span class="line">--width value                 Static width of the screen, 0(default) means dynamically resize (default: 0) [$GOTTY_WIDTH]</span><br><span class="line">--height value                Static height of the screen, 0(default) means dynamically resize (default: 0) [$GOTTY_HEIGHT]</span><br><span class="line">--ws-origin value             A regular expression that matches origin URLs to be accepted by WebSocket. No cross origin requests are acceptable by default [$GOTTY_WS_ORIGIN]</span><br><span class="line">--term value                  Terminal name to use on the browser, one of xterm or hterm. (default: &quot;xterm&quot;) [$GOTTY_TERM]</span><br><span class="line">--close-signal value          Signal sent to the command process when gotty close it (default: SIGHUP) (default: 1) [$GOTTY_CLOSE_SIGNAL]</span><br><span class="line">--close-timeout value         Time in seconds to force kill process after client is disconnected (default: -1) (default: -1) [$GOTTY_CLOSE_TIMEOUT]</span><br><span class="line">--config value                Config file path (default: &quot;~&#x2F;.gotty&quot;) [$GOTTY_CONFIG]</span><br><span class="line">--version, -v                 print the version</span><br></pre></td></tr></table></figure><ol start="3"><li>GoTTY çš„é…ç½®æ–‡ä»¶</li></ol><p>é™¤äº†é€šè¿‡å‘½ä»¤è¡Œç›´æ¥ç»™ <code>GoTTY</code> æŒ‡å®šå‚æ•°å¤–ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡å‘ <code>GoTTY</code> å‘½ä»¤æä¾›é…ç½®æ–‡ä»¶æ¥è‡ªå®šä¹‰é»˜è®¤å‚æ•°å’Œç»ˆç«¯çš„æ ·å¼ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>GoTTY</code> ä¼šåŠ è½½ç”¨æˆ·ç›®å½•ä¸‹çš„ <code>.gotty</code> æ–‡ä»¶ (<code>~/.gotty</code>) ä¸ºé…ç½®æ–‡ä»¶ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ cat ~&#x2F;.gotty</span><br><span class="line">&#x2F;&#x2F; Listen at port 9000 by default</span><br><span class="line">port &#x3D; &quot;9000&quot;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Enable TSL&#x2F;SSL by default</span><br><span class="line">enable_tls &#x3D; true</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; hterm preferences</span><br><span class="line">&#x2F;&#x2F; Smaller font and a little bit bluer background color</span><br><span class="line">preferences &#123;</span><br><span class="line">    font_size &#x3D; 5</span><br><span class="line">    background_color &#x3D; &quot;rgb(16, 16, 32)&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨å®ä¾‹">ä½¿ç”¨å®ä¾‹</h3><p><code>GoTTY</code> å‘½ä»¤è¿è¡Œå®Œæˆåï¼Œé»˜è®¤ä¼šåœ¨ 8080 å¯åŠ¨ä¸€ä¸ª <code>Web</code> æœåŠ¡å™¨ã€‚ä½ åªéœ€åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ <code>http://127.0.0.1:8080/</code>ï¼Œå°±ä¼šçœ‹åˆ°è¿è¡Œçš„å‘½ä»¤ï¼Œä»¿ä½›å’Œè¿è¡Œåœ¨ç»ˆç«¯ä¸­ä¸€æ ·ã€‚<code>GoTTY</code> æ”¯æŒçš„åŠŸèƒ½ç›¸å½“ä¸°å¯Œï¼Œä¸‹é¢æˆ‘å°±æ¥çœ‹å‡ ä¸ªæ¯”è¾ƒå¸¸ç”¨çš„ä½¿ç”¨å®ä¾‹ã€‚</p><ol><li>é€šè¿‡ GoTTY ç›´æ¥åœ¨ Web ç«¯æŸ¥çœ‹ç³»ç»Ÿåˆ†åŒºç©ºé—´åŠä½¿ç”¨ç‡</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gotty df -h</span><br></pre></td></tr></table></figure><p><img src="https://www.tecmint.com/wp-content/uploads/2017/03/Gotty-Linux-Disk-Usage.png" alt=""></p><ol start="2"><li>å…è®¸åœ¨ Web ç»ˆç«¯ä¸­è¿è¡Œå‘½ä»¤</li></ol><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>GoTTY</code> ä¸å…è®¸åœ¨ <code>Web</code> ç»ˆç«¯ä¸­è¿›è¡Œè¾“å…¥ã€‚ä½†æ˜¯ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>-w</code> æˆ– <code>--permit-write</code> é€‰é¡¹æ¥å¯ç”¨ <code>Web</code> ç»ˆç«¯å¯å†™å…¥ <code>TTY</code> çš„ç‰¹æ€§ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬æ¼”ç¤ºä¸€ä¸ªç”¨ <code>vi</code> å‘½ä»¤åœ¨æµè§ˆå™¨ä¸­ç¼–è¾‘ <code>fossmint.txt</code> æ–‡ä»¶çš„ä¾‹å­ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gotty -w vi fossmint.txt</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ä»æµè§ˆå™¨ä¸­çœ‹åˆ°æ‰“å¼€çš„ <code>vi</code> ç•Œé¢å’Œåœ¨ç»ˆç«¯æ‰“å¼€çš„ä¸€æ¨¡ä¸€æ ·ã€‚</p><p><img src="https://www.tecmint.com/wp-content/uploads/2017/03/Gotty-Web-Vi-Editor.png" alt=""></p><ol start="3"><li>ä½¿ç”¨ GoTTY å¯¹å®¹å™¨å†…éƒ¨è¿›è¡Œç®¡ç†</li></ol><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨ <code>Kubernetes</code> / <code>Docker</code> ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬éœ€è¦æä¾›ä¸€ç§èƒ½åŠ›è®©ç ”å‘æˆ–è€…å…¶å®ƒç›¸å…³æŠ€æœ¯äººå‘˜å¯ä»¥åœ¨ä¸ç™»é™†å®¿ä¸»æœºçš„æƒ…å†µä¸‹ç›´æ¥è®¿é—®å®¹å™¨æˆ–è€…æ˜¯æŸ¥çœ‹å®¹å™¨ä¸­åº”ç”¨ç¨‹åºçš„å½“å‰çŠ¶æ€ã€‚åŸºäºä¸Šé¢ä»‹ç»çš„å…è®¸ <code>Web</code> ç»ˆç«¯å†™å…¥ <code>TTY</code> çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥çµæ´»çš„å°†è¿™ä¸€ç‰¹æ€§è¿ç”¨åˆ°å®¹å™¨ç®¡ç†ä¸­æ¥ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ä½¿ç”¨ Docker å‘½ä»¤è¿›å…¥å®¹å™¨å†…éƒ¨</span><br><span class="line">$ gotty -w --permit-arguments docker exec -ti</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ä½¿ç”¨ Kubectl å‘½ä»¤è¿›å…¥å®¹å™¨å†…éƒ¨</span><br><span class="line">$ gotty -w --permit-arguments kubectl exec -ti</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä¸Šé¢å‘½ä»¤åï¼Œä½ å°±å¯ä»¥ç›´æ¥é€šè¿‡æµè§ˆå™¨ä¼ å…¥å®¹å™¨çš„ ID å’Œè¿›å…¥å®¹å™¨éœ€è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚è¿™é‡Œä¼ å…¥çš„å‘½ä»¤æ˜¯ <code>/bin/bash</code>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;172.172.241.180:8080&#x2F;?arg&#x3D;6f&amp;arg&#x3D;%2fbin%2fbash</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šä½¿ç”¨æµè§ˆå™¨é¢‘ç¹è¿›å…¥å®¹å™¨ä¹‹åï¼Œå®¹å™¨å†…éƒ¨ä¼šäº§ç”Ÿå¤§é‡ <code>/bin/bash</code> è¿›ç¨‹ ï¼Œä¸€èˆ¬ä¸æ¨èç›´æ¥è¿›å…¥å®¹å™¨ã€‚</p></blockquote><ol start="4"><li>ç»™ GoTTY åŠ ä¸ŠåŸºæœ¬çš„èº«ä»½éªŒè¯</li></ol><p>é»˜è®¤æƒ…å†µä¸‹é€šè¿‡æµè§ˆå™¨è®¿é—® <code>GoTTY</code> æ˜¯ä¸éœ€è¦éªŒè¯çš„ï¼Œä»»ä½•äººéƒ½å¯ä»¥è®¿é—®ã€‚ä¸ºäº†æ›´åŠ çš„å®‰å…¨ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ <code>GoTTY</code> åŠ ä¸ŠåŸºæœ¬èº«ä»½éªŒè¯æœºåˆ¶ã€‚è¿™æ ·åœ¨é€šè¿‡æµè§ˆå™¨è®¿é—®æ—¶ï¼Œå°±éœ€è¦è¾“å…¥æŒ‡å®šçš„ç”¨æˆ·åå’Œå¯†ç æ‰èƒ½è®¿é—®åˆ° <code>GoTTY</code> æ‰€åœ¨çš„æœåŠ¡å™¨ã€‚</p><p>è¦ç»™ <code>GoTTY</code> åŠ ä¸ŠåŸºæœ¬çš„éªŒè¯ï¼Œç”¨åˆ°çš„æ˜¯ <code>-c</code> é€‰é¡¹ï¼Œè¯¥é€‰é¡¹ä¸»è¦ç”¨æ¥æŒ‡å®šè®¿é—® <code>GoTTY</code> æ—¶æ‰€éœ€çš„ç”¨æˆ·åå’Œå¯†ç ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ç”¨æˆ·åæ˜¯ï¼štest å¯†ç æ˜¯ï¼š@67890</span><br><span class="line">$ gotty -w -p &quot;9000&quot; -c &quot;test:@67890&quot; glances</span><br></pre></td></tr></table></figure><p><img src="https://www.tecmint.com/wp-content/uploads/2017/03/Gotty-use-basic-authentication.png" alt=""></p><ol start="5"><li>ç»™ Gotty ç”Ÿæˆéšæœº URL</li></ol><p>é™¤äº†èº«ä»½éªŒè¯å¤–ï¼Œé™åˆ¶è®¿é—®æœåŠ¡å™¨çš„å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨éšæœº <code>URL</code>ã€‚é€šè¿‡ <code>GoTTY</code> çš„ <code>-r</code> é€‰é¡¹ï¼Œæˆ‘ä»¬å°±èƒ½ç”Ÿæˆä¸€ä¸ªéšæœº <code>URL</code>ï¼Œè¿™æ ·å°±åªæœ‰çŸ¥é“è¯¥ <code>URL</code> çš„ç”¨æˆ·æ‰å¯ä»¥è®¿é—®è¯¥æœåŠ¡å™¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gotty -r glances</span><br></pre></td></tr></table></figure><p>ä½ è¿˜å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„é€‰é¡¹æ¥å®šä¹‰æµè§ˆå™¨æ ‡é¢˜ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gotty -r --title-format <span class="string">"GoTTY - &#123;&#123; .Command &#125;&#125; (&#123;&#123; .Hostname &#125;&#125;)"</span> glances</span><br></pre></td></tr></table></figure><p><img src="https://www.tecmint.com/wp-content/uploads/2017/03/Gotty-Random-URL-for-Glances-Linux-Monitoring.png" alt=""></p><ol start="6"><li>ç»™ GoTTY å¯ç”¨ SSL/TLS è®¤è¯</li></ol><p>é»˜è®¤æƒ…å†µä¸‹æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´çš„æ‰€æœ‰è¿æ¥éƒ½ä¸åŠ å¯†ï¼Œå½“ä½ é€šè¿‡ <code>GoTTY</code> å‘é€æ•æ„Ÿæ•°æ®æ—¶ï¼Œä¸ºä¿è¯æ•°æ®å®Œå…¨å»ºè®®ä½ å¯ç”¨ <code>SSL/TLS</code>ã€‚</p><p><code>GoTTY</code> å¯ç”¨ <code>SSL/TLS</code> çš„æ”¯æŒéœ€è¦ä½¿ç”¨ <code>-t</code> æˆ– <code>--tls</code> é€‰é¡¹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>GoTTY</code> ä¼šè¯»å–ç”¨æˆ·ä¸»ç›®å½•ä¸‹çš„è¯ä¹¦æ–‡ä»¶å’Œå¯†é’¥æ–‡ä»¶ ( <code>~/.gotty.crt</code> å’Œ <code>~/.gotty.key</code>)ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªè‡ªç­¾åçš„è¯ä¹¦æ–‡ä»¶ä»¥åŠå¯†é’¥æ–‡ä»¶ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout ~&#x2F;.gotty.key -out ~&#x2F;.gotty.crt</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œé€šè¿‡ä¸‹é¢çš„å‘½ä»¤å¯ç”¨ <code>GoTTY</code> çš„ <code>SSL/TLS</code> ç‰¹æ€§åï¼Œä»¥è¾¾åˆ°å®‰å…¨è®¿é—® <code>GoTTY</code> çš„ç›®çš„ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gotty -tr --title-format &quot;GoTTY - &#123;&#123; .Command &#125;&#125; (&#123;&#123; .Hostname &#125;&#125;)&quot; glances</span><br></pre></td></tr></table></figure><ol start="7"><li>ä¸å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶å…±äº«ç»ˆç«¯</li></ol><p>å¦‚æœä½ éœ€è¦å’Œå¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶å…±äº«ä¸€ä¸ªç»ˆç«¯ï¼Œè¿™é‡Œä½ éœ€è¦ä½¿ç”¨ä¸€ä¸ªç»ˆç«¯å¤šè·¯å¤ç”¨å™¨ä¸å¤šä¸ªå®¢æˆ·ç«¯å…±äº«å•ä¸ªè¿›ç¨‹ï¼Œä»¥ä¸‹å‘½ä»¤ä»¥ <code>tmux</code> ä¸ºä¾‹ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆå¯åŠ¨ä¸€ä¸ªåä¸º <code>gotty</code> çš„æ–° <code>tmux</code> ä¼šè¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gotty tmux new -A -s gotty</span><br></pre></td></tr></table></figure><p>å…¶æ¬¡ï¼Œåœ¨å¦å¤–ä¸€ä¸ªç»ˆç«¯ä¸Š <code>attach</code> ä¸Šè¿™ä¸ª <code>tmux</code> ä¼šè¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ tmux attach -t gotty</span><br><span class="line">$ vim test.php</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œæˆ‘ä»¬é€šè¿‡æµè§ˆå™¨å¯ä»¥å®æ—¶çœ‹åˆ°åœ¨ç»ˆç«¯ä¸­æ‰€æœ‰çš„è¾“å…¥ï¼Œè¿™ç§åœºæ™¯ç‰¹åˆ«é€‚ç”¨äºæ•™å­¦å’Œæ¼”ç¤ºã€‚</p><h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2><ol><li><p><a href="http://www.google.com" target="_blank" rel="noopener">http://www.google.com</a></p></li><li><p><a href="https://ywnz.com/linuxrj/4060.html" target="_blank" rel="noopener">https://ywnz.com/linuxrj/4060.html</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/26590894" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/26590894</a></p></li><li><p><a href="https://blog.csdn.net/cj2580/article/details/79318726" target="_blank" rel="noopener">https://blog.csdn.net/cj2580/article/details/79318726</a></p></li><li><p><a href="https://www.tecmint.com/gotty-share-linux-terminal-in-web-browser/" target="_blank" rel="noopener">https://www.tecmint.com/gotty-share-linux-terminal-in-web-browser/</a></p></li></ol></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;GoTTY&lt;/code&gt; æ˜¯ä¸€ä¸ªç®€å•çš„åŸºäº &lt;code&gt;Go&lt;/code&gt; è¯­è¨€çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒå¯ä»¥å°†ä½ çš„ç»ˆç«¯ï¼ˆTTYï¼‰ä½œä¸º &lt;code&gt;Web&lt;/code&gt; ç¨‹åºå…±äº«ã€‚&lt;code&gt;GoTTY&lt;/code&gt; çš„æ¶æ„æ˜¯åŸºäº &lt;code&gt;Hterm&lt;/code&gt; + &lt;code&gt;Web Socket&lt;/code&gt; çš„ï¼Œå®ƒèƒ½åœ¨ &lt;code&gt;Web&lt;/code&gt; æµè§ˆå™¨ä¸Šè¿è¡Œä¸€ä¸ªåŸºäº &lt;code&gt;JavaScript&lt;/code&gt; çš„ç»ˆç«¯ï¼Œå¹¶æ”¯æŒé€šè¿‡ &lt;code&gt;HTTP&lt;/code&gt; å’Œ &lt;code&gt;HTTPS&lt;/code&gt; è®¿é—®ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¡¹ç›®åœ°å€ï¼š&lt;a href=&quot;https://github.com/yudai/gotty&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/yudai/gotty&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/yudai/gotty/master/screenshot.gif&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;å®‰è£…-GoTTY&quot;&gt;å®‰è£… GoTTY&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;GoTTY&lt;/code&gt; åŸç”Ÿæ”¯æŒè‰¯å¥½çš„è·¨å¹³å°æ€§ï¼Œå¼€ç®±å³ç”¨ã€‚åªéœ€ä¸‹è½½å¯¹åº”å¹³å°çš„äºŒè¿›åˆ¶åŒ…å°±è¡Œäº†ï¼Œè¿™é‡Œä»¥ &lt;code&gt;Linux&lt;/code&gt; å¹³å°ä¸ºä¾‹ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# ä¸‹è½½å¹¶è§£å‹ GoTTY å®‰è£…åŒ…&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ wget https:&amp;#x2F;&amp;#x2F;github.com&amp;#x2F;yudai&amp;#x2F;gotty&amp;#x2F;releases&amp;#x2F;download&amp;#x2F;v1.0.1&amp;#x2F;gotty_linux_amd64.tar.gz&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ tar -xzvf gotty_linux_amd64.tar.gz&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# å¤åˆ¶å¯æ‰§è¡Œæ–‡ä»¶åˆ°æŒ‡å®šç›®å½•å¹¶èµ‹äºˆæ‰§è¡Œæƒé™&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ sudo cp gotty &amp;#x2F;usr&amp;#x2F;local&amp;#x2F;bin&amp;#x2F;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ chmod +x &amp;#x2F;usr&amp;#x2F;local&amp;#x2F;bin&amp;#x2F;gotty&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ›´å¤šå¹³å°çš„äºŒè¿›åˆ¶å®‰è£…åŒ…ï¼Œå¯è‡ªè¡Œåœ¨å®˜æ–¹é¡¹ç›®åœ°å€çš„ &lt;a href=&quot;https://github.com/yudai/gotty/releases&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Releases&lt;/a&gt; é¡µé¢è¿›è¡Œä¸‹è½½ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Macï¼Œä¹Ÿå¯ä»¥é€šè¿‡ &lt;code&gt;Homebrew&lt;/code&gt; æ¥å®ç°ä¸€é”®å®‰è£…ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ brew install yudai&amp;#x2F;gotty&amp;#x2F;gotty&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å®‰è£…å®Œæˆåï¼Œæ£€æŸ¥ä¸€ä¸‹ &lt;code&gt;Gotty&lt;/code&gt; çš„ç‰ˆæœ¬ï¼Œä»¥éªŒè¯æ˜¯å¦å®‰è£…æ­£ç¡®ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ gotty -version&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;gotty version 1.0.1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="Docker" scheme="https://www.hi-linux.com/categories/docker/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="Docker" scheme="https://www.hi-linux.com/tags/Docker/"/>
    
      <category term="æŠ€å·§" scheme="https://www.hi-linux.com/tags/%E6%8A%80%E5%B7%A7/"/>
    
  </entry>
  
  <entry>
    <title>nftables ç®€æ˜æ•™ç¨‹</title>
    <link href="https://www.hi-linux.com/posts/29206.html"/>
    <id>https://www.hi-linux.com/posts/29206.html</id>
    <published>2020-05-12T01:00:00.000Z</published>
    <updated>2020-05-12T05:06:03.209Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><h2 id="ä»€ä¹ˆæ˜¯-nftables">ä»€ä¹ˆæ˜¯ nftablesï¼Ÿ</h2><p><code>nftables</code> æ˜¯ä¸€ä¸ªæ–°å¼çš„æ•°æ®åŒ…è¿‡æ»¤æ¡†æ¶ï¼Œæ—¨åœ¨æ›¿ä»£ç°ç”¨çš„ <code>iptables</code>ã€<code>ip6tables</code>ã€<code>arptables</code> å’Œ <code>ebtables</code> çš„æ–°çš„åŒ…è¿‡æ»¤æ¡†æ¶ã€‚<code>nftables</code> è¯ç”Ÿäº 2008 å¹´ï¼Œ2013 å¹´åº•åˆå¹¶åˆ° <code>Linux å†…æ ¸</code>ï¼Œä» <code>Linux</code> å†…æ ¸ <code>3.13</code> ç‰ˆæœ¬å¼€å§‹å¤§å¤šæ•°åœºæ™¯ä¸‹ <code>nftables</code> å·²ç»å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯å®Œæ•´çš„æ”¯æŒï¼ˆå³ï¼š<code>nftables</code> ä¼˜å…ˆçº§é«˜äº <code>iptables</code>ï¼‰åº”è¯¥æ˜¯åœ¨ Linux å†…æ ¸ <code>3.15</code> ç‰ˆæœ¬ã€‚</p><p><code>nftables</code> æ—¨åœ¨è§£å†³ç°æœ‰ <code>{ip/ip6}tables</code> å·¥å…·å­˜åœ¨çš„è¯¸å¤šé™åˆ¶ã€‚ç›¸å¯¹äºæ—§çš„ <code>iptables</code>ï¼Œ<code>nftables</code> æœ€å¼•äººæ³¨ç›®çš„åŠŸèƒ½åŒ…æ‹¬ï¼šæ”¹è¿›æ€§èƒ½ã€æ”¯æŒæŸ¥è¯¢è¡¨ã€äº‹åŠ¡å‹è§„åˆ™æ›´æ–°ã€æ‰€æœ‰è§„åˆ™è‡ªåŠ¨åº”ç”¨ç­‰ç­‰ã€‚</p><p><code>nftables</code> ä¸»è¦ç”±ä¸‰ä¸ªç»„ä»¶ç»„æˆï¼šå†…æ ¸å®ç°ã€<code>libnl netlink</code> é€šä¿¡å’Œ <code>nftables</code> ç”¨æˆ·ç©ºé—´ã€‚å…¶ä¸­å†…æ ¸æä¾›äº†ä¸€ä¸ª <code>netlink</code> é…ç½®æ¥å£ä»¥åŠè¿è¡Œæ—¶è§„åˆ™é›†è¯„ä¼°ï¼Œ<code>libnl</code> åŒ…å«äº†ä¸å†…æ ¸é€šä¿¡çš„åŸºæœ¬å‡½æ•°ï¼Œç”¨æˆ·ç©ºé—´å¯ä»¥é€šè¿‡æ–°å¼•å…¥çš„å‘½ä»¤è¡Œå·¥å…· <code>nft</code> å’Œç”¨æˆ·è¿›è¡Œäº¤äº’ã€‚</p><p><code>nft</code> å¯ä»¥é€šè¿‡åœ¨å¯„å­˜å™¨ä¸­å‚¨å­˜å’ŒåŠ è½½æ¥äº¤æ¢æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒçš„è¯­æ³•ä¸ <code>iptables</code> ä¸åŒã€‚ä½† <code>nft</code> å¯ä»¥åˆ©ç”¨å†…æ ¸æä¾›çš„è¡¨è¾¾å¼å»æ¨¡æ‹Ÿæ—§çš„ <code>iptables</code> å‘½ä»¤ï¼Œç»´æŒå…¼å®¹æ€§çš„åŒæ—¶è·å¾—æ›´å¤§çš„çµæ´»æ€§ã€‚ç®€å•æ¥è¯´ï¼Œ<code>nft</code> æ˜¯ <code>iptables</code> åŠå…¶è¡ç”ŸæŒ‡ä»¤ï¼ˆ<code>ip6tables</code> å’Œ <code>arptables</code> ï¼‰çš„è¶…é›†ã€‚</p><h3 id="nftables-çš„ç‰¹ç‚¹">nftables çš„ç‰¹ç‚¹</h3><ol><li><p><code>nftables</code> æ‹¥æœ‰ä¸€äº›é«˜çº§çš„ç±»ä¼¼ç¼–ç¨‹è¯­è¨€çš„èƒ½åŠ›ï¼Œä¾‹å¦‚ï¼šå®šä¹‰å˜é‡å’ŒåŒ…å«å¤–éƒ¨æ–‡ä»¶ï¼Œå³æ‹¥æœ‰ä½¿ç”¨é¢å¤–è„šæœ¬çš„èƒ½åŠ›ã€‚<code>nftables</code> ä¹Ÿå¯ä»¥ç”¨äºå¤šç§åœ°å€ç°‡çš„è¿‡æ»¤å’Œå¤„ç†ã€‚</p></li><li><p>ä¸åŒäº <code>iptables</code>, <code>nftables</code> å¹¶ä¸åŒ…å«ä»»ä½•çš„å†…ç½®è¡¨ï¼Œéœ€è¦å“ªäº›è¡¨å¹¶åœ¨è¿™äº›è¡¨ä¸­æ·»åŠ ä»€ä¹ˆå¤„ç†è§„åˆ™ä¸€åˆ‡ç”±ç®¡ç†å‘˜å†³å®šã€‚</p></li><li><p>è¡¨åŒ…å«è§„åˆ™é“¾ï¼Œè§„åˆ™é“¾åŒ…å«è§„åˆ™ã€‚</p></li></ol><h3 id="nftables-ç›¸è¾ƒäº-iptables-çš„ä¼˜ç‚¹">nftables ç›¸è¾ƒäº iptables çš„ä¼˜ç‚¹</h3><ol><li>æ›´æ–°é€Ÿåº¦æ›´å¿«</li></ol><p>åœ¨ <code>iptables</code> ä¸­æ·»åŠ ä¸€æ¡è§„åˆ™ï¼Œä¼šéšç€è§„åˆ™æ•°é‡å¢å¤šè€Œå˜å¾—éå¸¸æ…¢ã€‚è¿™ç§çŠ¶å†µå¯¹ <code>nftables</code> è€Œè¨€å°±ä¸å­˜åœ¨äº†ï¼Œå› ä¸º <code>nftables</code> ä½¿ç”¨åŸå­çš„å¿«é€Ÿæ“ä½œæ¥æ›´æ–°è§„åˆ™é›†åˆã€‚</p><ol start="2"><li>å†…æ ¸æ›´æ–°æ›´å°‘ã€‚</li></ol><p>ä½¿ç”¨ <code>iptables</code> æ—¶ï¼Œæ¯ä¸€ä¸ªåŒ¹é…æˆ–æŠ•é€’éƒ½éœ€è¦å†…æ ¸æ¨¡å—çš„æ”¯æŒã€‚å› æ­¤ï¼Œå¦‚æœä½ å¿˜è®°ä¸€äº›ä¸œè¥¿æˆ–è€…è¦æ·»åŠ æ–°çš„åŠŸèƒ½æ—¶éƒ½éœ€è¦é‡æ–°ç¼–è¯‘å†…æ ¸ã€‚è€Œåœ¨ <code>nftables</code> ä¸­å°±ä¸å­˜åœ¨è¿™ç§æƒ…å†µäº†ï¼Œ å› ä¸ºåœ¨ <code>nftables</code> ä¸­ï¼Œå¤§éƒ¨åˆ†å·¥ä½œæ˜¯åœ¨ç”¨æˆ·æ€å®Œæˆçš„ï¼Œå†…æ ¸åªçŸ¥é“ä¸€äº›åŸºæœ¬æŒ‡ä»¤ï¼ˆè¿‡æ»¤æ˜¯ç”¨ä¼ªçŠ¶æ€æœºå®ç°çš„ï¼‰ã€‚ä¾‹å¦‚ï¼Œ<code>icmpv6</code> æ”¯æŒæ˜¯é€šè¿‡ <code>nft</code> å·¥å…·çš„ä¸€ä¸ªç®€å•çš„è¡¥ä¸å®ç°çš„ï¼Œè€Œåœ¨ <code>iptables</code> ä¸­è¿™ç§ç±»å‹çš„æ›´æ”¹éœ€è¦å†…æ ¸å’Œ <code>iptables</code> éƒ½å‡çº§æ‰å¯ä»¥ã€‚</p><a id="more"></a><h2 id="nftables-åŸºç¡€æ“ä½œ">nftables åŸºç¡€æ“ä½œ</h2><p><code>nftables</code> å’Œ <code>iptables</code> ä¸€æ ·ï¼Œç”±è¡¨ï¼ˆtableï¼‰ã€é“¾ï¼ˆchainï¼‰å’Œè§„åˆ™ï¼ˆruleï¼‰ç»„æˆï¼Œå…¶ä¸­è¡¨åŒ…å«é“¾ï¼Œé“¾åŒ…å«è§„åˆ™ï¼Œè§„åˆ™æ˜¯çœŸæ­£çš„åŠ¨ä½œã€‚</p><p>åœ¨ <code>nftables</code> ä¸­ï¼Œè¡¨æ˜¯é“¾çš„å®¹å™¨ã€‚æ‰€ä»¥å¼€å§‹ä½¿ç”¨ <code>nftables</code> æ—¶ä½ é¦–å…ˆéœ€è¦åšçš„æ˜¯æ·»åŠ è‡³å°‘ä¸€ä¸ªè¡¨ã€‚ç„¶åï¼Œä½ å¯ä»¥å‘ä½ çš„è¡¨é‡Œæ·»åŠ é“¾ï¼Œç„¶åå¾€é“¾é‡Œæ·»åŠ è§„åˆ™ã€‚</p><h3 id="nftables-çš„è¡¨ç®¡ç†">nftables çš„è¡¨ç®¡ç†</h3><p>ä¸ <code>iptables</code> ä¸­çš„è¡¨ä¸åŒï¼Œ<code>nftables</code> ä¸­æ²¡æœ‰å†…ç½®è¡¨ã€‚è¡¨çš„æ•°é‡å’Œåç§°ç”±ç”¨æˆ·å†³å®šã€‚ä½†æ˜¯ï¼Œæ¯ä¸ªè¡¨åªæœ‰ä¸€ä¸ªåœ°å€ç°‡ï¼Œå¹¶ä¸”åªé€‚ç”¨äºè¯¥ç°‡çš„æ•°æ®åŒ…ã€‚<code>nftables</code> è¡¨å¯ä»¥æŒ‡å®šä¸ºä»¥ä¸‹äº”ä¸ªç°‡ä¸­çš„ä¸€ä¸ªï¼š</p><table><thead><tr><th>nftables ç°‡</th><th>å¯¹åº” iptables çš„å‘½ä»¤è¡Œå·¥å…·</th></tr></thead><tbody><tr><td>ip</td><td>iptables</td></tr><tr><td>ip6</td><td>ip6tables</td></tr><tr><td>inet</td><td>iptables å’Œ ip6tables</td></tr><tr><td>arp</td><td>arptables</td></tr><tr><td>bridge</td><td>ebtables</td></tr></tbody></table><p><code>ip</code>ï¼ˆå³ IPv4ï¼‰æ˜¯é»˜è®¤ç°‡ï¼Œå¦‚æœæœªæŒ‡å®šç°‡ï¼Œåˆ™ä½¿ç”¨è¯¥ç°‡ã€‚å¦‚æœè¦åˆ›å»ºåŒæ—¶é€‚ç”¨äº <code>IPv4</code> å’Œ <code>IPv6</code> çš„è§„åˆ™ï¼Œè¯·ä½¿ç”¨ <code>inet</code> ç°‡ ã€‚<code>inet</code> å…è®¸ç»Ÿä¸€ <code>ip</code> å’Œ <code>ip6</code> ç°‡ï¼Œä»¥ä¾¿æ›´å®¹æ˜“åœ°å®šä¹‰è§„åˆ™ã€‚</p><blockquote><p>æ³¨æ„: <code>inet</code> ä¸èƒ½ç”¨äº <code>nat</code> ç±»å‹çš„é“¾ï¼Œåªèƒ½ç”¨äº <code>filter</code> ç±»å‹çš„é“¾ã€‚</p></blockquote><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹ <code>nftables</code> æ˜¯å¦‚ä½•è¿›è¡Œè¡¨ç®¡ç†æ“ä½œçš„ï¼Œä»¥ä¸‹ä¸º <code>nftables</code> åˆ›å»ºè¡¨çš„åŸºæœ¬å‘½ä»¤è¯­æ³•ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nft list tables [&lt;family&gt;]</span><br><span class="line">nft list table [&lt;family&gt;] &lt;name&gt; [-n] [-a]</span><br><span class="line">nft (add | delete | flush) table [&lt;family&gt;] &lt;name&gt;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬ä»¥åˆ›å»ºä¸€ä¸ª <code>inet</code> ç°‡çš„è¡¨ä¸ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•åˆ›å»ºå’Œç®¡ç†ä¸€ä¸ªæ–°çš„è¡¨ã€‚</p><ol><li>åˆ›å»ºè¡¨</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªæ–°çš„è¡¨</span></span><br><span class="line">$ nft add table inet mytable</span><br></pre></td></tr></table></figure><ol start="2"><li>åˆ—å‡ºè¡¨</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ—å‡ºæ‰€æœ‰è¡¨</span></span><br><span class="line">$ nft list tables</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ—å‡ºæŒ‡å®šæ—çš„æ‰€æœ‰è¡¨</span></span><br><span class="line">$ nft list tables inet</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ—å‡º inet ç°‡ä¸­ mytable è¡¨ä¸­çš„æ‰€æœ‰è§„åˆ™</span></span><br><span class="line">$ nft list table inet mytable</span><br></pre></td></tr></table></figure><ol start="3"><li>åˆ é™¤è¡¨</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤ä¸€ä¸ªè¡¨</span></span><br><span class="line">$ nft delete table inet mytable</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šåªèƒ½åˆ é™¤ä¸åŒ…å«é“¾çš„è¡¨ã€‚</p></blockquote><ol start="4"><li>æ¸…ç©ºè¡¨</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¸…ç©ºä¸€ä¸ªè¡¨ä¸­çš„æ‰€æœ‰è§„åˆ™</span></span><br><span class="line">$ nft flush table inet mytable</span><br></pre></td></tr></table></figure><h3 id="nftables-çš„é“¾ç®¡ç†">nftables çš„é“¾ç®¡ç†</h3><p>é“¾æ˜¯ç”¨æ¥ä¿å­˜è§„åˆ™çš„ï¼Œä¸ <code>iptables</code> ä¸­çš„é“¾ä¸åŒï¼Œ<code>nftables</code> æ²¡æœ‰å†…ç½®é“¾ã€‚è¿™æ„å‘³ç€å’Œè¡¨ä¸€æ ·ï¼Œé“¾ä¹Ÿéœ€è¦è¢«æ˜¾ç¤ºåˆ›å»ºã€‚é“¾æœ‰ä»¥ä¸‹ä¸¤ç§ç±»å‹ï¼š</p><ul><li><p>å¸¸è§„é“¾ : ä¸»è¦ç”¨æ¥åšè·³è½¬ï¼Œä¸éœ€è¦æŒ‡å®šé’©å­ç±»å‹å’Œä¼˜å…ˆçº§ã€‚ä»é€»è¾‘ä¸Šå¯¹è§„åˆ™è¿›è¡Œåˆ†ç±»ï¼Œæ”¯æŒæ‰€æœ‰çš„ <code>nftables</code> ç°‡ã€‚</p></li><li><p>åŸºæœ¬é“¾ : æ¥è‡ªç½‘ç»œæ ˆæ•°æ®åŒ…çš„å…¥å£ç‚¹ï¼Œéœ€è¦æŒ‡å®šé’©å­ç±»å‹å’Œä¼˜å…ˆçº§ï¼Œæ”¯æŒ <code>ip</code> å’Œ <code>ip6</code> ç°‡ã€‚</p></li></ul><p><strong>nftables é“¾æ”¯æŒé’©å­çš„ç±»å‹</strong></p><p><code>nftables</code> å’Œ <code>iptables</code> ç±»ä¼¼ï¼Œä¾ç„¶ä½¿ç”¨ <code>netfiler</code> ä¸­çš„ 5 ä¸ª é’©å­ã€‚</p><p><img src="https://i.loli.net/2019/11/11/Xk6QsDoqw7xRC21.png" alt=""></p><p>ä¸åŒçš„æ˜¯ <code>nftables</code> åœ¨ <code>Linux Kernel 4.2</code> ä¸­æ–°å¢äº† <code>ingress</code> é’©å­ã€‚</p><p><img src="https://i.loli.net/2019/11/11/498zJrR27kqptXT.png" alt=""></p><p><strong>nftables é“¾æ”¯æŒé’©å­çš„ä½œç”¨</strong></p><ul><li><p><code>prerouting</code>ï¼šåˆšåˆ°è¾¾å¹¶æœªè¢« <code>nftables</code> çš„å…¶ä»–éƒ¨åˆ†æ‰€è·¯ç”±æˆ–å¤„ç†çš„æ•°æ®åŒ…ã€‚</p></li><li><p><code>input</code>ï¼šå·²ç»è¢«æ¥æ”¶å¹¶ä¸”å·²ç»ç»è¿‡ <code>prerouting</code> é’©å­çš„ä¼ å…¥æ•°æ®åŒ…ã€‚</p></li><li><p><code>forward</code>ï¼šå¦‚æœæ•°æ®æŠ¥å°†è¢«å‘é€åˆ°å¦ä¸€ä¸ªè®¾å¤‡ï¼Œå®ƒå°†ä¼šé€šè¿‡ <code>forward</code> é’©å­ã€‚</p></li><li><p><code>output</code>ï¼šä»æœ¬åœ°ä¼ å‡ºçš„æ•°æ®åŒ…ã€‚</p></li><li><p><code>postrouting</code>ï¼šä»…ä»…åœ¨ç¦»å¼€ç³»ç»Ÿä¹‹å‰ï¼Œå¯ä»¥å¯¹æ•°æ®åŒ…è¿›è¡Œè¿›ä¸€æ­¥å¤„ç†ã€‚</p></li></ul><p><strong>nftables é“¾æ”¯æŒé’©å­çš„é€‚ç”¨èŒƒå›´</strong></p><ul><li><p><code>ip</code>ã€<code>ip6</code> å’Œ <code>inet</code> ç°‡æ”¯æŒçš„é’©å­æœ‰ï¼š <code>prerouting</code>ã€ <code>input</code>ã€<code>forward</code>ã€ <code>output</code>ã€<code>postrouting</code> ã€‚</p></li><li><p><code>arp</code> ç°‡æ”¯æŒçš„é’©å­æœ‰ï¼š <code>input</code>ã€<code>output</code> ã€‚</p></li></ul><p><strong>nftables é“¾æ”¯æŒçš„ä¼˜å…ˆçº§</strong></p><p>ä¼˜å…ˆçº§é‡‡ç”¨æ•´æ•°å€¼è¡¨ç¤ºï¼Œæ•°å­—è¾ƒå°çš„é“¾ä¼˜å…ˆå¤„ç†ï¼Œå¹¶ä¸”å¯ä»¥æ˜¯è´Ÿæ•°ã€‚å¯ä»¥ä½¿ç”¨çš„å€¼æœ‰ï¼š</p><ul><li><p>NF_IP_PRI_CONNTRACK_DEFRAG (-400)</p></li><li><p>NF_IP_PRI_RAW (-300)</p></li><li><p>NF_IP_PRI_SELINUX_FIRST (-225)</p></li><li><p>NF_IP_PRI_CONNTRACK (-200)</p></li><li><p>NF_IP_PRI_MANGLE (-150)</p></li><li><p>NF_IP_PRI_NAT_DST (-100)</p></li><li><p>NF_IP_PRI_FILTER (0)</p></li><li><p>NF_IP_PRI_SECURITY (50)</p></li><li><p>NF_IP_PRI_NAT_SRC (100)</p></li><li><p>NF_IP_PRI_SELINUX_LAST (225)</p></li><li><p>NF_IP_PRI_CONNTRACK_HELPER (300)</p></li></ul><p><strong>nftables é“¾å¯¹æŠ¥æ–‡æ•°æ®æ”¯æŒé‡‡å–çš„åŠ¨ä½œ</strong></p><ul><li><p>accept</p></li><li><p>drop</p></li><li><p>queue</p></li><li><p>continue</p></li><li><p>return</p></li></ul><p><strong>nftables åˆ›å»ºé“¾çš„åŸºæœ¬å‘½ä»¤è¯­æ³•</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nft (add | create) chain [&lt;family&gt;] &lt;table&gt; &lt;name&gt; [ &#123; <span class="built_in">type</span> &lt;<span class="built_in">type</span>&gt; hook &lt;hook&gt; [device &lt;device&gt;] priority &lt;priority&gt; \; [policy &lt;policy&gt; \;] &#125; ]</span><br><span class="line">nft (delete | list | flush) chain [&lt;family&gt;] &lt;table&gt; &lt;name&gt;</span><br><span class="line">nft rename chain [&lt;family&gt;] &lt;table&gt; &lt;name&gt; &lt;newname&gt;</span><br></pre></td></tr></table></figure><p><strong>nftables åˆ›å»ºé“¾çš„åŸºæœ¬æ“ä½œ</strong></p><ol><li>åˆ›å»ºé“¾</li></ol><ul><li>åˆ›å»ºä¸€ä¸ªå¸¸è§„é“¾</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†åä¸º tcpchain çš„å¸¸è§„é“¾æ·»åŠ åˆ° inet ç°‡ä¸­åä¸º mytable çš„è¡¨ä¸­</span></span><br><span class="line">$ nft add chain inet mytable tcpchain</span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºä¸€ä¸ªåŸºæœ¬é“¾</li></ul><p>æ·»åŠ ä¸€ä¸ªåŸºæœ¬é“¾ï¼Œä½ å¿…éœ€æŒ‡å®šé’©å­å’Œä¼˜å…ˆçº§ã€‚åŸºæœ¬é“¾çš„ç±»å‹å¯ä»¥æ˜¯ <code>filter</code>ã€<code>route</code> æˆ–è€… <code>nat</code>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ ä¸€ä¸ªç­›é€‰è¾“å…¥æ•°æ®åŒ…çš„åŸºæœ¬é“¾</span></span><br><span class="line">$ nft add chain inet mytable input &#123; <span class="built_in">type</span> filter hook input priority 0\; &#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šå‘½ä»¤ä¸­çš„åæ–œçº¿ <code>ï¼ˆ\ï¼‰</code> ç”¨æ¥è½¬ä¹‰ï¼Œè¿™æ · <code>Shell</code> å°±ä¸ä¼šå°†åˆ†å·è§£é‡Šä¸ºå‘½ä»¤çš„ç»“å°¾ã€‚</p></blockquote><ol start="2"><li>åˆ—å‡ºè§„åˆ™</li></ol><p>åˆ—å‡ºä¸€ä¸ªé“¾ä¸­çš„æ‰€æœ‰è§„åˆ™ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ—å‡º inet ç­›ä¸­ filter è¡¨çš„ input é“¾ä¸­çš„æ‰€æœ‰çš„è§„åˆ™</span></span><br><span class="line">$ nft list chain inet filter input</span><br></pre></td></tr></table></figure><ol start="3"><li>ç¼–è¾‘é“¾</li></ol><p>è¦ç¼–è¾‘ä¸€ä¸ªé“¾ï¼Œåªéœ€æŒ‰åç§°è°ƒç”¨å¹¶é‡æ–°å®šä¹‰è¦æ›´æ”¹çš„è§„åˆ™å³å¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†é»˜è®¤è¡¨ä¸­çš„ input é“¾ç­–ç•¥ä» accept æ›´æ”¹ä¸º drop</span></span><br><span class="line">$ nft chain inet mytable input &#123; policy drop \; &#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>æ¸…ç©ºé“¾ä¸­çš„è§„åˆ™</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¸…ç©ºæŒ‡å®šé“¾ä¸­çš„è§„åˆ™ï¼Œè¿™é‡Œä¸º input</span></span><br><span class="line">$ nft flush chain inet mytable input</span><br></pre></td></tr></table></figure><ol start="5"><li>åˆ é™¤é“¾</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤æŒ‡å®šçš„é“¾ï¼Œè¿™é‡Œä¸º input</span></span><br><span class="line">$ nft delete chain inet mytable input</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šè¦åˆ é™¤çš„é“¾ä¸­ä¸èƒ½åŒ…å«ä»»ä½•è§„åˆ™æˆ–è€…è·³è½¬ç›®æ ‡ã€‚</p></blockquote><h3 id="nftables-çš„è§„åˆ™ç®¡ç†">nftables çš„è§„åˆ™ç®¡ç†</h3><p><code>nftables</code> è§„åˆ™ç”±è¯­å¥æˆ–è¡¨è¾¾å¼æ„æˆï¼ŒåŒ…å«åœ¨é“¾ä¸­ã€‚ä»¥ä¸‹ä¸ºåˆ›å»º <code>nftables</code> è§„åˆ™çš„åŸºæœ¬å‘½ä»¤è¯­æ³•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nft add rule [&lt;family&gt;] &lt;table&gt; &lt;chain&gt; &lt;matches&gt; &lt;statements&gt;</span><br><span class="line">nft insert rule [&lt;family&gt;] &lt;table&gt; &lt;chain&gt; [position &lt;position&gt;] &lt;matches&gt; &lt;statements&gt;</span><br><span class="line">nft replace rule [&lt;family&gt;] &lt;table&gt; &lt;chain&gt; [handle &lt;handle&gt;] &lt;matches&gt; &lt;statements&gt;</span><br><span class="line">nft delete rule [&lt;family&gt;] &lt;table&gt; &lt;chain&gt; [handle &lt;handle&gt;]</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>matches</code> æ˜¯æŠ¥æ–‡éœ€è¦æ»¡è¶³çš„æ¡ä»¶ã€‚<code>matches</code> çš„å†…å®¹éå¸¸å¤šï¼Œå¯ä»¥è¯†åˆ«ä»¥ä¸‹å¤šç§ç±»å‹çš„æŠ¥æ–‡ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">ip          :  ipv4 åè®®å­—æ®µ</span><br><span class="line">ip6         :  ipv6 åè®®å­—æ®µ</span><br><span class="line">tcp         :  tcp åè®®å­—æ®µ</span><br><span class="line">udp         :  udp åè®®å­—æ®µ</span><br><span class="line">udplite     :  udp-lite åè®®</span><br><span class="line">sctp        :  sctp åè®® </span><br><span class="line">dccp</span><br><span class="line">ah</span><br><span class="line">esp</span><br><span class="line">comp</span><br><span class="line">icmp</span><br><span class="line">icmpv6</span><br><span class="line">ether       :  ä»¥å¤ªå¤´</span><br><span class="line">dst</span><br><span class="line">frag        :</span><br><span class="line">hbh</span><br><span class="line">mh</span><br><span class="line">rt            </span><br><span class="line">vlan        :  vlan</span><br><span class="line">arp         :  arpåè®®</span><br><span class="line">ct          :  è¿æ¥çŠ¶æ€</span><br><span class="line">meta        :  æŠ¥æ–‡çš„åŸºæœ¬ä¿¡æ¯</span><br></pre></td></tr></table></figure><p>å¯¹æ¯ä¸€ç§ç±»å‹çš„æŠ¥æ–‡ï¼Œä½ åˆå¯ä»¥åŒæ—¶æ£€æŸ¥å¤šä¸ªå­—æ®µï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ip dscp cs1</span><br><span class="line">ip dscp != cs1</span><br><span class="line">ip dscp 0x38</span><br><span class="line">ip dscp != 0x20</span><br><span class="line">ip dscp &#123;cs0, cs1, cs2, cs3, cs4, cs5, cs6, cs7, af11, af12, af13, af21, </span><br><span class="line">af22, af23, af31, af32, af33, af41, af42, af43, ef&#125;</span><br><span class="line"></span><br><span class="line">ip length 232</span><br><span class="line">ip length != 233</span><br><span class="line">ip length 333-435</span><br><span class="line">ip length != 333-453</span><br><span class="line">ip length &#123; 333, 553, 673, 838&#125;</span><br><span class="line"></span><br><span class="line">ip6 flowlabel 22</span><br><span class="line">ip6 flowlabel != 233</span><br><span class="line">ip6 flowlabel &#123; 33, 55, 67, 88 &#125;</span><br><span class="line">ip6 flowlabel &#123; 33-55 &#125;</span><br></pre></td></tr></table></figure><p>è€Œ <code>statement</code> æ˜¯æŠ¥æ–‡åŒ¹é…è§„åˆ™æ—¶è§¦å‘çš„æ“ä½œï¼Œå¤§è‡´æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Verdict statements :   åŠ¨ä½œ</span><br><span class="line">Log                :   è®°å½•æ—¥å¿—å¹¶ç»§ç»­å¤„ç†è¯·æ±‚</span><br><span class="line">Reject             :   åœæ­¢å¤„ç†å¹¶æ‹’ç»è¯·æ±‚</span><br><span class="line">Counter            :   è®¡æ•°</span><br><span class="line">Limit              :   å¦‚æœè¾¾åˆ°äº†æ¥æ”¶æ•°æ®åŒ…çš„åŒ¹é…é™åˆ¶ï¼Œåˆ™æ ¹æ®è§„åˆ™å¤„ç†æ•°æ®åŒ…</span><br><span class="line">Nat                :   NAT</span><br><span class="line">Queuea             :   åœæ­¢å¤„ç†å¹¶å‘é€æ•°æ®åŒ…åˆ°ç”¨æˆ·ç©ºé—´ç¨‹åº</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>Verdict Statements</code> æ˜¯ä¸€ç»„åŠ¨ä½œï¼Œå¤§è‡´æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ul><li><p>acceptï¼šæ¥å—æ•°æ®åŒ…å¹¶åœæ­¢å‰©ä½™è§„åˆ™è¯„ä¼°ã€‚</p></li><li><p>dropï¼šä¸¢å¼ƒæ•°æ®åŒ…å¹¶åœæ­¢å‰©ä½™è§„åˆ™è¯„ä¼°ã€‚</p></li><li><p>queueï¼šå°†æ•°æ®åŒ…æ’é˜Ÿåˆ°ç”¨æˆ·ç©ºé—´å¹¶åœæ­¢å‰©ä½™è§„åˆ™è¯„ä¼°ã€‚</p></li><li><p>continueï¼šä½¿ç”¨ä¸‹ä¸€æ¡è§„åˆ™ç»§ç»­è¿›è¡Œè§„åˆ™è¯„ä¼°ã€‚</p></li><li><p>returnï¼šä»å½“å‰é“¾è¿”å›å¹¶ç»§ç»­æ‰§è¡Œæœ€åä¸€æ¡é“¾çš„ä¸‹ä¸€æ¡è§„åˆ™ã€‚</p></li><li><p>jump <chain>ï¼šè·³è½¬åˆ°æŒ‡å®šçš„è§„åˆ™é“¾ï¼Œå½“æ‰§è¡Œå®Œæˆæˆ–è€…è¿”å›æ—¶ï¼Œè¿”å›åˆ°è°ƒç”¨çš„è§„åˆ™é“¾ã€‚</chain></p></li><li><p>goto <chain>ï¼šç±»ä¼¼äºè·³è½¬ï¼Œå‘é€åˆ°æŒ‡å®šè§„åˆ™é“¾ä½†ä¸è¿”å›ã€‚</chain></p></li></ul><p>ä¸‹é¢å°†ä»¥æ·»åŠ ä¸€æ¡å…è®¸ <code>SSH</code> ç™»å½•çš„è§„åˆ™ä¸ºä¾‹ï¼Œç»™å¤§å®¶ä»‹ç»ä¸‹å¦‚ä½•å¢åŠ æˆ–æ’å…¥ä¸€æ¡æ–°çš„è§„åˆ™ã€‚</p><ol><li>å¢åŠ è§„åˆ™</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nft add rule inet mytable input tcp dport ssh accept</span><br></pre></td></tr></table></figure><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>add</code> è¡¨ç¤ºå°†è§„åˆ™æ·»åŠ åˆ°é“¾çš„æœ«å°¾ã€‚å¦‚æœä½ æƒ³ä»é“¾çš„å¼€å¤´å¢åŠ è§„åˆ™ï¼Œå¯ä»¥ä½¿ç”¨ <code>insert</code> æ¥å®ç°ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nft insert rule inet mytable input tcp dport http accept</span><br></pre></td></tr></table></figure><ol start="2"><li>åˆ—å‡ºè§„åˆ™</li></ol><ul><li>åˆ—å‡ºç›®å‰é“¾ä¸­æ‰€æœ‰çš„è§„åˆ™</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ nft list ruleset</span><br><span class="line">table inet mytable &#123;</span><br><span class="line">        chain input &#123;</span><br><span class="line">                <span class="built_in">type</span> filter hook input priority 0; policy accept;</span><br><span class="line">                tcp dport http accept</span><br><span class="line">                tcp dport ssh accept</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åˆ—å‡ºæŸä¸ªè¡¨ä¸­çš„æ‰€æœ‰è§„åˆ™</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nft list table inet mytable</span><br></pre></td></tr></table></figure><ul><li>åˆ—å‡ºæŸæ¡é“¾ä¸­çš„æ‰€æœ‰è§„åˆ™</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nft list chain inet mytable input</span><br></pre></td></tr></table></figure><ol start="3"><li>æŒ‰æŒ‡å®šä½ç½®å¢åŠ è§„åˆ™</li></ol><p>æ— è®ºä½ æ˜¯ä½¿ç”¨ <code>add</code> æˆ–è€… <code>insert</code> æ¥å¢åŠ è§„åˆ™ï¼Œä½ éƒ½å¯ä»¥é€šè¿‡ <code>index</code> æˆ–è€… <code>handle</code> æ¥æŒ‡å®šæ·»åŠ çš„ä½ç½®ã€‚</p><ul><li>ä½¿ç”¨ index æ¥æŒ‡å®šè§„åˆ™çš„ç´¢å¼•</li></ul><p><code>index</code> ç±»ä¼¼äº <code>iptables</code> çš„ <code>-I</code> é€‰é¡¹ï¼Œ <code>add</code> è¡¨ç¤ºæ–°è§„åˆ™æ·»åŠ åœ¨ç´¢å¼•ä½ç½®çš„è§„åˆ™åé¢ï¼Œ<code>inser</code> è¡¨ç¤ºæ–°è§„åˆ™æ·»åŠ åœ¨ç´¢å¼•ä½ç½®çš„è§„åˆ™å‰é¢ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨ input é“¾ä¸­å·²æœ‰è§„åˆ™ä¸­çš„ç¬¬äºŒæ¡è§„åˆ™å‰æ’å…¥ä¸€æ¡æ–°çš„è§„åˆ™</span></span><br><span class="line">$ nft insert rule inet mytable input index 1 tcp dport nfs accept</span><br><span class="line">$ nft list ruleset</span><br><span class="line">table inet mytable &#123;</span><br><span class="line">     chain input &#123;</span><br><span class="line">             <span class="built_in">type</span> filter hook input priority 0; policy accept;</span><br><span class="line">             tcp dport http accept</span><br><span class="line">             tcp dport nfs accept</span><br><span class="line">             tcp dport ssh accept</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨ input é“¾ä¸­å·²æœ‰è§„åˆ™ä¸­çš„ç¬¬ä¸€æ¡è§„åˆ™åæ’å…¥ä¸€æ¡æ–°çš„è§„åˆ™</span></span><br><span class="line">$ nft add rule inet mytable input index 0 tcp dport 1234 accept</span><br><span class="line">$ nft list ruleset</span><br><span class="line">table inet mytable &#123;</span><br><span class="line">     chain input &#123;</span><br><span class="line">             <span class="built_in">type</span> filter hook input priority 0; policy accept;</span><br><span class="line">             tcp dport http accept</span><br><span class="line">             tcp dport 1234 accept</span><br><span class="line">             tcp dport nfs accept</span><br><span class="line">             tcp dport ssh accept</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼š<code>index</code> çš„å€¼æ˜¯ä» <code>0</code> å¼€å§‹çš„ï¼Œ<code>index</code> å¿…é¡»æŒ‡å‘ä¸€ä¸ªå·²å­˜åœ¨çš„è§„åˆ™çš„ç´¢å¼•ã€‚</p></blockquote><ul><li>ä½¿ç”¨ handle æ¥æŒ‡å®šè§„åˆ™çš„å¥æŸ„</li></ul><p>é€šè¿‡ <code>handle</code> çš„å€¼æ¥æŒ‡å®šè§„åˆ™æ·»åŠ çš„ä½ç½®ï¼Œå¿…é¡»å…ˆçŸ¥é“ç°æœ‰è§„åˆ™çš„å¥æŸ„ä½ç½®ã€‚ä½ å¯ä»¥é€šè¿‡å‚æ•° <code>--handle</code> æ¥è·å–å½“å‰è§„åˆ™çš„å¥æŸ„ä½ç½®ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ nft --handle list ruleset</span><br><span class="line">table inet mytable &#123; <span class="comment"># handle 10</span></span><br><span class="line">     chain input &#123; <span class="comment"># handle 2</span></span><br><span class="line">             <span class="built_in">type</span> filter hook input priority 0; policy accept;</span><br><span class="line">             tcp dport http accept <span class="comment"># handle 4</span></span><br><span class="line">             tcp dport 1234 accept <span class="comment"># handle 6</span></span><br><span class="line">             tcp dport nfs accept <span class="comment"># handle 5</span></span><br><span class="line">             tcp dport ssh accept <span class="comment"># handle 3</span></span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·å–åˆ°å½“å‰è§„åˆ™çš„å¥æŸ„ä½ç½®åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨æŒ‡å®šå¥æŸ„ä½ç½®æ·»åŠ è§„åˆ™ã€‚ä¸‹é¢æˆ‘ä»¬ä»¥åœ¨å¥æŸ„ä½ç½® 4 åé¢å’Œå¥æŸ„ä½ç½® 5 å‰é¢åˆ†åˆ«å¢åŠ ä¸€æ¡æ–°çš„è§„åˆ™ä¸ºä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ nft add rule inet mytable input handle 4 tcp dport 2345 accept</span><br><span class="line">$ nft insert rule inet mytable input handle 5 tcp dport 3456 accept</span><br><span class="line">$ nft --handle list ruleset</span><br><span class="line">table inet mytable &#123; <span class="comment"># handle 10</span></span><br><span class="line">     chain input &#123; <span class="comment"># handle 2</span></span><br><span class="line">             <span class="built_in">type</span> filter hook input priority 0; policy accept;</span><br><span class="line">             tcp dport http accept <span class="comment"># handle 4</span></span><br><span class="line">             tcp dport 2345 accept <span class="comment"># handle 8</span></span><br><span class="line">             tcp dport 1234 accept <span class="comment"># handle 6</span></span><br><span class="line">             tcp dport 3456 accept <span class="comment"># handle 9</span></span><br><span class="line">             tcp dport nfs accept <span class="comment"># handle 5</span></span><br><span class="line">             tcp dport ssh accept <span class="comment"># handle 3</span></span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>nftables</code> ä¸­ï¼Œå¥æŸ„å€¼æ˜¯å›ºå®šä¸å˜çš„ï¼Œé™¤éè§„åˆ™è¢«åˆ é™¤ã€‚è€Œ <code>index</code> çš„å€¼æ˜¯å¯å˜çš„ï¼Œåªè¦æœ‰æ–°è§„åˆ™æ’å…¥ï¼Œå°±æœ‰å¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚ä¸€èˆ¬å»ºè®®ä½¿ç”¨ <code>handle</code> æ¥æ’å…¥æ–°è§„åˆ™ã€‚</p><p>ä½ ä¹Ÿå¯ä»¥åœ¨åˆ›å»ºè§„åˆ™æ—¶å°±è·å–åˆ°è§„åˆ™çš„å¥æŸ„å€¼ï¼Œåªéœ€è¦åœ¨åˆ›å»ºè§„åˆ™æ—¶åŒæ—¶åŠ ä¸Šå‚æ•° <code>--echo</code> å’Œ <code>--handle</code>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ nft --<span class="built_in">echo</span> --handle add rule inet mytable input udp dport 3333 accept</span><br><span class="line">add rule inet mytable input udp dport 3333 accept <span class="comment"># handle 10</span></span><br></pre></td></tr></table></figure><ol start="4"><li>åˆ é™¤è§„åˆ™</li></ol><p>å•ä¸ªè§„åˆ™åªèƒ½é€šè¿‡å¥æŸ„å€¼åˆ é™¤ï¼Œæ¯ä¸ªè§„åˆ™çš„å¥æŸ„å€¼å¯é€šè¿‡ <code>nft --handle list ruleset</code> å‘½ä»¤æŸ¥çœ‹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤æŒ‡å®šå¥æŸ„å€¼å¯¹åº”çš„è§„åˆ™</span></span><br><span class="line">$ nft delete rule inet mytable input handle 8</span><br></pre></td></tr></table></figure><blockquote><p>å°æŠ€å·§ï¼šä½ å¯ä»¥ä½¿ç”¨ <code>iptables-translate</code> å®ç”¨ç¨‹åºå°† <code>iptables</code> è§„åˆ™è½¬æ¢æˆ <code>nftables</code> æ ¼å¼</p></blockquote><h2 id="nftables-é«˜çº§åŠŸèƒ½è¿›é˜¶">nftables é«˜çº§åŠŸèƒ½è¿›é˜¶</h2><p><code>nftables</code> é™¤äº†ä¸Šé¢çš„åŸºç¡€åŠŸèƒ½å¤–ï¼Œè¿˜ç»™æˆ‘ä»¬é¢å¤–æä¾›äº†ä¸€äº›éå¸¸å®ç”¨ä¸”åŠŸèƒ½å¼ºå¤§çš„é«˜çº§åŠŸèƒ½ã€‚</p><h3 id="é›†åˆ">é›†åˆ</h3><p><code>nftables</code> çš„è¯­æ³•åŸç”Ÿæ”¯æŒé›†åˆï¼Œå¯ä»¥ç”¨æ¥åŒ¹é…å¤šä¸ª <code>IP</code> åœ°å€ã€ç«¯å£å·ã€ç½‘å¡æˆ–å…¶ä»–ä»»ä½•æ¡ä»¶ã€‚<code>nftables</code> çš„é›†åˆå¯åˆ†ä¸ºåŒ¿åé›†åˆä¸å‘½åé›†åˆï¼Œç›¸å¯¹ <code>iptables</code> æ¥è¯´ï¼Œ<code>nftables</code> æ˜¯åŸç”Ÿæ”¯æŒé›†åˆï¼Œå¹¶ä¸éœ€è¦å€ŸåŠ© <code>ipset</code> æ¥å®ç°ã€‚</p><ol><li>åŒ¿åé›†åˆ</li></ol><p>åŒ¿åé›†åˆæ¯”è¾ƒé€‚åˆç”¨äºå°†æ¥ä¸éœ€è¦æ›´æ”¹çš„è§„åˆ™ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…è®¸æ¥è‡ªæº IP å¤„äº 10.10.10.123 ~ 10.10.10.231 è¿™ä¸ªåŒºé—´å†…çš„ä¸»æœºçš„æµé‡ã€‚</span></span><br><span class="line">$ nft add rule inet mytable input ip saddr &#123; 10.10.10.123, 10.10.10.231 &#125; accept</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…è®¸æŒ‡å®šåä¹‰çš„æµé‡é€šè¿‡</span></span><br><span class="line">$ nft add rule inet mytable input tcp dport &#123; http, nfs, ssh &#125; accept</span><br></pre></td></tr></table></figure><p>åŒ¿åé›†åˆçš„ç¼ºç‚¹æ˜¯éœ€è¦ä¿®æ”¹é›†åˆè§„åˆ™æ—¶ï¼Œå°±å¾—æ›¿æ¢åŸè§„åˆ™ã€‚å¦‚æœéœ€è¦é¢‘ç¹ä¿®æ”¹çš„é›†åˆï¼Œæ¨èä½¿ç”¨å‘½åé›†åˆã€‚</p><ol start="2"><li>å‘½åé›†åˆ</li></ol><p><code>nftables</code> çš„å‘½åé›†åˆæ˜¯å¯ä»¥ä¿®æ”¹çš„ã€‚åˆ›å»ºå‘½åé›†åˆæ—¶éœ€è¦æŒ‡å®šå…¶å…ƒç´ çš„ç±»å‹ï¼Œå½“å‰æ”¯æŒçš„æ•°æ®ç±»å‹æœ‰ï¼š</p><ul><li><p><code>ipv4_addr</code> : <code>IPv4</code> åœ°å€</p></li><li><p><code>ipv6_addr</code> : <code>IPv6</code> åœ°å€</p></li><li><p><code>ether_addr</code> : ä»¥å¤ªç½‘ï¼ˆEthernetï¼‰åœ°å€</p></li><li><p><code>inet_proto</code> : ç½‘ç»œåè®®</p></li><li><p><code>inet_service</code> : ç½‘ç»œæœåŠ¡</p></li><li><p><code>mark</code> : æ ‡è®°ç±»å‹</p></li></ul><p>è¿™é‡Œï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®ä¾‹ã€‚é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªç©ºçš„å‘½åé›†åˆã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªç©ºçš„å‘½åé›†åˆ</span></span><br><span class="line">$ nft add <span class="built_in">set</span> inet mytable myset &#123; <span class="built_in">type</span> ipv4_addr \; &#125;</span><br><span class="line">$ nft list sets</span><br><span class="line">table inet mytable &#123;</span><br><span class="line">        <span class="built_in">set</span> myset &#123;</span><br><span class="line">                <span class="built_in">type</span> ipv4_addr</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ç€ï¼Œæˆ‘ä»¬å‘é›†åˆä¸­æ·»åŠ ä¸€äº›å…ƒç´ ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ nft add element inet mytable myset &#123; 10.10.10.22, 10.10.10.33 &#125;</span><br><span class="line">$ nft list <span class="built_in">set</span> inet mytable myset</span><br><span class="line">table inet mytable &#123;</span><br><span class="line">        <span class="built_in">set</span> myset &#123;</span><br><span class="line">                <span class="built_in">type</span> ipv4_addr</span><br><span class="line">                elements = &#123; 10.10.10.22, 10.10.10.33 &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œåœ¨æ·»åŠ è§„åˆ™æ—¶å¼•ç”¨é›†åˆï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>@</code> ç¬¦å·è·Ÿä¸Šé›†åˆçš„åå­—æ¥å¼•ç”¨å‘½åé›†åˆã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†æ¥æºä¸ºé›†åˆ myset ä¸­çš„ IP åœ°å€çš„è¯·æ±‚é˜»æ­¢æ‰</span></span><br><span class="line">$ nft insert rule inet mytable input ip saddr @myset drop</span><br><span class="line">$ nft list chain inet mytable input</span><br><span class="line">table inet mytable &#123;</span><br><span class="line">        chain input &#123;</span><br><span class="line">                <span class="built_in">type</span> filter hook input priority 0; policy accept;</span><br><span class="line">                ip saddr @my_set drop</span><br><span class="line">                tcp dport http accept</span><br><span class="line">                tcp dport nfs accept</span><br><span class="line">                tcp dport ssh accept</span><br><span class="line">                ip saddr &#123; 10.10.10.123, 10.10.10.231 &#125; accept</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>æ”¯æŒåŒºé—´</li></ol><p>ä»ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¡«åŠ å…ƒç´ æ—¶æ˜¯ä½¿ç”¨çš„ä¸¤ä¸ªç‹¬ç«‹çš„ <code>IP</code> åœ°å€ï¼Œå¹¶æ²¡æœ‰ç›´æ¥ä½¿ç”¨ <code>10.10.10.0-10.10.10.255</code> è¿™æ ·çš„åŒºé—´æ®µæ¥è¡¨ç¤ºã€‚è¿™æ˜¯å› ä¸ºç›´æ¥ä½¿ç”¨åŒºé—´æ®µä¼šæŠ¥ä»¥ä¸‹ç±»ä¼¼é”™è¯¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ nft add element inet mytable myset &#123; 10.10.10.0-10.10.10.255 &#125;</span><br><span class="line"></span><br><span class="line">Error: Set member cannot be range, missing interval flag on declaration</span><br><span class="line">add element inet mytable my_set &#123; 10.10.10.0-10.10.10.255 &#125;</span><br><span class="line">                                   ^^^^^^^^^^^^^^^^^^^^^^^</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ æƒ³åœ¨é›†åˆä¸­ä½¿ç”¨åŒºé—´ï¼Œéœ€è¦åŠ ä¸Šä¸€ä¸ª <code>flag interval</code>ï¼Œå› ä¸ºå†…æ ¸å¿…é¡»æå‰ç¡®è®¤è¯¥é›†åˆå­˜å‚¨çš„æ•°æ®ç±»å‹ï¼Œä»¥ä¾¿é‡‡ç”¨é€‚å½“çš„æ•°æ®ç»“æ„ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®ä¾‹å§ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªæ”¯æŒåŒºé—´çš„å‘½åé›†åˆ</span></span><br><span class="line">$ nft add <span class="built_in">set</span> inet mytable my_rangeset &#123; <span class="built_in">type</span> ipv4_addr \; flags interval</span><br><span class="line">$ nft add element inet mytable my_rangeset &#123; 10.10.10.0/24 &#125;</span><br><span class="line">$ nft list <span class="built_in">set</span> inet mytable my_rangeset</span><br><span class="line">table inet mytable &#123;</span><br><span class="line">        <span class="built_in">set</span> my_rangeset &#123;</span><br><span class="line">                <span class="built_in">type</span> ipv4_addr</span><br><span class="line">                flags interval</span><br><span class="line">                elements = &#123; 10.10.10.0/24 &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä¾‹å­ä¸­ç›´æ¥ä½¿ç”¨äº†å­ç½‘æ©ç æ¥è¡¨ç¤º <code>IP</code> åœ°å€æ®µï¼Œå®ƒä¼šè¢«éšå¼è½¬æ¢ä¸º <code>IP</code> åœ°å€çš„åŒºé—´ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨åŒºé—´ <code>10.10.10.0-10.10.10.255</code> æ¥è·å¾—ç›¸åŒçš„æ•ˆæœã€‚</p><ol start="4"><li>çº§è”ä¸åŒç±»å‹</li></ol><p>å‘½åé›†åˆä¸ä»…æ”¯æŒåŒä¸€ç±»å‹å…ƒç´ ï¼Œä¹Ÿå¯ä»¥æ”¯æŒå¯¹ä¸åŒç±»å‹çš„å…ƒç´ è¿›è¡Œçº§è”ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„è§„åˆ™å¯ä»¥ä¸€æ¬¡æ€§åŒ¹é… <code>IP</code> åœ°å€ã€åè®®å’Œç«¯å£å·ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªçº§è”ç±»å‹çš„é›†åˆã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ nft add <span class="built_in">set</span> inet mytable my_concatset  &#123; <span class="built_in">type</span> ipv4_addr . inet_proto . inet_service \; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸åŒç±»å‹çš„å…ƒç´ å¯ä»¥é€šè¿‡çº§è”æ“ä½œç¬¦ . æ¥åˆ†éš”ã€‚</span></span><br><span class="line">$ nft list <span class="built_in">set</span> inet mytable my_concatset</span><br><span class="line">table inet mytable &#123;</span><br><span class="line">        <span class="built_in">set</span> my_concatset &#123;</span><br><span class="line">                <span class="built_in">type</span> ipv4_addr . inet_proto . inet_service</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ç€ï¼Œå‘é›†åˆä¸­æ·»åŠ å…ƒç´ ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nft add element inet mytable my_concatset &#123; 10.30.30.30 . tcp . telnet &#125;</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œæˆ‘ä»¬åœ¨è§„åˆ™ä¸­å¯¹çº§è”ç±»å‹çš„é›†åˆè¿›è¡Œå¼•ç”¨ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœæ•°æ®åŒ…çš„æº IPã€åè®®ç±»å‹ã€ç›®æ ‡ç«¯å£åŒ¹é… 10.30.30.30ã€tcpã€telnet æ—¶ï¼Œå°±ä¼šå…è®¸è¯¥æ•°æ®åŒ…é€šè¿‡</span></span><br><span class="line">$ nft add rule inet mytable input ip saddr . meta l4proto . tcp dport @my_concatset accept</span><br></pre></td></tr></table></figure><p>é™¤äº†å‘½åé›†åˆï¼ŒåŒ¿åé›†åˆä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çº§è”å…ƒç´ ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nft add rule inet mytable input ip saddr . meta l4proto . udp dport &#123; 10.30.30.30 . udp . bootps &#125; accept</span><br></pre></td></tr></table></figure><p>åœ¨è§„åˆ™ä¸­å¼•ç”¨çº§è”ç±»å‹çš„é›†åˆå’Œä¸€èˆ¬ç±»å‹é›†åˆçš„ä¸»è¦ä¸åŒä¹‹å¤„ï¼šä¸»è¦åœ¨äºéœ€è¦æ ‡æ˜é›†åˆä¸­æ¯ä¸ªå…ƒç´ å¯¹åº”åˆ°è§„åˆ™ä¸­çš„å“ªä¸ªä½ç½®ï¼Œè¿™ç±»ä¼¼äº ipset çš„èšåˆç±»å‹ï¼Œä¾‹å¦‚ <code>hash:ip,port</code> ã€‚</p><h3 id="å­—å…¸">å­—å…¸</h3><p>å­—å…¸æ˜¯ <code>nftables</code> çš„åˆä¸€ä¸ªé«˜çº§ç‰¹æ€§ï¼Œå®ƒåŒæ ·å¯ä»¥æ”¯æŒåœ¨ä¸€æ¡è§„åˆ™ä¸Šé¢ä½¿ç”¨ä¸åŒç±»å‹çš„æ•°æ®ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‘½åå­—å…¸ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nft add map inet mytable my_vmap &#123; <span class="built_in">type</span> inet_proto : verdict \; &#125;</span><br></pre></td></tr></table></figure><p>æ¥ç€ï¼Œæˆ‘ä»¬å‘å­—å…¸ä¸­æ·»åŠ ä¸€äº›å…ƒç´ ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nft add element inet mytable my_vmap &#123; 192.168.0.10 : drop, 192.168.0.11 : accept &#125;</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨è§„åˆ™ä¸­å¼•ç”¨å­—å…¸ä¸­çš„å…ƒç´ ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nft add rule inet mytable input ip saddr vmap @my_vmap</span><br></pre></td></tr></table></figure><p>å’Œé›†åˆä¸€æ ·ï¼Œé™¤äº†å‘½åå­—å…¸ï¼Œä½ ä¹Ÿå¯ä»¥åˆ›å»ºåŒ¿åå­—å…¸ã€‚ä¾‹å¦‚ï¼Œä¸ºäº†ä»é€»è¾‘ä¸Šå¯¹ <code>TCP</code> å’Œ <code>UDP</code> çš„æ•°æ®åŒ…æ‹†åˆ†å¼€æ¥ç”¨ä¸¤æ¡ä¸åŒé“¾æ¥å¤„ç†ï¼Œä½ å°±å¯ä»¥é€šè¿‡ä½¿ç”¨å­—å…¸æ¥å®ç°ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ nft add chain inet mytable my_tcpchain</span><br><span class="line">$ nft add chain inet mytable my_udpchain</span><br><span class="line">$ nft add rule inet mytable input meta l4proto vmap &#123; tcp : jump my_tcpchain, udp : jump my_udpchain &#125;</span><br><span class="line">$ nft list chain inet mytable input</span><br><span class="line">table inet mytable &#123;</span><br><span class="line">    chain input &#123;</span><br><span class="line">    ...</span><br><span class="line">    meta nfproto ipv4 ip saddr . meta l4proto . udp dport &#123; 10.30.30.30 . udp . bootps &#125; accept</span><br><span class="line">    meta l4proto vmap &#123; tcp : jump my_tcpchain, udp : jump my_udpchain &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¡¨ä¸å‘½åç©ºé—´">è¡¨ä¸å‘½åç©ºé—´</h3><p>åœ¨ <code>nftables</code> ä¸­ï¼Œæ¯ä¸ªè¡¨éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å‘½åç©ºé—´ï¼Œè¿™å°±æ„å‘³ç€ä¸åŒçš„è¡¨ä¸­çš„é“¾ã€é›†åˆã€å­—å…¸ç­‰åå­—å¯ä»¥ç›¸åŒã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ nft add table inet table_one</span><br><span class="line">$ nft add chain inet table_one mychain</span><br><span class="line">$ nft add table inet table_two</span><br><span class="line">$ nft add chain inet table_two mychain</span><br><span class="line">$ nft list ruleset</span><br><span class="line">...</span><br><span class="line">table inet table_one &#123;</span><br><span class="line">    chain mychain &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">table inet table_two &#123;</span><br><span class="line">    chain mychain &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ‰äº†è¿™ä¸ªç‰¹æ€§åï¼Œä¸åŒçš„åº”ç”¨å°±å¯ä»¥åœ¨ç›¸äº’ä¸å½±å“çš„æƒ…å†µä¸‹ç®¡ç†è‡ªå·±çš„è¡¨ä¸­çš„è§„åˆ™ã€‚ä¸è¿‡ä½¿ç”¨è¿™ä¸ªç‰¹æ€§å‰ï¼Œä½ éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼šç”±äº <code>nftables</code> å°†æ¯ä¸ªè¡¨éƒ½è¢«è§†ä¸ºç‹¬ç«‹çš„é˜²ç«å¢™ï¼Œä¸€ä¸ªæ•°æ®åŒ…å¿…é¡»è¢«æ‰€æœ‰è¡¨ä¸­çš„è§„åˆ™æ”¾è¡Œæ‰èƒ½çœŸæ­£é€šè¿‡ã€‚å¦‚æœï¼Œå‡ºç°ä¸¤æ¡é“¾çš„ä¼˜å…ˆçº§ç›¸åŒï¼Œå°±ä¼šè¿›å…¥ç«äº‰çŠ¶æ€ã€‚</p><p>å½“ç„¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>nftables</code> ä¼˜å…ˆçº§ç‰¹æ€§æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä¼˜å…ˆçº§å€¼è¶Šé«˜çš„é“¾ä¼˜å…ˆçº§è¶Šä½ï¼Œæ‰€ä»¥ä¼˜å…ˆçº§å€¼ä½çš„é“¾ä¼šæ¯”ä¼˜å…ˆçº§å€¼é«˜çš„é“¾å…ˆæ‰§è¡Œã€‚</p><h3 id="å¤‡ä»½ä¸æ¢å¤">å¤‡ä»½ä¸æ¢å¤</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œé€šè¿‡ <code>nftables</code> ç”¨æˆ·æ€å·¥å…· <code>nft</code> ç›´æ¥åœ¨ç»ˆç«¯ä¸­åŠ å…¥çš„è§„åˆ™éƒ½æ˜¯ä¸´æ—¶çš„ã€‚å¦‚æœè¦æƒ³æ°¸ä¹…ç”Ÿæ•ˆï¼Œæˆ‘ä»¬å¯ä»¥å°†è§„åˆ™å¤‡ä»½åå¹¶åœ¨å¼€æœºè‡ªåŠ¨åŠ è½½æ—¶è¿›è¡Œæ¢å¤ã€‚</p><ol><li>å¤‡ä»½è§„åˆ™</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nft list ruleset &gt; /root/nftables.conf</span><br></pre></td></tr></table></figure><ol start="2"><li>æ¢å¤è§„åˆ™</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nft -f /root/nftables.conf</span><br></pre></td></tr></table></figure><p>åœ¨ <code>CentOS 8</code> ä¸­ï¼Œ<code>nftables</code> æ˜¯ä»¥ <code>Systemd</code> æœåŠ¡å½¢å¼è¿›è¡Œå·¥ä½œçš„ã€‚<code>nftables.service</code> çš„è§„åˆ™è¢«å­˜å‚¨åœ¨ <code>/etc/nftables.conf</code> ä¸­ï¼Œå…¶ä¸­åŒ…å«äº†ä¸€äº›å…¶ä»–çš„ç¤ºä¾‹è§„åˆ™ï¼Œä¸€èˆ¬ä¼šä½äº <code>/etc/sysconfig/nftables.conf</code> æ–‡ä»¶ä¸­ã€‚å¦‚æœä½ æƒ³å¼€æœºè‡ªåŠ è½½ <code>nftables</code> è§„åˆ™ï¼Œåªéœ€å°†å¤‡ä»½è§„åˆ™æ”¾åˆ° <code>/etc/sysconfig/nftables.conf</code> æ–‡ä»¶å³å¯ã€‚</p><h2 id="æ€»ç»“">æ€»ç»“</h2><p>è‡³æ­¤ï¼Œæœ¬æ–‡å¯¹ <code>nftables</code> çš„åŸºæœ¬åŠŸèƒ½å’Œç”¨æ³•å°±è®²è§£å®Œäº†ï¼Œæ›´é«˜çº§çš„ç”¨æ³•å¯ä»¥åœ¨ä»¥ä¸‹æ–‡æ¡£ä¸­åšè¿›ä¸€æ­¥æ¢ç´¢ã€‚</p><blockquote><ol><li><p>Archlinux Wikiï¼š<a href="https://wiki.archlinux.org/index.php/Nftables" target="_blank" rel="noopener">https://wiki.archlinux.org/index.php/Nftables</a></p></li><li><p>nftables HOWTOï¼š<a href="https://farkasity.gitbooks.io/nftables-howto-zh/" target="_blank" rel="noopener">https://farkasity.gitbooks.io/nftables-howto-zh/</a></p></li><li><p>nftables Wikiï¼š<a href="https://wiki.nftables.org/wiki-nftables/index.php/Main_Page" target="_blank" rel="noopener">https://wiki.nftables.org/wiki-nftables/index.php/Main_Page</a></p></li></ol></blockquote><h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2><ol><li><p><a href="https://www.google.com" target="_blank" rel="noopener">https://www.google.com</a></p></li><li><p><a href="https://url.cn/56tJkD8" target="_blank" rel="noopener">https://url.cn/56tJkD8</a></p></li><li><p><a href="http://www.freecls.com/a/2712/fc" target="_blank" rel="noopener">http://www.freecls.com/a/2712/fc</a></p></li><li><p><a href="https://blog.51cto.com/babyshen/2065749" target="_blank" rel="noopener">https://blog.51cto.com/babyshen/2065749</a></p></li><li><p><a href="https://adoyle.me/Today-I-Learned/linux/iptables.html" target="_blank" rel="noopener">https://adoyle.me/Today-I-Learned/linux/iptables.html</a></p></li><li><p><a href="https://blog.csdn.net/dog250/article/details/54170683" target="_blank" rel="noopener">https://blog.csdn.net/dog250/article/details/54170683</a></p></li><li><p><a href="https://www.yangcs.net/posts/using-nftables/" target="_blank" rel="noopener">https://www.yangcs.net/posts/using-nftables/</a></p></li><li><p><a href="https://wiki.archlinux.org/index.php/Nftables" target="_blank" rel="noopener">https://wiki.archlinux.org/index.php/Nftables</a></p></li><li><p><a href="https://farkasity.gitbooks.io/nftables-howto-zh/content/" target="_blank" rel="noopener">https://farkasity.gitbooks.io/nftables-howto-zh/content/</a></p></li><li><p><a href="https://blog.omicron3069.com/post/nftablesfornode/" target="_blank" rel="noopener">https://blog.omicron3069.com/post/nftablesfornode/</a></p></li></ol></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä»€ä¹ˆæ˜¯-nftablesï¼Ÿ&quot;&gt;ä»€ä¹ˆæ˜¯ nftablesï¼Ÿ&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;nftables&lt;/code&gt; æ˜¯ä¸€ä¸ªæ–°å¼çš„æ•°æ®åŒ…è¿‡æ»¤æ¡†æ¶ï¼Œæ—¨åœ¨æ›¿ä»£ç°ç”¨çš„ &lt;code&gt;iptables&lt;/code&gt;ã€&lt;code&gt;ip6tables&lt;/code&gt;ã€&lt;code&gt;arptables&lt;/code&gt; å’Œ &lt;code&gt;ebtables&lt;/code&gt; çš„æ–°çš„åŒ…è¿‡æ»¤æ¡†æ¶ã€‚&lt;code&gt;nftables&lt;/code&gt; è¯ç”Ÿäº 2008 å¹´ï¼Œ2013 å¹´åº•åˆå¹¶åˆ° &lt;code&gt;Linux å†…æ ¸&lt;/code&gt;ï¼Œä» &lt;code&gt;Linux&lt;/code&gt; å†…æ ¸ &lt;code&gt;3.13&lt;/code&gt; ç‰ˆæœ¬å¼€å§‹å¤§å¤šæ•°åœºæ™¯ä¸‹ &lt;code&gt;nftables&lt;/code&gt; å·²ç»å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯å®Œæ•´çš„æ”¯æŒï¼ˆå³ï¼š&lt;code&gt;nftables&lt;/code&gt; ä¼˜å…ˆçº§é«˜äº &lt;code&gt;iptables&lt;/code&gt;ï¼‰åº”è¯¥æ˜¯åœ¨ Linux å†…æ ¸ &lt;code&gt;3.15&lt;/code&gt; ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;nftables&lt;/code&gt; æ—¨åœ¨è§£å†³ç°æœ‰ &lt;code&gt;{ip/ip6}tables&lt;/code&gt; å·¥å…·å­˜åœ¨çš„è¯¸å¤šé™åˆ¶ã€‚ç›¸å¯¹äºæ—§çš„ &lt;code&gt;iptables&lt;/code&gt;ï¼Œ&lt;code&gt;nftables&lt;/code&gt; æœ€å¼•äººæ³¨ç›®çš„åŠŸèƒ½åŒ…æ‹¬ï¼šæ”¹è¿›æ€§èƒ½ã€æ”¯æŒæŸ¥è¯¢è¡¨ã€äº‹åŠ¡å‹è§„åˆ™æ›´æ–°ã€æ‰€æœ‰è§„åˆ™è‡ªåŠ¨åº”ç”¨ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;nftables&lt;/code&gt; ä¸»è¦ç”±ä¸‰ä¸ªç»„ä»¶ç»„æˆï¼šå†…æ ¸å®ç°ã€&lt;code&gt;libnl netlink&lt;/code&gt; é€šä¿¡å’Œ &lt;code&gt;nftables&lt;/code&gt; ç”¨æˆ·ç©ºé—´ã€‚å…¶ä¸­å†…æ ¸æä¾›äº†ä¸€ä¸ª &lt;code&gt;netlink&lt;/code&gt; é…ç½®æ¥å£ä»¥åŠè¿è¡Œæ—¶è§„åˆ™é›†è¯„ä¼°ï¼Œ&lt;code&gt;libnl&lt;/code&gt; åŒ…å«äº†ä¸å†…æ ¸é€šä¿¡çš„åŸºæœ¬å‡½æ•°ï¼Œç”¨æˆ·ç©ºé—´å¯ä»¥é€šè¿‡æ–°å¼•å…¥çš„å‘½ä»¤è¡Œå·¥å…· &lt;code&gt;nft&lt;/code&gt; å’Œç”¨æˆ·è¿›è¡Œäº¤äº’ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;nft&lt;/code&gt; å¯ä»¥é€šè¿‡åœ¨å¯„å­˜å™¨ä¸­å‚¨å­˜å’ŒåŠ è½½æ¥äº¤æ¢æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒçš„è¯­æ³•ä¸ &lt;code&gt;iptables&lt;/code&gt; ä¸åŒã€‚ä½† &lt;code&gt;nft&lt;/code&gt; å¯ä»¥åˆ©ç”¨å†…æ ¸æä¾›çš„è¡¨è¾¾å¼å»æ¨¡æ‹Ÿæ—§çš„ &lt;code&gt;iptables&lt;/code&gt; å‘½ä»¤ï¼Œç»´æŒå…¼å®¹æ€§çš„åŒæ—¶è·å¾—æ›´å¤§çš„çµæ´»æ€§ã€‚ç®€å•æ¥è¯´ï¼Œ&lt;code&gt;nft&lt;/code&gt; æ˜¯ &lt;code&gt;iptables&lt;/code&gt; åŠå…¶è¡ç”ŸæŒ‡ä»¤ï¼ˆ&lt;code&gt;ip6tables&lt;/code&gt; å’Œ &lt;code&gt;arptables&lt;/code&gt; ï¼‰çš„è¶…é›†ã€‚&lt;/p&gt;
&lt;h3 id=&quot;nftables-çš„ç‰¹ç‚¹&quot;&gt;nftables çš„ç‰¹ç‚¹&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;nftables&lt;/code&gt; æ‹¥æœ‰ä¸€äº›é«˜çº§çš„ç±»ä¼¼ç¼–ç¨‹è¯­è¨€çš„èƒ½åŠ›ï¼Œä¾‹å¦‚ï¼šå®šä¹‰å˜é‡å’ŒåŒ…å«å¤–éƒ¨æ–‡ä»¶ï¼Œå³æ‹¥æœ‰ä½¿ç”¨é¢å¤–è„šæœ¬çš„èƒ½åŠ›ã€‚&lt;code&gt;nftables&lt;/code&gt; ä¹Ÿå¯ä»¥ç”¨äºå¤šç§åœ°å€ç°‡çš„è¿‡æ»¤å’Œå¤„ç†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸åŒäº &lt;code&gt;iptables&lt;/code&gt;, &lt;code&gt;nftables&lt;/code&gt; å¹¶ä¸åŒ…å«ä»»ä½•çš„å†…ç½®è¡¨ï¼Œéœ€è¦å“ªäº›è¡¨å¹¶åœ¨è¿™äº›è¡¨ä¸­æ·»åŠ ä»€ä¹ˆå¤„ç†è§„åˆ™ä¸€åˆ‡ç”±ç®¡ç†å‘˜å†³å®šã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è¡¨åŒ…å«è§„åˆ™é“¾ï¼Œè§„åˆ™é“¾åŒ…å«è§„åˆ™ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;nftables-ç›¸è¾ƒäº-iptables-çš„ä¼˜ç‚¹&quot;&gt;nftables ç›¸è¾ƒäº iptables çš„ä¼˜ç‚¹&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;æ›´æ–°é€Ÿåº¦æ›´å¿«&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åœ¨ &lt;code&gt;iptables&lt;/code&gt; ä¸­æ·»åŠ ä¸€æ¡è§„åˆ™ï¼Œä¼šéšç€è§„åˆ™æ•°é‡å¢å¤šè€Œå˜å¾—éå¸¸æ…¢ã€‚è¿™ç§çŠ¶å†µå¯¹ &lt;code&gt;nftables&lt;/code&gt; è€Œè¨€å°±ä¸å­˜åœ¨äº†ï¼Œå› ä¸º &lt;code&gt;nftables&lt;/code&gt; ä½¿ç”¨åŸå­çš„å¿«é€Ÿæ“ä½œæ¥æ›´æ–°è§„åˆ™é›†åˆã€‚&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;å†…æ ¸æ›´æ–°æ›´å°‘ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;iptables&lt;/code&gt; æ—¶ï¼Œæ¯ä¸€ä¸ªåŒ¹é…æˆ–æŠ•é€’éƒ½éœ€è¦å†…æ ¸æ¨¡å—çš„æ”¯æŒã€‚å› æ­¤ï¼Œå¦‚æœä½ å¿˜è®°ä¸€äº›ä¸œè¥¿æˆ–è€…è¦æ·»åŠ æ–°çš„åŠŸèƒ½æ—¶éƒ½éœ€è¦é‡æ–°ç¼–è¯‘å†…æ ¸ã€‚è€Œåœ¨ &lt;code&gt;nftables&lt;/code&gt; ä¸­å°±ä¸å­˜åœ¨è¿™ç§æƒ…å†µäº†ï¼Œ å› ä¸ºåœ¨ &lt;code&gt;nftables&lt;/code&gt; ä¸­ï¼Œå¤§éƒ¨åˆ†å·¥ä½œæ˜¯åœ¨ç”¨æˆ·æ€å®Œæˆçš„ï¼Œå†…æ ¸åªçŸ¥é“ä¸€äº›åŸºæœ¬æŒ‡ä»¤ï¼ˆè¿‡æ»¤æ˜¯ç”¨ä¼ªçŠ¶æ€æœºå®ç°çš„ï¼‰ã€‚ä¾‹å¦‚ï¼Œ&lt;code&gt;icmpv6&lt;/code&gt; æ”¯æŒæ˜¯é€šè¿‡ &lt;code&gt;nft&lt;/code&gt; å·¥å…·çš„ä¸€ä¸ªç®€å•çš„è¡¥ä¸å®ç°çš„ï¼Œè€Œåœ¨ &lt;code&gt;iptables&lt;/code&gt; ä¸­è¿™ç§ç±»å‹çš„æ›´æ”¹éœ€è¦å†…æ ¸å’Œ &lt;code&gt;iptables&lt;/code&gt; éƒ½å‡çº§æ‰å¯ä»¥ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/categories/Linux/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="æŠ€å·§" scheme="https://www.hi-linux.com/tags/%E6%8A%80%E5%B7%A7/"/>
    
      <category term="nftables" scheme="https://www.hi-linux.com/tags/nftables/"/>
    
  </entry>
  
  <entry>
    <title>æ¨èä¸€æ¬¾ Go è¯­è¨€å¤šç‰ˆæœ¬ç®¡ç†åˆ©å™¨ GVM</title>
    <link href="https://www.hi-linux.com/posts/20165.html"/>
    <id>https://www.hi-linux.com/posts/20165.html</id>
    <published>2020-05-12T01:00:00.000Z</published>
    <updated>2020-05-12T05:06:03.211Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><p><code>Golang</code> å‘å±•è¿…é€Ÿï¼Œä»£ç è¿­ä»£éå¸¸å¿«ï¼Œæƒ³è¦åœ¨åŒä¸€ç¯å¢ƒè°ƒè¯•å’Œæ¢³ç†ä¸åŒé¡¹ç›®è¿›ç¨‹å°±æˆäº†ä¸€ä»¶ç›¸å¯¹æ£˜æ‰‹çš„äº‹æƒ…ã€‚äºŒè¿›åˆ¶æ–‡ä»¶çš„ç®¡ç†æ¯”è¾ƒç®€å•ï¼Œé€šè¿‡é“¾æ¥ä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„ç¨‹åºå³å¯ã€‚å®é™…ä¸Šä¸»è¦æ˜¯ä¸€äº›ç¯å¢ƒå˜é‡å’Œæ ‡å‡†åº“çš„è®¾ç½®é—®é¢˜ï¼Œå¶ç„¶é—´å‘ç°äº† <code>GVM - Go Version Manager</code>ï¼Œ<code>GVM</code> å®é™…ä¸Šå°±æ˜¯å¸®åŠ©æˆ‘ä»¬å®Œæˆè¿™äº›é…ç½®å·¥ä½œï¼Œè¿™ç®—æ˜¯æ‰¾åˆ°äº†è°ƒè¯•åˆ‡æ¢ç‰ˆæœ¬çš„ç¦éŸ³äº†ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯-gvm">ä»€ä¹ˆæ˜¯ GVM</h2><p><code>Go</code> è¯­è¨€ç‰ˆæœ¬ç®¡ç†å™¨ï¼ˆ<code>GVM</code>ï¼‰æ˜¯ç®¡ç† <code>Go</code> è¯­è¨€ç¯å¢ƒçš„å¼€æºå·¥å…·ã€‚<code>GVM ã€Œpkgsetsã€</code> æ”¯æŒå®‰è£…å¤šä¸ªç‰ˆæœ¬çš„ <code>Go</code> å¹¶ç®¡ç†æ¯ä¸ªé¡¹ç›®çš„æ¨¡å—ã€‚å®ƒæœ€åˆç”± <code>Josh Bussdieker</code> å¼€å‘ï¼Œ<code>GVM</code> ä¸ <code>Ruby RVM</code> ç±»ä¼¼ï¼Œå…è®¸ä½ ä¸ºæ¯ä¸ªé¡¹ç›®æˆ–ä¸€ç»„é¡¹ç›®åˆ›å»ºä¸€ä¸ªå¼€å‘ç¯å¢ƒï¼Œåˆ†ç¦»ä¸åŒçš„ <code>Go</code> ç‰ˆæœ¬å’ŒåŒ…ä¾èµ–å…³ç³»ï¼Œæ¥æä¾›æ›´å¤§çš„çµæ´»æ€§ï¼Œä»¥é˜²ä¸åŒç‰ˆæœ¬é€ æˆçš„é—®é¢˜ã€‚<code>GVM</code> ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹æ€§ï¼š</p><ul><li><p>ç®¡ç† <code>Go</code> çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬å®‰è£…ã€å¸è½½å’ŒæŒ‡å®šä½¿ç”¨ <code>Go</code> çš„æŸä¸ªç‰ˆæœ¬</p></li><li><p>æŸ¥çœ‹å®˜æ–¹æ‰€æœ‰å¯ç”¨çš„ <code>Go</code> ç‰ˆæœ¬ï¼ŒåŒæ—¶å¯ä»¥æŸ¥çœ‹æœ¬åœ°å·²å®‰è£…å’Œé»˜è®¤ä½¿ç”¨çš„ <code>Go</code> ç‰ˆæœ¬</p></li><li><p>ç®¡ç†å¤šä¸ª <code>GOPATH</code>ï¼Œå¹¶å¯ç¼–è¾‘ <code>Go</code> çš„ç¯å¢ƒå˜é‡</p></li><li><p>å¯å°†å½“å‰ç›®å½•å…³è”åˆ° <code>GOPATH</code></p></li><li><p>å¯ä»¥æŸ¥çœ‹ <code>GOROOT</code> ä¸‹çš„æ–‡ä»¶å·®å¼‚</p></li><li><p>æ”¯æŒ <code>Go</code> ç‰ˆæœ¬åˆ‡æ¢</p></li></ul><blockquote><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/moovweb/gvm" target="_blank" rel="noopener">https://github.com/moovweb/gvm</a></p></blockquote><a id="more"></a><h2 id="å®‰è£…-gvm">å®‰è£… GVM</h2><p><code>GVM</code> æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª <code>SHELL</code> è„šæœ¬ï¼Œå®ƒèƒŒååšçš„äº‹æƒ…æ˜¯å…ˆæŠŠæºç ä¸‹è½½ä¸‹æ¥ï¼Œå†ç”¨ <code>C</code> åšç¼–è¯‘ã€‚æ‰€ä»¥ï¼Œå®‰è£… <code>GVM</code> å‰ä½ éœ€è¦å…ˆå®‰è£…ä¸€äº›ä¾èµ–åŒ…ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Debian/Ubuntu</span></span><br><span class="line">$ sudo apt-get install curl git mercurial make binutils bison gcc build-essential</span><br><span class="line"></span><br><span class="line"><span class="comment"># Redhat/Centos</span></span><br><span class="line">$ sudo yum install curl</span><br><span class="line">$ sudo yum install git</span><br><span class="line">$ sudo yum install make</span><br><span class="line">$ sudo yum install bison</span><br><span class="line">$ sudo yum install gcc</span><br><span class="line">$ sudo yum install glibc-devel</span><br><span class="line"></span><br><span class="line"><span class="comment"># macOS</span></span><br><span class="line">$ xcode-select --install</span><br><span class="line">$ brew update</span><br><span class="line">$ brew install mercurial</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼š<code>Centos</code> å®˜æ–¹ä»“åº“æ²¡æœ‰ <code>mercurial</code> è½¯ä»¶åŒ…ï¼Œå¦‚æœä½ éœ€è¦å¯ä»¥åœ¨ <code>mercurial</code> å®˜ç½‘ <code>https://www.mercurial-scm.org/downloads</code> ä¸‹è½½åå®‰è£…ã€‚</p></blockquote><p>å®‰è£…å¥½ä¾èµ–ç¯å¢ƒåï¼Œ <code>GVM</code> çš„å®‰è£…ä¹Ÿå¾ˆç®€å•ã€‚å®˜æ–¹æä¾›äº†ä¸€é”®å®‰è£…è„šæœ¬ï¼Œä½ åªéœ€ç›´æ¥è¿è¡Œå°±è¡Œäº†ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ bash &lt; &lt;(curl -s -S -L https://raw.githubusercontent.com/moovweb/gvm/master/binscripts/gvm-installer)</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ <code>zsh</code> çš„è¯å°†å‰é¢çš„ <code>bash</code> æ”¹ä¸º <code>zsh</code> å³å¯ï¼Œè¿™æ¡å‘½ä»¤ä¸»è¦æ˜¯æ£€æŸ¥ç›¸å…³ä¾èµ–ç¯å¢ƒå¹¶ä¸‹è½½ <code>GVM</code> ç›¸å…³çš„æ–‡ä»¶ï¼Œç„¶ååˆ›å»ºæ‰€éœ€ç›®å½•ï¼Œå¹¶ä¸”åœ¨ <code>.bashrc</code> æˆ–è€… <code>.zshrc</code> ä¸­åŠ å…¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[ -s <span class="string">"/home/wcl/.gvm/scripts/gvm"</span> ]] &amp;&amp; <span class="built_in">source</span> <span class="string">"/home/wcl/.gvm/scripts/gvm"</span></span><br></pre></td></tr></table></figure><p>ä½¿æ¯æ¬¡ç™»å½• <code>Shell</code> æ—¶éƒ½å¯ä»¥è‡ªåŠ¨ç”Ÿæ•ˆã€‚</p><h2 id="ä½¿ç”¨-gvm-å®‰è£…å’Œç®¡ç†-go-ç‰ˆæœ¬">ä½¿ç”¨ GVM å®‰è£…å’Œç®¡ç† Go ç‰ˆæœ¬</h2><p>ä¸€æ—¦å®‰è£…äº† <code>GVM</code>ï¼Œå°±å¯ä»¥å¼€å§‹ä½¿ç”¨å®ƒæ¥å®‰è£…å’Œç®¡ç†ä¸åŒç‰ˆæœ¬çš„ <code>Go</code>ã€‚é¦–å…ˆï¼Œä½ å¯ä»¥ç”¨ <code>gvm listall</code> å‘½ä»¤æ˜¾ç¤ºå¯ä»¥ä¸‹è½½å’Œç¼–è¯‘å¯ç”¨çš„ <code>Go</code> ç‰ˆæœ¬ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ gvm listall</span><br><span class="line"></span><br><span class="line">gvm gos (available)</span><br><span class="line"></span><br><span class="line">   go1</span><br><span class="line">   go1.0.1</span><br><span class="line">   go1.0.2</span><br><span class="line">   go1.0.3</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>å®‰è£…ç‰¹å®šçš„ <code>Go</code> ç‰ˆæœ¬åªéœ€è¿è¡Œ <code>gvm install &lt;version&gt;</code>å‘½ä»¤ï¼Œå…¶ä¸­ <code>&lt;version&gt;</code> æ˜¯è¡¨ç¤ºè¦å®‰è£…çš„ç‰ˆæœ¬ã€‚å‡è®¾ä½ æ­£åœ¨å¤„ç†ä¸€ä¸ªä½¿ç”¨ <code>Go 1.12.8</code> ç‰ˆæœ¬çš„é¡¹ç›®ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨ <code>gvm install go1.12.8</code> å‘½ä»¤æ¥å®‰è£…è¿™ä¸ªç‰ˆæœ¬ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ gvm install go1.12.8</span><br><span class="line">Installing go1.12.8...</span><br><span class="line"> * Compiling...</span><br><span class="line">go1.12.8 successfully installed!</span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œæˆåï¼Œè¾“å…¥ <code>gvm list</code> å‘½ä»¤åï¼Œä½ ä¼šçœ‹åˆ° <code>Go 1.12.8</code> ç‰ˆæœ¬ä¸ç³»ç»Ÿè‡ªå¸¦çš„ <code>Go</code> ç‰ˆæœ¬ï¼ˆä½¿ç”¨æ“ä½œç³»ç»Ÿçš„è½¯ä»¶åŒ…ç®¡ç†å™¨æ‰“åŒ…çš„ç‰ˆæœ¬ï¼‰éƒ½åŒæ—¶å­˜åœ¨ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ gvm list</span><br><span class="line">gvm gos (installed)</span><br><span class="line">   go1.12.8</span><br><span class="line">=&gt; system</span><br></pre></td></tr></table></figure><p>ä¸è¿‡ï¼Œè¿™æ—¶ <code>GVM</code> ä»ç„¶é»˜è®¤ä½¿ç”¨ç³»ç»Ÿçš„ <code>Go</code> ç‰ˆæœ¬ï¼Œé€šè¿‡å®ƒæ—è¾¹çš„ <code>=&gt;</code> ç¬¦å·æ¥è¡¨ç¤ºã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>gvm use</code> å‘½ä»¤æ¥åˆ‡æ¢åˆ°æ–°å®‰è£…çš„ <code>go 1.12.8</code> ç‰ˆæœ¬ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ gvm use go1.12.8</span><br><span class="line">Now using version go1.12.8</span><br><span class="line">$ go version</span><br><span class="line">go version go1.12.8 linux/amd64</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸æƒ³æ¯æ¬¡æ•² <code>gvm use</code> æŒ‡ä»¤æ¥åˆ‡æ¢ç‰ˆæœ¬ï¼Œä½ å¯ä»¥åŠ ä¸Š <code>--default</code> å‚æ•°æ¥æŒ‡å®šé»˜è®¤ä½¿ç”¨è¿™ä¸ªç‰ˆæœ¬ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gvm use go1.12.8 --default</span><br></pre></td></tr></table></figure><p>æ˜¯ä¸æ˜¯ï¼Œå¾ˆå®¹æ˜“å‘¢ï¼<code>GVM</code> ä½¿ç®¡ç†å·²å®‰è£…çš„ <code>Go</code> ç‰ˆæœ¬å˜å¾—æå…¶ç®€å•ï¼Œä½†å®ƒä¸æ­¢å¦‚æ­¤ï¼</p><blockquote><p>ç”±äº <code>Go 1.5</code> ä½¿ç”¨äº†è‡ªä¸¾ï¼ˆç”¨ <code>Go</code> ç¼–è¯‘ <code>Go</code>ï¼‰ï¼Œå¦‚æœåœ¨ç³»ç»Ÿç¯å¢ƒå®Œå…¨æ²¡æœ‰ <code>Go</code> å‘½ä»¤çš„æƒ…å†µä¸‹ï¼Œç›´æ¥ä½¿ç”¨ <code>gvm install go</code> ä¼šæŠ¥é”™ã€‚æ‰€ä»¥ï¼Œä½ å¿…é¡»å…ˆå®‰è£… <code>Go 1.4</code>ã€‚</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…ˆå®‰è£… 1.4 ç‰ˆæœ¬çš„ï¼Œ-B è¡¨ç¤ºåªå®‰è£…äºŒè¿›åˆ¶åŒ…ã€‚</span></span><br><span class="line">$ gvm install go1.4 -B  </span><br><span class="line">$ gvm use go1.4  </span><br><span class="line">$ <span class="built_in">export</span> GOROOT_BOOTSTRAP=<span class="variable">$GOROOT</span>  </span><br><span class="line"><span class="comment"># å†å®‰è£… 1.5+ ç‰ˆæœ¬çš„</span></span><br><span class="line">$ gvm install go1.12.8</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨-gvm-pkgset">ä½¿ç”¨ GVM pkgset</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä½ é€šè¿‡ <code>go get</code> è·å–ä¸€ä¸ªåŒ…ï¼Œå®ƒä¼šè¢«ä¸‹è½½åˆ° <code>$GOPATH</code> ç›®å½•ä¸­çš„ <code>src</code> å’Œ <code>pkg</code> ç›®å½•ä¸‹ã€‚ç„¶åä½ å¯ä»¥ä½¿ç”¨ <code>import</code> å°†å…¶å¼•å…¥åˆ°ä½ çš„ <code>Go</code> ç¨‹åºä¸­ã€‚ç„¶è€Œï¼Œåœ¨ä¸åŒçš„é¡¹ç›®ä¸­ç®¡ç†ç›¸åŒåŒ…çš„ä¸åŒç‰ˆæœ¬å°±ä¼šå˜å¾—å›°éš¾ã€‚</p><p><code>GVM</code> é€šè¿‡ä½¿ç”¨ã€Œ<code>pkgsets</code>ã€å°†é¡¹ç›®çš„æ–°ç›®å½•é™„åŠ åˆ° <code>Go</code> å®‰è£…ç‰ˆæœ¬çš„é»˜è®¤ <code>$GOPATH</code>ï¼Œç±»ä¼¼ <code>Linux</code> ç³»ç»Ÿä¸Šçš„ <code>$PATH</code>ï¼Œè¿™æ ·å°±å¯ä»¥å¾ˆå¥½åœ°å®Œæˆäº†é¡¹ç›®ä¹‹é—´åŒ…çš„ç®¡ç†å’Œéš”ç¦»ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®ä¾‹ï¼Œå®‰è£…ä¸€ä¸ªæ–°ç‰ˆæœ¬çš„ <code>Go 1.12.9</code>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$GOPATH</span></span><br><span class="line">/home/chris/.gvm/pkgsets/go1.12.8/global</span><br><span class="line">$ gvm install go1.12.9</span><br><span class="line">Installing go1.12.9...</span><br><span class="line"> * Compiling...</span><br><span class="line">go1.12.9 successfully installed</span><br><span class="line">$ gvm use go1.12.9</span><br><span class="line">Now using version go1.12.9</span><br></pre></td></tr></table></figure><p>å½“ <code>GVM</code> è¢«å‘ŠçŸ¥ä½¿ç”¨ä¸€ä¸ªæ–°ç‰ˆæœ¬æ—¶ï¼Œå®ƒå°†ä¼šæ›´æ¢ä¸€ä¸ªæ–°çš„ <code>$GOPATH</code>ï¼Œ<code>gloabl pkgset</code> å°†é»˜è®¤ä½¿ç”¨è¯¥ç‰ˆæœ¬ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$GOPATH</span></span><br><span class="line">/home/chris/.gvm/pkgsets/go1.12.9/global</span><br><span class="line">$ gvm pkgset list</span><br><span class="line">gvm go package sets (go1.12.9)</span><br><span class="line">=&gt;  global</span><br></pre></td></tr></table></figure><blockquote><p>å°½ç®¡é»˜è®¤æƒ…å†µä¸‹æ²¡æœ‰å®‰è£…é¢å¤–çš„åŒ…ï¼Œä½†æ˜¯ <code>global pkgset</code> ä¸­çš„åŒ…å¯¹äºä½¿ç”¨è¿™ä¸ªç‰¹å®šç‰ˆæœ¬ <code>Go</code> çš„ä»»ä½•é¡¹ç›®éƒ½æ˜¯å¯ç”¨çš„ã€‚</p></blockquote><p>ç°åœ¨ï¼Œå‡è®¾ä½ æ­£åœ¨å¯åŠ¨ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œå®ƒéœ€è¦ä¸€ä¸ªç‰¹å®šçš„åŒ…ã€‚é¦–å…ˆï¼Œä½¿ç”¨ <code>GVM</code> åˆ›å»ºä¸€ä¸ªåä¸º <code>introToGvm</code> çš„æ–°çš„ <code>pkgset</code>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ gvm pkgset create introToGvm</span><br><span class="line">$ gvm pkgset use introToGvm</span><br><span class="line">Now using version go1.12.9@introToGvm</span><br><span class="line">$ gvm pkgset list</span><br><span class="line">gvm go package sets (go1.12.9)</span><br><span class="line">    global</span><br><span class="line">=&gt;  introToGvm</span><br></pre></td></tr></table></figure><p>å¦‚ä¸Šæ‰€è¿°ï¼Œä¸€ä¸ªä¸ <code>pkgset</code> åŒåçš„æ–°ç›®å½• <code>introToGvm</code> è¢«æ·»åŠ åˆ° <code>$GOPATH</code>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$GOPATH</span></span><br><span class="line">/home/chris/.gvm/pkgsets/go1.12.9/introToGvm:/home/chris/.gvm/pkgsets/go1.12.9/global</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼ŒéªŒè¯ä¸‹æ–°ç›®å½• <code>introToGvm</code> ä¸­çš„ç›®å½•ç»“æ„ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> $( awk -F<span class="string">':'</span> <span class="string">'&#123;print $1&#125;'</span> &lt;&lt;&lt; <span class="variable">$GOPATH</span> )</span><br><span class="line">$ <span class="built_in">pwd</span></span><br><span class="line">/home/chris/.gvm/pkgsets/go1.12.9/introToGvm</span><br><span class="line">$ ls</span><br><span class="line">overlay  pkg  src</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šæ–°ç›®å½•çœ‹èµ·æ¥å¾ˆåƒæ™®é€šçš„ <code>$GOPATH</code>ï¼Œæ–°çš„ <code>Go</code> åŒ…ä¼šè¢«  <code>Go get</code> å‘½ä»¤ä¸‹è½½å¹¶ä¸”è¢«æ·»åŠ åˆ° <code>pkgset</code> ä¸­ã€‚</p></blockquote><p>æœ€åï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è·å–ä¸€ä¸ª <code>gorilla/mux</code> åŒ…ï¼Œç„¶åæ£€æŸ¥ <code>pkgset</code> ä¸‹çš„å†…å®¹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">$ go get github.com/gorilla/mux</span><br><span class="line">$ tree</span><br><span class="line">.</span><br><span class="line">â”œâ”€â”€ overlay</span><br><span class="line">â”‚   â”œâ”€â”€ bin</span><br><span class="line">â”‚   â””â”€â”€ lib</span><br><span class="line">â”‚       â””â”€â”€ pkgconfig</span><br><span class="line">â”œâ”€â”€ pkg</span><br><span class="line">â”‚   â””â”€â”€ linux_amd64</span><br><span class="line">â”‚       â””â”€â”€ github.com</span><br><span class="line">â”‚           â””â”€â”€ gorilla</span><br><span class="line">â”‚               â””â”€â”€ mux.a</span><br><span class="line">src/</span><br><span class="line">â””â”€â”€ github.com</span><br><span class="line">    â””â”€â”€ gorilla</span><br><span class="line">        â””â”€â”€ mux</span><br><span class="line">            â”œâ”€â”€ AUTHORS</span><br><span class="line">            â”œâ”€â”€ bench_test.go</span><br><span class="line">            â”œâ”€â”€ context.go</span><br><span class="line">            â”œâ”€â”€ context_test.go</span><br><span class="line">            â”œâ”€â”€ doc.go</span><br><span class="line">            â”œâ”€â”€ example_authentication_middleware_test.go</span><br><span class="line">            â”œâ”€â”€ example_cors_method_middleware_test.go</span><br><span class="line">            â”œâ”€â”€ example_route_test.go</span><br><span class="line">            â”œâ”€â”€ go.mod</span><br><span class="line">            â”œâ”€â”€ LICENSE</span><br><span class="line">            â”œâ”€â”€ middleware.go</span><br><span class="line">            â”œâ”€â”€ middleware_test.go</span><br><span class="line">            â”œâ”€â”€ mux.go</span><br><span class="line">            â”œâ”€â”€ mux_test.go</span><br><span class="line">            â”œâ”€â”€ old_test.go</span><br><span class="line">            â”œâ”€â”€ README.md</span><br><span class="line">            â”œâ”€â”€ regexp.go</span><br><span class="line">            â”œâ”€â”€ route.go</span><br><span class="line">            â””â”€â”€ test_helpers.go</span><br></pre></td></tr></table></figure><p>å¦‚ä¸Šæ‰€ç¤ºï¼Œ<code>gorilla/mux</code> æŒ‰ç…§é¢„æœŸæ·»åŠ åˆ°äº† <code>pkgset</code> çš„ <code>$GOPATH</code> ç›®å½•ï¼Œç°åœ¨ä½ å°±å¯ä»¥ä¸ä½¿ç”¨è¯¥ <code>pkgset</code> çš„é¡¹ç›®ä¸€èµ·ä½¿ç”¨è¯¥æ¨¡å—äº†ã€‚</p><h2 id="å¸è½½-gvm-æˆ–æŒ‡å®šç‰ˆæœ¬-go-è¯­è¨€">å¸è½½ GVM æˆ–æŒ‡å®šç‰ˆæœ¬ Go è¯­è¨€</h2><ol><li>å¦‚æœä½ åªæ˜¯æƒ³å¸è½½æŸä¸ªå®‰è£…å¥½çš„ <code>Go</code> ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤ã€‚</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gvm uninstall go1.12.8</span><br></pre></td></tr></table></figure><ol start="2"><li>å¦‚æœä½ æƒ³å®Œå…¨å¸è½½æ‰ GVM å’Œ æ‰€æœ‰å®‰è£…çš„ Go ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤ã€‚</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># éœ€è°¨æ…æ“ä½œ</span></span><br><span class="line">$ gvm implode</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><p><code>GVM</code> æ˜¯ä»¥ä¸€ç§ç›´è§‚çš„ã€éä¾µå…¥æ€§çš„æ–¹å¼æ¥ç®¡ç† <code>Go</code> ç‰ˆæœ¬å’ŒåŒ…çš„å·¥å…·ã€‚å®ƒå¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>GVM</code> çš„ <code>Go</code> ç‰ˆæœ¬ç®¡ç†åŠŸèƒ½ä¸å…¶ä»– <code>Go</code> æ¨¡å—ç®¡ç†æŠ€æœ¯ç»“åˆä½¿ç”¨ã€‚<code>GVM</code> é€šè¿‡å¯¹ <code>Go</code> ç‰ˆæœ¬å’ŒåŒ…ä¾èµ–å…³ç³»çš„éš”ç¦»ä½¿é¡¹ç›®å¼€å‘æ›´åŠ å®¹æ˜“ï¼Œå¹¶å‡å°‘äº†ç®¡ç†ç‰ˆæœ¬å†²çªçš„å¤æ‚æ€§ã€‚</p><h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2><ol><li><p><a href="https://www.google.com" target="_blank" rel="noopener">https://www.google.com</a></p></li><li><p><a href="https://bingohuang.com/go-gvm/" target="_blank" rel="noopener">https://bingohuang.com/go-gvm/</a></p></li><li><p><a href="https://learnku.com/articles/35269" target="_blank" rel="noopener">https://learnku.com/articles/35269</a></p></li><li><p><a href="https://dryyun.com/2018/11/28/how-to-use-gvm/" target="_blank" rel="noopener">https://dryyun.com/2018/11/28/how-to-use-gvm/</a></p></li><li><p><a href="https://laucyun.com/ff3bc3db699464aa76756e41be780712.html" target="_blank" rel="noopener">https://laucyun.com/ff3bc3db699464aa76756e41be780712.html</a></p></li><li><p><a href="https://opensource.com/article/19/10/go-introduction-gvm" target="_blank" rel="noopener">https://opensource.com/article/19/10/go-introduction-gvm</a></p></li><li><p><a href="http://blog.fatedier.com/2016/07/25/use-different-go-version-by-gvm/" target="_blank" rel="noopener">http://blog.fatedier.com/2016/07/25/use-different-go-version-by-gvm/</a></p></li></ol></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;Golang&lt;/code&gt; å‘å±•è¿…é€Ÿï¼Œä»£ç è¿­ä»£éå¸¸å¿«ï¼Œæƒ³è¦åœ¨åŒä¸€ç¯å¢ƒè°ƒè¯•å’Œæ¢³ç†ä¸åŒé¡¹ç›®è¿›ç¨‹å°±æˆäº†ä¸€ä»¶ç›¸å¯¹æ£˜æ‰‹çš„äº‹æƒ…ã€‚äºŒè¿›åˆ¶æ–‡ä»¶çš„ç®¡ç†æ¯”è¾ƒç®€å•ï¼Œé€šè¿‡é“¾æ¥ä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„ç¨‹åºå³å¯ã€‚å®é™…ä¸Šä¸»è¦æ˜¯ä¸€äº›ç¯å¢ƒå˜é‡å’Œæ ‡å‡†åº“çš„è®¾ç½®é—®é¢˜ï¼Œå¶ç„¶é—´å‘ç°äº† &lt;code&gt;GVM - Go Version Manager&lt;/code&gt;ï¼Œ&lt;code&gt;GVM&lt;/code&gt; å®é™…ä¸Šå°±æ˜¯å¸®åŠ©æˆ‘ä»¬å®Œæˆè¿™äº›é…ç½®å·¥ä½œï¼Œè¿™ç®—æ˜¯æ‰¾åˆ°äº†è°ƒè¯•åˆ‡æ¢ç‰ˆæœ¬çš„ç¦éŸ³äº†ã€‚&lt;/p&gt;
&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯-GVM&quot;&gt;ä»€ä¹ˆæ˜¯ GVM&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Go&lt;/code&gt; è¯­è¨€ç‰ˆæœ¬ç®¡ç†å™¨ï¼ˆ&lt;code&gt;GVM&lt;/code&gt;ï¼‰æ˜¯ç®¡ç† &lt;code&gt;Go&lt;/code&gt; è¯­è¨€ç¯å¢ƒçš„å¼€æºå·¥å…·ã€‚&lt;code&gt;GVM ã€Œpkgsetsã€&lt;/code&gt; æ”¯æŒå®‰è£…å¤šä¸ªç‰ˆæœ¬çš„ &lt;code&gt;Go&lt;/code&gt; å¹¶ç®¡ç†æ¯ä¸ªé¡¹ç›®çš„æ¨¡å—ã€‚å®ƒæœ€åˆç”± &lt;code&gt;Josh Bussdieker&lt;/code&gt; å¼€å‘ï¼Œ&lt;code&gt;GVM&lt;/code&gt; ä¸ &lt;code&gt;Ruby RVM&lt;/code&gt; ç±»ä¼¼ï¼Œå…è®¸ä½ ä¸ºæ¯ä¸ªé¡¹ç›®æˆ–ä¸€ç»„é¡¹ç›®åˆ›å»ºä¸€ä¸ªå¼€å‘ç¯å¢ƒï¼Œåˆ†ç¦»ä¸åŒçš„ &lt;code&gt;Go&lt;/code&gt; ç‰ˆæœ¬å’ŒåŒ…ä¾èµ–å…³ç³»ï¼Œæ¥æä¾›æ›´å¤§çš„çµæ´»æ€§ï¼Œä»¥é˜²ä¸åŒç‰ˆæœ¬é€ æˆçš„é—®é¢˜ã€‚&lt;code&gt;GVM&lt;/code&gt; ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹æ€§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç®¡ç† &lt;code&gt;Go&lt;/code&gt; çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬å®‰è£…ã€å¸è½½å’ŒæŒ‡å®šä½¿ç”¨ &lt;code&gt;Go&lt;/code&gt; çš„æŸä¸ªç‰ˆæœ¬&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æŸ¥çœ‹å®˜æ–¹æ‰€æœ‰å¯ç”¨çš„ &lt;code&gt;Go&lt;/code&gt; ç‰ˆæœ¬ï¼ŒåŒæ—¶å¯ä»¥æŸ¥çœ‹æœ¬åœ°å·²å®‰è£…å’Œé»˜è®¤ä½¿ç”¨çš„ &lt;code&gt;Go&lt;/code&gt; ç‰ˆæœ¬&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç®¡ç†å¤šä¸ª &lt;code&gt;GOPATH&lt;/code&gt;ï¼Œå¹¶å¯ç¼–è¾‘ &lt;code&gt;Go&lt;/code&gt; çš„ç¯å¢ƒå˜é‡&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯å°†å½“å‰ç›®å½•å…³è”åˆ° &lt;code&gt;GOPATH&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯ä»¥æŸ¥çœ‹ &lt;code&gt;GOROOT&lt;/code&gt; ä¸‹çš„æ–‡ä»¶å·®å¼‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ”¯æŒ &lt;code&gt;Go&lt;/code&gt; ç‰ˆæœ¬åˆ‡æ¢&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;é¡¹ç›®åœ°å€ï¼š&lt;a href=&quot;https://github.com/moovweb/gvm&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/moovweb/gvm&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/categories/Linux/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="æŠ€å·§" scheme="https://www.hi-linux.com/tags/%E6%8A%80%E5%B7%A7/"/>
    
      <category term="Go" scheme="https://www.hi-linux.com/tags/Go/"/>
    
  </entry>
  
  <entry>
    <title>å†è§ XShell å’Œ ITerm 2ï¼Œæ˜¯æ—¶å€™æ‹¥æŠ±å…¨å¹³å°é«˜é¢œå€¼ç»ˆç«¯å·¥å…· Hyper äº†</title>
    <link href="https://www.hi-linux.com/posts/44812.html"/>
    <id>https://www.hi-linux.com/posts/44812.html</id>
    <published>2020-05-11T01:00:00.000Z</published>
    <updated>2020-05-13T05:15:00.352Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><p>ä¸è®ºæ˜¯ <code>macOS</code> è¿˜æ˜¯ <code>Windows</code> ä¸‹ï¼Œæˆ‘ä»¬éƒ½ä¸æ¨èä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦ç»ˆç«¯ã€‚æ— è®ºæ˜¯å¯æ‹“å±•æ€§è¿˜æ˜¯å¯ç¼–ç¨‹æ€§éƒ½è¢«ã€Œç³»ç»Ÿè‡ªå¸¦ã€è¿™æ ·çš„ç‰¹ç‚¹é™åˆ¶ã€‚ç‰¹åˆ«æ˜¯ <code>Windows</code> ä¸‹çš„ä¸‡æ¶ä¹‹æºã€Œå°é»‘æ¡†ã€ï¼Œåœ¨ 9012 å¹´çœŸçš„æ˜¯ä¸å¤ªå¥½ç”¨å“Ÿï¼</p><p>ä»Šå¤©æˆ‘ä»¬å°†ç»™å¤§å®¶ä»‹ç»ä¸€æ¬¾åŸºäº <code>Electron</code> çš„å…¨å¹³å°é«˜é¢œå€¼çš„ç»ˆç«¯å·¥å…· <code>Hyper</code>ã€‚<code>Hyper</code> æ”¯æŒä¸°å¯Œçš„ä¸»é¢˜å’Œæ’ä»¶åŠŸèƒ½ï¼Œé€šè¿‡å¼ºå¤§çš„æ’ä»¶ç³»ç»Ÿæä¾›äº†éå¸¸ä¸°å¯Œçš„è‡ªå®šä¹‰é€‰é¡¹ï¼Œå¯è°“æ˜¯é¢œå€¼å’Œæ˜“ç”¨å¹¶å­˜çš„ç¥å™¨ã€‚</p><blockquote><p>å®˜ç½‘åœ°å€ï¼š<a href="https://hyper.is" target="_blank" rel="noopener">https://hyper.is</a></p></blockquote><p>ä¸‹é¢å…ˆæ”¾ä¸€å¼ é…ç½®å¥½çš„é¢„è§ˆæ•ˆæœå›¾ï¼Œè®©å¤§å®¶å…ˆç¹ä¸ºå¿«ã€‚</p><p><img src="https://img.fythonfang.com/MacScreenShot%202018-07-20-5-35-35.png" alt=""></p><p>ç”±äº <code>Hyper</code> æ˜¯åŸºäº <code>Electron</code> çš„ï¼Œæ‰€ä»¥å®ƒçš„æ’ä»¶ã€ä¸»é¢˜ç­‰ç­‰å¯æ‹“å±•æ€§éƒ½éå¸¸å¼ºå¤§ã€‚å‡ è¡Œç®€å•çš„ <code>Javascript</code>ã€<code>HTML</code>ã€ <code>CSS</code> ä»£ç ï¼Œä½ å°±å¯ä»¥å®šåˆ¶è‡ªå·±çš„æ’ä»¶ã€‚</p><blockquote><p><code>Electron</code> æ˜¯ä¸€ä¸ªåˆ©ç”¨æœ€æ–° <code>Web</code> æŠ€æœ¯æ ˆæ­å»ºè·¨å¹³å°åº”ç”¨çš„é¡¹ç›®ï¼Œæ¯”å¦‚: <code>GitHub</code> å‡ºå“çš„ä»£ç ç¼–è¾‘å™¨ <code>Atom</code> å’Œå¾®è½¯å‡ºå“çš„ <code>VSCode</code> éƒ½æ˜¯åŸºäº <code>Electron</code> çš„ã€‚</p></blockquote><h2 id="å®‰è£…-hyper">å®‰è£… Hyper</h2><p><code>Hyper</code> çš„å®‰è£…éå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨å®˜ç½‘ä¸‹è½½å¯¹åº”å¹³å°äºŒè¿›åˆ¶å®‰è£…åŒ…åï¼Œç›´æ¥å®‰è£…å°±å¯ä»¥è¿è¡Œã€‚</p><p><img src="https://cdn.sspai.com/editor/u_735639/media/15651037049805/15651047302326.jpg" alt=""></p><p>å¦‚æœä½ æ˜¯ <code>macOS</code> å¹³å°ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡ <code>Homebrew</code> å‘½ä»¤æ¥å¿«é€Ÿå®Œæˆå®‰è£…ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ brew cask install hyper</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ è¿˜ä¸çŸ¥é“ <code>Homebrew</code> å¦‚ä½•å®‰è£…å’Œä½¿ç”¨å¯ä»¥å‚è€ƒ â€‹<a href="https://mp.weixin.qq.com/s?__biz=MzI3MTI2NzkxMA==&amp;mid=2247484646&amp;idx=1&amp;sn=f73feedee278c03c6c2d138154f822fb&amp;chksm=eac525cfddb2acd964c163f6020cc1c385abc8f0680cc6086881a8093b73511db31c34e3e3fc&amp;token=985021721&amp;lang=zh_CN#rd" target="_blank" rel="noopener">ã€ŒmacOS ä¸å¯æˆ–ç¼ºçš„å¥—ä»¶ç®¡ç†å™¨â€”â€”Homebrewã€</a> å’Œ  â€‹<a href="https://mp.weixin.qq.com/s?__biz=MzI3MTI2NzkxMA==&amp;mid=2247484672&amp;idx=1&amp;sn=55dc5a5b3283fe618124684d9b683a17&amp;chksm=eac52429ddb2ad3fba77229c3ffbe4c3e3cf7b6477fbc08a43232e0c67bdc367be3a293f04d5&amp;token=985021721&amp;lang=zh_CN#rd" target="_blank" rel="noopener">ã€ŒmacOSå°æŠ€å·§ â€”â€” å¦‚ä½•ç”¨ Homebrew å®‰è£…æŒ‡å®šç‰ˆæœ¬è½¯ä»¶ã€</a> ä¸¤ç¯‡æ–‡ç« å…ˆäº†è§£ä¸‹ã€‚</p><a id="more"></a><h2 id="hyper-ä¸»é¢˜å®‰è£…">Hyper ä¸»é¢˜å®‰è£…</h2><p><code>Hyper</code> åšä¸ºä¸€ä¸ªé«˜é¢œå€¼ç»ˆç«¯å·¥å…·ï¼Œè‡ªç„¶å°±å°‘ä¸äº†å¯¹ä¸»é¢˜çš„æ”¯æŒã€‚å®˜æ–¹é¦–é¡µæ¨èäº† 4 ç§ä¸åŒé¢œè‰²çš„ä¸»é¢˜ï¼Œä½ å¯ä»¥åœ¨å®˜æ–¹ä¸»é¢˜åœ°å€ <code>https://hyper.is/themes</code> ç›´æ¥æŸ¥çœ‹å¹¶å®‰è£…ã€‚</p><p><img src="https://www.hi-linux.com/img/linux/hyper-theme.jpg" alt=""></p><p>å½“ç„¶ï¼Œå¦‚æœä¸Šé¢å®˜æ–¹æ¨èçš„ä¸»é¢˜æ»¡è¶³ä¸äº†ä½ ï¼Œä½ ä¹Ÿå¯ä»¥å»åœ¨ä¸Šé¢çš„ä¸»é¢˜åœ°å€ä¸­çš„ <code>NEWEST</code> é¡µç­¾æ‰¾åˆ°æ›´å¤šä¸»é¢˜ï¼Œæˆ–è€…æ˜¯å» <code>GitHub</code> æœç´¢æ›´å¤šå¥½çœ‹çš„ä¸»é¢˜ã€‚</p><h2 id="å–„ç”¨-hyper-æ’ä»¶">å–„ç”¨ Hyper æ’ä»¶</h2><p><code>Hyper</code> æœ¬èº«æ˜¯æ”¯æŒæ’ä»¶ç³»ç»Ÿçš„ï¼Œåœ¨å®‰è£…æ‰©å±•æ’ä»¶å‰ï¼Œä½ éœ€è¦å…ˆå®‰è£… <code>Hyper</code> å‘½ä»¤è¡Œç¨‹åºã€‚ä½ å¯ä»¥ç‚¹å‡»èœå•ï¼Œé€‰æ‹© <code>Plugin</code> é€‰é¡¹ï¼Œç„¶åç‚¹å‡» <code>Install Hyper CLI command in PATH</code>ã€‚</p><p><code>Hyper</code> å‘½ä»¤è¡Œç¨‹åºå®‰è£…å®Œæˆåï¼Œ<code>Hyper</code> æ’ä»¶å®‰è£…å°±ååˆ†ç®€å•äº†ï¼Œåªéœ€è¦æ‰“å¼€ <code>Hyper</code> ä¹‹åä¸€è¡Œä»£ç å°±å¯ä»¥æå®šï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hyper i verminal</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±å®‰è£…äº† <code>verminal</code> è¿™ä¸ªæ’ä»¶ã€‚</p><p><code>Hyper</code> å®˜æ–¹ä¹Ÿåœ¨é¦–é¡µç»™å¤§å®¶æ¨èäº† 4 ä¸ªæ¯”è¾ƒæ˜“ç”¨çš„æ’ä»¶ï¼Œæ¨èå¤§å®¶å…¨éƒ¨éƒ½å®‰è£…è¯•è¯•ã€‚</p><h3 id="1-hypercwd">1. hypercwd</h3><p><img src="https://raw.githubusercontent.com/hharnisc/hypercwd/master/newTabs.gif" alt=""></p><p>å®ƒå¯ä»¥è®©ä½ çš„ç»ˆç«¯åœ¨æ–°å»ºæ ‡ç­¾é¡µæ—¶ï¼Œä¿æŒä¸Šä¸€ä¸ªç»ˆç«¯çš„ç›®å½•åœ°å€ã€‚å…¶å®‰è£…å‘½ä»¤æ˜¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hyper i hypercwd</span><br></pre></td></tr></table></figure><h3 id="2-hyper-search">2. hyper-search</h3><p><img src="https://www.hi-linux.com/img/linux/hyper-search.jpg" alt=""></p><p>å®ƒå¯ä»¥è®©ä½ æœç´¢æ•´ä¸ªç»ˆç«¯çš„æ‰€æœ‰æ–‡æœ¬å†…å®¹ã€‚å…¶å®‰è£…å‘½ä»¤æ˜¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hyper i hyper-search</span><br></pre></td></tr></table></figure><h3 id="3-hyper-pane">3. hyper-pane</h3><p><img src="https://hyper-plugin-screenshots.now.sh/hyper-pane.gif" alt=""></p><p>è¯¥æ’ä»¶ç”¨æ¥å¢å¼ºçª—å£å¯¼èˆªï¼Œå¯¹äºæ”¯æŒå¤šä¸ªé¡µç­¾çš„è½¯ä»¶æ¥è¯´è¿™æ˜¯ä¸ªåˆ©å™¨ã€‚å…¶å®‰è£…å‘½ä»¤æ˜¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hyper i hyper-pane</span><br></pre></td></tr></table></figure><h3 id="4-hyperpower">4. hyperpower</h3><p><img src="https://cloud.githubusercontent.com/assets/13041/16820268/13c9bfe6-4905-11e6-8fe4-baf8fc8d9293.gif" alt=""></p><p>è¿™æ˜¯ä¸€ä¸ªè®©ä½ çš„ç»ˆç«¯å˜å¾—æ›´åŠ ç»šä¸½çš„æ’ä»¶ï¼Œç±»ä¼¼äº <code>Atom</code> é‡Œé¢çš„ä¸€ä¸ªå«åš <code>activate-power-mode</code> çš„æ’ä»¶ã€‚å½“ç„¶è¿™ä¹ˆç‚«é…·çš„æ•ˆæœæ˜¯ä¸æ˜¯ä¼šå½±å“ä½ çš„å·¥ä½œå‘¢ï¼Œè¿˜æ˜¯è¦è§†ä¸ªäººæƒ…è€Œå®šã€‚å…¶å®‰è£…å‘½ä»¤æ˜¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hyper i hyperpower</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ éœ€è¦æ›´å¤šçš„æ’ä»¶å’Œä¸»é¢˜ï¼Œä½ å¯ä»¥åœ¨å®˜æ–¹ç½‘ç«™ä»¥ä¸‹åœ°å€ä¸­æ‰¾åˆ°ã€‚</p><blockquote><ol><li><p><code>Hyper</code> çš„å®˜æ–¹ä¸»é¢˜åœ°å€ï¼š<a href="https://hyper.is/themes" target="_blank" rel="noopener">https://hyper.is/themes</a></p></li><li><p><code>Hyper</code> çš„å®˜æ–¹æ’ä»¶åœ°å€ï¼š<a href="https://hyper.is/plugins" target="_blank" rel="noopener">https://hyper.is/plugins</a></p></li></ol></blockquote><p>é™¤äº†ï¼Œå®˜æ–¹æä¾›çš„ä¸»é¢˜å’Œæ’ä»¶ã€‚ç›®å‰è¿˜æœ‰ä¸€ä¸ªç¤¾åŒºé©±åŠ¨çš„ <code>awesome-hyper</code> é¡¹ç›®ï¼Œé‡Œé¢æœ‰ç€æ›´å¤šå¼€æºçš„ <code>Hyper</code> ç»ˆç«¯æ’ä»¶ã€ä¸»é¢˜ç­‰ç­‰ã€‚å¦‚æœä½ å¯¹ä¸åŒçš„ä¸»é¢˜å’Œæ’ä»¶æœ‰å…´è¶£ï¼Œå¯ä»¥å»è¿™ä¸ªé¡¹ç›®é‡Œè¿›è¡Œæ¢ç´¢å“Ÿï¼</p><blockquote><ol><li>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/bnb/awesome-hyper" target="_blank" rel="noopener">https://github.com/bnb/awesome-hyper</a></li></ol></blockquote><h2 id="æ•´åˆ-zsh">æ•´åˆ ZSH</h2><p>é€šå¸¸ <code>Linux</code> æœåŠ¡å™¨ä¸Šé¢é»˜è®¤ä½¿ç”¨çš„ <code>SHELL</code> æ˜¯ <code>Bash</code>ã€‚å…¶å®é™¤äº† <code>Bash</code> ä¹‹å¤–ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„ <code>SHELL</code> ç¨‹åºï¼Œæ¯”å¦‚ï¼š<code>ZSH</code>ã€<code>CSH</code>ã€<code>Fish</code> ç­‰ç­‰ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬å°†ä»‹ç»çš„ <code>ZSH</code> æ˜¯æˆ‘è®¤ä¸ºåœ¨ç±» <code>Unix</code> ç³»ç»Ÿä¸‹æœ€ä¼˜é›…çš„ <code>Shell</code> ç¨‹åº ã€‚è™½ç„¶ <code>ZSH</code> è®¾ç½®å¤æ‚ï¼Œä½†å¾—ç›Šäºå¼€æºç¤¾åŒºï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨  <code>Oh-My-ZSH</code> è¿™ä¸ªç¥å™¨æ¥å¾ˆæ–¹ä¾¿çš„ç®¡ç†å’Œé…ç½® <code>ZSH</code>ã€‚</p><h3 id="å®‰è£…-zsh-å’Œ-oh-my-zsh">å®‰è£… ZSH å’Œ Oh-My-ZSH</h3><p>åœ¨ä½¿ç”¨ <code>Oh-My-ZSH</code> ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆå®‰è£… <code>ZSH</code>ã€‚å„ä¸ªå¹³å°å®‰è£…çš„æ–¹å¼å¯èƒ½ä¸ä¸€æ ·ï¼Œè¿™é‡Œå°±åªç®€å•è¯´ä¸‹æ¯”è¾ƒå¸¸ç”¨çš„ <code>Centos</code> å’Œ <code>Ubuntu</code> ç³»ç»Ÿä¸‹çš„å®‰è£…æ–¹æ³•ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Redhat / Centos</span></span><br><span class="line">$ yum install zsh</span><br><span class="line"></span><br><span class="line"><span class="comment"># Debian / Ubuntu</span></span><br><span class="line">$ apt-get install zsh</span><br></pre></td></tr></table></figure><p>æ›´å¤šå¹³å°çš„å®‰è£…æ–¹æ³•ï¼Œä½ å¯ä»¥é€šè¿‡ â€‹<a href="https://mp.weixin.qq.com/s?__biz=MzI3MTI2NzkxMA==&amp;mid=2247483784&amp;idx=1&amp;sn=60aa4c40e12b0d64bf373d5606f8e2e9&amp;chksm=eac520a1ddb2a9b70ce515e9ee6f290842ef2276d0b52f620f05280b8e30f7f3c7591802ca5f&amp;token=1853415346&amp;lang=zh_CN#rd" target="_blank" rel="noopener">ã€Œåˆ©ç”¨ Oh-My-Zsh æ‰“é€ ä½ çš„è¶…çº§ç»ˆç«¯ã€</a> è¿™ç¯‡æ–‡ç« äº†è§£ã€‚</p><p>å®‰è£…å¥½ <code>ZSH</code>  åï¼Œå°±å¯ä»¥å®‰è£… <code>Oh-My-ZSH</code> äº†ã€‚<code>Oh-My-ZSH</code> çš„å®‰è£…ä¹Ÿæ˜¯éå¸¸ç®€å•çš„ï¼Œä½ åªéœ€è¦ç”¨ä¸‹é¢ä¸¤æ¡æŒ‡ä»¤ä¸­çš„ä»»æ„ä¸€æ¡å°±å¯å®Œæˆå®‰è£…ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é€šè¿‡ curl å®‰è£…</span></span><br><span class="line">$ sh -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€šè¿‡ wget å®‰è£…</span></span><br><span class="line">$ sh -c <span class="string">"<span class="variable">$(wget https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -)</span>"</span></span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œæˆåï¼Œä½ å°±ä¼šå‘ç°ä½ çš„ç»ˆç«¯ <code>SHELL</code> å˜æˆäº† <code>ZSH</code>ã€‚ä½ è¿˜å¯ä»¥é€šè¿‡å‘½ä»¤ <code>chsh -s /bin/zsh</code> å°† <code>ZSH</code> è®¾ç½®ä¸ºé»˜è®¤çš„ <code>Shell</code>ã€‚</p><h3 id="é…ç½®ä¸»é¢˜">é…ç½®ä¸»é¢˜</h3><p><code>Oh-My-ZSH</code> é»˜è®¤ä¹Ÿé™„å¸¦äº†å¤§é‡å¥½çœ‹çš„ä¸»é¢˜ï¼Œä½ å¯ä»¥åˆ©ç”¨å®ƒä»¬å¯¹ç»ˆç«¯ç•Œé¢åšè¿›ä¸€æ­¥å¢å¼ºå’Œç¾åŒ–ã€‚<code>Oh-My-ZSH</code> é»˜è®¤çš„ä¸»é¢˜å­˜æ”¾åœ¨ <code>~/.oh-my-zsh/themes</code> ç›®å½•ä¸­ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ ls ~/.oh-my-zsh/themes</span><br><span class="line"></span><br><span class="line">3den.zsh-theme                essembeh.zsh-theme            junkfood.zsh-theme            rgm.zsh-theme</span><br><span class="line">Soliah.zsh-theme              evan.zsh-theme                kafeitu.zsh-theme             risto.zsh-theme</span><br><span class="line">adben.zsh-theme               example.zsh-theme             kardan.zsh-theme              rixius.zsh-theme</span><br><span class="line">af-magic.zsh-theme            fino-time.zsh-theme           kennethreitz.zsh-theme        rkj-repos.zsh-theme</span><br><span class="line">afowler.zsh-theme             fino.zsh-theme                kiwi.zsh-theme                rkj.zsh-theme</span><br><span class="line">agnoster.zsh-theme            fishy.zsh-theme               kolo.zsh-theme                robbyrussell.zsh-theme</span><br><span class="line">alanpeabody.zsh-theme         flazz.zsh-theme               kphoen.zsh-theme              sammy.zsh-theme</span><br><span class="line">amuse.zsh-theme               fletcherm.zsh-theme           lambda.zsh-theme              simonoff.zsh-theme</span><br><span class="line">apple.zsh-theme               fox.zsh-theme                 linuxonly.zsh-theme           simple.zsh-theme</span><br><span class="line">arrow.zsh-theme               frisk.zsh-theme               lukerandall.zsh-theme         skaro.zsh-theme</span><br><span class="line">....</span><br></pre></td></tr></table></figure><p>å¯¹äºä¸»é¢˜çš„å¯ç”¨ï¼Œä½ åªéœ€ç¼–è¾‘ <code>ZSH</code> é…ç½®æ–‡ä»¶ <code>~/.zshrc</code>ã€‚å¹¶åœ¨ <code>ZSH_THEME</code> é¡¹ä¸­ç›´æ¥ä¿®æ”¹ä¸»é¢˜åç§°ä¸ºè¦å¯ç”¨çš„ä¸»é¢˜åç§°å³å¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZSH_THEME&#x3D;&quot;agnoster&quot;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šå¦‚æœä½ å®‰è£…çš„ä¸»é¢˜æ— æ³•æ˜¾ç¤ºé¢„æœŸæ•ˆæœï¼Œé‚£æ˜¯å› ä¸ºå“åº”çš„ä¸»é¢˜çš„ç³»ç»Ÿå­—ä½“æ²¡æœ‰å®‰è£…ã€‚è¿™æ—¶ï¼Œä½ éœ€è¦æ­£ç¡®çš„å®‰è£…äº† <code>Powerline</code> å­—ä½“æ‰ä¼šæ˜¾ç¤ºå‡ºæ¥ã€‚</p><ol><li><p><code>Powerline</code> é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/powerline/fonts" target="_blank" rel="noopener">https://github.com/powerline/fonts</a></p></li><li><p><code>Powerline</code> å®‰è£…æ•™ç¨‹ï¼š<a href="https://powerline.readthedocs.io/en/latest/installation.html#fonts-installation" target="_blank" rel="noopener">https://powerline.readthedocs.io/en/latest/installation.html#fonts-installation</a></p></li></ol></blockquote><p>å¦‚æœè¿™äº›é»˜è®¤ä¸»é¢˜è¿˜ä¸èƒ½æ»¡è¶³ä½ çš„éœ€è¦ï¼Œä½ è¿˜å¯ä»¥åˆ°ä¸‹é¢è¿™äº›åœ°å€ä¸­æ‰¾åˆ°æ›´å¤šçš„ <code>ZSH</code> ä¸»é¢˜ã€‚</p><blockquote><ol><li><p><a href="https://github.com/robbyrussell/oh-my-zsh/wiki/Themes" target="_blank" rel="noopener">https://github.com/robbyrussell/oh-my-zsh/wiki/Themes</a></p></li><li><p><a href="https://github.com/robbyrussell/oh-my-zsh/wiki/External-themes" target="_blank" rel="noopener">https://github.com/robbyrussell/oh-my-zsh/wiki/External-themes</a></p></li><li><p><a href="https://github.com/unixorn/awesome-zsh-plugins#themes" target="_blank" rel="noopener">https://github.com/unixorn/awesome-zsh-plugins#themes</a></p></li></ol></blockquote><h3 id="é…ç½®æ’ä»¶">é…ç½®æ’ä»¶</h3><p><code>Oh-My-ZSH</code> ä¹‹æ‰€ä»¥å¼ºå¤§ï¼Œå…¶ä¸­ä¸€ä¸ªåŸå› å°±æ˜¯æ”¯æŒè¯¸å¤šåŠŸèƒ½å¼ºå¤§çš„æ’ä»¶ï¼Œ<code>Oh-My-ZSH</code> é»˜è®¤è‡ªå¸¦çš„æ’ä»¶éƒ½å­˜æ”¾åœ¨ <code>~/.oh-my-zsh/plugins</code> ç›®å½•ä¸­ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ ls ~/.oh-my-zsh/plugins</span><br><span class="line"></span><br><span class="line">adb               brew         coffee             dirpersist      fastfile         gitignore                 httpie     last-working-dir  nanoc                  pod         rebar       sprunge        terminitor  vault              zeus</span><br><span class="line">ant               brew-cask    colemak            django          fbterm           git-prompt                iwhois     lein              nmap                   postgres    redis-cli   ssh-agent      terraform   vim-interaction    zsh-navigation-tools</span><br><span class="line">apache2-macports  bundler      colored-man-pages  dnf             fedora           git-remote-branch         jake-node  lighthouse        node                   pow         repo        stack          textastic   vi-mode            zsh_reload</span><br><span class="line">archlinux         bwana        colorize           docker          forklift         glassfish                 jhbuild    lol               npm                    powder      rsync       sublime        textmate    virtualenv</span><br><span class="line">asdf              cabal        <span class="built_in">command</span>-not-found  docker-compose  frontend-search  gnu-utils                 jira       macports          nvm                    powify      ruby        sudo           thefuck     virtualenvwrapper</span><br><span class="line">autoenv           cake         common-aliases     emacs           gas              go                        jruby      man               nyan                   profiles    rvm         supervisor     themes      vundle</span><br><span class="line">autojump          cakephp3     compleat           ember-cli       geeknote         golang                    jsontools  marked2           osx                    pyenv       safe-paste  suse           thor        wakeonlan</span><br><span class="line">autopep8          capistrano   composer           emoji           gem              gpg-agent                 jump       mercurial         pass                   pylint      sbt         svn            tmux        wd</span><br><span class="line">aws               cask         copydir            emoji-clock     git              gradle                    kate       meteor            paver                  python      scala       svn-fast-info  tmux-cssh   web-search</span><br><span class="line">battery           catimg       copyfile           emotty          git-extras       grails                    kitchen    mix               pep8                   rails       scd         symfony        tmuxinator  wp-cli</span><br><span class="line">bbedit            celery       cp                 encode64        gitfast          grunt                     knife      mix-fast          per-directory-history  rake        screen      symfony2       torrent     xcode</span><br><span class="line">bgnotify          chruby       cpanm              extract         git-flow         gulp                      knife_ssh  mosh              perl                   rake-fast   scw         systemadmin    tugboat     yii</span><br><span class="line">boot2docker       chucknorris  debian             fabric          git-flow-avh     heroku                    laravel    mvn               phing                  rand-quote  sfffe       systemd        ubuntu      yii2</span><br><span class="line">bower             cloudapp     dircycle           fancy-ctrl-z    github           <span class="built_in">history</span>                   laravel4   mysql-macports    pip                    rbenv       singlechar  taskwarrior    urltools    yum</span><br><span class="line">branch            codeclimate  dirhistory         fasd            git-hubflow      <span class="built_in">history</span>-substring-search  laravel5   n98-magerun       pj                     rbfu        spring      terminalapp    vagrant     z</span><br></pre></td></tr></table></figure><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>Oh-My-ZSH</code> åªå¯ç”¨ <code>Git</code> æ’ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Git æ’ä»¶å¯ä»¥ååˆ†æ¸…æ™°çš„æ˜¾ç¤ºå‡ºå½“å‰ä»£ç ä»“åº“é‡Œä¸è¿œç¨‹ä»“åº“æ˜¯å¦åŒæ­¥ï¼Œä»¥åŠæœ€æ–°åŒæ­¥æ—¥æœŸç­‰ç­‰ä¿¡æ¯ã€‚</span></span><br><span class="line">plugins=(git)</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ éœ€å¯ç”¨æ›´å¤šæ’ä»¶ï¼Œåªéœ€åŠ å…¥è¦å¯ç”¨æ’ä»¶çš„åç§°ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plugins=(git wd web-search <span class="built_in">history</span> <span class="built_in">history</span>-substring-search)</span><br></pre></td></tr></table></figure><p>é™¤é»˜è®¤è‡ªå¸¦çš„æ’ä»¶å¤–ï¼Œä½ è¿˜å¯ä»¥åœ¨ <code>GitHub</code> ä¸Šæ‰¾åˆ°æ›´å¤šå¥½ç”¨çš„ <code>ZSH</code> ä¸‰æ–¹æ’ä»¶ï¼Œè¿™é‡Œæ¨èå‡ ä¸ªæ¯”è¾ƒå¥½ç”¨ä¸‰æ–¹æ’ä»¶ã€‚</p><blockquote><ol><li>zsh-history-substring-search</li></ol><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/robbyrussell/oh-my-zsh/tree/master/plugins/history-substring-search" target="_blank" rel="noopener">https://github.com/robbyrussell/oh-my-zsh/tree/master/plugins/history-substring-search</a></p><ol start="2"><li>zsh-syntax-highlighting</li></ol><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/zsh-users/zsh-syntax-highlighting" target="_blank" rel="noopener">https://github.com/zsh-users/zsh-syntax-highlighting</a></p><ol start="3"><li>zsh-autosuggestions</li></ol><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/zsh-users/zsh-autosuggestions" target="_blank" rel="noopener">https://github.com/zsh-users/zsh-autosuggestions</a></p></blockquote><p>å¦‚æœä½ æƒ³æ›´å¤šäº†è§£ <code>ZSH</code> å’Œ <code>Oh-My-ZSH</code>ï¼Œå¯ä»¥é€šè¿‡ â€‹<a href="https://mp.weixin.qq.com/s?__biz=MzI3MTI2NzkxMA==&amp;mid=2247483784&amp;idx=1&amp;sn=60aa4c40e12b0d64bf373d5606f8e2e9&amp;chksm=eac520a1ddb2a9b70ce515e9ee6f290842ef2276d0b52f620f05280b8e30f7f3c7591802ca5f&amp;token=1853415346&amp;lang=zh_CN#rd" target="_blank" rel="noopener">ã€Œåˆ©ç”¨ Oh-My-Zsh æ‰“é€ ä½ çš„è¶…çº§ç»ˆç«¯ã€</a> å’Œ  â€‹<a href="https://mp.weixin.qq.com/s?__biz=MzI3MTI2NzkxMA==&amp;mid=2247488164&amp;idx=1&amp;sn=4a0d6635638148684d893aa0b45b0946&amp;chksm=eac5338dddb2ba9bd8e071a5aba95697a0f7b4891087a5740cc1f0297382f9035ac9fc7895ac&amp;token=1853415346&amp;lang=zh_CN#rd" target="_blank" rel="noopener">ã€Œè®©ä½ æå‰ä½“éªŒ macOS Catalina çš„ Shell â€” Oh My Zsh é…ç½®æŒ‡å—ã€</a> è¿™ä¸¤ç¯‡æ–‡ç« è¿›ä¸€æ­¥æ¢ç´¢ã€‚</p><h2 id="é›†æˆ-wsl">é›†æˆ WSL</h2><p>é€šå¸¸åœ¨ä½¿ç”¨ <code>WSL (Windows Subsystem for Linux)</code> å·¥ä½œæ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›å¯åŠ¨ç»ˆç«¯æ—¶å°±è¿›å…¥ <code>WSL</code> çš„ <code>SHELL</code> å†…éƒ¨ã€‚ä½†é»˜è®¤æƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦åœ¨å¯åŠ¨ç»ˆç«¯å¹¶è¾“å…¥ <code>bash</code> å‘½ä»¤åæ‰èƒ½è¿›å…¥ <code>WSL</code> ç»ˆç«¯ã€‚</p><p>å¾ˆæ˜¾ç„¶æœ‰æ­¤ä¸€æ­¥æ“ä½œåï¼Œæˆ‘ä»¬ä¼šè§‰å¾—å¤ªç¹çäº†ã€‚æœ‰äº† <code>Hyper</code> åï¼Œæˆ‘ä»¬åªéœ€è¦æ”¹åŠ¨ä¸€ä¸‹é…ç½®æ–‡ä»¶ï¼Œä¸Šé¢è¿™æ­¥å°±å¯ä»¥ç›´æ¥çœç•¥ã€‚</p><p>ç°åœ¨ï¼Œä½ åªéœ€æ‰“å¼€ <code>Hyper</code> è®¾ç½®é¡µé¢æ–‡ä»¶ï¼Œä»èœå• <code>Edit -&gt; Preferences</code> è¿›å…¥ï¼Œç„¶åç¼–è¾‘ <code>shell</code> å’Œ <code>shellArgs</code> å‚æ•°å³å¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell: <span class="string">'C:\\Windows\\System32\\bash.exe'</span>,</span><br><span class="line">shellArgs: [],</span><br></pre></td></tr></table></figure><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly96aHlvbmctY24tZmlsZS5vc3MtY24tc2hhbmdoYWkuYWxpeXVuY3MuY29tLzIwMTgxMi8yMDE4LTEyLTE1XzE3LTI0LTQzLnBuZw" alt=""></p><p>ä¿®æ”¹å®Œæˆåï¼Œå†æ¬¡é‡æ–°æ‰“å¼€ <code>Hyper</code>ï¼Œä½ ä¼šå‘ç°é»˜è®¤å·²ç»è¿›å…¥äº† <code>Bash</code> ç»ˆç«¯ç•Œé¢äº†ã€‚</p><h2 id="æ€»ç»“">æ€»ç»“</h2><p>æœ¬æ–‡è®²è¿°äº†å¦‚ä½•å®‰è£…å’Œä½¿ç”¨ <code>Hyper</code> è¿™ä¸ªé«˜é¢œå€¼è·¨å¹³å°çš„ç»ˆç«¯è½¯ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬é…ç½® <code>Hyper</code> æ’ä»¶å’Œä¸»é¢˜ã€‚å¹¶è®²è¿°äº†å¦‚ä½•ä½¿ç”¨ <code>ZSH</code> æ¥ä»£æ›¿ <code>Bash</code> è®©ä½ çš„ç»ˆç«¯æ›´åŠ å¼ºå¤§æ˜“ç”¨çš„æ–¹æ³•ã€‚éƒ½çœ‹åˆ°è¿™é‡Œäº†ï¼Œä½ è¿˜åœ¨ç­‰ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯æ—¶å€™æ”¾å¼ƒä½ çš„ <code>Xshell</code> å’Œ <code>iTerm 2</code> å§ï¼</p><h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2><ol><li><p><a href="https://www.google.com" target="_blank" rel="noopener">https://www.google.com</a></p></li><li><p><a href="https://sspai.com/post/56081" target="_blank" rel="noopener">https://sspai.com/post/56081</a></p></li><li><p><a href="https://sspai.com/post/45332" target="_blank" rel="noopener">https://sspai.com/post/45332</a></p></li><li><p><a href="https://archive.spencerwoo.com/posts/2018/06/17/terminal.html" target="_blank" rel="noopener">https://archive.spencerwoo.com/posts/2018/06/17/terminal.html</a></p></li><li><p><a href="https://www.fythonfang.com/blog/post/24" target="_blank" rel="noopener">https://www.fythonfang.com/blog/post/24</a></p></li><li><p><a href="https://github.com/sindresorhus/hyper-snazzy" target="_blank" rel="noopener">https://github.com/sindresorhus/hyper-snazzy</a></p></li><li><p><a href="https://www.veinin.com/2018/11/30/hyper-windows-tutorial/" target="_blank" rel="noopener">https://www.veinin.com/2018/11/30/hyper-windows-tutorial/</a></p></li><li><p><a href="https://blog.csdn.net/was172/article/details/85016495" target="_blank" rel="noopener">https://blog.csdn.net/was172/article/details/85016495</a></p></li><li><p><a href="https://github.com/sindresorhus/pure" target="_blank" rel="noopener">https://github.com/sindresorhus/pure</a></p></li><li><p><a href="https://www.fythonfang.com/blog/post/24" target="_blank" rel="noopener">https://www.fythonfang.com/blog/post/24</a></p></li></ol></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸è®ºæ˜¯ &lt;code&gt;macOS&lt;/code&gt; è¿˜æ˜¯ &lt;code&gt;Windows&lt;/code&gt; ä¸‹ï¼Œæˆ‘ä»¬éƒ½ä¸æ¨èä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦ç»ˆç«¯ã€‚æ— è®ºæ˜¯å¯æ‹“å±•æ€§è¿˜æ˜¯å¯ç¼–ç¨‹æ€§éƒ½è¢«ã€Œç³»ç»Ÿè‡ªå¸¦ã€è¿™æ ·çš„ç‰¹ç‚¹é™åˆ¶ã€‚ç‰¹åˆ«æ˜¯ &lt;code&gt;Windows&lt;/code&gt; ä¸‹çš„ä¸‡æ¶ä¹‹æºã€Œå°é»‘æ¡†ã€ï¼Œåœ¨ 9012 å¹´çœŸçš„æ˜¯ä¸å¤ªå¥½ç”¨å“Ÿï¼&lt;/p&gt;
&lt;p&gt;ä»Šå¤©æˆ‘ä»¬å°†ç»™å¤§å®¶ä»‹ç»ä¸€æ¬¾åŸºäº &lt;code&gt;Electron&lt;/code&gt; çš„å…¨å¹³å°é«˜é¢œå€¼çš„ç»ˆç«¯å·¥å…· &lt;code&gt;Hyper&lt;/code&gt;ã€‚&lt;code&gt;Hyper&lt;/code&gt; æ”¯æŒä¸°å¯Œçš„ä¸»é¢˜å’Œæ’ä»¶åŠŸèƒ½ï¼Œé€šè¿‡å¼ºå¤§çš„æ’ä»¶ç³»ç»Ÿæä¾›äº†éå¸¸ä¸°å¯Œçš„è‡ªå®šä¹‰é€‰é¡¹ï¼Œå¯è°“æ˜¯é¢œå€¼å’Œæ˜“ç”¨å¹¶å­˜çš„ç¥å™¨ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å®˜ç½‘åœ°å€ï¼š&lt;a href=&quot;https://hyper.is&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://hyper.is&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸‹é¢å…ˆæ”¾ä¸€å¼ é…ç½®å¥½çš„é¢„è§ˆæ•ˆæœå›¾ï¼Œè®©å¤§å®¶å…ˆç¹ä¸ºå¿«ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://img.fythonfang.com/MacScreenShot%202018-07-20-5-35-35.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;ç”±äº &lt;code&gt;Hyper&lt;/code&gt; æ˜¯åŸºäº &lt;code&gt;Electron&lt;/code&gt; çš„ï¼Œæ‰€ä»¥å®ƒçš„æ’ä»¶ã€ä¸»é¢˜ç­‰ç­‰å¯æ‹“å±•æ€§éƒ½éå¸¸å¼ºå¤§ã€‚å‡ è¡Œç®€å•çš„ &lt;code&gt;Javascript&lt;/code&gt;ã€&lt;code&gt;HTML&lt;/code&gt;ã€ &lt;code&gt;CSS&lt;/code&gt; ä»£ç ï¼Œä½ å°±å¯ä»¥å®šåˆ¶è‡ªå·±çš„æ’ä»¶ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;Electron&lt;/code&gt; æ˜¯ä¸€ä¸ªåˆ©ç”¨æœ€æ–° &lt;code&gt;Web&lt;/code&gt; æŠ€æœ¯æ ˆæ­å»ºè·¨å¹³å°åº”ç”¨çš„é¡¹ç›®ï¼Œæ¯”å¦‚: &lt;code&gt;GitHub&lt;/code&gt; å‡ºå“çš„ä»£ç ç¼–è¾‘å™¨ &lt;code&gt;Atom&lt;/code&gt; å’Œå¾®è½¯å‡ºå“çš„ &lt;code&gt;VSCode&lt;/code&gt; éƒ½æ˜¯åŸºäº &lt;code&gt;Electron&lt;/code&gt; çš„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;å®‰è£…-Hyper&quot;&gt;å®‰è£… Hyper&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Hyper&lt;/code&gt; çš„å®‰è£…éå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨å®˜ç½‘ä¸‹è½½å¯¹åº”å¹³å°äºŒè¿›åˆ¶å®‰è£…åŒ…åï¼Œç›´æ¥å®‰è£…å°±å¯ä»¥è¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.sspai.com/editor/u_735639/media/15651037049805/15651047302326.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æ˜¯ &lt;code&gt;macOS&lt;/code&gt; å¹³å°ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡ &lt;code&gt;Homebrew&lt;/code&gt; å‘½ä»¤æ¥å¿«é€Ÿå®Œæˆå®‰è£…ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ brew cask install hyper&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¦‚æœä½ è¿˜ä¸çŸ¥é“ &lt;code&gt;Homebrew&lt;/code&gt; å¦‚ä½•å®‰è£…å’Œä½¿ç”¨å¯ä»¥å‚è€ƒ â€‹&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzI3MTI2NzkxMA==&amp;amp;mid=2247484646&amp;amp;idx=1&amp;amp;sn=f73feedee278c03c6c2d138154f822fb&amp;amp;chksm=eac525cfddb2acd964c163f6020cc1c385abc8f0680cc6086881a8093b73511db31c34e3e3fc&amp;amp;token=985021721&amp;amp;lang=zh_CN#rd&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ã€ŒmacOS ä¸å¯æˆ–ç¼ºçš„å¥—ä»¶ç®¡ç†å™¨â€”â€”Homebrewã€&lt;/a&gt; å’Œ  â€‹&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzI3MTI2NzkxMA==&amp;amp;mid=2247484672&amp;amp;idx=1&amp;amp;sn=55dc5a5b3283fe618124684d9b683a17&amp;amp;chksm=eac52429ddb2ad3fba77229c3ffbe4c3e3cf7b6477fbc08a43232e0c67bdc367be3a293f04d5&amp;amp;token=985021721&amp;amp;lang=zh_CN#rd&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ã€ŒmacOSå°æŠ€å·§ â€”â€” å¦‚ä½•ç”¨ Homebrew å®‰è£…æŒ‡å®šç‰ˆæœ¬è½¯ä»¶ã€&lt;/a&gt; ä¸¤ç¯‡æ–‡ç« å…ˆäº†è§£ä¸‹ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/categories/Linux/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="æŠ€å·§" scheme="https://www.hi-linux.com/tags/%E6%8A%80%E5%B7%A7/"/>
    
      <category term="ç»ˆç«¯" scheme="https://www.hi-linux.com/tags/%E7%BB%88%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>åˆ†äº«ä¸€ä¸ªå¿«é€Ÿè·å– Nginx å®¢æˆ·ç«¯å…¬ç½‘ IP çš„ç¥æŠ€</title>
    <link href="https://www.hi-linux.com/posts/4701.html"/>
    <id>https://www.hi-linux.com/posts/4701.html</id>
    <published>2020-05-11T01:00:00.000Z</published>
    <updated>2020-05-11T04:51:39.272Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><p>æœ¬æ–‡å°†ç»™å¤§å®¶ä»‹ç»ä¸€ä¸ª <code>Nginx</code> çš„å°æŠ€å·§ï¼Œå¯ä»¥åœ¨ä¸ä½¿ç”¨ä»»ä½•ç¼–ç¨‹è¯­è¨€çš„æƒ…å†µä¸‹ï¼Œç›´æ¥è¿”å›å®¢æˆ·ç«¯å…¬ç½‘ <code>IP</code> åœ°å€ã€‚</p><p>å®ç°æ–¹æ³•éå¸¸çš„ç®€å•ï¼Œä½ åªè¦åœ¨ <code>Nginx</code> ä¸­é…ç½®ä»¥ä¸‹å†…å®¹å°±å¯ä»¥è§£å†³é—®é¢˜ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location &#x2F;ip &#123;</span><br><span class="line">    default_type text&#x2F;plain;</span><br><span class="line">    return 200 $remote_addr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>curl</code> å‘½ä»¤æµ‹è¯•ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä»å“åº”ç»“æœå¯ä»¥çœ‹åˆ°åªæ˜¾ç¤ºäº†å®¢æˆ·ç«¯çš„ <code>IP</code> åœ°å€ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl https:&#x2F;&#x2F;example.com&#x2F;ip</span><br><span class="line">2001:1b48:103::189</span><br></pre></td></tr></table></figure><blockquote><p><code>default_type text/plain</code> æŒ‡ä»¤é™¤äº†é˜»æ­¢ <code>Web</code> æµè§ˆå™¨å°è¯•å°†å“åº”ä¸‹è½½ä¸ºæ–‡ä»¶å¤–ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨ä»»ä½•å®ç”¨ç¨‹åºã€‚å³ï¼Œ<code>Web</code> æµè§ˆå™¨å¯ä»¥ç›´æ¥æ˜¾ç¤º <code>IP</code> åœ°å€ã€‚</p></blockquote><a id="more"></a><p>å¦‚æœä½ æƒ³å°†ä»¥ä¸Šç»“æœä»¥ <code>JSON</code> æ ¼å¼è¾“å‡ºï¼Œåªéœ€åšä¸€ç‚¹å°ä¿®æ”¹å³å¯å®ç°ã€‚å…·ä½“æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location &#x2F;json_ip &#123;</span><br><span class="line">    default_type application&#x2F;json;</span><br><span class="line">    return 200 &quot;&#123;\&quot;ip\&quot;:\&quot;$remote_addr\&quot;&#125;&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œå“åº”çš„å°±æ˜¯ä¸€ä¸ªæ¼‚äº®çš„ <code>JSON</code> æ ¼å¼çš„è¾“å‡ºã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ curl -s https:&#x2F;&#x2F;example.com&#x2F;json_ip | jq</span><br><span class="line">&#123;</span><br><span class="line">    &quot;ip&quot;: &quot;2001:1b48:103::189&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œå¿«é€Ÿé€šè¿‡ <code>Nginx</code> è·å–å®¢æˆ·ç«¯å…¬ç½‘ <code>IP</code> åœ°å€çš„å°æŠ€å·§å°±æ¼”ç¤ºå®Œäº†ã€‚å¸Œæœ›è¿™ä¸ª <code>Nginx</code> çš„å°æŠ€å·§å¯ä»¥ä¸ºä½ èŠ‚çœä¸€äº›ç»´æŠ¤æ—¶é—´ã€‚</p><blockquote><p>æœ¬æ–‡ç¿»è¯‘è‡³ï¼š<a href="https://url.cn/5Th0D1e%EF%BC%8C%E7%89%88%E6%9D%83%E5%BD%92%E5%8E%9F%E4%BD%9C%E8%80%85%E6%89%80%E6%9C%89%E3%80%82" target="_blank" rel="noopener">https://url.cn/5Th0D1eï¼Œç‰ˆæƒå½’åŸä½œè€…æ‰€æœ‰ã€‚</a></p></blockquote></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ¬æ–‡å°†ç»™å¤§å®¶ä»‹ç»ä¸€ä¸ª &lt;code&gt;Nginx&lt;/code&gt; çš„å°æŠ€å·§ï¼Œå¯ä»¥åœ¨ä¸ä½¿ç”¨ä»»ä½•ç¼–ç¨‹è¯­è¨€çš„æƒ…å†µä¸‹ï¼Œç›´æ¥è¿”å›å®¢æˆ·ç«¯å…¬ç½‘ &lt;code&gt;IP&lt;/code&gt; åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;å®ç°æ–¹æ³•éå¸¸çš„ç®€å•ï¼Œä½ åªè¦åœ¨ &lt;code&gt;Nginx&lt;/code&gt; ä¸­é…ç½®ä»¥ä¸‹å†…å®¹å°±å¯ä»¥è§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;location &amp;#x2F;ip &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    default_type text&amp;#x2F;plain;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    return 200 $remote_addr;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;curl&lt;/code&gt; å‘½ä»¤æµ‹è¯•ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä»å“åº”ç»“æœå¯ä»¥çœ‹åˆ°åªæ˜¾ç¤ºäº†å®¢æˆ·ç«¯çš„ &lt;code&gt;IP&lt;/code&gt; åœ°å€ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ curl https:&amp;#x2F;&amp;#x2F;example.com&amp;#x2F;ip&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2001:1b48:103::189&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;default_type text/plain&lt;/code&gt; æŒ‡ä»¤é™¤äº†é˜»æ­¢ &lt;code&gt;Web&lt;/code&gt; æµè§ˆå™¨å°è¯•å°†å“åº”ä¸‹è½½ä¸ºæ–‡ä»¶å¤–ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨ä»»ä½•å®ç”¨ç¨‹åºã€‚å³ï¼Œ&lt;code&gt;Web&lt;/code&gt; æµè§ˆå™¨å¯ä»¥ç›´æ¥æ˜¾ç¤º &lt;code&gt;IP&lt;/code&gt; åœ°å€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Nginx" scheme="https://www.hi-linux.com/categories/nginx/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="æŠ€å·§" scheme="https://www.hi-linux.com/tags/%E6%8A%80%E5%B7%A7/"/>
    
      <category term="Nginx" scheme="https://www.hi-linux.com/tags/Nginx/"/>
    
  </entry>
  
  <entry>
    <title>æ¨èä¸€æ¬¾å²ä¸Šæœ€å¼ºè·¨å¹³å°ã€å¤šç«¯åŠ å¯†åŒæ­¥ç¥å™¨ Restic</title>
    <link href="https://www.hi-linux.com/posts/42308.html"/>
    <id>https://www.hi-linux.com/posts/42308.html</id>
    <published>2020-05-11T01:00:00.000Z</published>
    <updated>2020-05-11T04:51:39.273Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><h2 id="ä»€ä¹ˆæ˜¯-restic">ä»€ä¹ˆæ˜¯ Restic</h2><p><code>Restic</code> æ˜¯ä¸€æ¬¾ GO è¯­è¨€å¼€å‘çš„å¼€æºå…è´¹ä¸”å¿«é€Ÿã€é«˜æ•ˆå’Œå®‰å…¨çš„è·¨å¹³å°å¤‡ä»½å·¥å…·ã€‚<code>Restic</code> ä½¿ç”¨åŠ å¯†æŠ€æœ¯æ¥ä¿è¯ä½ çš„æ•°æ®å®‰å…¨æ€§å’Œå®Œæ•´æ€§ï¼Œå¯ä»¥å°†æœ¬åœ°æ•°æ®åŠ å¯†åä¼ è¾“åˆ°æŒ‡å®šçš„å­˜å‚¨ã€‚</p><p><code>Restic</code> åŒæ ·æ”¯æŒå¢é‡å¤‡ä»½ï¼Œå¯éšæ—¶å¤‡ä»½å’Œæ¢å¤å¤‡ä»½ã€‚<code>Restic</code> æ”¯æŒå¤§å¤šæ•°ä¸»æµæ“ä½œç³»ç»Ÿï¼Œæ¯”å¦‚ï¼š<code>Linux</code>ã€<code>macOS</code>ã€<code>Windows</code> ä»¥åŠä¸€äº›è¾ƒå°ä¼—çš„æ“ä½œç³»ç»Ÿ <code>FreeBSD</code> å’Œ <code>OpenBSD</code> ç­‰ã€‚</p><blockquote><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/restic/restic" target="_blank" rel="noopener">https://github.com/restic/restic</a></p></blockquote><p><strong>Restic æ”¯æŒçš„å­˜å‚¨ç±»å‹</strong></p><p><code>Restic</code> æ”¯æŒçš„å­˜å‚¨ç§ç±»æ¯”è¾ƒå¤šï¼Œå¤§è‡´æœ‰å¦‚ä¸‹è¿™äº›ç±»å‹ï¼š</p><ul><li><p>æœ¬åœ°å­˜å‚¨</p></li><li><p>SFTP</p></li><li><p>REST Server</p></li><li><p>Amazon S3</p></li><li><p>Minio Server</p></li><li><p>OpenStack Swift</p></li><li><p>Backblaze B2</p></li><li><p>Microsoft Azure Blob Storage</p></li><li><p>Google Cloud Storage</p></li><li><p>é€šè¿‡ Rclone æŒ‚è½½çš„å­˜å‚¨ (æ¯”å¦‚ï¼šGoogle Driveã€OneDrive ç­‰)</p></li></ul><p><strong>Restic ä¸ Rclone çš„åŒºåˆ«</strong></p><p><code>Restic</code> ä¸ <code>Rclone</code> éƒ½æ˜¯å¼€æºçš„å‘½ä»¤è¡Œæ–‡ä»¶å¤‡ä»½ï¼ˆåŒæ­¥ï¼‰å·¥å…·ï¼Œä½†å´æœ‰ç€å¾ˆæœ¬è´¨çš„åŒºåˆ«ã€‚</p><ol><li>ä¸¤è€…çš„ç›¸åŒç‚¹</li></ol><ul><li><p>ä¸¤è€…éƒ½æ˜¯åŸºäºå‘½ä»¤è¡Œçš„å¼€æºæ–‡ä»¶åŒæ­¥å’Œå¤‡ä»½å·¥å…·ã€‚</p></li><li><p>ä¸¤è€…éƒ½æ”¯æŒå°†æ–‡ä»¶å¤‡ä»½åˆ°æœ¬åœ°ã€è¿œç¨‹æœåŠ¡å™¨æˆ–å¯¹è±¡å­˜å‚¨ã€‚</p></li></ul><ol start="2"><li>ä¸¤è€…ä¸åŒç‚¹</li></ol><ul><li><p>Rclone é¢å‘çš„æ˜¯æ–‡ä»¶åŒæ­¥ï¼Œå³ä¿è¯ä¸¤ç«¯æ–‡ä»¶çš„ä¸€è‡´ï¼Œä¹Ÿå¯ä»¥å¢é‡å¤‡ä»½ã€‚</p></li><li><p>Restic é¢å‘çš„æ˜¯æ–‡ä»¶å¤‡ä»½å’ŒåŠ å¯†ï¼Œæ–‡ä»¶å…ˆåŠ å¯†å†ä¼ è¾“å¤‡ä»½ï¼Œè€Œä¸”æ˜¯å¢é‡å¤‡ä»½ï¼Œå³æ¯æ¬¡åªå¤‡ä»½å˜åŒ–çš„éƒ¨åˆ†ã€‚</p></li><li><p>Rclone ä»“åº“é…ç½®ä¿å­˜åœ¨æœ¬åœ°ï¼Œå¤‡ä»½çš„æ–‡ä»¶ä¼šä¿æŒåŸæ ·çš„åŒæ­¥äºå­˜å‚¨ä»“åº“ä¸­ã€‚</p></li><li><p>Restic é…ç½®ä¿¡æ¯ç›´æ¥å†™åœ¨ä»“åº“ï¼Œåªè¦æœ‰ä»“åº“å¯†ç ï¼Œåœ¨ä»»ä½•å®‰è£…äº† Restic çš„è®¡ç®—æœºä¸Šéƒ½å¯ä»¥æ“ä½œä»“åº“ã€‚</p></li><li><p>Rclone ä¸è®°å½•æ–‡ä»¶ç‰ˆæœ¬ï¼Œæ— æ³•æ ¹æ®æŸä¸€æ¬¡å¤‡ä»½æ‰¾å›ç‰¹å®šæ—¶é—´ç‚¹ä¸Šçš„æ–‡ä»¶ã€‚</p></li><li><p>Restic æ¯æ¬¡å¤‡ä»½éƒ½ä¼šç”Ÿæˆä¸€ä¸ªå¿«ç…§ï¼Œè®°å½•å½“å‰æ—¶é—´ç‚¹çš„æ–‡ä»¶ç»“æ„ï¼Œå¯ä»¥æ‰¾å›ç‰¹å®šæ—¶é—´ç‚¹çš„æ–‡ä»¶ã€‚</p></li><li><p>Rclone å¯ä»¥åœ¨é…ç½®çš„å¤šä¸ªå­˜å‚¨ç«¯ä¹‹é—´ä¼ è¾“æ–‡ä»¶ã€‚</p></li></ul><p>æ€»çš„æ¥è¯´ï¼Œ<code>Rclone</code> å’Œ <code>Restic</code> å„æœ‰æ‰€é•¿ï¼Œè¦æ ¹æ®ä¸åŒçš„ä¸šåŠ¡éœ€æ±‚é€‰æ‹©ä½¿ç”¨ã€‚æ¯”å¦‚ï¼šç½‘ç«™æ•°æ®çš„å¢é‡å¤‡ä»½ï¼Œç”¨ <code>Resitc</code> å°±æ¯”è¾ƒåˆé€‚ã€‚è€Œå¸¸è§„æ–‡ä»¶çš„è¿œç¨‹å¤‡ä»½å½’æ¡£ï¼Œç”¨ <code>Rclone</code> å°±å¾ˆåˆé€‚ã€‚</p><a id="more"></a><h2 id="å®‰è£…-restic">å®‰è£… Restic</h2><p><code>Restic</code> å¯ä»¥é€šè¿‡ç³»ç»Ÿè½¯ä»¶åŒ…å®‰è£…ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä¸‹è½½æœ€æ–°çš„äºŒè¿›åˆ¶åŒ…æ–¹å¼è¿›è¡Œå®‰è£…ã€‚</p><ol><li>é€šè¿‡è½¯ä»¶åŒ…å®‰è£…</li></ol><ul><li>Debian &amp; Ubuntu</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ apt-get install restic</span><br></pre></td></tr></table></figure><ul><li>RHEL &amp; CentOS</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ yum install yum-plugin-copr</span><br><span class="line">$ yum copr enable copart&#x2F;restic</span><br><span class="line">$ yum install restic</span><br></pre></td></tr></table></figure><ul><li>Fedora</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dnf install restic</span><br></pre></td></tr></table></figure><ul><li>Arch Linux</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pacman -S restic</span><br></pre></td></tr></table></figure><ul><li>macOS</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ brew install restic</span><br></pre></td></tr></table></figure><p>æ›´å¤šå¹³å°çš„è½¯ä»¶åŒ…å®‰è£…æ–¹æ³•å¯å‚è§å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://restic.readthedocs.io/en/stable/020_installation.html" target="_blank" rel="noopener">https://restic.readthedocs.io/en/stable/020_installation.html</a></p><ol start="2"><li>é€šè¿‡äºŒè¿›åˆ¶ç‰ˆæœ¬å®‰è£…</li></ol><p>é€šè¿‡é¢„ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶ç‰ˆæœ¬è¿›è¡Œå®‰è£…ï¼Œéå¸¸çš„ç®€å•ã€‚åªè¦æ ¹æ®è‡ªå·±æ‰€éœ€çš„å¹³å°é€‰æ‹©å¯¹åº”çš„ç‰ˆæœ¬ä¸‹è½½å³å¯ï¼Œè¿™é‡Œä»¥ <code>Linux</code> ç³»ç»Ÿä¸ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># ä¸‹è½½æŒ‡å®šç‰ˆæœ¬çš„å®‰è£…åŒ…</span><br><span class="line">$ wget https:&#x2F;&#x2F;github.com&#x2F;restic&#x2F;restic&#x2F;releases&#x2F;download&#x2F;v0.9.5&#x2F;restic_0.9.5_linux_amd64.bz2</span><br><span class="line"></span><br><span class="line"># è§£å‹å¹¶åˆ é™¤å‹ç¼©åŒ…</span><br><span class="line">$ bzip2 -d restic*.bz2 &amp;&amp; rm -rf restic*.bz2</span><br><span class="line"></span><br><span class="line"># å¢åŠ æ‰§è¡Œæƒé™</span><br><span class="line">$ chmod +x restic*</span><br><span class="line"></span><br><span class="line"># ç§»åŠ¨äºŒè¿›åˆ¶æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•</span><br><span class="line">$ mv restic* &#x2F;usr&#x2F;local&#x2F;bin&#x2F;restic</span><br><span class="line"></span><br><span class="line"># éªŒè¯æ‰€å®‰è£…çš„ç‰ˆæœ¬</span><br><span class="line">$ restic version</span><br></pre></td></tr></table></figure><p>å¦‚æœä»¥åéœ€è¦æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œåªéœ€è¿è¡Œä»¥ä¸‹å‘½ä»¤å°±å¯å®Œæˆã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ç›´æ¥å‡çº§äºŒè¿›åˆ¶æ–‡ä»¶åˆ°æœ€æ–°ç‰ˆæœ¬</span><br><span class="line">$ restic self-update</span><br></pre></td></tr></table></figure><ol start="3"><li>Restic å¸¸ç”¨è¯­æ³•å‘½ä»¤</li></ol><p><code>Restic</code> æ”¯æŒçš„å‘½ä»¤å’Œå‚æ•°æ¯”è¾ƒå¤šï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>--help</code> å‚æ•°æ¥æŸ¥çœ‹å®ƒä»¬çš„åŸºæœ¬ç”¨æ³•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">$ restic --help</span><br><span class="line">restic is a backup program which allows saving multiple revisions of files and</span><br><span class="line">directories in an encrypted repository stored on different backends.</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  restic [command]</span><br><span class="line"></span><br><span class="line">Available Commands:</span><br><span class="line">  backup        Create a new backup of files and&#x2F;or directories</span><br><span class="line">  cache         Operate on local cache directories</span><br><span class="line">  cat           Print internal objects to stdout</span><br><span class="line">  check         Check the repository for errors</span><br><span class="line">  diff          Show differences between two snapshots</span><br><span class="line">  dump          Print a backed-up file to stdout</span><br><span class="line">  find          Find a file or directory</span><br><span class="line">  forget        Remove snapshots from the repository</span><br><span class="line">  generate      Generate manual pages and auto-completion files (bash, zsh)</span><br><span class="line">  help          Help about any command</span><br><span class="line">  init          Initialize a new repository</span><br><span class="line">  key           Manage keys (passwords)</span><br><span class="line">  list          List objects in the repository</span><br><span class="line">  ls            List files in a snapshot</span><br><span class="line">  migrate       Apply migrations</span><br><span class="line">  mount         Mount the repository</span><br><span class="line">  prune         Remove unneeded data from the repository</span><br><span class="line">  rebuild-index Build a new index file</span><br><span class="line">  restore       Extract the data from a snapshot</span><br><span class="line">  snapshots     List all snapshots</span><br><span class="line">  stats         Count up sizes and show information about repository data</span><br><span class="line">  tag           Modify tags on snapshots</span><br><span class="line">  unlock        Remove locks other processes created</span><br><span class="line">  version       Print version information</span><br><span class="line"></span><br><span class="line">Flags:</span><br><span class="line">      --cacert file              file to load root certificates from (default: use system certificates)</span><br><span class="line">      --cache-dir string         set the cache directory. (default: use system default cache directory)</span><br><span class="line">      --cleanup-cache            auto remove old cache directories</span><br><span class="line">  -h, --help                     help for restic</span><br><span class="line">      --json                     set output mode to JSON for commands that support it</span><br><span class="line">      --key-hint string          key ID of key to try decrypting first (default: $RESTIC_KEY_HINT)</span><br><span class="line">      --limit-download int       limits downloads to a maximum rate in KiB&#x2F;s. (default: unlimited)</span><br><span class="line">      --limit-upload int         limits uploads to a maximum rate in KiB&#x2F;s. (default: unlimited)</span><br><span class="line">      --no-cache                 do not use a local cache</span><br><span class="line">      --no-lock                  do not lock the repo, this allows some operations on read-only repos</span><br><span class="line">  -o, --option key&#x3D;value         set extended option (key&#x3D;value, can be specified multiple times)</span><br><span class="line">  -p, --password-file string     read the repository password from a file (default: $RESTIC_PASSWORD_FILE)</span><br><span class="line">  -q, --quiet                    do not output comprehensive progress report</span><br><span class="line">  -r, --repo string              repository to backup to or restore from (default: $RESTIC_REPOSITORY)</span><br><span class="line">      --tls-client-cert string   path to a file containing PEM encoded TLS client certificate and private key</span><br><span class="line">  -v, --verbose n[&#x3D;-1]           be verbose (specify --verbose multiple times or level n)</span><br><span class="line"></span><br><span class="line">Use &quot;restic [command] --help&quot; for more information about a command.</span><br></pre></td></tr></table></figure><p>ä¸ <code>Git</code> ç­‰ç¨‹åºç±»ä¼¼ <code>Restic</code> æœ‰è®¸å¤šå­å‘½ä»¤ï¼Œæ¯ä¸ªå­å‘½ä»¤éƒ½æœ‰è‡ªå·±çš„å‘½ä»¤è¡Œé€‰é¡¹ã€‚å¦‚æœä½ è¦åˆ—å‡ºæ¯ä¸ªå­å‘½ä»¤çš„å¸®åŠ©é€‰é¡¹ï¼Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼ä¸‹é¢çš„å‘½ä»¤è¯­æ³•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"># ä»¥å¤‡ä»½å­å‘½ä»¤ä¸ºä¾‹</span><br><span class="line">$ restic backup --help</span><br><span class="line">The &quot;backup&quot; command creates a new snapshot and saves the files and directories</span><br><span class="line">given as the arguments.</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  restic backup [flags] FILE&#x2F;DIR [FILE&#x2F;DIR] ...</span><br><span class="line"></span><br><span class="line">Flags:</span><br><span class="line">  -e, --exclude pattern                  exclude a pattern (can be specified multiple times)</span><br><span class="line">      --exclude-caches                   excludes cache directories that are marked with a CACHEDIR.TAG file. See http:&#x2F;&#x2F;bford.info&#x2F;cachedir&#x2F;spec.html for the Cache Directory Tagging Standard</span><br><span class="line">      --exclude-file file                read exclude patterns from a file (can be specified multiple times)</span><br><span class="line">      --exclude-if-present stringArray   takes filename[:header], exclude contents of directories containing filename (except filename itself) if header of that file is as provided (can be specified multiple times)</span><br><span class="line">      --files-from string                read the files to backup from file (can be combined with file args&#x2F;can be specified multiple times)</span><br><span class="line">  -f, --force                            force re-reading the target files&#x2F;directories (overrides the &quot;parent&quot; flag)</span><br><span class="line">  -h, --help                             help for backup</span><br><span class="line">      --hostname hostname                set the hostname for the snapshot manually. To prevent an expensive rescan use the &quot;parent&quot; flag</span><br><span class="line">  -x, --one-file-system                  exclude other file systems</span><br><span class="line">      --parent string                    use this parent snapshot (default: last snapshot in the repo that has the same target files&#x2F;directories)</span><br><span class="line">      --stdin                            read backup from stdin</span><br><span class="line">      --stdin-filename string            file name to use when reading from stdin (default &quot;stdin&quot;)</span><br><span class="line">      --tag tag                          add a tag for the new snapshot (can be specified multiple times)</span><br><span class="line">      --time string                      time of the backup (ex. &#39;2012-11-01 22:08:41&#39;) (default: now)</span><br><span class="line">      --with-atime                       store the atime for all files and directories</span><br><span class="line"></span><br><span class="line">Global Flags:</span><br><span class="line">      --cacert file              file to load root certificates from (default: use system certificates)</span><br><span class="line">      --cache-dir string         set the cache directory. (default: use system default cache directory)</span><br><span class="line">      --cleanup-cache            auto remove old cache directories</span><br><span class="line">      --json                     set output mode to JSON for commands that support it</span><br><span class="line">      --key-hint string          key ID of key to try decrypting first (default: $RESTIC_KEY_HINT)</span><br><span class="line">      --limit-download int       limits downloads to a maximum rate in KiB&#x2F;s. (default: unlimited)</span><br><span class="line">      --limit-upload int         limits uploads to a maximum rate in KiB&#x2F;s. (default: unlimited)</span><br><span class="line">      --no-cache                 do not use a local cache</span><br><span class="line">      --no-lock                  do not lock the repo, this allows some operations on read-only repos</span><br><span class="line">  -o, --option key&#x3D;value         set extended option (key&#x3D;value, can be specified multiple times)</span><br><span class="line">  -p, --password-file string     read the repository password from a file (default: $RESTIC_PASSWORD_FILE)</span><br><span class="line">  -q, --quiet                    do not output comprehensive progress report</span><br><span class="line">  -r, --repo string              repository to backup to or restore from (default: $RESTIC_REPOSITORY)</span><br><span class="line">      --tls-client-cert string   path to a file containing PEM encoded TLS client certificate and private key</span><br><span class="line">  -v, --verbose n[&#x3D;-1]           be verbose (specify --verbose multiple times or level n)</span><br></pre></td></tr></table></figure><h2 id="é…ç½®-restic-æ”¯æŒçš„å­˜å‚¨æ–¹å¼">é…ç½® Restic æ”¯æŒçš„å­˜å‚¨æ–¹å¼</h2><p>å®‰è£…å¥½ <code>Restic</code> åï¼Œæˆ‘ä»¬éœ€è¦é…ç½®ä¸‹å­˜å‚¨æ–¹å¼ã€‚ä¹Ÿå°±æ˜¯ä½ æƒ³å¤‡ä»½æ•°æ®åˆ°æœ¬åœ°ï¼Œè¿˜æ˜¯å…¶å®ƒè¿œç¨‹æœåŠ¡ä¸Šã€‚</p><p>æœ¬æ–‡å°†ä¸»è¦è®²è®²æœ€å¸¸ç”¨çš„æœ¬åœ°ã€SFTP ä¸¤ç§å¤‡ä»½æ–¹å¼ï¼Œå…¶å®ƒè¿œç¨‹åº“é…ç½®æ–¹æ³•å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://restic.readthedocs.io/en/stable/030_preparing_a_new_repo.html" target="_blank" rel="noopener">https://restic.readthedocs.io/en/stable/030_preparing_a_new_repo.html</a> ã€‚</p><ol><li>é…ç½®æœ¬åœ°å­˜å‚¨ä»“åº“</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># å¤‡ä»½åˆ°æœ¬åœ° &#x2F;home&#x2F;mike&#x2F;backup æ–‡ä»¶å¤¹</span><br><span class="line">$ restic init --repo &#x2F;home&#x2F;mike&#x2F;backup</span><br></pre></td></tr></table></figure><ol start="2"><li>é…ç½® SFTP æ–¹å¼çš„å­˜å‚¨ä»“åº“</li></ol><p>è¯¥æ–¹æ³•é€‚åˆå°†æ–‡ä»¶å¤‡ä»½åˆ°å¦ä¸€å°æœåŠ¡å™¨ä¸Šã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸¤å°æœåŠ¡å™¨é—´é…ç½®å…å¯†ç ç™»å½•ã€‚</p><blockquote><p>æ³¨æ„ï¼šä»¥ä¸‹å°†éœ€è¦å¤‡ä»½çš„æœåŠ¡å™¨ç§°ä¸º Aï¼Œå¤‡ä»½æœåŠ¡å™¨ç§°ä¸º Bã€‚</p></blockquote><p>2.1 é…ç½® SSH å…å¯†ç ç™»å½•</p><p>è¿™éƒ¨åˆ†å†…å®¹æ¯”è¾ƒåŸºç¡€ï¼Œå°±ä¸åœ¨è¿™é‡Œå±•å¼€äº†ã€‚å¦‚æœä½ ä¸ä¼šé…ç½®å¯ä»¥å‚è€ƒä»¥ä¸‹ä¸¤ç¯‡æ–‡ç« ï¼š</p><ul><li><p>ã€ŒCentOS ä¸‹é…ç½® SSH å…å¯†ç ç™»å½•ã€ï¼š<a href="https://zhuanlan.zhihu.com/p/45025702" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/45025702</a></p></li><li><p>ã€ŒSSH å’Œ ssh-copy-id ä»¥åŠæ‰¹é‡å¤šæœºæ— å¯†ç ç™»é™†è¯¦è§£ã€: <a href="https://www.cnblogs.com/operationhome/p/9166583.html" target="_blank" rel="noopener">https://www.cnblogs.com/operationhome/p/9166583.html</a></p></li></ul><p>2.2 åœ¨æœåŠ¡å™¨ A ä¸Šè¿›è¡Œæ•°æ®å¤‡ä»½</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># root ä¸ºæœåŠ¡å™¨ B çš„ç”¨æˆ·åï¼Œ192.168.1.100 ä¸º B æœåŠ¡å™¨ IPï¼Œç«¯å£é»˜è®¤ä¸º 22ï¼Œ&#x2F;home&#x2F;mike&#x2F;backup ä¸ºæœåŠ¡å™¨ B ä¸Šçš„ç›®å½•ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä¼šè‡ªåŠ¨åˆ›å»ºã€‚</span><br><span class="line">$ restic -r sftp:root@192.168.1.100:&#x2F;home&#x2F;mike&#x2F;backup init</span><br></pre></td></tr></table></figure><p>å¦‚æœæœåŠ¡å™¨ B çš„ <code>SSH</code> é»˜è®¤ç«¯å£ä¸æ˜¯ 22ï¼Œä½ å°±éœ€è¦ç®€å•è°ƒæ•´ä¸‹ A æœåŠ¡å™¨ä¸Šçš„ <code>SSH</code> é…ç½®æ–‡ä»¶ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># åœ¨æœåŠ¡å™¨ A ä¸­ ~&#x2F;.ssh ç›®å½•åˆ›å»ºä¸€ä¸ª config æ–‡ä»¶ï¼Œå¹¶æ–°å¢å¦‚ä¸‹å†…å®¹ã€‚</span><br><span class="line"># åˆ†åˆ«æ˜¯ B æœåŠ¡å™¨çš„ IPã€ç”¨æˆ·åå’Œ SSH çš„ç«¯å£ã€‚</span><br><span class="line">$ vim ~&#x2F;.ssh&#x2F;config</span><br><span class="line">Host 192.168.1.100</span><br><span class="line">    User root</span><br><span class="line">    Port 2000</span><br></pre></td></tr></table></figure><p>ç”±äºä¸Šé¢é…ç½®äº†é»˜è®¤çš„ B æœåŠ¡å™¨çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œç°åœ¨å°±å¯ä»¥ç›´æ¥åªå†™ B æœåŠ¡å™¨çš„ IP å°±å¯ä»¥äº†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ restic -r sftp:192.168.1.100:&#x2F;home&#x2F;mike&#x2F;backup init</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šä»¥ä¸Šé…ç½®è¿‡ç¨‹ä¸­éƒ½ä¼šè¦æ±‚ä½ è¾“å…¥å¯†ç ï¼Œåˆ‡è®°ä¸è¦é—å¿˜ã€‚</p></blockquote><h2 id="ä½¿ç”¨-restic-å¤‡ä»½æ•°æ®">ä½¿ç”¨ Restic å¤‡ä»½æ•°æ®</h2><p>ç»è¿‡ä¸Šé¢çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†å¤‡ä»½å­˜å‚¨çš„åˆå§‹åŒ–ã€‚ç°åœ¨æˆ‘å°±æ¥çœ‹å‡ ä¸ª <code>Restic</code> å¤‡ä»½çš„ä¾‹å­ã€‚</p><p>ä»¥ä¸‹æˆ‘ä»¬æ‰€æœ‰æ¼”ç¤ºçš„ä¾‹å­å‡æ˜¯å°† A æœåŠ¡å™¨ä¸Š <code>/var/www/</code> ç›®å½•ä¸‹çš„æ–‡ä»¶å¤‡ä»½åˆ° B æœåŠ¡å™¨ä¸Šçš„ <code>/home/mike/backup</code> ç›®å½•ä¸‹ã€‚</p><h3 id="åˆ›å»ºå¤‡ä»½å¿«ç…§">åˆ›å»ºå¤‡ä»½å¿«ç…§</h3><p>ä»¥ä¸‹å‘½ä»¤æ˜¯å¤‡ä»½çš„ <code>/var/www</code> æ•´ä¸ªç›®å½•ï¼Œå¦‚æœåªéœ€å¤‡ä»½ç›®å½•ä¸­å•ä¸ªæ–‡ä»¶ï¼Œæ¯”å¦‚ï¼š<code>/var/www/mike.zip</code>ï¼Œé‚£å¤‡ä»½å†…å®¹å°±å¯ä»¥æ”¹æˆ <code>/var/www/mike.zip</code> ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># æœ¬åœ°å¤‡ä»½</span><br><span class="line">$ restic -r &#x2F;home&#x2F;mike&#x2F;backup --verbose backup &#x2F;var&#x2F;www</span><br><span class="line"></span><br><span class="line"># SFTP å¤‡ä»½</span><br><span class="line">$ restic -r sftp:192.168.1.100:&#x2F;home&#x2F;mike&#x2F;backup --verbose backup &#x2F;var&#x2F;www</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ ä¸æƒ³å¤‡ä»½ç›®å½•ä¸‹å…¨éƒ¨çš„å†…å®¹ï¼Œä½ è¿˜å¯ä»¥ç”¨ä»¥ä¸‹å‚æ•°æ’é™¤æˆ–åŒ…å«æŒ‡å®šçš„å¤‡ä»½ç›®å½•æˆ–è€…æ–‡ä»¶ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--include æŒ‡å®šä¸€æ¬¡æˆ–å¤šæ¬¡ä»¥åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªç›®å½•æˆ–æ–‡ä»¶</span><br><span class="line">--exclude æŒ‡å®šä¸€æ¬¡æˆ–å¤šæ¬¡ä»¥æ’é™¤ä¸€ä¸ªæˆ–å¤šä¸ªç›®å½•æˆ–æ–‡ä»¶</span><br><span class="line">--exclude-caches æŒ‡å®šä¸€æ¬¡ä»¥æ’é™¤åŒ…å«ç‰¹æ®Šæ–‡ä»¶çš„ç›®å½•</span><br><span class="line">--exclude-file æŒ‡å®šä¸€æ¬¡æˆ–å¤šæ¬¡ä»¥æ’é™¤ç»™å®šæ–‡ä»¶ä¸­åˆ—å‡ºçš„é¡¹ç›®</span><br><span class="line">--exclude-if-present å¦‚æœç›®å½•å†…å®¹åŒ…å«ç»™å®šæ–‡ä»¶ï¼Œåˆ™æŒ‡å®šä¸€æ¬¡æˆ–å¤šæ¬¡æ’é™¤ç›®å½•çš„å†…å®¹</span><br></pre></td></tr></table></figure><p>å…·ä½“ç”¨æ³•å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£: <a href="https://restic.readthedocs.io/en/stable/040_backup.html#including-and-excluding-files" target="_blank" rel="noopener">https://restic.readthedocs.io/en/stable/040_backup.html#including-and-excluding-files</a></p><p><code>Restic</code> è¿˜æ”¯æŒç›´æ¥å°†å‘½ä»¤çš„è¾“å‡ºè¿›è¡Œé‡å®šå‘ï¼Œæ¯”å¦‚ï¼šå°†å¤‡ä»½å¥½çš„æ•°æ®åº“æ–‡ä»¶ç›´æ¥é€šè¿‡ <code>SFTP</code> æ–¹å¼å¤‡ä»½åˆ°å¦ä¸€å°æœåŠ¡å™¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># å°† Wordpress æ•°æ®åº“å¤‡ä»½åˆ°å¦ä¸€å°æœåŠ¡å™¨ï¼Œå¹¶å‘½åä¸º Wordpress_Backup.sql</span><br><span class="line">$ mysqldump -uroot -ppasswd 000000 --databases Wordpress | restic -r sftp:192.168.1.100:&#x2F;home&#x2F;mike&#x2F;backup backup --stdin --stdin-filename Wordpress_Backup.sql</span><br></pre></td></tr></table></figure><h3 id="åˆ—å‡ºå¤‡ä»½å¿«ç…§">åˆ—å‡ºå¤‡ä»½å¿«ç…§</h3><p>å¤‡ä»½å®Œæˆåï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å¤‡ä»½çš„å¿«ç…§ä¿¡æ¯ã€‚æ‚¨å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åœ¨ç¬¬ä¸€æ¬¡å¤‡ä»½æœŸé—´çš„å¿«ç…§ IDï¼Œæ‹æ‘„å¿«ç…§çš„æ—¶é—´æˆ³ï¼Œä¸»æœºåï¼Œæ ‡ç­¾ä»¥åŠå¤‡ä»½çš„ç›®å½•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹æ‰€æœ‰å¤‡ä»½å¿«ç…§</span><br><span class="line"></span><br><span class="line">$ restic -r sftp:192.168.1.100:&#x2F;home&#x2F;mike&#x2F;backup snapshots</span><br><span class="line">ID        Time                 Host        Tags              Paths</span><br><span class="line">---------------------------------------------------------------------</span><br><span class="line">ef5ff5fe  2019-08-25 17:03:57  Mike-Dev01                          &#x2F;home&#x2F;mike&#x2F;backup</span><br><span class="line">9f0bc19e  2019-08-26 17:18:57  Mike-Dev02                          &#x2F;home&#x2F;devops&#x2F;backup</span><br><span class="line">---------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"># åªæŸ¥çœ‹ &#x2F;home&#x2F;mike&#x2F;backup ç›®å½•çš„å¤‡ä»½å¿«ç…§</span><br><span class="line">$ restic -r sftp:192.168.1.100:&#x2F;home&#x2F;mike&#x2F;backup snapshots --path&#x3D;&quot;&#x2F;home&#x2F;mike&#x2F;backup&quot;</span><br><span class="line">ID        Time                 Host        Tags              Paths</span><br><span class="line">---------------------------------------------------------------------</span><br><span class="line">ef5ff5fe  2019-08-25 17:03:57  Mike-Dev01                          &#x2F;home&#x2F;mike&#x2F;backup</span><br><span class="line">---------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"># åªæŸ¥çœ‹ä¸»æœºåä¸º Mike-Dev01 çš„å¤‡ä»½å¿«ç…§</span><br><span class="line">$ restic -r sftp:192.168.1.100:&#x2F;home&#x2F;mike&#x2F;backup snapshots --host Mike-Dev01</span><br><span class="line">ID        Time                 Host        Tags              Paths</span><br><span class="line">---------------------------------------------------------------------</span><br><span class="line">ef5ff5fe  2019-08-25 17:03:57  Mike-Dev01                          &#x2F;home&#x2F;mike&#x2F;backup</span><br><span class="line">---------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line"># åˆ—å‡ºæŸä¸ªå¿«ç…§ä¸­æ‰€åŒ…å«çš„æ–‡ä»¶</span><br><span class="line">$ restic ls ef5ff5fe</span><br><span class="line">snapshot ef5ff5fe of [&#x2F;home&#x2F;mike&#x2F;backup] at 2019-08-25 20:35:39.450146467 +0800 CST):</span><br><span class="line">&#x2F;backup</span><br><span class="line">&#x2F;backup&#x2F;2019-04-19_2004334933.jpg</span><br><span class="line">&#x2F;backup&#x2F;2019-04-13_15-00-15.png</span><br><span class="line">&#x2F;backup&#x2F;2019-04-16_15-19-39.png</span><br><span class="line">&#x2F;backup&#x2F;2019-04-16_15-20-22.png</span><br><span class="line">&#x2F;backup&#x2F;2019-04-18_17-11-52.png</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>Tags</code> åˆ—æ˜¯ç©ºçš„ã€‚è¿™æ˜¯å› ä¸ºå¤‡ä»½æ—¶æ²¡æœ‰ä½¿ç”¨ <code>--tag</code> å‚æ•°ï¼Œä¸‹é¢æˆ‘ä»¬æ¼”ç¤ºä¸‹ <code>--tag</code> å‚æ•°çš„ä½¿ç”¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ç»™å¤‡ä»½æ–‡ä»¶æŒ‡å®šæ ‡ç­¾</span><br><span class="line">$ restic -r sftp:192.168.1.100:&#x2F;home&#x2F;mike&#x2F;backup --verbose backup &#x2F;var&#x2F;www --tag site</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ æƒ³åŠ å…¥æ›´å¤šæ ‡ç­¾æ¥æ›´è¯¦ç»†çš„åŒºåˆ†å¤‡ä»½ï¼Œé‚£å°±åœ¨åé¢å¤šåŠ å‡ ä¸ª <code>--tag</code> å‚æ•°ã€‚</p><h3 id="æ¢å¤å¤‡ä»½å¿«ç…§">æ¢å¤å¤‡ä»½å¿«ç…§</h3><p>è¿™é‡Œä»¥ <code>SFTP</code> å­˜å‚¨ä»“åº“ä¸ºä¾‹ï¼Œæˆ‘ä»¬å°†è¿œç¨‹å­˜å‚¨ç›®å½• <code>/home/mike/backup</code> çš„å¤‡ä»½æ–‡ä»¶æ¢å¤åˆ°æœ¬åœ° <code>/var/wwww</code> æ–‡ä»¶å¤¹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># restore åé¢æŒ‡å®šä¸ºè¦æ¢å¤å¤‡ä»½çš„ ID</span><br><span class="line">$ restic -r sftp:root@192.168.1.100:&#x2F;home&#x2F;mike&#x2F;backup restore ef5ff5fe --target &#x2F;var&#x2F;wwww</span><br><span class="line"></span><br><span class="line"># ä½ ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ latest æ¥æ¢å¤æœ€åä¸€æ¬¡çš„å¤‡ä»½æ–‡ä»¶</span><br><span class="line">$ restic -r sftp:root@192.168.1.100:&#x2F;home&#x2F;mike&#x2F;backup restore latest --target &#x2F;var&#x2F;wwww</span><br></pre></td></tr></table></figure><h3 id="åˆ é™¤å¤‡ä»½å¿«ç…§">åˆ é™¤å¤‡ä»½å¿«ç…§</h3><p>å¦‚æœä½ ä¸åœ¨å†è¦ä¸€äº›å¤‡ä»½å¿«ç…§ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤åˆ é™¤æŒ‡å®šçš„å¤‡ä»½å¿«ç…§ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ef5ff5fe ä¸ºè¦åˆ é™¤æ–‡ä»¶çš„ ID</span><br><span class="line">$ restic -r sftp:root@192.168.1.100:&#x2F;home&#x2F;mike&#x2F;backup forget ef5ff5fe</span><br></pre></td></tr></table></figure><p>ä¸è¿‡ä¸Šé¢çš„å‘½ä»¤åªæ˜¯å°†å¿«ç…§è®°å½•æ¸…é™¤äº†ï¼Œä½†å¿«ç…§ä¸­åŒ…å«çš„æ–‡ä»¶æ•°æ®ä»å­˜å‚¨åœ¨å­˜å‚¨åº“ä¸­ã€‚å¦‚æœè¦å½»åº•æ¸…é™¤æœªå¼•ç”¨çš„æ•°æ®ï¼Œä½ å¿…é¡»è¿è¡Œ <code>prune</code> å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ restic -r sftp:root@192.168.1.100:&#x2F;home&#x2F;mike&#x2F;backup prune</span><br><span class="line">enter password for repository:</span><br><span class="line"></span><br><span class="line">counting files in repo</span><br><span class="line">building new index for repo</span><br><span class="line">[0:00] 100.00%  22 &#x2F; 22 files</span><br><span class="line">repository contains 22 packs (8512 blobs) with 100.092 MiB bytes</span><br><span class="line">processed 8512 blobs: 0 duplicate blobs, 0B duplicate</span><br><span class="line">load all snapshots</span><br><span class="line">find data that is still in use for 1 snapshots</span><br><span class="line">[0:00] 100.00%  1 &#x2F; 1 snapshots</span><br><span class="line">found 8433 of 8512 data blobs still in use</span><br><span class="line">will rewrite 3 packs</span><br><span class="line">creating new index</span><br><span class="line">[0:00] 86.36%  19 &#x2F; 22 files</span><br><span class="line">saved new index as 544a5084</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p>æ¸…ç†å®Œæˆåï¼Œå­˜å‚¨åº“çš„ç©ºé—´å°±ä¼šé‡Šæ”¾å‡ºæ¥ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>--prune</code> å‚æ•°æ¥å°†ä¸Šé¢ä¸¤æ­¥åˆæˆä¸ºä¸€æ­¥ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ef5ff5fe ä¸ºè¦åˆ é™¤æ–‡ä»¶çš„ ID</span><br><span class="line">$ restic -r sftp:root@192.168.1.100:&#x2F;home&#x2F;mike&#x2F;backup forget ef5ff5fe --prune</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨-restic-è¿›è¡Œè‡ªåŠ¨å¤‡ä»½">ä½¿ç”¨ Restic è¿›è¡Œè‡ªåŠ¨å¤‡ä»½</h2><ol><li>å…å¯†ç æ“ä½œå­˜å‚¨ä»“åº“</li></ol><p>ä¸Šé¢çš„å¤‡ä»½ä¸­æˆ‘ä»¬éƒ½æ‰‹å·¥è¾“å…¥äº†å¯†ç ï¼Œå¦‚æœéœ€è¦å®šæœŸå¤‡ä»½å½“ç„¶æ˜¯é€šè¿‡ä¸€ä¸ªè„šæœ¬æ¥å®ç°æ˜¯æœ€æ–¹ä¾¿ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨è„šæœ¬å¤‡ä»½æ—¶å¦‚æœè¦æ˜¾ç¤ºè¾“å…¥è®¿é—®å­˜å‚¨ä»“åº“çš„å¯†ç è‚¯å®šä¸é€‚ç”¨çš„ã€‚è¿™é‡Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨ <code>--password-file</code> å‚æ•°æ¥è¾¾åˆ°è‡ªåŠ¨è¯»å–å¯†ç çš„ç›®çš„ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># å°†å¯†ç ä¿å­˜åœ¨ &#x2F;home&#x2F;mike&#x2F;resticpasswd æ–‡æœ¬ä¸­</span><br><span class="line">$ echo &#39;000000&#39; &gt; &#x2F;home&#x2F;mike&#x2F;resticpasswd</span><br><span class="line"></span><br><span class="line"># åœ¨å¤‡ä»½å‘½ä»¤ä¸­ä½¿ç”¨ --password-file å‚æ•°æ¥è¯»å–æ–‡æœ¬ä¸­çš„å¯†ç </span><br><span class="line">$ restic -r sftp:root@192.168.1.100:&#x2F;home&#x2F;mike&#x2F;backup --verbose backup &#x2F;var&#x2F;www --password-file &#x2F;home&#x2F;mike&#x2F;resticpasswd</span><br></pre></td></tr></table></figure><p>é™¤äº†ä½¿ç”¨ <code>--password-file</code> å‚æ•°æŒ‡å®šå¯†ç å¤–ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡æ¥æŒ‡å®šä¸€äº› <code>Restic</code> æ‰€éœ€çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨è…¾è®¯äº‘çš„å¯¹è±¡å­˜å‚¨å°±å¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™äº›ç¯å¢ƒå˜é‡ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export TencentCloud_ACCESS_KEY_ID&#x3D;&quot;your-access-key&quot;</span><br><span class="line">export TencentCloud_SECRET_ACCESS_KEY&#x3D;&quot;your-secret-key&quot;</span><br><span class="line">export RESTIC_REPOSITORY&#x3D;&quot;s3:server-url&#x2F;bucket-name&quot;</span><br><span class="line">export RESTIC_PASSWORD&#x3D;&quot;a-strong-password&quot;</span><br></pre></td></tr></table></figure><ol start="2"><li>ç»“åˆ Cron å®Œæˆè‡ªåŠ¨å¤‡ä»½</li></ol><p><code>Restic</code> ä¸­çš„ <code>forget</code> å‘½ä»¤å¯ä»¥å¸®åŠ©ä½ æ¥ç»´æŠ¤å¿«ç…§çš„è¿è¡Œå­˜æ¡£ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>restic forget --prune</code> æ¥è®¾ç½®æ¯å°æ—¶ã€æ¯æ—¥ã€æ¯å‘¨ç­‰ä¿ç•™çš„å¤‡ä»½æ•°é‡ï¼Œä»»ä½•ä¸ç¬¦åˆç­–ç•¥çš„å¤‡ä»½éƒ½å°†ä»å­˜å‚¨åº“ä¸­æ¸…é™¤ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬å°†ä½¿ç”¨ <code>Cron</code> ç³»ç»ŸæœåŠ¡æ¯ 30 åˆ†é’Ÿè¿è¡Œä¸€æ¬¡å¤‡ä»½ä»»åŠ¡ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ crontab -e</span><br><span class="line">30 * * * * &#x2F;usr&#x2F;local&#x2F;bin&#x2F;restic -r sftp:root@192.168.1.100:&#x2F;home&#x2F;mike&#x2F;backup backup --password-file &#x2F;home&#x2F;mike&#x2F;resticpasswd -q &#x2F;var&#x2F;www; &#x2F;usr&#x2F;local&#x2F;bin&#x2F;restic forget -q --prune --keep-hourly 24 --keep-daily 7</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„è®¡åˆ’ä»»åŠ¡é‡Œï¼Œå…¶ä¸­ <code>30 * * * *</code> å®šä¹‰äº† Cron ä¸­ä»»åŠ¡è¿è¡Œçš„æ—¶é—´ï¼Œè¿™é‡Œå®šä¹‰ä¸ºæ¯éš” 30 åˆ†é’Ÿè¿è¡Œã€‚<code>--keep-hourly 24 --keep-daily 7</code> å®šä¹‰äº†æ ¹æ®æŒ‡å®šçš„ä¿ç•™æ ‡å¿—å¹¶åˆ é™¤ä¸å†éœ€è¦çš„æ—§å¿«ç…§ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬æ˜¯å°† 24 å°æ—¶å†…çš„å¿«ç…§ä¿ç•™ 7 å¤©ã€‚</p><p>æ›´å¤šç­–ç•¥å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://restic.readthedocs.io/en/latest/060_forget.html#removing-snapshots-according-to-a-policy" target="_blank" rel="noopener">https://restic.readthedocs.io/en/latest/060_forget.html#removing-snapshots-according-to-a-policy</a></p><h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2><ol><li><p><a href="https://www.google.com" target="_blank" rel="noopener">https://www.google.com</a></p></li><li><p><a href="https://restic.readthedocs.io/en/latest/" target="_blank" rel="noopener">https://restic.readthedocs.io/en/latest/</a></p></li><li><p><a href="https://www.moerats.com/archives/897/" target="_blank" rel="noopener">https://www.moerats.com/archives/897/</a></p></li><li><p><a href="https://cloud.tencent.com/developer/article/1160729" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1160729</a></p></li><li><p><a href="https://it.ismy.fun/2018/04/22/restic-backup-to-aliyun-oss/" target="_blank" rel="noopener">https://it.ismy.fun/2018/04/22/restic-backup-to-aliyun-oss/</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/66324926" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/66324926</a></p></li><li><p><a href="https://www.elasticfeed.com/e8590b1297e81b6e7ab19c66be4f037d/" target="_blank" rel="noopener">https://www.elasticfeed.com/e8590b1297e81b6e7ab19c66be4f037d/</a></p></li><li><p><a href="https://www.vmvps.com/restic-a-new-opensource-backup-free-tool-to-backup-your-vps-files.html" target="_blank" rel="noopener">https://www.vmvps.com/restic-a-new-opensource-backup-free-tool-to-backup-your-vps-files.html</a></p></li></ol></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä»€ä¹ˆæ˜¯-Restic&quot;&gt;ä»€ä¹ˆæ˜¯ Restic&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Restic&lt;/code&gt; æ˜¯ä¸€æ¬¾ GO è¯­è¨€å¼€å‘çš„å¼€æºå…è´¹ä¸”å¿«é€Ÿã€é«˜æ•ˆå’Œå®‰å…¨çš„è·¨å¹³å°å¤‡ä»½å·¥å…·ã€‚&lt;code&gt;Restic&lt;/code&gt; ä½¿ç”¨åŠ å¯†æŠ€æœ¯æ¥ä¿è¯ä½ çš„æ•°æ®å®‰å…¨æ€§å’Œå®Œæ•´æ€§ï¼Œå¯ä»¥å°†æœ¬åœ°æ•°æ®åŠ å¯†åä¼ è¾“åˆ°æŒ‡å®šçš„å­˜å‚¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Restic&lt;/code&gt; åŒæ ·æ”¯æŒå¢é‡å¤‡ä»½ï¼Œå¯éšæ—¶å¤‡ä»½å’Œæ¢å¤å¤‡ä»½ã€‚&lt;code&gt;Restic&lt;/code&gt; æ”¯æŒå¤§å¤šæ•°ä¸»æµæ“ä½œç³»ç»Ÿï¼Œæ¯”å¦‚ï¼š&lt;code&gt;Linux&lt;/code&gt;ã€&lt;code&gt;macOS&lt;/code&gt;ã€&lt;code&gt;Windows&lt;/code&gt; ä»¥åŠä¸€äº›è¾ƒå°ä¼—çš„æ“ä½œç³»ç»Ÿ &lt;code&gt;FreeBSD&lt;/code&gt; å’Œ &lt;code&gt;OpenBSD&lt;/code&gt; ç­‰ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¡¹ç›®åœ°å€ï¼š&lt;a href=&quot;https://github.com/restic/restic&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/restic/restic&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;Restic æ”¯æŒçš„å­˜å‚¨ç±»å‹&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Restic&lt;/code&gt; æ”¯æŒçš„å­˜å‚¨ç§ç±»æ¯”è¾ƒå¤šï¼Œå¤§è‡´æœ‰å¦‚ä¸‹è¿™äº›ç±»å‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æœ¬åœ°å­˜å‚¨&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;SFTP&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;REST Server&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Amazon S3&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Minio Server&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;OpenStack Swift&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Backblaze B2&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Microsoft Azure Blob Storage&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Google Cloud Storage&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é€šè¿‡ Rclone æŒ‚è½½çš„å­˜å‚¨ (æ¯”å¦‚ï¼šGoogle Driveã€OneDrive ç­‰)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Restic ä¸ Rclone çš„åŒºåˆ«&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Restic&lt;/code&gt; ä¸ &lt;code&gt;Rclone&lt;/code&gt; éƒ½æ˜¯å¼€æºçš„å‘½ä»¤è¡Œæ–‡ä»¶å¤‡ä»½ï¼ˆåŒæ­¥ï¼‰å·¥å…·ï¼Œä½†å´æœ‰ç€å¾ˆæœ¬è´¨çš„åŒºåˆ«ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸¤è€…çš„ç›¸åŒç‚¹&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ä¸¤è€…éƒ½æ˜¯åŸºäºå‘½ä»¤è¡Œçš„å¼€æºæ–‡ä»¶åŒæ­¥å’Œå¤‡ä»½å·¥å…·ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸¤è€…éƒ½æ”¯æŒå°†æ–‡ä»¶å¤‡ä»½åˆ°æœ¬åœ°ã€è¿œç¨‹æœåŠ¡å™¨æˆ–å¯¹è±¡å­˜å‚¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;ä¸¤è€…ä¸åŒç‚¹&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Rclone é¢å‘çš„æ˜¯æ–‡ä»¶åŒæ­¥ï¼Œå³ä¿è¯ä¸¤ç«¯æ–‡ä»¶çš„ä¸€è‡´ï¼Œä¹Ÿå¯ä»¥å¢é‡å¤‡ä»½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Restic é¢å‘çš„æ˜¯æ–‡ä»¶å¤‡ä»½å’ŒåŠ å¯†ï¼Œæ–‡ä»¶å…ˆåŠ å¯†å†ä¼ è¾“å¤‡ä»½ï¼Œè€Œä¸”æ˜¯å¢é‡å¤‡ä»½ï¼Œå³æ¯æ¬¡åªå¤‡ä»½å˜åŒ–çš„éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Rclone ä»“åº“é…ç½®ä¿å­˜åœ¨æœ¬åœ°ï¼Œå¤‡ä»½çš„æ–‡ä»¶ä¼šä¿æŒåŸæ ·çš„åŒæ­¥äºå­˜å‚¨ä»“åº“ä¸­ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Restic é…ç½®ä¿¡æ¯ç›´æ¥å†™åœ¨ä»“åº“ï¼Œåªè¦æœ‰ä»“åº“å¯†ç ï¼Œåœ¨ä»»ä½•å®‰è£…äº† Restic çš„è®¡ç®—æœºä¸Šéƒ½å¯ä»¥æ“ä½œä»“åº“ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Rclone ä¸è®°å½•æ–‡ä»¶ç‰ˆæœ¬ï¼Œæ— æ³•æ ¹æ®æŸä¸€æ¬¡å¤‡ä»½æ‰¾å›ç‰¹å®šæ—¶é—´ç‚¹ä¸Šçš„æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Restic æ¯æ¬¡å¤‡ä»½éƒ½ä¼šç”Ÿæˆä¸€ä¸ªå¿«ç…§ï¼Œè®°å½•å½“å‰æ—¶é—´ç‚¹çš„æ–‡ä»¶ç»“æ„ï¼Œå¯ä»¥æ‰¾å›ç‰¹å®šæ—¶é—´ç‚¹çš„æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Rclone å¯ä»¥åœ¨é…ç½®çš„å¤šä¸ªå­˜å‚¨ç«¯ä¹‹é—´ä¼ è¾“æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ€»çš„æ¥è¯´ï¼Œ&lt;code&gt;Rclone&lt;/code&gt; å’Œ &lt;code&gt;Restic&lt;/code&gt; å„æœ‰æ‰€é•¿ï¼Œè¦æ ¹æ®ä¸åŒçš„ä¸šåŠ¡éœ€æ±‚é€‰æ‹©ä½¿ç”¨ã€‚æ¯”å¦‚ï¼šç½‘ç«™æ•°æ®çš„å¢é‡å¤‡ä»½ï¼Œç”¨ &lt;code&gt;Resitc&lt;/code&gt; å°±æ¯”è¾ƒåˆé€‚ã€‚è€Œå¸¸è§„æ–‡ä»¶çš„è¿œç¨‹å¤‡ä»½å½’æ¡£ï¼Œç”¨ &lt;code&gt;Rclone&lt;/code&gt; å°±å¾ˆåˆé€‚ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/categories/Linux/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="æŠ€å·§" scheme="https://www.hi-linux.com/tags/%E6%8A%80%E5%B7%A7/"/>
    
      <category term="Restic" scheme="https://www.hi-linux.com/tags/Restic/"/>
    
  </entry>
  
  <entry>
    <title>æ¨èä¸€æ¬¾è¶…å®ç”¨çš„å‘½ä»¤è¡Œå¤‡å¿˜ç¥å™¨ Navi</title>
    <link href="https://www.hi-linux.com/posts/29102.html"/>
    <id>https://www.hi-linux.com/posts/29102.html</id>
    <published>2020-05-11T01:00:00.000Z</published>
    <updated>2020-05-11T05:22:20.129Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œæ— è®ºå¯¹äºè¿ç»´,è¿˜æ˜¯å¼€å‘æ¥è¯´ï¼Œå‘½ä»¤è¡Œå·¥å…·éƒ½æ˜¯éå¸¸é«˜æ•ˆçš„ä¸€ç§ç®¡ç†æ–¹å¼ã€‚ä½†æœ‰ä¸€ä¸ªå¾ˆå¸¸è§çš„ç°è±¡å°±æ˜¯ï¼Œå¾ˆå¤šå‘½ä»¤è¡Œè¯­å¥æ¯”è¾ƒå¤æ‚ï¼Œç”¨è¿‡ä¸€æ®µæ—¶é—´åå°±å¿˜è®°äº†ã€‚å½“ç„¶ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡ç½‘ç»œæœç´¢æˆ–è€…ä½¿ç”¨å‘½ä»¤çš„ <code>-â€”help</code> é€‰é¡¹æ¥å¿«é€Ÿæ‰¾åˆ°ç­”æ¡ˆã€‚è™½ç„¶è¿™ç§å¸¸ç”¨çš„æ–¹æ³•èƒ½è§£å†³é—®é¢˜ï¼Œä½†æ˜¯ä½¿ç”¨èµ·æ¥ç›¸å¯¹è¿˜æ˜¯æ˜¾å¾—ä¸é‚£ä¹ˆå¿«é€Ÿé«˜æ•ˆã€‚</p><p>ä¹‹å‰ï¼Œæˆ‘ä»¬åœ¨ã€Œ<a href="https://mp.weixin.qq.com/s?__biz=MzI3MTI2NzkxMA==&amp;mid=2247487743&amp;idx=1&amp;sn=e726fa2c2b8fa0e56e5653c9aba08732&amp;chksm=eac531d6ddb2b8c06c599a1290a1fb4dd22d53855d88294a8a8b443be74a0279fdcaf912eb67&amp;token=1334996765&amp;lang=zh_CN#rd" target="_blank" rel="noopener">å¦‚ä½•å¿«é€Ÿçš„å›å¿†èµ·é—å¿˜çš„ Linux å‘½ä»¤</a>ã€ ä¸€æ–‡ä¸­ä»‹ç»äº†å¦‚ä½•åˆ©ç”¨ <code>Apropos</code> å‘½ä»¤æ¥å¿«é€ŸæŸ¥æ‰¾ç›¸åº”çš„ <code>Linux</code> å‘½ä»¤ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å†ç»™å¤§å®¶æ¨èå¦ä¸€æ¬¾ç¥å™¨ <code>navi</code>ã€‚</p><p><code>navi</code> æ˜¯ä¸€ä½æ¥è‡ªå·´è¥¿çš„å°å“¥å“¥ <code>Denis Isidoro</code> åœ¨ <code>GitHub</code> ä¸Šå¼€æºçš„ä¸€ä¸ªçš„å·¥å…· ï¼Œç›®å‰å·²ç»è·å¾—è¶…è¿‡ 4200 æ˜Ÿã€‚<code>navi</code> å¯ä»¥åœ¨å‘½ä»¤è¡Œé‡Œç»™ä½ æä¾›äº†ä¸€ä¸ªå¾ˆæ–¹ä¾¿ä½¿ç”¨çš„äº¤äº’å¼çš„å¤‡å¿˜å½•ï¼Œèƒ½å¤Ÿå¸®åŠ©ä½ åœ¨å‘½ä»¤è¡Œé‡Œå¿«é€ŸæŸ¥é˜…ã€è°ƒç”¨å„ç§å¤æ‚éš¾è®°çš„å‘½ä»¤è¡Œè¯­å¥ã€‚</p><blockquote><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/denisidoro/navi" target="_blank" rel="noopener">https://github.com/denisidoro/navi</a></p></blockquote><p>ä¿—è¯è¯´å¾—å¥½ï¼Œä¸çœ‹å¹¿å‘Šçœ‹ç–—æ•ˆã€‚åºŸè¯ä¸å¤šè¯´ï¼Œå…ˆçœ‹çœ‹ä¸‹é¢çš„æ¼”ç¤ºæ•ˆæœå›¾å§ï¼</p><p><img src="https://www.hi-linux.com/img/linux/navi1.gif" alt=""></p><p>ä»æ¼”ç¤ºä¸­ï¼Œæˆ‘ä»¬å¯èƒ½çœ‹åˆ°ä½¿ç”¨äº† <code>navi</code> åï¼Œåªéœ€è¦é”®å…¥ä¸€ä¸ªå•è¯ï¼Œå¤‡å¿˜å½•ä¸­çš„ç›¸å…³å‘½ä»¤ä»¥åŠå‘½ä»¤ç”¨æ³•æ³¨é‡Šéƒ½ä¼šå®æ—¶æ˜¾ç¤ºåœ¨ä¸‹æ–¹ä¾›ä½ ç›´æ¥é€‰æ‹©ä½¿ç”¨ï¼Œè¿™æ—¶æˆ‘ä»¬åªéœ€æ‰¾åˆ°æƒ³è¦çš„å‘½ä»¤åå³å¯ç›´æ¥è¿è¡Œç›¸å…³å‘½ä»¤ã€‚æ˜¯ä¸æ˜¯è§‰å¾—å¾ˆç¥å¥‡å’Œå¼ºå¤§å‘¢ï¼</p><a id="more"></a><h2 id="å®‰è£…-navi">å®‰è£… Navi</h2><p><code>navi</code> çš„å®‰è£…è¿˜æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œ<code>macOS</code> å’Œ <code>Linux</code> ç”¨æˆ·éƒ½å¯ä»¥å®‰è£…ã€‚å¦‚æœä½ å·²ç»å®‰è£…äº† <code>Homebrew</code> æˆ–è€… <code>Linuxbrew</code>ï¼Œé‚£ä¹ˆåªéœ€ä¸‹é¢ä¸€å¥å‘½ä»¤å°±å¯ä»¥å®‰è£…å¥½ <code>navi</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ brew install denisidoro&#x2F;tools&#x2F;navi</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ æ²¡æœ‰å®‰è£… <code>Homebrew</code> æˆ–è€… <code>Linuxbrew</code> è¿™æ ·çš„åŒ…ç®¡ç†å™¨ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡æºç å®‰è£…ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git clone --depth 1 https:&#x2F;&#x2F;github.com&#x2F;denisidoro&#x2F;navi &#x2F;opt&#x2F;navi</span><br><span class="line">$ cd &#x2F;opt&#x2F;navi</span><br><span class="line">$ sudo make install</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šå¦‚æœä½ ä½¿ç”¨æºç è¿›è¡Œç¼–è¯‘ï¼Œä½ éœ€è¦å…ˆå®‰è£…å¥½å‘½ä»¤è¡Œæ¨¡ç³ŠæŸ¥æ‰¾å·¥å…· <code>fzf</code>ã€‚ æœ‰å…³ <code>fzf</code> çš„å…·ä½“å®‰è£…æ–¹æ³•ï¼Œä½ å¯ä»¥å‚è€ƒå…¶å®˜æ–¹ç½‘å€ï¼š<a href="https://github.com/junegunn/fzf" target="_blank" rel="noopener">https://github.com/junegunn/fzf</a> ã€‚</p></blockquote><h2 id="ä½¿ç”¨-navi">ä½¿ç”¨ Navi</h2><p><code>navi</code> ä½¿ç”¨ä¹Ÿæ˜¯å¾ˆç®€å•çš„ï¼Œä½ åªéœ€ç›´æ¥è¾“å…¥ <code>navi</code> å‘½ä»¤å¹¶å›è½¦åï¼Œå³å¯è¿›å…¥äº¤äº’ç•Œé¢è¿›è¡Œå‘½ä»¤æŸ¥æ‰¾ã€‚</p><p><img src="https://www.hi-linux.com/img/linux/navi2.jpeg" alt=""></p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œé€‰ä¸­çš„å‘½ä»¤ä¼šç›´æ¥æ‰§è¡Œã€‚å¦‚æœä½ åªæƒ³å°†é€‰ä¸­çš„å‘½ä»¤è¾“å…¥åˆ°å‘½ä»¤è¡Œä¸Šï¼Œä½ å¯ä»¥åŠ ä¸Š <code>--print</code> é€‰é¡¹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ navi --print</span><br></pre></td></tr></table></figure><p>ä½ ä¹Ÿå¯ä»¥åœ¨ <code>navi</code> å‘½ä»¤åç›´æ¥åŠ å…¥ <code>query</code> å­å‘½ä»¤æ¥é¢„å…ˆè¿‡æ»¤è¦è¾“å‡ºçš„å‘½ä»¤ç»“æœã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ navi query &lt;cmd&gt;</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ æƒ³æŸ¥æ‰¾ä¸€äº›å‘½ä»¤çš„å¸¸ç”¨è¯­æ³•ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>search</code> å­å‘½ä»¤æ¥ä»åœ¨çº¿ä»“åº“ä¸­ä¸‹è½½å¯¹åº”çš„å¤‡å¿˜æ¸…å•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ navi search &lt;cmd&gt;</span><br></pre></td></tr></table></figure><h3 id="è‡ªå®šä¹‰å¤‡å¿˜å½•">è‡ªå®šä¹‰å¤‡å¿˜å½•</h3><p><code>navi</code> æ‰€ä½¿ç”¨çš„å¤‡å¿˜æ¸…å•éƒ½æ˜¯ä»¥ <code>.cheat</code> ä¸ºåç¼€çš„ä¸€äº›æ–‡ä»¶ï¼Œ<code>navi</code> å®‰è£…å®Œåï¼Œé»˜è®¤åŒ…æ‹¬äº†ä»¥ä¸‹è¿™äº›å¤‡å¿˜æ¸…å•ã€‚</p><p><img src="https://i.loli.net/2019/10/21/Kl1J8tBA75wbnjq.png" alt=""></p><p><code>navi</code> ä¹‹æ‰€ä»¥å¦‚æ­¤å—æ¬¢è¿ï¼Œä¸»è¦åŸå› æ˜¯å®ƒæ”¯æŒå¼ºå¤§çš„è‡ªå®šä¹‰åŠŸèƒ½ï¼Œè€Œä¸”è‡ªå®šä¹‰æ³¨é‡Šè¿˜æ”¯æŒä¸­æ–‡å“Ÿã€‚</p><p>è¦å®ç°æ­¤åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <code>--dir</code> å‚æ•°å°†è‡ªå·±å®šä¹‰çš„å¤‡å¿˜å½• ( <code>.cheat</code> æ–‡ä»¶) ä¼ é€’ç»™ <code>navi</code> ä½¿ç”¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ navi --dir &quot;&#x2F;folder&#x2F;with&#x2F;cheats&quot;</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ è§‰å¾—æ¯æ¬¡éƒ½é€šè¿‡ <code>--dir</code> å‚æ•°è¿‡äºéº»çƒ¦ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡æ¥è¿›è¡Œè®¾ç½®ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ export NAVI_PATH&#x3D;&quot;&#x2F;folder&#x2F;with&#x2F;cheats:&#x2F;another&#x2F;folder&quot;</span><br></pre></td></tr></table></figure><p>ä»‹ç»å®Œäº†å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰çš„å¤‡å¿˜æ¸…å•åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•è‡ªå·²å†™ä¸€ä¸ªå¤‡å¿˜æ¸…å•ã€‚</p><h4 id="cheat-æ–‡ä»¶è¯­æ³•">.cheat æ–‡ä»¶è¯­æ³•</h4><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªå®˜æ–¹ç»™å‡ºçš„ <code>.cheat</code> æ–‡ä»¶çš„ç¤ºä¾‹å†…å®¹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">% git, code</span><br><span class="line"></span><br><span class="line"># Change branch</span><br><span class="line">git checkout &lt;branch&gt;</span><br><span class="line"></span><br><span class="line">$ branch: git branch | awk &#39;&#123;print $NF&#125;&#39;</span><br></pre></td></tr></table></figure><p><code>.cheat</code> æ–‡ä»¶è¯­æ³•ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªæ³¨æ„ç‚¹ã€‚</p><ul><li><p>ä»¥ã€Œ<code>%</code>ã€å¼€å¤´çš„è¡Œå®šä¹‰äº†è¯¥æ–‡ä»¶åŒ…å«çš„ç‰¹å®šçš„æ ‡ç­¾</p></li><li><p>ä»¥ã€Œ<code>#</code>ã€å¼€å¤´çš„è¡Œæè¿°äº†è¯¥å‘½ä»¤çš„ä½œç”¨å’Œç”¨æ³•</p></li><li><p>ä»¥ã€Œ<code>$</code>ã€å¼€å¤´çš„è¡Œå®šä¹‰äº†ç»™å®šå‚æ•°çš„å¯é€‰å€¼</p></li><li><p>å…¶å®ƒæ‰€æœ‰çš„éç©ºè¡Œéƒ½è¢«è§†ä¸ºå¯æ‰§è¡Œå‘½ä»¤ï¼Œå‘½ä»¤ä¸­çš„å˜é‡ä»¥ <code>&lt;&gt;</code> è¡¨ç¤º</p></li></ul><p>æœ€åæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®ä¾‹ï¼Œæˆ‘ä»¬å¸¸ç”¨åˆ°çš„ <code>ffmpeg</code> å¤„ç†è§†é¢‘çš„å‘½ä»¤é€šå¸¸éƒ½å¤ªé•¿ï¼Œè¿™é‡Œæˆ‘ä»¬å°±å®šä¹‰ä¸€ä¸ª <code>ffmpeg.cheat</code> æ–‡ä»¶æ¥ç®¡ç†è¿™äº›æ—¥å¸¸å¸¸ç”¨çš„å‘½ä»¤ã€‚</p><p><img src="https://www.hi-linux.com/img/linux/navi4.gif" alt=""></p><p>ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨å®Œæˆ <code>ffmpeg</code> å‘½ä»¤å¤‡å¿˜æ¸…å•çš„å®šä¹‰åã€‚æ—¥å¸¸ä½¿ç”¨ä¸­å†ä¹Ÿä¸ç”¨è¾“å…¥é•¿é•¿çš„å‘½ä»¤ï¼Œåªéœ€è¦é€‰ä¸­å¯¹åº”å‘½ä»¤åï¼Œå†è¾“å…¥è‡ªå®šä¹‰å‚æ•°å°±å¯å®Œæˆæ‰€æœ‰æ“ä½œã€‚è¿™æ ·ä»¥æ¥ï¼Œæ˜¯ä¸æ˜¯å¤§å¤§æå‡äº†å·¥ä½œæ•ˆç‡å‘¢!</p><h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2><ol><li><a href="https://www.google.com" target="_blank" rel="noopener">https://www.google.com</a></li><li><a href="https://url.cn/5pyiQLg" target="_blank" rel="noopener">https://url.cn/5pyiQLg</a></li><li><a href="https://url.cn/5EE2Ejc" target="_blank" rel="noopener">https://url.cn/5EE2Ejc</a></li></ol></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¼—æ‰€å‘¨çŸ¥ï¼Œæ— è®ºå¯¹äºè¿ç»´,è¿˜æ˜¯å¼€å‘æ¥è¯´ï¼Œå‘½ä»¤è¡Œå·¥å…·éƒ½æ˜¯éå¸¸é«˜æ•ˆçš„ä¸€ç§ç®¡ç†æ–¹å¼ã€‚ä½†æœ‰ä¸€ä¸ªå¾ˆå¸¸è§çš„ç°è±¡å°±æ˜¯ï¼Œå¾ˆå¤šå‘½ä»¤è¡Œè¯­å¥æ¯”è¾ƒå¤æ‚ï¼Œç”¨è¿‡ä¸€æ®µæ—¶é—´åå°±å¿˜è®°äº†ã€‚å½“ç„¶ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡ç½‘ç»œæœç´¢æˆ–è€…ä½¿ç”¨å‘½ä»¤çš„ &lt;code&gt;-â€”help&lt;/code&gt; é€‰é¡¹æ¥å¿«é€Ÿæ‰¾åˆ°ç­”æ¡ˆã€‚è™½ç„¶è¿™ç§å¸¸ç”¨çš„æ–¹æ³•èƒ½è§£å†³é—®é¢˜ï¼Œä½†æ˜¯ä½¿ç”¨èµ·æ¥ç›¸å¯¹è¿˜æ˜¯æ˜¾å¾—ä¸é‚£ä¹ˆå¿«é€Ÿé«˜æ•ˆã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹å‰ï¼Œæˆ‘ä»¬åœ¨ã€Œ&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzI3MTI2NzkxMA==&amp;amp;mid=2247487743&amp;amp;idx=1&amp;amp;sn=e726fa2c2b8fa0e56e5653c9aba08732&amp;amp;chksm=eac531d6ddb2b8c06c599a1290a1fb4dd22d53855d88294a8a8b443be74a0279fdcaf912eb67&amp;amp;token=1334996765&amp;amp;lang=zh_CN#rd&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å¦‚ä½•å¿«é€Ÿçš„å›å¿†èµ·é—å¿˜çš„ Linux å‘½ä»¤&lt;/a&gt;ã€ ä¸€æ–‡ä¸­ä»‹ç»äº†å¦‚ä½•åˆ©ç”¨ &lt;code&gt;Apropos&lt;/code&gt; å‘½ä»¤æ¥å¿«é€ŸæŸ¥æ‰¾ç›¸åº”çš„ &lt;code&gt;Linux&lt;/code&gt; å‘½ä»¤ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å†ç»™å¤§å®¶æ¨èå¦ä¸€æ¬¾ç¥å™¨ &lt;code&gt;navi&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;navi&lt;/code&gt; æ˜¯ä¸€ä½æ¥è‡ªå·´è¥¿çš„å°å“¥å“¥ &lt;code&gt;Denis Isidoro&lt;/code&gt; åœ¨ &lt;code&gt;GitHub&lt;/code&gt; ä¸Šå¼€æºçš„ä¸€ä¸ªçš„å·¥å…· ï¼Œç›®å‰å·²ç»è·å¾—è¶…è¿‡ 4200 æ˜Ÿã€‚&lt;code&gt;navi&lt;/code&gt; å¯ä»¥åœ¨å‘½ä»¤è¡Œé‡Œç»™ä½ æä¾›äº†ä¸€ä¸ªå¾ˆæ–¹ä¾¿ä½¿ç”¨çš„äº¤äº’å¼çš„å¤‡å¿˜å½•ï¼Œèƒ½å¤Ÿå¸®åŠ©ä½ åœ¨å‘½ä»¤è¡Œé‡Œå¿«é€ŸæŸ¥é˜…ã€è°ƒç”¨å„ç§å¤æ‚éš¾è®°çš„å‘½ä»¤è¡Œè¯­å¥ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¡¹ç›®åœ°å€ï¼š&lt;a href=&quot;https://github.com/denisidoro/navi&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/denisidoro/navi&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¿—è¯è¯´å¾—å¥½ï¼Œä¸çœ‹å¹¿å‘Šçœ‹ç–—æ•ˆã€‚åºŸè¯ä¸å¤šè¯´ï¼Œå…ˆçœ‹çœ‹ä¸‹é¢çš„æ¼”ç¤ºæ•ˆæœå›¾å§ï¼&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.hi-linux.com/img/linux/navi1.gif&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;ä»æ¼”ç¤ºä¸­ï¼Œæˆ‘ä»¬å¯èƒ½çœ‹åˆ°ä½¿ç”¨äº† &lt;code&gt;navi&lt;/code&gt; åï¼Œåªéœ€è¦é”®å…¥ä¸€ä¸ªå•è¯ï¼Œå¤‡å¿˜å½•ä¸­çš„ç›¸å…³å‘½ä»¤ä»¥åŠå‘½ä»¤ç”¨æ³•æ³¨é‡Šéƒ½ä¼šå®æ—¶æ˜¾ç¤ºåœ¨ä¸‹æ–¹ä¾›ä½ ç›´æ¥é€‰æ‹©ä½¿ç”¨ï¼Œè¿™æ—¶æˆ‘ä»¬åªéœ€æ‰¾åˆ°æƒ³è¦çš„å‘½ä»¤åå³å¯ç›´æ¥è¿è¡Œç›¸å…³å‘½ä»¤ã€‚æ˜¯ä¸æ˜¯è§‰å¾—å¾ˆç¥å¥‡å’Œå¼ºå¤§å‘¢ï¼&lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/categories/Linux/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="æŠ€å·§" scheme="https://www.hi-linux.com/tags/%E6%8A%80%E5%B7%A7/"/>
    
      <category term="ç»ˆç«¯" scheme="https://www.hi-linux.com/tags/%E7%BB%88%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>åˆ†äº«å‡ ä¸ªæ— éœ€ Docker ç¯å¢ƒæ‹‰å–å®¹å™¨é•œåƒçš„ç¥å™¨</title>
    <link href="https://www.hi-linux.com/posts/46425.html"/>
    <id>https://www.hi-linux.com/posts/46425.html</id>
    <published>2020-05-09T01:00:00.000Z</published>
    <updated>2020-05-09T03:23:02.446Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><p>ä½ æ˜¯å¦æ›¾ç»é‡åˆ°è¿‡éœ€è¦åœ¨æ²¡æœ‰å®‰è£…ä»»ä½• <code>Docker</code> å®¢æˆ·ç«¯çš„æœºå™¨ä¸Šæ‹‰å–å®¹å™¨é•œåƒè¿™æ ·å˜æ€çš„éœ€æ±‚å‘¢ï¼Ÿå¦‚æœæœ‰,ä½ å½“æ—¶åˆæ˜¯å¦‚ä½•è§£å†³çš„å‘¢ï¼Ÿä»Šå¤©æˆ‘ä»¬å°±æ¥ç»™å¤§å®¶ä»‹ç»å‡ ç§å¦è¾Ÿè¹Šå¾„çš„æ–¹æ³•æ¥å®ç°è¿™æ ·çš„éœ€æ±‚ã€‚</p><h2 id="ä½¿ç”¨-docker-drag-å®ç°">ä½¿ç”¨ docker-drag å®ç°</h2><p>æ ¹æ®å®˜ç½‘ä»‹ç»ï¼š<code>docker-drag</code> æ˜¯ä¸€ä¸ªç”¨äºä¸ <code>Docker Hub</code> äº¤äº’çš„å·¥å…·ï¼Œå¹¶ä¸”ä¸éœ€ <code>Docker</code> å®¢æˆ·ç«¯æœ¬èº«æ”¯æŒã€‚å®ƒä¸»è¦æ˜¯é€šè¿‡ä¸ <code>Docker Hub</code> çš„ <code>HTTPS API</code> è¿›è¡Œäº¤äº’æ¥å®ç°ç›¸åº”åŠŸèƒ½ã€‚</p><blockquote><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/NotGlop/docker-drag" target="_blank" rel="noopener">https://github.com/NotGlop/docker-drag</a></p></blockquote><h3 id="å®‰è£…-docker-drag">å®‰è£… docker-drag</h3><p><code>docker-drag</code> å…¶å®å°±æ˜¯ä¸€ä¸ª <code>Python</code> è„šæœ¬ï¼Œç›®å‰ç‰ˆæœ¬æ€»å…±æ‰ 168 è¡Œä»£ç ã€‚ä½ åªéœ€è¦å»å®˜ç½‘ä»“åº“ç›´æ¥ä¸‹è½½å°±å¯ä»¥ä½¿ç”¨äº†ï¼Œéå¸¸çš„ç®€å•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ wget https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;NotGlop&#x2F;docker-drag&#x2F;master&#x2F;docker_pull.py</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-docker-drag">ä½¿ç”¨ docker-drag</h3><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹å®˜æ–¹ç»™å‡ºçš„æ¼”ç¤ºæ•ˆæœã€‚</p><p><img src="https://user-images.githubusercontent.com/26483750/63388733-b419f480-c3a9-11e9-8617-7c5b47b76dbd.gif" alt=""></p><p><code>docker-drag</code> çš„ä½¿ç”¨ä¹Ÿæ˜¯éå¸¸ç®€å•çš„ï¼ŒåŸºæœ¬ä¸Šå’Œ <code>docke pull</code> å‘½ä»¤ä½¿ç”¨æ–¹æ³•ä¸€è‡´ã€‚å…¶ä¸»è¦æ˜¯å€ŸåŠ© <code>Python</code> çš„ <code>Request</code> åº“å’Œ <code>HTTPS API</code> ç›´æ¥ä»ä»“åº“ä¸­æ‹‰å–é•œåƒï¼Œå¹¶ä¿å­˜ä¸º <code>TAR</code> æ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç›´æ¥åœ¨å®˜æ–¹ä»“åº“æ‹‰å–å®˜æ–¹é•œåƒ</span></span><br><span class="line">$ python docker_pull.py nginx:alpine</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›´æ¥åœ¨å®˜æ–¹ä»“åº“æ‹‰å–ä¸‰æ–¹é•œåƒ</span></span><br><span class="line">$ python docker_pull.py mysql/mysql-server:8.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›´æ¥åœ¨ä¸‰æ–¹ä»“åº“æ‹‰å–é•œåƒ</span></span><br><span class="line">$ python docker_pull.py mcr.microsoft.com/windows/nanoserver@sha256:ae443bd9609b9ef06d21d6caab59505cb78f24a725cc24716d4427e36aedabf2</span><br></pre></td></tr></table></figure><p>é•œåƒä¸‹è½½å®Œæˆåï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>docker load -i</code> å‘½ä»¤å¯¹ <code>TAR</code> æ–‡ä»¶è¿›è¡ŒåŠ è½½ã€‚ç”±äºä¸åœ¨ä¾èµ–å®¹å™¨å·¥å…·æœ¬èº«ï¼Œåœ¨ä¸€äº›å®é™…ä½¿ç”¨åœºæ™¯ä¸­ï¼Œä¾‹å¦‚ï¼šCICD æµç¨‹ã€‚è¿™ä¸ªå°å·¥å…·æˆ–è®¸èƒ½åŠ©ä½ è§£å†³å¤§é—®é¢˜å“Ÿï¼</p><a id="more"></a><h2 id="ä½¿ç”¨-download-frozen-image-v2-å®ç°">ä½¿ç”¨ download-frozen-image-v2 å®ç°</h2><p>ä¸ <code>docker-drag</code> ç±»ä¼¼çš„å·¥å…·ï¼Œè¿˜æœ‰ä¸€ä¸ª <code>SHELL</code> è„šæœ¬çš„å®ç° <code>download-frozen-image-v2</code>ï¼Œè¯¥è„šæœ¬éš¶å±äº <code>Moby</code> é¡¹ç›®ã€‚</p><blockquote><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/moby/moby" target="_blank" rel="noopener">https://github.com/moby/moby</a></p></blockquote><p>å®ƒçš„ä½¿ç”¨åŸºæœ¬ä¸Šå’Œ <code>docker-drag</code> ç±»ä¼¼ï¼Œå¤§è‡´æœ‰å¦‚ä»¥ä¸‹å‡ æ­¥æ‰€ç¤ºã€‚</p><ol><li>ä¸‹è½½å¯¹åº”çš„è„šæœ¬</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ wget https://raw.githubusercontent.com/moby/moby/master/contrib/download-frozen-image-v2.sh</span><br></pre></td></tr></table></figure><ol start="2"><li>download-frozen-image-v2 è„šæœ¬ä½¿ç”¨è¯­æ³•</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">download-frozen-image-v2.sh target_dir image[:tag][@digest] ...</span><br></pre></td></tr></table></figure><ol start="3"><li>ä¸€ä¸ªå®Œæ•´çš„ä½¿ç”¨å®ä¾‹</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹è½½ Ubuntu å®¹å™¨é•œåƒ</span></span><br><span class="line">$ bash download-frozen-image-v2.sh ubuntu ubuntu:latest</span><br><span class="line"></span><br><span class="line"><span class="comment"># download-frozen-image-v2 è¿™é‡Œè¦ç¨ä¸ºå¤æ‚ç‚¹ï¼Œéœ€è¦è‡ªå·±æ‰‹åŠ¨æ‰“æˆ TAR åŒ…</span></span><br><span class="line">$ tar -C <span class="string">'ubuntu'</span> -cf <span class="string">'ubuntu.tar'</span> .</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¼å…¥å®¹å™¨é•œåƒ</span></span><br><span class="line">$ docker load -i ubuntu.tar</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¼å…¥å®¹å™¨é•œåƒå®Œæˆåï¼Œè¿ä¸€ä¸ªå®¹å™¨</span></span><br><span class="line">$ docker run --rm -ti ubuntu bash</span><br><span class="line">root@1dd5e62113b9:/<span class="comment">#</span></span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨-dp-å®ç°">ä½¿ç”¨ dp å®ç°</h2><p><code>dp</code> åŒæ ·ä¹Ÿæ˜¯ä¸€ä¸ªå®ç°ä¸Šè¿°ç±»ä¼¼éœ€æ±‚çš„å°å·¥å…·ã€‚<code>dp</code> ä½¿ç”¨ <code>Go</code> è¯­è¨€å¼€å‘ï¼Œå¤©ç”Ÿå…·æœ‰è‰¯å¥½çš„è·¨å¹³å°æ€§ã€‚ç›¸å¯¹äºå‰ä¸¤ä¸ªå·¥å…·æ¥è¯´æ›´å®¹æ˜“åœ¨å¤šå¹³å°ä¸Šéƒ¨ç½²ä½¿ç”¨ï¼Œè€Œä¸” <code>dp</code> è¿˜æ”¯æŒå°†å¤šä¸ªé•œåƒæ‰“åŒ…åœ¨ä¸€èµ·ã€‚</p><blockquote><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/zhangguanzhang/dp/" target="_blank" rel="noopener">https://github.com/zhangguanzhang/dp/</a></p></blockquote><h3 id="å®‰è£…-dp">å®‰è£… dp</h3><p><code>dp</code> çš„å®‰è£…éå¸¸ç®€å•ï¼Œåªéœ€åœ¨å®˜æ–¹ä»“åº“ <code>Releases</code> é¡µé¢ç›´æ¥ä¸‹è½½å„å¹³å°å¯¹åº”çš„ç‰ˆæœ¬ï¼Œè§£å‹åå³å¯ä½¿ç”¨ã€‚</p><h3 id="ä½¿ç”¨-dp">ä½¿ç”¨ dp</h3><p><code>dp</code> ä½¿ç”¨èµ·æ¥ä¹Ÿæ˜¯å¾ˆå®¹æ˜“çš„ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥çœ‹å‡ ä¸ªå®ä¾‹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»å®˜æ–¹ä»“åº“æ‹‰å–ä¸€ä¸ªå®¹å™¨é•œåƒ</span></span><br><span class="line">$ dp pull nginx:alpine</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»å®˜æ–¹ä»“åº“æ‹‰å–ä¸€ä¸ªå®¹å™¨é•œåƒå¹¶æ‰“åŒ…åˆ°å‹ç¼©æ–‡ä»¶</span></span><br><span class="line">$ dp pull -o nginx.tar.gz nginx:alpine</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ sha256 æ‹‰å–ä¸€ä¸ªå®¹å™¨é•œåƒ</span></span><br><span class="line">$ dp pull mcr.microsoft.com/windows/nanoserver@sha256:ae443bd9609b9ef06d21d6caab59505cb78f24a725cc24716d4427e36aedabf2</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸€æ¬¡ä»å®˜æ–¹ä»“åº“æ‹‰å–å¤šä¸ªå®¹å™¨é•œåƒå¹¶æ‰“åŒ…åˆ°å‹ç¼©æ–‡ä»¶</span></span><br><span class="line">$ dp pull -o project.tar.gz nginx:alpine nginx:1.17.5-alpine-perl</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»ä¸‰æ–¹é•œåƒä»“åº“æ‹‰å–å¤šä¸ªå®¹å™¨é•œåƒå¹¶æ‰“åŒ…åˆ°å‹ç¼©æ–‡ä»¶</span></span><br><span class="line">$ dp pull -o project.tar.gz nginx:alpine gcr.io/google_containers/pause-amd64:3.1</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±æ¼”ç¤ºå®Œäº†å¦‚ä½•åœ¨ä¸éœ€è¦ <code>Docker</code> å®¢æˆ·ç«¯çš„å‰æä¸‹æ‹‰å–å®¹å™¨é•œåƒçš„æ–¹æ³•ã€‚å¦‚æœä½ è¿˜æœ‰æ›´å¤šæ›´å¥½çš„æ–¹æ³•ï¼Œæ¬¢è¿å¤§å®¶ç§¯æç•™è¨€å“Ÿï¼</p><h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2><ol><li><p><a href="https://www.google.com" target="_blank" rel="noopener">https://www.google.com</a></p></li><li><p><a href="https://xbuba.com/questions/37905763" target="_blank" rel="noopener">https://xbuba.com/questions/37905763</a></p></li><li><p><a href="https://blog.fleeto.us/post/pull-image-without-docker/" target="_blank" rel="noopener">https://blog.fleeto.us/post/pull-image-without-docker/</a></p></li></ol></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä½ æ˜¯å¦æ›¾ç»é‡åˆ°è¿‡éœ€è¦åœ¨æ²¡æœ‰å®‰è£…ä»»ä½• &lt;code&gt;Docker&lt;/code&gt; å®¢æˆ·ç«¯çš„æœºå™¨ä¸Šæ‹‰å–å®¹å™¨é•œåƒè¿™æ ·å˜æ€çš„éœ€æ±‚å‘¢ï¼Ÿå¦‚æœæœ‰,ä½ å½“æ—¶åˆæ˜¯å¦‚ä½•è§£å†³çš„å‘¢ï¼Ÿä»Šå¤©æˆ‘ä»¬å°±æ¥ç»™å¤§å®¶ä»‹ç»å‡ ç§å¦è¾Ÿè¹Šå¾„çš„æ–¹æ³•æ¥å®ç°è¿™æ ·çš„éœ€æ±‚ã€‚&lt;/p&gt;
&lt;h2 id=&quot;ä½¿ç”¨-docker-drag-å®ç°&quot;&gt;ä½¿ç”¨ docker-drag å®ç°&lt;/h2&gt;
&lt;p&gt;æ ¹æ®å®˜ç½‘ä»‹ç»ï¼š&lt;code&gt;docker-drag&lt;/code&gt; æ˜¯ä¸€ä¸ªç”¨äºä¸ &lt;code&gt;Docker Hub&lt;/code&gt; äº¤äº’çš„å·¥å…·ï¼Œå¹¶ä¸”ä¸éœ€ &lt;code&gt;Docker&lt;/code&gt; å®¢æˆ·ç«¯æœ¬èº«æ”¯æŒã€‚å®ƒä¸»è¦æ˜¯é€šè¿‡ä¸ &lt;code&gt;Docker Hub&lt;/code&gt; çš„ &lt;code&gt;HTTPS API&lt;/code&gt; è¿›è¡Œäº¤äº’æ¥å®ç°ç›¸åº”åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¡¹ç›®åœ°å€ï¼š&lt;a href=&quot;https://github.com/NotGlop/docker-drag&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/NotGlop/docker-drag&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;å®‰è£…-docker-drag&quot;&gt;å®‰è£… docker-drag&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;docker-drag&lt;/code&gt; å…¶å®å°±æ˜¯ä¸€ä¸ª &lt;code&gt;Python&lt;/code&gt; è„šæœ¬ï¼Œç›®å‰ç‰ˆæœ¬æ€»å…±æ‰ 168 è¡Œä»£ç ã€‚ä½ åªéœ€è¦å»å®˜ç½‘ä»“åº“ç›´æ¥ä¸‹è½½å°±å¯ä»¥ä½¿ç”¨äº†ï¼Œéå¸¸çš„ç®€å•ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ wget https:&amp;#x2F;&amp;#x2F;raw.githubusercontent.com&amp;#x2F;NotGlop&amp;#x2F;docker-drag&amp;#x2F;master&amp;#x2F;docker_pull.py&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;ä½¿ç”¨-docker-drag&quot;&gt;ä½¿ç”¨ docker-drag&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹å®˜æ–¹ç»™å‡ºçš„æ¼”ç¤ºæ•ˆæœã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/26483750/63388733-b419f480-c3a9-11e9-8617-7c5b47b76dbd.gif&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;docker-drag&lt;/code&gt; çš„ä½¿ç”¨ä¹Ÿæ˜¯éå¸¸ç®€å•çš„ï¼ŒåŸºæœ¬ä¸Šå’Œ &lt;code&gt;docke pull&lt;/code&gt; å‘½ä»¤ä½¿ç”¨æ–¹æ³•ä¸€è‡´ã€‚å…¶ä¸»è¦æ˜¯å€ŸåŠ© &lt;code&gt;Python&lt;/code&gt; çš„ &lt;code&gt;Request&lt;/code&gt; åº“å’Œ &lt;code&gt;HTTPS API&lt;/code&gt; ç›´æ¥ä»ä»“åº“ä¸­æ‹‰å–é•œåƒï¼Œå¹¶ä¿å­˜ä¸º &lt;code&gt;TAR&lt;/code&gt; æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ç›´æ¥åœ¨å®˜æ–¹ä»“åº“æ‹‰å–å®˜æ–¹é•œåƒ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ python docker_pull.py nginx:alpine&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ç›´æ¥åœ¨å®˜æ–¹ä»“åº“æ‹‰å–ä¸‰æ–¹é•œåƒ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ python docker_pull.py mysql/mysql-server:8.0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ç›´æ¥åœ¨ä¸‰æ–¹ä»“åº“æ‹‰å–é•œåƒ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ python docker_pull.py mcr.microsoft.com/windows/nanoserver@sha256:ae443bd9609b9ef06d21d6caab59505cb78f24a725cc24716d4427e36aedabf2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;é•œåƒä¸‹è½½å®Œæˆåï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨ &lt;code&gt;docker load -i&lt;/code&gt; å‘½ä»¤å¯¹ &lt;code&gt;TAR&lt;/code&gt; æ–‡ä»¶è¿›è¡ŒåŠ è½½ã€‚ç”±äºä¸åœ¨ä¾èµ–å®¹å™¨å·¥å…·æœ¬èº«ï¼Œåœ¨ä¸€äº›å®é™…ä½¿ç”¨åœºæ™¯ä¸­ï¼Œä¾‹å¦‚ï¼šCICD æµç¨‹ã€‚è¿™ä¸ªå°å·¥å…·æˆ–è®¸èƒ½åŠ©ä½ è§£å†³å¤§é—®é¢˜å“Ÿï¼&lt;/p&gt;
    
    </summary>
    
    
      <category term="Docker" scheme="https://www.hi-linux.com/categories/docker/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="Docker" scheme="https://www.hi-linux.com/tags/Docker/"/>
    
      <category term="æŠ€å·§" scheme="https://www.hi-linux.com/tags/%E6%8A%80%E5%B7%A7/"/>
    
  </entry>
  
  <entry>
    <title>å·§ç”¨ Cowrie éƒ¨ç½² SSH èœœç½ï¼Œè®©é»‘å®¢æ”»å‡»æ— å¤„éå½¢</title>
    <link href="https://www.hi-linux.com/posts/6021.html"/>
    <id>https://www.hi-linux.com/posts/6021.html</id>
    <published>2020-05-09T01:00:00.000Z</published>
    <updated>2020-05-09T05:08:04.782Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><h2 id="ä»€ä¹ˆæ˜¯èœœç½">ä»€ä¹ˆæ˜¯èœœç½</h2><p>èœœç½å…¶å®å°±æ˜¯ä¸€å°æ— äººä½¿ç”¨ä½†å´è¢«ä¸¥å¯†ç›‘æ§çš„ç½‘ç»œä¸»æœºï¼Œé‡Œé¢åŒ…å«ç€å„ç±»è™šå‡çš„é«˜ä»·å€¼èµ„æºå’Œä¸€äº›å·²çŸ¥æ¼æ´ï¼Œä»¥æ­¤å¸å¼•å…¥ä¾µè€…æ¥å…¥ä¾µè¯¥ä¸»æœºã€‚å¹¶ä¸”åœ¨è¢«å…¥ä¾µçš„è¿‡ç¨‹ä¸­ï¼Œå®æ—¶è®°å½•å’Œå®¡è®¡å…¥ä¾µè€…çš„æ‰€æœ‰å…¥ä¾µæ”»å‡»æµé‡ã€è¡Œä¸ºå’Œæ•°æ®ã€‚ä»¥æ­¤äº†è§£å…¥ä¾µè€…çš„æ”»å‡»æ–¹å¼ã€æ‰‹æ®µå’Œç›®çš„ï¼Œä¾¿äºåæœŸå¿«é€Ÿå®Œæˆå¯¹å…¶çš„æº¯æºå’Œå–è¯å·¥ä½œã€‚</p><p><strong>èœœç½çš„ä¸€äº›ä¸»è¦æ„æˆæ¨¡å—</strong></p><ol><li>æŒ‰å®ç°é€»è¾‘åˆ’åˆ†</li></ol><ul><li><p>æ§åˆ¶ï¼šå°†å…¥ä¾µè€…ç‰¢ç‰¢æ§åˆ¶åœ¨æŒ‡å®šçš„ç½‘ç»œèŒƒå›´ä¸­ï¼Œä½¿å…¶ä¸èƒ½å†ä»¥æ­¤æœºå™¨ä½œä¸ºè·³æ¿æ¥æ”»å‡»å…¶å®ƒçš„æœºå™¨ã€‚</p></li><li><p>æ•è·ï¼šæŠŠå…¥ä¾µè€…åœ¨å…¥ä¾µè¿‡ç¨‹ä¸­æ‰€äº§ç”Ÿçš„å„ç§æµé‡æ•è·ä½ã€‚</p></li><li><p>åˆ†æï¼šå°†æ•è·åˆ°çš„å„ç§æ•°æ®å­˜åˆ°æ•°æ®åº“æˆ–è€…å…¶å®ƒæŒ‡å®šåœ°æ–¹ï¼Œä¾¿äºåç»­è¿˜åŸå…¶è¯¦ç»†çš„å…¥ä¾µæ”»å‡»è¿‡ç¨‹ã€‚</p></li></ul><ol start="2"><li>æŒ‰å…·ä½“å®ç°è¿‡ç¨‹åˆ’åˆ†</li></ol><ul><li><p>ç›‘æ§å„ç§ä¸»æœºé¡¹ï¼Œå¦‚ï¼šè¿›ç¨‹ã€æ–‡ä»¶ã€æ³¨å†Œè¡¨ã€ç½‘ç»œç­‰ã€‚</p></li><li><p>åŒæ—¶æäº¤ç»™å…¥ä¾µæ£€æµ‹ï¼Œä»¥è¯†åˆ«å…¶æ›´è¯¦ç»†çš„å…¥ä¾µæ‰‹æ®µï¼Œå¹¶å¯¹æ•´ä¸ªå…¥ä¾µè¿‡ç¨‹åšè¯¦ç»†è®°å½•ã€‚</p></li><li><p>å…¥ä¾µæ•°æ®æ±‡æ€»åˆ†æï¼Œå…¶å®å°±æ˜¯æŠŠä¸Šè¿°ä¸¤æ­¥æ‰€å¾—åˆ°çš„å„ç§æ•°æ®è¿›è¡Œé›†ä¸­åˆ†æï¼Œæœ€åå‹¾å‹’å‡ºå®Œæ•´çš„å…¥ä¾µè½¨è¿¹ç”»åƒã€‚</p></li></ul><ol start="3"><li>æœ€å®¹æ˜“ç†è§£çš„è¯´æ³•</li></ol><ul><li><p>èœœç½ç¯å¢ƒéš”ç¦»: ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒå°†ç‰©ç†ç¯å¢ƒå’Œèœœç½éš”ç»å¼€ï¼Œé˜²æ­¢æŸäº›æ•æ„Ÿæ“ä½œåœ¨å…¶çœŸå®çš„ç³»ç»Ÿç¯å¢ƒä¸­è¿›è¡Œé€ æˆç ´åã€‚</p></li><li><p>æ•æ„Ÿæ“ä½œè®°å½•ï¼šæŠŠèœœç½ä¸­æ‰€æœ‰çš„å…¥ä¾µæ“ä½œéƒ½å†™è¿›æ•°æ®åº“ã€‚</p></li><li><p>é‚®ä»¶æŠ¥è­¦ç³»ç»Ÿï¼šèœœç½è¢«å…¥ä¾µåè‡ªåŠ¨å‘é€æŠ¥è­¦é‚®ä»¶é€šçŸ¥ç›¸å…³å®‰å…¨åº”æ€¥äººå‘˜ã€‚</p></li></ul><a id="more"></a><h2 id="èœœç½çš„åˆ†ç±»">èœœç½çš„åˆ†ç±»</h2><p><strong>1. ä½äº¤äº’èœœç½</strong></p><p>ä½äº¤äº’èœœç½æœ€å¤§çš„ç‰¹ç‚¹æ˜¯ï¼šèœœç½ä¸ºæ”»å‡»è€…å±•ç¤ºçš„æ‰€æœ‰æ”»å‡»å¼±ç‚¹å’Œæ”»å‡»å¯¹è±¡éƒ½ä¸æ˜¯çœŸæ­£çš„äº§å“ç³»ç»Ÿï¼Œè€Œæ˜¯å¯¹å„ç§ç³»ç»ŸåŠå…¶æä¾›çš„æœåŠ¡çš„æ¨¡æ‹Ÿã€‚ç”±äºå®ƒçš„æœåŠ¡éƒ½æ˜¯æ¨¡æ‹Ÿçš„è¡Œä¸ºï¼Œæ‰€ä»¥èœœç½å¯ä»¥è·å¾—çš„ä¿¡æ¯éå¸¸æœ‰é™ï¼Œåªèƒ½å¯¹æ”»å‡»è€…è¿›è¡Œç®€å•çš„åº”ç­”ã€‚ä¸è¿‡ï¼Œå®ƒä¹Ÿæ˜¯æœ€å®‰å…¨çš„èœœç½ç±»å‹ã€‚</p><p><strong>2. ä¸­äº¤äº’èœœç½</strong></p><p>ä¸­äº¤äº’èœœç½æ˜¯å¯¹çœŸæ­£çš„æ“ä½œç³»ç»Ÿçš„å„ç§è¡Œä¸ºçš„æ¨¡æ‹Ÿï¼Œå®ƒæä¾›äº†æ›´å¤šçš„äº¤äº’ä¿¡æ¯ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ä»æ”»å‡»è€…çš„è¡Œä¸ºä¸­è·å¾—æ›´å¤šçš„ä¿¡æ¯ã€‚åœ¨è¿™ä¸ªæ¨¡æ‹Ÿè¡Œä¸ºçš„ç³»ç»Ÿä¸­ï¼Œèœœç½æ­¤æ—¶çœ‹èµ·æ¥å’Œä¸€ä¸ªçœŸæ­£çš„æ“ä½œç³»ç»Ÿæ²¡æœ‰åŒºåˆ«ï¼Œå®ƒä»¬ç”šè‡³æ˜¯æ¯”çœŸæ­£ç³»ç»Ÿè¿˜è¯±äººçš„æ”»å‡»ç›®æ ‡ã€‚</p><p><strong>3. é«˜äº¤äº’èœœç½</strong></p><p>é«˜äº¤äº’èœœç½å…·æœ‰ä¸€ä¸ªçœŸå®çš„æ“ä½œç³»ç»Ÿï¼Œå®ƒçš„ä¼˜ç‚¹ä½“ç°åœ¨å¯¹æ”»å‡»è€…æä¾›å®Œå…¨çœŸå®çš„ç³»ç»Ÿã€‚å½“æ”»å‡»è€…è·å¾— ROOT æƒé™åï¼Œå—ç³»ç»Ÿã€æ•°æ®çœŸå®æ€§çš„è¿·æƒ‘ï¼Œä»–çš„æ›´å¤šæ´»åŠ¨å’Œè¡Œä¸ºå°†è¢«è®°å½•ä¸‹æ¥ã€‚ç¼ºç‚¹æ˜¯è¢«å…¥ä¾µçš„å¯èƒ½æ€§å¾ˆé«˜ï¼Œå¦‚æœæ•´ä¸ªé«˜äº¤äº’èœœç½è¢«å…¥ä¾µï¼Œé‚£ä¹ˆå®ƒå°±ä¼šæˆä¸ºæ”»å‡»è€…ä¸‹ä¸€æ­¥æ”»å‡»çš„è·³æ¿ï¼Œä¸å¤ªå®‰å…¨ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯-cowrie">ä»€ä¹ˆæ˜¯ Cowrie</h2><p><code>Cowrie</code> æ˜¯ä¸€ä¸ªå…·æœ‰ä¸­ç­‰äº¤äº’çš„ <code>SSH</code> èœœç½ï¼Œå®ƒå¯ä»¥è·å–æ”»å‡»è€…ç”¨äºæš´åŠ›ç ´è§£çš„å­—å…¸ã€è¾“å…¥çš„å‘½ä»¤ä»¥åŠä¸Šä¼ æˆ–ä¸‹è½½çš„æ¶æ„æ–‡ä»¶ã€‚æ‰€æœ‰è¿™äº›æ”»å‡»è®°å½•éƒ½ä¼šè¢«è®°è½½åˆ°æ—¥å¿—ä¸­ï¼Œä»¥ä¾¿æ—¥ååˆ†æã€‚</p><blockquote><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/cowrie/cowrie" target="_blank" rel="noopener">https://github.com/cowrie/cowrie</a></p></blockquote><p><img src="http://image.3001.net/images/20160816/14713421328918.png" alt=""></p><h2 id="cowrie-å®‰è£…éƒ¨ç½²">Cowrie å®‰è£…éƒ¨ç½²</h2><h3 id="ä½¿ç”¨æºç éƒ¨ç½²">ä½¿ç”¨æºç éƒ¨ç½²</h3><p>æœ¬æ¬¡æ­å»ºä½¿ç”¨çš„åŸºç¡€ç¯å¢ƒæ˜¯ <code>Ubuntu</code> ï¼Œä»¥ä¸‹æ­¥éª¤é™¤åˆ‡æ¢åˆ°è™šæ‹Ÿç¯å¢ƒä¸­çš„æ“ä½œï¼Œå…¶å®ƒå‡ä¸º root æƒé™æ‰§è¡Œã€‚</p><h4 id="å®‰è£…å¿…è¦çš„æ”¯æŒè½¯ä»¶">å®‰è£…å¿…è¦çš„æ”¯æŒè½¯ä»¶</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Python 3</span><br><span class="line">$ sudo apt-get install git python-virtualenv libssl-dev libffi-dev build-essential libpython3-dev python3-minimal authbind virtualenv</span><br><span class="line"></span><br><span class="line"># Python 2</span><br><span class="line">$ sudo apt-get install git python-virtualenv libssl-dev libffi-dev build-essential libpython-dev python2.7-minimal authbind</span><br></pre></td></tr></table></figure><h4 id="æ·»åŠ ä¸€ä¸ªæ™®é€šç”¨æˆ·">æ·»åŠ ä¸€ä¸ªæ™®é€šç”¨æˆ·</h4><p>å¯¹å¤–æä¾›æœåŠ¡çš„ç¨‹åºå‡ä»¥æ™®é€šç”¨æˆ·èº«ä»½è¿è¡Œï¼Œèƒ½æ›´å¥½çš„ä¿è¯æœåŠ¡å™¨å®‰å…¨æ€§ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ sudo adduser --disabled-password cowrie</span><br><span class="line">Adding user &#39;cowrie&#39; ...</span><br><span class="line">Adding new group &#39;cowrie&#39; (1002) ...</span><br><span class="line">Adding new user &#39;cowrie&#39; (1002) with group &#39;cowrie&#39; ...</span><br><span class="line">Changing the user information for cowrie</span><br><span class="line">Enter the new value, or press ENTER for the default</span><br><span class="line">Full Name []:</span><br><span class="line">Room Number []:</span><br><span class="line">Work Phone []:</span><br><span class="line">Home Phone []:</span><br><span class="line">Other []:</span><br><span class="line">Is the information correct? [Y&#x2F;n]</span><br><span class="line"></span><br><span class="line">$ sudo su - cowrie</span><br></pre></td></tr></table></figure><h4 id="å®‰è£…-cowire">å®‰è£… Cowire</h4><p>ç”±äº <code>Cowire</code> æ˜¯é‡‡ç”¨ <code>Python</code> å¼€å‘ï¼Œä¸ºäº†æ–¹ä¾¿ç®¡ç†å’Œå®‰å…¨ï¼Œæˆ‘ä»¬å°±ç›´æ¥å°† <code>Cowire</code> éƒ¨ç½²åˆ° <code>Python</code> çš„è™šæ‹Ÿç¯å¢ƒä¸­ã€‚</p><ol><li>ä¸‹è½½ Cowire</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd &#x2F;home&#x2F;cowrie&#x2F;</span><br><span class="line">$ git clone https:&#x2F;&#x2F;github.com&#x2F;cowrie&#x2F;cowrie.git</span><br></pre></td></tr></table></figure><ol start="2"><li>åœ¨ Python è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£… Cowire</li></ol><ul><li>è¿›å…¥ <code>Cowrie</code> æ‰€åœ¨ç›®å½•ï¼Œå¹¶å®‰è£…è™šæ‹Ÿç¯å¢ƒ</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cd &#x2F;home&#x2F;cowrie&#x2F;cowrie</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨ Python 3 åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ virtualenv --python&#x3D;python3 cowrie-env</span><br><span class="line">New python executable in .&#x2F;cowrie&#x2F;cowrie-env&#x2F;bin&#x2F;python</span><br><span class="line">Installing setuptools, pip, wheel...done.</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨ Python 2 åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ virtualenv --python&#x3D;python2 cowrie-env</span><br><span class="line">New python executable in .&#x2F;cowrie&#x2F;cowrie-env&#x2F;bin&#x2F;python</span><br><span class="line">Installing setuptools, pip, wheel...done.</span><br></pre></td></tr></table></figure><ul><li>æ¿€æ´» Cowrie ç¯å¢ƒï¼Œå¹¶å®‰è£…å¿…è¦çš„è½¯ä»¶åŒ…</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ source cowrie-env&#x2F;bin&#x2F;activate</span><br><span class="line">(cowrie-env) $ pip install --upgrade pip</span><br><span class="line">(cowrie-env) $ pip install --upgrade -r requirements.txt</span><br></pre></td></tr></table></figure><ol start="3"><li>åˆ›å»ºå¹¶ä¿®æ”¹ Cowire çš„é…ç½®æ–‡ä»¶</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(cowrie-env) $ cd etc&#x2F;</span><br><span class="line">(cowrie-env) $ cp cowrie.cfg.dist cowrie.cfg</span><br><span class="line">(cowrie-env) $ vi cowrie.cfg</span><br></pre></td></tr></table></figure><ul><li>æ‰“å¼€ SSH æœåŠ¡ï¼Œå¹¶ä¸”ä¿®æ”¹ç›‘å¬ç«¯å£</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[ssh]</span><br><span class="line"></span><br><span class="line"># Enable SSH support</span><br><span class="line"># (default: true)</span><br><span class="line">enabled &#x3D; true</span><br><span class="line"></span><br><span class="line">listen_endpoints &#x3D; tcp:2222:interface&#x3D;0.0.0.0</span><br></pre></td></tr></table></figure><ul><li>é…ç½®æ—¥å¿—æ–‡ä»¶è¾“å‡º</li></ul><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>Cowire</code> æ”¯æŒå°†æ—¥å¿—è¾“å‡ºåˆ°å¤šä¸ªæ¥æ”¶ç»ˆç«¯ä¸­ã€‚æ¯”å¦‚ï¼šæ–‡ä»¶æ–‡ä»¶ã€<code>Cucko</code>oã€<code>ELK Stack</code>ã€<code>Graylog</code>ã€<code>Kippo-Graph</code>ã€<code>Splunk</code>ã€<code>SQL</code> (<code>MySQL</code>ã€<code>SQLite3</code>ã€<code>RethinkDB</code>) ç­‰ç­‰ä¸­ã€‚è¿™é‡Œæˆ‘ä»¬å°±æ¥è¯´è¯´æœ€å¸¸ç”¨çš„æ–‡æœ¬æ–‡ä»¶å’Œ <code>MySQL</code> æ•°æ®åº“ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># ä¿å­˜åœ¨æ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œéœ€è¦é…ç½®ä»¥ä¸‹ä¸€äº›å†…å®¹ã€‚</span><br><span class="line">[output_textlog]</span><br><span class="line">enabled &#x3D; true</span><br><span class="line">logfile &#x3D; $&#123;honeypot:log_path&#125;&#x2F;audit.log</span><br><span class="line">format &#x3D; text</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œéœ€è¦é…ç½®ä»¥ä¸‹ä¸€äº›å†…å®¹ã€‚</span><br><span class="line">[output_mysql]</span><br><span class="line">host &#x3D; localhost</span><br><span class="line">database &#x3D; cowrie</span><br><span class="line">username &#x3D; cowrie</span><br><span class="line">password &#x3D; PASSWORD HERE</span><br><span class="line">port &#x3D; 3306</span><br><span class="line">debug &#x3D; false</span><br><span class="line">enabled &#x3D; true</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯éœ€è¦ä¿å­˜åœ¨ <code>MySQL</code> æ•°æ®åº“ä¸­ï¼Œå½“ç„¶åªé…ç½®æ˜¯ä¸è¡Œçš„ï¼Œä½ è¿˜å¾—éœ€è¦æœ‰ä¸€ä¸ªå¯¹åº”çš„æ•°æ®åº“ã€‚å¦‚æœä½ æ²¡æœ‰ï¼Œå¯ä»¥æŒ‰ä¸‹é¢çš„æ­¥éª¤è¿›è¡Œå®‰è£…ã€‚</p><ul><li>å®‰è£… MySQL</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install mysql-server mysql-client libmysqlclient-dev python-mysqldb</span><br></pre></td></tr></table></figure><p>å®‰è£…æˆåŠŸåï¼Œä½ å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo netstat -tap | grep mysql</span><br></pre></td></tr></table></figure><ul><li>åœ¨ Python è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£… MySQL ä¾èµ–åŒ…</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ source cowrie-env&#x2F;bin&#x2F;activate</span><br><span class="line">$ pip install mysqlclient mysql-python</span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºåä¸º cowrie çš„æ•°æ®åº“</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mysql -u root -p</span><br><span class="line">mysql&gt; create database cowrie;</span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºä¸€ä¸ªç»™ Cowrie è®¿é—®æ•°æ®åº“çš„ç”¨æˆ·</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; GRANT INSERT, SELECT, UPDATE ON cowrie.* TO &#39;cowrie&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;PASSWORD HERE&#39;;</span><br><span class="line">mysql&gt; FLUSH PRIVILEGES;</span><br><span class="line">mysql&gt; exit</span><br></pre></td></tr></table></figure><ul><li>æ•°æ®åº“å’Œå¯¹åº”çš„æ•°æ®åº“ç”¨æˆ·åˆ›å»ºå®Œæˆåï¼Œåœ¨æ•°æ®åº“ä¸­å¯¼å…¥åˆå§‹æ•°æ®çš„ SQL è¯­å¥</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ cd ~&#x2F;cowrie&#x2F;docs&#x2F;sql&#x2F;</span><br><span class="line">$ mysql -u cowrie -p</span><br><span class="line">mysql&gt; USE cowrie;</span><br><span class="line">mysql&gt; source mysql.sql;</span><br><span class="line">mysql&gt; exit</span><br></pre></td></tr></table></figure><ol start="4"><li>åœ¨ Python è™šæ‹Ÿç¯å¢ƒä¸‹å¯åŠ¨èœœç½</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(cowrie-env) $ bin&#x2F;cowrie start</span><br><span class="line">Activating virtualenv &quot;cowrie-env&quot;</span><br><span class="line">Starting cowrie with extra arguments [] ...</span><br></pre></td></tr></table></figure><ol start="5"><li>ä¿®æ”¹ SSH é»˜è®¤çš„ç›‘å¬ç«¯å£</li></ol><p>åœ¨ <code>root</code> ç”¨æˆ·ä¸‹å°† <code>Ubuntu</code> è‡ªèº«çš„ <code>SSH</code> ç›‘å¬ç«¯å£è¿›è¡Œæ›´æ”¹ï¼Œå¹¶ä¿®æ”¹ <code>Iptables</code> è§„åˆ™ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éªŒè¯ä¸‹æ˜¯å¦å®‰è£… <code>SSH</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ps -ef|grep sshd</span><br><span class="line">root      2720     1  0 Nov 02 ? 00:00:00 &#x2F;usr&#x2F;sbin&#x2F;sshd</span><br></pre></td></tr></table></figure><p>å¦‚æœè¾“å‡ºç»“æœå’Œä»¥ä¸Šç±»ä¼¼å°±è¯æ˜å·²ç»å®‰è£…ï¼Œæ²¡æœ‰å®‰è£…çš„è¯å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ apt-get install openssh-server</span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ <code>sshd_config</code> æ–‡ä»¶å°†é»˜è®¤ç«¯å£æ”¹ä¸ºä¸€ä¸ªè¾ƒé«˜çš„ç«¯å£ï¼Œè¿™é‡Œä¸º 51268 ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ vim &#x2F;etc&#x2F;ssh&#x2F;sshd_config</span><br><span class="line"># Port 22</span><br><span class="line">Port 51268</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šä¸€å®šä¸è¦ä¸ <code>cowrie.cfg</code> æ–‡ä»¶ä¸­ç›‘å¬çš„ç«¯å£ä¸€è‡´ï¼Œå¦åˆ™è¿›å…¥ <code>22</code> ç«¯å£çš„æµé‡å°±è½¬å‘åˆ°çœŸæ­£çš„ <code>SSH</code> æœåŠ¡ç«¯å£ï¼Œèœœç½å°±ä¸èµ·ä½œç”¨äº†ã€‚</p></blockquote><ol start="6"><li>é…ç½® Iptables è¿›è¡Œç«¯å£è½¬å‘</li></ol><p>ä»¥ä¸Šéƒ½é…ç½®å¥½åï¼Œæœ€åå°±æ˜¯åœ¨ <code>Iptables</code> ä¸­æ–°å¢ä¸€æ¡è½¬å‘è§„åˆ™ï¼Œå°†é»˜è®¤åˆ° <code>22</code> ç«¯å£çš„è¯·æ±‚è½¬å‘åˆ°èœœç½ä¸­å¯¹åº”çš„ç«¯å£ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo iptables -t nat -A PREROUTING -p tcp --dport 22 -j REDIRECT --to-port 2222</span><br><span class="line">$ iptables-save</span><br></pre></td></tr></table></figure><p>é™¤äº†ä½¿ç”¨ <code>Iptables</code> å¤–ï¼Œä½ è¿˜å¯ä»¥åœ¨æ²¡æœ‰ <code>Root</code> æƒé™çš„æ¡ä»¶ä¸‹ä½¿ç”¨ <code>Authbind</code> æˆ– <code>Setcap</code> å°†èœœç½ç»‘å®šåˆ°ä¸€äº›ç‰¹æƒç«¯å£ä¸Šï¼Œä»¥è¾¾åˆ°ä¼ªè£…ä¸€äº›æ­£å¸¸æœåŠ¡çš„ç›®çš„ã€‚å…·ä½“æ–¹æ³•å¯ä»¥å‚è§å®˜æ–¹æ–‡æ¡£å¦‚ä¸‹éƒ¨åˆ†ï¼š</p><blockquote><ol><li><p><a href="https://cowrie.readthedocs.io/en/latest/INSTALL.html#authbind" target="_blank" rel="noopener">https://cowrie.readthedocs.io/en/latest/INSTALL.html#authbind</a></p></li><li><p><a href="https://cowrie.readthedocs.io/en/latest/INSTALL.html#setcap" target="_blank" rel="noopener">https://cowrie.readthedocs.io/en/latest/INSTALL.html#setcap</a></p></li></ol></blockquote><h3 id="ä½¿ç”¨-docker-éƒ¨ç½²">ä½¿ç”¨ Docker éƒ¨ç½²</h3><p>ä¸Šé¢è®²è§£çš„é€šè¿‡æºç å®‰è£…ï¼Œä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤º <code>Cowrie</code> å¦‚ä½•å·¥ä½œçš„ï¼Œå½“ç„¶æœ€æ–¹ä¾¿çš„è¿˜æ˜¯ç›´æ¥ä½¿ç”¨ <code>Docker</code> éƒ¨ç½²ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -p 2222:2222 cowrie&#x2F;cowrie</span><br><span class="line">$ ssh -p 2222 root@localhost</span><br></pre></td></tr></table></figure><p>å¦‚ä¸Šæ‰€ç¤ºï¼Œåªéœ€ä¸€æ¡æŒ‡ä»¤ï¼Œ<code>Cowrie</code> å°±éƒ¨ç½²å®Œæˆäº†ã€‚å‰©ä¸‹å°±åªéœ€è¦è‡ªå·±ç”¨ <code>Iptables</code> è¿›è¡Œç«¯å£è½¬å‘å°±å¯ä»¥äº†ã€‚</p><h2 id="cowrie-æ—¥å¿—åˆ†æ">Cowrie æ—¥å¿—åˆ†æ</h2><p>èœœç½ç³»ç»Ÿçš„ä½œç”¨ä¸»è¦æ˜¯ç”¨ä½œå®æ—¶è®°å½•å’Œå®¡è®¡å…¥ä¾µè€…æ”»å‡»è¡Œä¸ºå’Œæ•°æ®ï¼Œæ‰€ä»¥æœ€é‡è¦çš„è¿˜æ˜¯äº‹åçš„æ—¥å¿—åˆ†æå·¥ä½œã€‚</p><ol><li>å¦‚æœæ—¥å¿—è®°å½•åœ¨æ–‡æœ¬æ–‡ä»¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è¿›è¡Œä¸€äº›æ•°æ®ç»Ÿè®¡åˆ†æã€‚</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ grep login &#x2F;home&#x2F;cowrie&#x2F;cowrie&#x2F;var&#x2F;log&#x2F;cowrie&#x2F;audit.log | awk &#39;&#123;print $5&#125;&#39; | sort | uniq -c</span><br></pre></td></tr></table></figure><ol start="2"><li>å¦‚æœæ—¥å¿—è®°å½•åœ¨æ•°æ®åº“ï¼Œä½ å¯ä»¥é€šè¿‡ä¸‹é¢çš„ä¸€äº›æ–¹å¼è¿›è¡Œä¸€äº›æ•°æ®ç»Ÿè®¡åˆ†æã€‚</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ mysql -u cowrie -p</span><br><span class="line">mysql&gt; USE cowrie;</span><br><span class="line">mysql&gt; SELECT * FROM auth;</span><br><span class="line">+----+--------------+---------+----------+-------------+---------------------+</span><br><span class="line">| id | session      | success | username | password    | timestamp           |</span><br><span class="line">+----+--------------+---------+----------+-------------+---------------------+</span><br><span class="line">|  1 | a551c0a74e06 |       0 | root     | 12345       | 2019-09-27 23:15:56 |</span><br><span class="line">|  2 | a551c0a74e06 |       0 | root     | seiko2005   | 2019-09-27 23:15:58 |</span><br><span class="line">|  3 | a551c0a74e06 |       0 | root     | anko        | 2019-09-27 23:15:59 |</span><br><span class="line">|  4 | a551c0a74e06 |       0 | root     | 123456      | 2019-09-27 23:16:00 |</span><br><span class="line">|  5 | a551c0a74e06 |       0 | root     | dreambox    | 2019-09-27 23:16:01 |</span><br></pre></td></tr></table></figure><p>å½“ç„¶ä¸Šé¢åªæ˜¯ä¸¾äº†ä¸€äº›ç®€å•çš„ä¾‹å­ï¼Œæ›´å¤šé«˜çº§ç©æ³•è¿˜ç­‰ç€ä½ å»æ¢ç´¢å“Ÿï¼</p><h2 id="å…¶å®ƒ">å…¶å®ƒ</h2><p>ç›®å‰å¼€æºçš„èœœç½ç³»ç»Ÿæœ‰å¾ˆå¤šï¼Œé™¤äº† <code>Cowrie</code> ä»¥å¤–ï¼Œè¿˜æœ‰ <code>Kippo</code>ã€<code>T-Pot</code>ã€<code>MHN</code>ã€<code>SSH-Honeypot</code> ç­‰ç­‰ã€‚å¦‚æœä½ å¯¹èœœç½ç³»ç»Ÿå¾ˆæ„Ÿå…´è¶£ï¼Œå¯ä»¥å‚è€ƒ <code>GitHub</code> ä¸Šä»¥ä¸‹ä¸¤ä¸ªå¼€æºé¡¹ç›®ã€‚</p><blockquote><ol><li><p><a href="https://github.com/jwxa2015/honeypotcollection" target="_blank" rel="noopener">https://github.com/jwxa2015/honeypotcollection</a></p></li><li><p><a href="https://github.com/paralax/awesome-honeypots" target="_blank" rel="noopener">https://github.com/paralax/awesome-honeypots</a></p></li></ol></blockquote><p>è‡³æ­¤ï¼Œä½¿ç”¨ <code>Cowrie</code> å¿«é€Ÿæ„å»ºä¸€ä¸ªèœœç½ç³»ç»Ÿçš„åŸºæœ¬æ–¹æ³•å°±ä»‹ç»å®Œäº†ã€‚å¦‚æœä½ å¯¹ <code>Cowrie</code> éå¸¸çš„æ„Ÿå…´è¶£ï¼Œè¿˜å¯ä»¥å»å®˜ç½‘æ¢ç´¢æ›´å¤šé«˜çº§åŠŸèƒ½å“Ÿï¼</p><p>å¯¹äºå¿«é€Ÿæ„å»ºä¸€ä¸ªèœœç½ç³»ç»Ÿï¼Œä½ è¿˜æœ‰å“ªäº›æ›´å¥½ç”¨é«˜æ•ˆçš„æ–¹æ³•å‘¢ï¼Ÿæ¬¢è¿å¤§å®¶åœ¨ç•™è¨€è®¨è®ºå“Ÿï¼</p><h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2><ol><li><p><a href="https://www.google.com" target="_blank" rel="noopener">https://www.google.com</a></p></li><li><p><a href="https://cowrie.readthedocs.io/en/latest/" target="_blank" rel="noopener">https://cowrie.readthedocs.io/en/latest/</a></p></li><li><p><a href="https://www.cnblogs.com/bmjoker/p/10156220.html" target="_blank" rel="noopener">https://www.cnblogs.com/bmjoker/p/10156220.html</a></p></li><li><p><a href="https://www.cnblogs.com/HacTF/p/8094516.html" target="_blank" rel="noopener">https://www.cnblogs.com/HacTF/p/8094516.html</a></p></li><li><p><a href="https://klionsec.github.io/2017/10/19/cowrie/" target="_blank" rel="noopener">https://klionsec.github.io/2017/10/19/cowrie/</a></p></li><li><p><a href="https://www.twblogs.net/a/5cb0b56bbd9eee48d788646c" target="_blank" rel="noopener">https://www.twblogs.net/a/5cb0b56bbd9eee48d788646c</a></p></li><li><p><a href="https://ama2in9.top/2019/03/12/cowrie/" target="_blank" rel="noopener">https://ama2in9.top/2019/03/12/cowrie/</a></p></li></ol></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä»€ä¹ˆæ˜¯èœœç½&quot;&gt;ä»€ä¹ˆæ˜¯èœœç½&lt;/h2&gt;
&lt;p&gt;èœœç½å…¶å®å°±æ˜¯ä¸€å°æ— äººä½¿ç”¨ä½†å´è¢«ä¸¥å¯†ç›‘æ§çš„ç½‘ç»œä¸»æœºï¼Œé‡Œé¢åŒ…å«ç€å„ç±»è™šå‡çš„é«˜ä»·å€¼èµ„æºå’Œä¸€äº›å·²çŸ¥æ¼æ´ï¼Œä»¥æ­¤å¸å¼•å…¥ä¾µè€…æ¥å…¥ä¾µè¯¥ä¸»æœºã€‚å¹¶ä¸”åœ¨è¢«å…¥ä¾µçš„è¿‡ç¨‹ä¸­ï¼Œå®æ—¶è®°å½•å’Œå®¡è®¡å…¥ä¾µè€…çš„æ‰€æœ‰å…¥ä¾µæ”»å‡»æµé‡ã€è¡Œä¸ºå’Œæ•°æ®ã€‚ä»¥æ­¤äº†è§£å…¥ä¾µè€…çš„æ”»å‡»æ–¹å¼ã€æ‰‹æ®µå’Œç›®çš„ï¼Œä¾¿äºåæœŸå¿«é€Ÿå®Œæˆå¯¹å…¶çš„æº¯æºå’Œå–è¯å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;èœœç½çš„ä¸€äº›ä¸»è¦æ„æˆæ¨¡å—&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æŒ‰å®ç°é€»è¾‘åˆ’åˆ†&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ§åˆ¶ï¼šå°†å…¥ä¾µè€…ç‰¢ç‰¢æ§åˆ¶åœ¨æŒ‡å®šçš„ç½‘ç»œèŒƒå›´ä¸­ï¼Œä½¿å…¶ä¸èƒ½å†ä»¥æ­¤æœºå™¨ä½œä¸ºè·³æ¿æ¥æ”»å‡»å…¶å®ƒçš„æœºå™¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ•è·ï¼šæŠŠå…¥ä¾µè€…åœ¨å…¥ä¾µè¿‡ç¨‹ä¸­æ‰€äº§ç”Ÿçš„å„ç§æµé‡æ•è·ä½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆ†æï¼šå°†æ•è·åˆ°çš„å„ç§æ•°æ®å­˜åˆ°æ•°æ®åº“æˆ–è€…å…¶å®ƒæŒ‡å®šåœ°æ–¹ï¼Œä¾¿äºåç»­è¿˜åŸå…¶è¯¦ç»†çš„å…¥ä¾µæ”»å‡»è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;æŒ‰å…·ä½“å®ç°è¿‡ç¨‹åˆ’åˆ†&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç›‘æ§å„ç§ä¸»æœºé¡¹ï¼Œå¦‚ï¼šè¿›ç¨‹ã€æ–‡ä»¶ã€æ³¨å†Œè¡¨ã€ç½‘ç»œç­‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åŒæ—¶æäº¤ç»™å…¥ä¾µæ£€æµ‹ï¼Œä»¥è¯†åˆ«å…¶æ›´è¯¦ç»†çš„å…¥ä¾µæ‰‹æ®µï¼Œå¹¶å¯¹æ•´ä¸ªå…¥ä¾µè¿‡ç¨‹åšè¯¦ç»†è®°å½•ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å…¥ä¾µæ•°æ®æ±‡æ€»åˆ†æï¼Œå…¶å®å°±æ˜¯æŠŠä¸Šè¿°ä¸¤æ­¥æ‰€å¾—åˆ°çš„å„ç§æ•°æ®è¿›è¡Œé›†ä¸­åˆ†æï¼Œæœ€åå‹¾å‹’å‡ºå®Œæ•´çš„å…¥ä¾µè½¨è¿¹ç”»åƒã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;æœ€å®¹æ˜“ç†è§£çš„è¯´æ³•&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;èœœç½ç¯å¢ƒéš”ç¦»: ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒå°†ç‰©ç†ç¯å¢ƒå’Œèœœç½éš”ç»å¼€ï¼Œé˜²æ­¢æŸäº›æ•æ„Ÿæ“ä½œåœ¨å…¶çœŸå®çš„ç³»ç»Ÿç¯å¢ƒä¸­è¿›è¡Œé€ æˆç ´åã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ•æ„Ÿæ“ä½œè®°å½•ï¼šæŠŠèœœç½ä¸­æ‰€æœ‰çš„å…¥ä¾µæ“ä½œéƒ½å†™è¿›æ•°æ®åº“ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é‚®ä»¶æŠ¥è­¦ç³»ç»Ÿï¼šèœœç½è¢«å…¥ä¾µåè‡ªåŠ¨å‘é€æŠ¥è­¦é‚®ä»¶é€šçŸ¥ç›¸å…³å®‰å…¨åº”æ€¥äººå‘˜ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="SSH" scheme="https://www.hi-linux.com/categories/SSH/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="æŠ€å·§" scheme="https://www.hi-linux.com/tags/%E6%8A%80%E5%B7%A7/"/>
    
      <category term="SSH" scheme="https://www.hi-linux.com/tags/SSH/"/>
    
  </entry>
  
  <entry>
    <title>åˆ†äº«ä¸€ä¸ªè¶…å®ç”¨çš„ Web ç‰ˆ SSH å·¥å…· Sshwifty</title>
    <link href="https://www.hi-linux.com/posts/2389.html"/>
    <id>https://www.hi-linux.com/posts/2389.html</id>
    <published>2020-05-09T01:00:00.000Z</published>
    <updated>2020-05-09T03:23:02.448Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><p>æ— è®ºä½ æ˜¯ä¸€åå¼€å‘æˆ–è€…è¿ç»´ï¼Œç›¸ä¿¡éƒ½å¯¹ <code>SSH</code> è¿™ä¸ªå·¥å…·éƒ½ä¸é™Œç”Ÿã€‚ä¸ç®¡æ˜¯å¼€å‘éœ€è¦è®¿é—®æœåŠ¡å™¨å¤„ç†ç¨‹åºé”™è¯¯è¿˜æ˜¯è¿ç»´è®¿é—®æœåŠ¡å™¨å¤„ç†æœåŠ¡å¼‚å¸¸ï¼Œæˆ‘ä»¬éƒ½éœ€è¦é€šè¿‡ <code>SSH</code> åè®®æ¥è¿œç¨‹è¿æ¥åˆ°æœåŠ¡å™¨ã€‚</p><p>é€šå¸¸æˆ‘ä»¬ä½¿ç”¨ <code>SSH</code> åè®®è®¿é—®æœåŠ¡å™¨åŸºæœ¬éƒ½æ˜¯ä½¿ç”¨ <code>SSH</code> å®¢æˆ·ç«¯è½¯ä»¶ï¼Œæ¯”å¦‚ï¼š<code>Xshell</code>ã€<code>Putty</code>ã€<code>SecureCRT</code>ã€<code>iTerm 2</code> ç­‰ã€‚è¿™äº›å®¢æˆ·ç«¯è½¯ä»¶è™½ç„¶ä½¿ç”¨ä¸Šéƒ½æ¯”è¾ƒæ–¹ä¾¿ï¼Œä½†åœ¨æœ‰äº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ²¡æœ‰å®‰è£… <code>SSH</code> å®¢æˆ·ç«¯çš„ç¯å¢ƒä¸‹è®¿é—®è¿œç¨‹æœåŠ¡å™¨ã€‚è¿™æ—¶æˆ‘ä»¬åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Œå½“ç„¶æ˜¯æœ‰åŠæ³•è§£å†³çš„ï¼Œé‚£å°±æ˜¯é€šè¿‡ <code>WebSSH</code> è¿™ç§æ–¹æ³•æ¥è¿›è¡Œè®¿é—®ã€‚</p><blockquote><p><code>WebSSH</code> æ³›æŒ‡ä¸€ç§å¯ä»¥åœ¨ç½‘é¡µä¸Šå®ç°ä¸€ä¸ª <code>SSH</code> ç»ˆç«¯çš„æŠ€æœ¯ã€‚ä»è€Œæ— éœ€ä»»ä½• <code>SSH</code> å®¢æˆ·ç«¯å·¥å…·å°±å¯è¿›è¡Œ <code>SSH</code> è¿æ¥ï¼Œå°† <code>SSH</code> ä» <code>C/S</code> æ¶æ„è½¬å˜æˆäº† <code>B/S</code> æ¶æ„ã€‚</p></blockquote><p>ç›®å‰ï¼Œå¯ä»¥å®ç° <code>WebSSH</code> çš„è½¯ä»¶æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ï¼š<code>GateOne</code>ã€<code>Shellinabox</code>ã€<code>WSSH</code>ã€<code>Xterm.js</code> ç­‰ï¼Œè€Œæˆ‘ä»¬ä»Šå¤©è¦ä»‹ç»çš„æ˜¯ä¸€æ¬¾æ›´ä¸ºå¼ºå¤§çš„ <code>WebSSH</code> è½¯ä»¶ <code>Sshwifty</code>ã€‚<code>Sshwifty</code> ä½¿ç”¨ <code>Go</code>ã€<code>Vuejs</code> å’Œ <code>xtermjs</code> è¿›è¡Œå¼€å‘ï¼Œå‡ ä¹å®ç°äº†ç›®å‰æ‰€æœ‰  <code>WebSSH</code> è½¯ä»¶çš„åŠŸèƒ½ã€‚</p><blockquote><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/niruix/sshwifty" target="_blank" rel="noopener">https://github.com/niruix/sshwifty</a></p></blockquote><p><img src="https://github.com/niruix/sshwifty/raw/master/Screenshot.png" alt=""></p><a id="more"></a><h2 id="å®‰è£…-sshwifty">å®‰è£… Sshwifty</h2><ol><li>é€šè¿‡äºŒè¿›åˆ¶åŒ…å®‰è£…</li></ol><p>ç”±äº  <code>Sshwifty</code> é‡‡ç”¨ <code>Go</code> è¯­è¨€å¼€å‘ï¼Œè‰¯å¥½çš„åŸç”Ÿè·¨å¹³å°æ”¯æŒã€‚å®‰è£…èµ·æ¥éå¸¸ç®€å•ï¼ŒåŸºæœ¬å¼€ç®±å³ç”¨ã€‚è¿™é‡Œä»¥ <code>Linux</code> å¹³å°ä¸ºä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># ä¸‹è½½å¹¶è§£å‹ Sshwifty å®‰è£…åŒ…</span><br><span class="line">$ wget https:&#x2F;&#x2F;github.com&#x2F;niruix&#x2F;sshwifty&#x2F;releases&#x2F;download&#x2F;0.1.0-beta-release-prebuild&#x2F;sshwifty_0.1.0-beta-release_linux_amd64.tar.gz</span><br><span class="line">$ tar -xzvf sshwifty_0.1.0-beta-release_linux_amd64.tar.gz</span><br><span class="line"></span><br><span class="line"># å¤åˆ¶å¯æ‰§è¡Œæ–‡ä»¶åˆ°æŒ‡å®šç›®å½•å¹¶èµ‹äºˆæ‰§è¡Œæƒé™</span><br><span class="line">$ cp sshwifty_linux_amd64 &#x2F;usr&#x2F;local&#x2F;bin&#x2F;sshwifty</span><br><span class="line">$ chmod +x &#x2F;usr&#x2F;local&#x2F;bin&#x2F;sshwifty</span><br><span class="line"></span><br><span class="line"># ç”Ÿæˆé»˜è®¤é…ç½®æ–‡ä»¶</span><br><span class="line">$ cp sshwifty.conf.example.json &#x2F;etc&#x2F;sshwifty.conf.json</span><br><span class="line"></span><br><span class="line"># å¯åŠ¨ Sshwifty</span><br><span class="line">$ sshwifty</span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨é»˜è®¤é…ç½®æ–‡ä»¶ä¼šåœ¨ <code>127.0.0.1</code> çš„ <code>8182</code> ç«¯å£å¯åŠ¨ <code>Sshwifty</code> æœåŠ¡ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªè¡Œéœ€è¦æ›´æ”¹ã€‚</p></blockquote><p>æ›´å¤šå¹³å°çš„äºŒè¿›åˆ¶å®‰è£…åŒ…ï¼Œå¯è‡ªè¡Œåœ¨å®˜æ–¹é¡¹ç›®åœ°å€çš„ <a href="https://github.com/niruix/sshwifty/releases" target="_blank" rel="noopener">Releases</a> é¡µé¢è¿›è¡Œä¸‹è½½ã€‚</p><ol start="2"><li>é€šè¿‡ Docker å®‰è£…</li></ol><p>å¦‚æœä½ ä¼šä¸€ç‚¹ <code>Docker</code> çš„è¯ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨ <code>Docker</code> è¿›è¡Œéƒ¨ç½²å®‰è£…ã€‚é€šè¿‡ <code>Docker</code> å®‰è£…ä»…éœ€è¦ä¸€æ¡æŒ‡ä»¤å°±å¯ä»¥æå®šï¼Œæ¯”äºŒè¿›åˆ¶åŒ…å®‰è£…æ›´åŠ çš„ç®€å•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ docker run --detach \</span><br><span class="line">  --restart&#x3D;always \</span><br><span class="line">  --publish 8182:8182 \</span><br><span class="line">  --name sshwifty \</span><br><span class="line">  niruix&#x2F;sshwifty:latest</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ æƒ³ç»™ <code>Sshwifty</code> éƒ¨ç½²ä¸€ä¸ª <code>HTTPS</code> è¯ä¹¦ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹çš„æŒ‡ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ docker run --detach \</span><br><span class="line">  --restart&#x3D;always \</span><br><span class="line">  --publish 8182:8182 \</span><br><span class="line">  --env SSHWIFTY_DOCKER_TLSCERT&#x3D;&quot;$(cat &#x2F;path&#x2F;to&#x2F;domain.crt)&quot;</span><br><span class="line">  --env SSHWIFTY_DOCKER_TLSCERTKEY&#x3D;&quot;$(cat &#x2F;path&#x2F;to&#x2F;domain.key)&quot;</span><br><span class="line">  --name sshwifty \</span><br><span class="line">  niruix&#x2F;sshwifty:latest</span><br></pre></td></tr></table></figure><blockquote><p><code>/path/to/domain.crt</code> å’Œ <code>/path/to/domain.key</code> æ˜¯ç”¨æ¥æŒ‡å®šæœ¬åœ° <code>HTTPS</code> è¯ä¹¦å’Œå¯†é’¥æ–‡ä»¶æ‰€åœ¨çš„ä½ç½®ã€‚</p></blockquote><h2 id="ä½¿ç”¨-sshwifty">ä½¿ç”¨ Sshwifty</h2><p><code>Sshwifty</code> éƒ¨ç½²å¥½åï¼Œç›´æ¥ç”¨æµè§ˆå™¨è®¿é—®ç›¸åº”åœ°å€å³å¯ä½¿ç”¨ã€‚é¦–æ¬¡è®¿é—®æ—¶ï¼Œä¼šè¦æ±‚è¾“å…¥ä¸€ä¸ªè®¤è¯å£ä»¤ã€‚</p><p><img src="https://i.loli.net/2019/09/16/DiOCrIVw6mPYEnu.png" alt=""></p><blockquote><p>é»˜è®¤å£ä»¤ä¸ºï¼š<code>WEB_ACCESS_PASSWORD</code>ï¼Œå¦‚éœ€ä¿®æ”¹å¯å˜æ›´é…ç½®æ–‡ä»¶ä¸­çš„ <code>&quot;SharedKey&quot;: &quot;WEB_ACCESS_PASSWORD&quot;</code> é…ç½®é¡¹ã€‚</p></blockquote><p>è®¤è¯å®Œæˆåï¼ŒæˆåŠŸç™»é™† <code>Sshwifty</code>ã€‚</p><p><img src="https://i.loli.net/2019/09/16/Uj5ClXMmyA3wLTF.png" alt=""></p><p>ç‚¹å‡»å·¦ä¸Šè§’ <code>+</code> å·å›¾æ ‡åï¼Œå°±å¯æ–°å»ºä¸€ä¸ªè®¿é—®è¿œç¨‹æœåŠ¡å™¨ <code>SSH</code> æˆ– <code>Telnet</code> çš„è¿æ¥ã€‚</p><p><img src="https://i.loli.net/2019/09/16/SgXJMa2ECVxDBfA.png" alt=""></p><p>å¦‚æœä½ è§‰å¾—è‡ªå·²éƒ¨ç½²è¿˜æ˜¯å¤ªéº»çƒ¦ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨å®˜æ–¹æä¾›çš„æ¼”ç¤ºåœ°å€è¿›è¡Œä½“éªŒå“Ÿï¼</p><blockquote><p>å®˜æ–¹æ¼”ç¤ºåœ°å€ï¼š<a href="https://sshwifty.herokuapp.com/" target="_blank" rel="noopener">https://sshwifty.herokuapp.com/</a></p></blockquote><p>ä½ åœ¨è¿™é‡Œä¸ä»…å¯ä»¥ä½“éªŒ <code>Sshwifty</code> çš„å¼ºå¤§åŠŸèƒ½ï¼Œè¿˜å¯ä»¥åœ¨è¿™é‡Œè§‚çœ‹æœ‰è¶£çš„æ˜Ÿçƒå¤§æˆ˜ <code>Telnet</code> ç‰ˆå“Ÿï¼</p><p><img src="https://i.loli.net/2019/09/16/E4VAHQi9Mm8FTJw.png" alt=""></p><p>è‡³æ­¤ï¼Œ<code>Sshwifty</code> çš„åŸºæœ¬ä½¿ç”¨å°±å·²ç»ä»‹ç»å®Œæˆäº†ã€‚å¦‚æœä½ å¯¹å®ƒå¾ˆæœ‰å…´è¶£ï¼Œå¯ä»¥è‡ªè¡Œå»å®˜ç½‘è¿›è¡Œæ¢ç´¢å“Ÿï¼</p><h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2><ol><li><p><a href="https://www.google.com" target="_blank" rel="noopener">https://www.google.com</a></p></li><li><p><a href="https://github.com/niruix/sshwifty" target="_blank" rel="noopener">https://github.com/niruix/sshwifty</a></p></li><li><p><a href="https://www.cnblogs.com/franknihao/p/8963634.html" target="_blank" rel="noopener">https://www.cnblogs.com/franknihao/p/8963634.html</a></p></li></ol></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ— è®ºä½ æ˜¯ä¸€åå¼€å‘æˆ–è€…è¿ç»´ï¼Œç›¸ä¿¡éƒ½å¯¹ &lt;code&gt;SSH&lt;/code&gt; è¿™ä¸ªå·¥å…·éƒ½ä¸é™Œç”Ÿã€‚ä¸ç®¡æ˜¯å¼€å‘éœ€è¦è®¿é—®æœåŠ¡å™¨å¤„ç†ç¨‹åºé”™è¯¯è¿˜æ˜¯è¿ç»´è®¿é—®æœåŠ¡å™¨å¤„ç†æœåŠ¡å¼‚å¸¸ï¼Œæˆ‘ä»¬éƒ½éœ€è¦é€šè¿‡ &lt;code&gt;SSH&lt;/code&gt; åè®®æ¥è¿œç¨‹è¿æ¥åˆ°æœåŠ¡å™¨ã€‚&lt;/p&gt;
&lt;p&gt;é€šå¸¸æˆ‘ä»¬ä½¿ç”¨ &lt;code&gt;SSH&lt;/code&gt; åè®®è®¿é—®æœåŠ¡å™¨åŸºæœ¬éƒ½æ˜¯ä½¿ç”¨ &lt;code&gt;SSH&lt;/code&gt; å®¢æˆ·ç«¯è½¯ä»¶ï¼Œæ¯”å¦‚ï¼š&lt;code&gt;Xshell&lt;/code&gt;ã€&lt;code&gt;Putty&lt;/code&gt;ã€&lt;code&gt;SecureCRT&lt;/code&gt;ã€&lt;code&gt;iTerm 2&lt;/code&gt; ç­‰ã€‚è¿™äº›å®¢æˆ·ç«¯è½¯ä»¶è™½ç„¶ä½¿ç”¨ä¸Šéƒ½æ¯”è¾ƒæ–¹ä¾¿ï¼Œä½†åœ¨æœ‰äº›åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ²¡æœ‰å®‰è£… &lt;code&gt;SSH&lt;/code&gt; å®¢æˆ·ç«¯çš„ç¯å¢ƒä¸‹è®¿é—®è¿œç¨‹æœåŠ¡å™¨ã€‚è¿™æ—¶æˆ‘ä»¬åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Œå½“ç„¶æ˜¯æœ‰åŠæ³•è§£å†³çš„ï¼Œé‚£å°±æ˜¯é€šè¿‡ &lt;code&gt;WebSSH&lt;/code&gt; è¿™ç§æ–¹æ³•æ¥è¿›è¡Œè®¿é—®ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;WebSSH&lt;/code&gt; æ³›æŒ‡ä¸€ç§å¯ä»¥åœ¨ç½‘é¡µä¸Šå®ç°ä¸€ä¸ª &lt;code&gt;SSH&lt;/code&gt; ç»ˆç«¯çš„æŠ€æœ¯ã€‚ä»è€Œæ— éœ€ä»»ä½• &lt;code&gt;SSH&lt;/code&gt; å®¢æˆ·ç«¯å·¥å…·å°±å¯è¿›è¡Œ &lt;code&gt;SSH&lt;/code&gt; è¿æ¥ï¼Œå°† &lt;code&gt;SSH&lt;/code&gt; ä» &lt;code&gt;C/S&lt;/code&gt; æ¶æ„è½¬å˜æˆäº† &lt;code&gt;B/S&lt;/code&gt; æ¶æ„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç›®å‰ï¼Œå¯ä»¥å®ç° &lt;code&gt;WebSSH&lt;/code&gt; çš„è½¯ä»¶æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ï¼š&lt;code&gt;GateOne&lt;/code&gt;ã€&lt;code&gt;Shellinabox&lt;/code&gt;ã€&lt;code&gt;WSSH&lt;/code&gt;ã€&lt;code&gt;Xterm.js&lt;/code&gt; ç­‰ï¼Œè€Œæˆ‘ä»¬ä»Šå¤©è¦ä»‹ç»çš„æ˜¯ä¸€æ¬¾æ›´ä¸ºå¼ºå¤§çš„ &lt;code&gt;WebSSH&lt;/code&gt; è½¯ä»¶ &lt;code&gt;Sshwifty&lt;/code&gt;ã€‚&lt;code&gt;Sshwifty&lt;/code&gt; ä½¿ç”¨ &lt;code&gt;Go&lt;/code&gt;ã€&lt;code&gt;Vuejs&lt;/code&gt; å’Œ &lt;code&gt;xtermjs&lt;/code&gt; è¿›è¡Œå¼€å‘ï¼Œå‡ ä¹å®ç°äº†ç›®å‰æ‰€æœ‰  &lt;code&gt;WebSSH&lt;/code&gt; è½¯ä»¶çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¡¹ç›®åœ°å€ï¼š&lt;a href=&quot;https://github.com/niruix/sshwifty&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/niruix/sshwifty&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://github.com/niruix/sshwifty/raw/master/Screenshot.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="SSH" scheme="https://www.hi-linux.com/categories/SSH/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="æŠ€å·§" scheme="https://www.hi-linux.com/tags/%E6%8A%80%E5%B7%A7/"/>
    
      <category term="SSH" scheme="https://www.hi-linux.com/tags/SSH/"/>
    
  </entry>
  
  <entry>
    <title>æ¨èä¸€ä¸ªæ¯” Postman æ›´å¥½ç”¨çš„æ¥å£æµ‹è¯•ç¥å™¨ Postwoman</title>
    <link href="https://www.hi-linux.com/posts/31368.html"/>
    <id>https://www.hi-linux.com/posts/31368.html</id>
    <published>2020-05-09T01:00:00.000Z</published>
    <updated>2020-05-09T03:23:02.449Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><p>å¯¹äºç»å¸¸è¿›è¡Œæ¥å£è°ƒè¯•çš„åŒå­¦æ¥è¯´ï¼Œåº”è¯¥æ˜¯æ¯”è¾ƒç†Ÿæ‚‰ <code>Postman</code> äº†ã€‚<code>Postman</code> è™½ç„¶åŠŸèƒ½å¼ºå¤§ï¼Œä½†ä¹Ÿæœ‰å¾ˆå¤šå¼Šç«¯ã€‚æ¯”å¦‚ï¼šä¸æ”¯æŒ <code>Web</code> æ–¹å¼ï¼Œéœ€è¦å®‰è£…å®¢æˆ·ç«¯è½¯ä»¶ç­‰ã€‚å¦‚æœä½ åªæƒ³ç®€å•åœ°æµ‹è¯•ä¸‹æ¥å£è¿”å›ï¼Œå°±éœ€è¦å®‰è£…ä¸€ä¸ªå®¢æˆ·ç«¯å·¥å…·å°±æ˜¾å¾—æ¯”è¾ƒéº»çƒ¦äº†ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªç—›ç‚¹ï¼Œä»Šå¤©å°±ç»™å¤§å®¶æ¨èä¸€ä¸ªè½»é‡çº§ã€åŠŸèƒ½å¼ºå¤§ä¸”é¢œå€¼è¶…é«˜çš„ç¥å™¨ <code>Postwoman</code>ã€‚<code>Postwoman</code> æ˜¯ä¸€ä¸ª <code>HTTP API</code> æµ‹è¯•å·¥å…·ï¼Œæ”¯æŒ <code>REST</code>ã€<code>SOAP</code> å’Œ <code>GraphQL</code> è¯·æ±‚ï¼Œå¹¶ä¸”å¯ä»¥å®ç°è‡ªåŠ¨åŒ–æ¥å£æµ‹è¯•ã€æ¥å£ç›‘æ§ã€æ¨¡æ‹Ÿæ¥å£æ•°æ®ã€ç”Ÿæˆæ¥å£æ–‡æ¡£ã€å¤šäººåä½œç­‰åŠŸèƒ½ã€‚ç®€å•æ¥è¯´ï¼Œ<code>Postwoman</code> æ˜¯ä¸€ä¸ªå¥½ç”¨ä¸”åŠŸèƒ½éå¸¸å¼ºå¤§çš„ <code>API</code> è°ƒè¯•å·¥å…·ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯-postwoman">ä»€ä¹ˆæ˜¯ Postwoman</h2><p><code>Postwoman</code> æ˜¯ä¸€ä¸ªåŸºäº <code>Vue</code> å¼€å‘çš„çš„ <code>Web</code> é¡¹ç›®ï¼ŒåŠŸèƒ½ç±»ä¼¼ <code>Poatman</code> çš„å…è´¹ä¸”ç¾è§‚çš„å¼€æºæ›¿ä»£æ–¹æ¡ˆï¼Œå®ƒå¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜æ›´å¿«åœ°åˆ›å»ºè¯·æ±‚ï¼Œæå‡å·¥ä½œæ•ˆç‡ã€‚ç›®å‰ï¼Œè¯¥é¡¹ç›®åœ¨ <code>Github</code> ä¸Šçš„ <code>Star</code> æ•°å·²ç»è¶…è¿‡ 10k äº†ï¼</p><blockquote><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/liyasthomas/postwoman" target="_blank" rel="noopener">https://github.com/liyasthomas/postwoman</a></p></blockquote><p><img src="https://raw.githubusercontent.com/liyasthomas/postwoman/master/static/images/screenshot1.png" alt=""></p><h2 id="postwoman-åŠŸèƒ½ä»‹ç»">Postwoman åŠŸèƒ½ä»‹ç»</h2><ol><li>Postwoman ç›¸å…³ç‰¹æ€§</li></ol><ul><li><p>é‡‡ç”¨ç®€çº¦çš„ UI è®¾è®¡ï¼Œç®€å•çš„è®¾è®¡æ˜¯æœ€å¥½çš„è®¾è®¡</p></li><li><p>å“åº”é€Ÿåº¦æ›´å¿«ï¼Œè½¯ä»¶ä½¿ç”¨æ›´è½»é‡ã€æ›´ç®€æ´</p></li><li><p>å®æ—¶å‘é€è¯·æ±‚å¹¶è·å–/å¤åˆ¶å“åº”</p></li></ul><ol start="2"><li>Postwoman æ”¯æŒçš„æ–¹æ³•</li></ol><ul><li><p>GET</p></li><li><p>HEAD</p></li><li><p>POST</p></li><li><p>PUT</p></li><li><p>DELETE</p></li><li><p>OPTIONS</p></li><li><p>PATCH</p></li></ul><ol start="3"><li>Postwoman æ”¯æŒç•Œé¢å®šåˆ¶</li></ol><ul><li><p>æ”¯æŒä¸»é¢˜é€‰æ‹©ï¼šKinda Darkï¼ˆé»˜è®¤ï¼‰ã€Clearly Whiteã€Just Black å’Œ System ä¸»é¢˜</p></li><li><p>æ”¯æŒè‡ªå®šä¹‰å¼ºè°ƒé¢œè‰²ï¼šç»¿è‰²ï¼ˆé»˜è®¤ï¼‰ã€é»„è‰²ã€ç²‰çº¢è‰²ã€çº¢è‰²ã€ç´«è‰²ã€æ©™è‰²ã€é’è‰²å’Œè“è‰²</p></li></ul><ol start="4"><li>å…¶å®ƒæ”¯æŒçš„ç‰¹æ€§</li></ol><ul><li><p>æ”¯æŒä»¥ <code>PWA</code> æ–¹å¼è¿›è¡Œå®‰è£…</p></li><li><p>æ”¯æŒç¦»çº¿ä½¿ç”¨</p></li><li><p>å†…å­˜å’Œ <code>CPU</code> ä½¿ç”¨ç‡éå¸¸ä½</p></li><li><p>æ”¯æŒå¤šå¹³å°ã€å¤šè®¾å¤‡</p></li><li><p>æ”¯æŒ <code>WebSocket</code></p></li><li><p>æ”¯æŒ <code>GraphQL</code></p></li><li><p>æ”¯æŒå¤šç§ <code>HTTP</code> è®¤è¯æ–¹å¼</p></li><li><p>â€¦</p></li></ul><p>é™¤æ­¤ä¹‹å¤–ï¼Œ<code>Postwoman</code> è¿˜å…·å¤‡å¾ˆå¤šå¥½ç”¨çš„ç‰¹æ€§ï¼Œå®Œæ•´åŠŸèƒ½åˆ—è¡¨ä»‹ç»å¯ä»¥æˆ³ã€Œ<a href="https://github.com/liyasthomas/postwoman" target="_blank" rel="noopener">è¿™é‡Œ</a>ã€ã€‚</p><a id="more"></a><h2 id="ä½¿ç”¨-postwoman">ä½¿ç”¨ Postwoman</h2><p><img src="https://github.com/liyasthomas/postwoman/blob/master/static/images/screenshot2.png" alt=""></p><p><code>Postwoman</code> æ—¢ç„¶æ˜¯ä¸€ä¸ª <code>Web</code> é¡¹ç›®ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿå°±éå¸¸ç®€å•ï¼Œä½ åªéœ€ç›´æ¥è®¿é—®å…¶å®˜ç½‘åœ°å€å³å¯ç›´æ¥ä½¿ç”¨ã€‚</p><blockquote><p>å®˜ç½‘åœ°å€ï¼š<a href="https://postwoman.io/" target="_blank" rel="noopener">https://postwoman.io/</a></p></blockquote><p>å¦‚æœä½ æƒ³åœ¨æœ¬åœ°è‡ªè¡Œæ­å»ºä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå¤§è‡´è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li>ä½¿ç”¨æºä»£ç è¿›è¡Œæ­å»º</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/liyasthomas/postwoman.git</span><br><span class="line">$ npm install</span><br><span class="line">$ npm run dev</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨ Docker è¿›è¡Œæ­å»º</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‹‰å– Postwoman ç›¸å…³é•œåƒ</span></span><br><span class="line">$ docker pull liyasthomas/postwoman</span><br><span class="line"><span class="comment"># è¿è¡Œä¸€ä¸ª Postwoman çš„å®¹å™¨</span></span><br><span class="line">$ docker run -p 3000:3000 liyasthomas/postwoman:latest</span><br></pre></td></tr></table></figure><p>ä¸è®ºä½¿ç”¨ä»¥ä¸‹å“ªç§æ–¹æ³•æ­å»ºï¼Œæ­å»ºæˆåŠŸåï¼Œä½ åªéœ€æ‰“å¼€æµè§ˆå™¨è®¿é—®å¯¹åº”ä¸»æœº <code>IP</code> çš„ <code>3000</code> ç«¯å£å³å¯è®¿é—®æœ¬åœ°çš„ <code>Postwoman</code> ç¯å¢ƒã€‚</p><h2 id="æ›´å¤šçš„ç•Œé¢æˆªå›¾">æ›´å¤šçš„ç•Œé¢æˆªå›¾</h2><p><img src="https://i.loli.net/2019/11/29/L9RsVMEhzUdYbPS.png" alt=""></p><p><img src="https://i.loli.net/2019/11/29/DmWaUkgT7uK5rif.png" alt=""></p><p><img src="https://i.loli.net/2019/11/29/z61X8EbiQRDFhAH.png" alt=""></p><p><img src="https://i.loli.net/2019/11/29/mkYbxGTMgesJh1B.png" alt=""></p><h2 id="æ€»ç»“">æ€»ç»“</h2><p>å¦‚æœä½ è§‰å¾— <code>Postman</code> ä¸å¤Ÿå¥½ç”¨æˆ–è€…ç¡®å®æ˜¯æƒ³è¦ä½¿ç”¨ä¸€ä¸ªç•Œé¢æ›´åŠ å¥½çœ‹çš„æ¥å£è°ƒè¯•å·¥å…·ï¼Œé‚£ä¹ˆ <code>Postwoman</code> å°†æ˜¯ä½ æœ€ä½³çš„é€‰æ‹©ï¼</p><h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2><ol><li><p><a href="https://www.google.com" target="_blank" rel="noopener">https://www.google.com</a></p></li><li><p><a href="https://github.com/liyasthomas/postwoman" target="_blank" rel="noopener">https://github.com/liyasthomas/postwoman</a></p></li><li><p><a href="https://juejin.im/post/5dca85cb6fb9a04a8953fef6" target="_blank" rel="noopener">https://juejin.im/post/5dca85cb6fb9a04a8953fef6</a></p></li><li><p><a href="http://www.xmhzd.com/study/article/view-607.html" target="_blank" rel="noopener">http://www.xmhzd.com/study/article/view-607.html</a></p></li></ol></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¯¹äºç»å¸¸è¿›è¡Œæ¥å£è°ƒè¯•çš„åŒå­¦æ¥è¯´ï¼Œåº”è¯¥æ˜¯æ¯”è¾ƒç†Ÿæ‚‰ &lt;code&gt;Postman&lt;/code&gt; äº†ã€‚&lt;code&gt;Postman&lt;/code&gt; è™½ç„¶åŠŸèƒ½å¼ºå¤§ï¼Œä½†ä¹Ÿæœ‰å¾ˆå¤šå¼Šç«¯ã€‚æ¯”å¦‚ï¼šä¸æ”¯æŒ &lt;code&gt;Web&lt;/code&gt; æ–¹å¼ï¼Œéœ€è¦å®‰è£…å®¢æˆ·ç«¯è½¯ä»¶ç­‰ã€‚å¦‚æœä½ åªæƒ³ç®€å•åœ°æµ‹è¯•ä¸‹æ¥å£è¿”å›ï¼Œå°±éœ€è¦å®‰è£…ä¸€ä¸ªå®¢æˆ·ç«¯å·¥å…·å°±æ˜¾å¾—æ¯”è¾ƒéº»çƒ¦äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è§£å†³è¿™ä¸ªç—›ç‚¹ï¼Œä»Šå¤©å°±ç»™å¤§å®¶æ¨èä¸€ä¸ªè½»é‡çº§ã€åŠŸèƒ½å¼ºå¤§ä¸”é¢œå€¼è¶…é«˜çš„ç¥å™¨ &lt;code&gt;Postwoman&lt;/code&gt;ã€‚&lt;code&gt;Postwoman&lt;/code&gt; æ˜¯ä¸€ä¸ª &lt;code&gt;HTTP API&lt;/code&gt; æµ‹è¯•å·¥å…·ï¼Œæ”¯æŒ &lt;code&gt;REST&lt;/code&gt;ã€&lt;code&gt;SOAP&lt;/code&gt; å’Œ &lt;code&gt;GraphQL&lt;/code&gt; è¯·æ±‚ï¼Œå¹¶ä¸”å¯ä»¥å®ç°è‡ªåŠ¨åŒ–æ¥å£æµ‹è¯•ã€æ¥å£ç›‘æ§ã€æ¨¡æ‹Ÿæ¥å£æ•°æ®ã€ç”Ÿæˆæ¥å£æ–‡æ¡£ã€å¤šäººåä½œç­‰åŠŸèƒ½ã€‚ç®€å•æ¥è¯´ï¼Œ&lt;code&gt;Postwoman&lt;/code&gt; æ˜¯ä¸€ä¸ªå¥½ç”¨ä¸”åŠŸèƒ½éå¸¸å¼ºå¤§çš„ &lt;code&gt;API&lt;/code&gt; è°ƒè¯•å·¥å…·ã€‚&lt;/p&gt;
&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯-Postwoman&quot;&gt;ä»€ä¹ˆæ˜¯ Postwoman&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Postwoman&lt;/code&gt; æ˜¯ä¸€ä¸ªåŸºäº &lt;code&gt;Vue&lt;/code&gt; å¼€å‘çš„çš„ &lt;code&gt;Web&lt;/code&gt; é¡¹ç›®ï¼ŒåŠŸèƒ½ç±»ä¼¼ &lt;code&gt;Poatman&lt;/code&gt; çš„å…è´¹ä¸”ç¾è§‚çš„å¼€æºæ›¿ä»£æ–¹æ¡ˆï¼Œå®ƒå¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜æ›´å¿«åœ°åˆ›å»ºè¯·æ±‚ï¼Œæå‡å·¥ä½œæ•ˆç‡ã€‚ç›®å‰ï¼Œè¯¥é¡¹ç›®åœ¨ &lt;code&gt;Github&lt;/code&gt; ä¸Šçš„ &lt;code&gt;Star&lt;/code&gt; æ•°å·²ç»è¶…è¿‡ 10k äº†ï¼&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¡¹ç›®åœ°å€ï¼š&lt;a href=&quot;https://github.com/liyasthomas/postwoman&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/liyasthomas/postwoman&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/liyasthomas/postwoman/master/static/images/screenshot1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;Postwoman-åŠŸèƒ½ä»‹ç»&quot;&gt;Postwoman åŠŸèƒ½ä»‹ç»&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Postwoman ç›¸å…³ç‰¹æ€§&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;é‡‡ç”¨ç®€çº¦çš„ UI è®¾è®¡ï¼Œç®€å•çš„è®¾è®¡æ˜¯æœ€å¥½çš„è®¾è®¡&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å“åº”é€Ÿåº¦æ›´å¿«ï¼Œè½¯ä»¶ä½¿ç”¨æ›´è½»é‡ã€æ›´ç®€æ´&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å®æ—¶å‘é€è¯·æ±‚å¹¶è·å–/å¤åˆ¶å“åº”&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;Postwoman æ”¯æŒçš„æ–¹æ³•&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;GET&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;HEAD&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;POST&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;PUT&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;DELETE&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;OPTIONS&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;PATCH&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;Postwoman æ”¯æŒç•Œé¢å®šåˆ¶&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ”¯æŒä¸»é¢˜é€‰æ‹©ï¼šKinda Darkï¼ˆé»˜è®¤ï¼‰ã€Clearly Whiteã€Just Black å’Œ System ä¸»é¢˜&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ”¯æŒè‡ªå®šä¹‰å¼ºè°ƒé¢œè‰²ï¼šç»¿è‰²ï¼ˆé»˜è®¤ï¼‰ã€é»„è‰²ã€ç²‰çº¢è‰²ã€çº¢è‰²ã€ç´«è‰²ã€æ©™è‰²ã€é’è‰²å’Œè“è‰²&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;å…¶å®ƒæ”¯æŒçš„ç‰¹æ€§&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ”¯æŒä»¥ &lt;code&gt;PWA&lt;/code&gt; æ–¹å¼è¿›è¡Œå®‰è£…&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ”¯æŒç¦»çº¿ä½¿ç”¨&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å†…å­˜å’Œ &lt;code&gt;CPU&lt;/code&gt; ä½¿ç”¨ç‡éå¸¸ä½&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ”¯æŒå¤šå¹³å°ã€å¤šè®¾å¤‡&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ”¯æŒ &lt;code&gt;WebSocket&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ”¯æŒ &lt;code&gt;GraphQL&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ”¯æŒå¤šç§ &lt;code&gt;HTTP&lt;/code&gt; è®¤è¯æ–¹å¼&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;â€¦&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é™¤æ­¤ä¹‹å¤–ï¼Œ&lt;code&gt;Postwoman&lt;/code&gt; è¿˜å…·å¤‡å¾ˆå¤šå¥½ç”¨çš„ç‰¹æ€§ï¼Œå®Œæ•´åŠŸèƒ½åˆ—è¡¨ä»‹ç»å¯ä»¥æˆ³ã€Œ&lt;a href=&quot;https://github.com/liyasthomas/postwoman&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è¿™é‡Œ&lt;/a&gt;ã€ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/categories/Linux/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="æŠ€å·§" scheme="https://www.hi-linux.com/tags/%E6%8A%80%E5%B7%A7/"/>
    
      <category term="å·¥å…·" scheme="https://www.hi-linux.com/tags/%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>Kubernetes ç§æœ‰é›†ç¾¤è´Ÿè½½å‡è¡¡å™¨ç»ˆæè§£å†³æ–¹æ¡ˆ MetalLB ( è´«è‹¦ K8S ç”¨æˆ·çš„ LoadBalancer )</title>
    <link href="https://www.hi-linux.com/posts/34820.html"/>
    <id>https://www.hi-linux.com/posts/34820.html</id>
    <published>2020-05-08T01:00:00.000Z</published>
    <updated>2020-05-08T05:14:23.217Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><p>ç§æœ‰äº‘è£¸é‡‘å±æ¶æ„ï¼ˆè¿™é‡Œæ˜¯ç›¸å¯¹äº‘ä¸Šç¯å¢ƒæ¥è¯´ï¼Œä¸æ˜¯è¯´æ— æ“ä½œç³»ç»Ÿï¼‰ä¸Šéƒ¨ç½²çš„ Kubernetes é›†ç¾¤ï¼Œé€šå¸¸æ˜¯æ— æ³•ä½¿ç”¨ LoadBalancer ç±»å‹çš„ Service çš„ã€‚å› ä¸º Kubernetes æœ¬èº«æ²¡æœ‰ä¸ºè£¸æœºç¾¤é›†æä¾›ç½‘ç»œè´Ÿè½½å‡è¡¡å™¨ï¼ˆç±»å‹ä¸º LoadBalancer çš„æœåŠ¡ï¼‰çš„å®ç°ã€‚å¦‚æœä½ çš„ Kubernetes é›†ç¾¤æ²¡æœ‰åœ¨å…¬æœ‰äº‘çš„ IaaS å¹³å°ï¼ˆGCPï¼ŒAWSï¼ŒAzure â€¦ï¼‰ä¸Šè¿è¡Œï¼Œåˆ™ LoadBalancers å°†åœ¨åˆ›å»ºæ—¶æ— é™æœŸåœ°ä¿æŒ â€œæŒ‚èµ·â€ çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´åªæœ‰å…¬æœ‰äº‘å‚å•†è‡ªå®¶çš„ Kubernetes æ”¯æŒ LoadBalancer ã€‚</p><p>ä¸ºäº†ä»å¤–éƒ¨è®¿é—®è£¸æœº Kubernetes ç¾¤é›†ï¼Œç›®å‰åªèƒ½ä½¿ç”¨ <code>NodePort</code> æˆ– <code>Ingress</code> çš„æ–¹æ³•è¿›è¡ŒæœåŠ¡æš´éœ²ã€‚å‰è€…çš„ç¼ºç‚¹æ˜¯æ¯ä¸ªæš´éœ²çš„æœåŠ¡éœ€è¦å ç”¨æ‰€æœ‰èŠ‚ç‚¹çš„æŸä¸ªç«¯å£ï¼Œåè€…çš„ç¼ºç‚¹æ˜¯ä»…ä»…èƒ½æ”¯æŒ <code>HTTP</code> åè®®ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯-metallb">ä»€ä¹ˆæ˜¯ MetalLB</h2><p><code>MetalLB</code> æ˜¯ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨ï¼Œä¸“é—¨è§£å†³è£¸é‡‘å± Kubernetes é›†ç¾¤ä¸­æ— æ³•ä½¿ç”¨ <code>LoadBalancer</code> ç±»å‹æœåŠ¡çš„ç—›ç‚¹ã€‚<code>MetalLB</code> ä½¿ç”¨æ ‡å‡†åŒ–çš„è·¯ç”±åè®®ï¼Œä»¥ä¾¿è£¸é‡‘å± Kubernetes é›†ç¾¤ä¸Šçš„å¤–éƒ¨æœåŠ¡ä¹Ÿå°½å¯èƒ½åœ°å·¥ä½œã€‚å³ MetalLB èƒ½å¤Ÿå¸®åŠ©ä½ åœ¨è£¸é‡‘å± Kubernetes é›†ç¾¤ä¸­åˆ›å»º LoadBalancer ç±»å‹çš„ Kubernetes æœåŠ¡ï¼Œè¯¥é¡¹ç›®å‘å¸ƒäº 2017 å¹´åº•ï¼Œå½“å‰å¤„äº <code>Beta</code> é˜¶æ®µã€‚</p><blockquote><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/danderson/metallb" target="_blank" rel="noopener">https://github.com/danderson/metallb</a></p></blockquote><h2 id="metallb-å·¥ä½œåŸç†">MetalLB å·¥ä½œåŸç†</h2><p>MetalLB ä¼šåœ¨ Kubernetes å†…è¿è¡Œï¼Œç›‘æ§æœåŠ¡å¯¹è±¡çš„å˜åŒ–ï¼Œä¸€æ—¦ç›‘æµ‹åˆ°æœ‰æ–°çš„ LoadBalancer æœåŠ¡è¿è¡Œï¼Œå¹¶ä¸”æ²¡æœ‰å¯ç”³è¯·çš„è´Ÿè½½å‡è¡¡å™¨ä¹‹åï¼Œå°±ä¼šå®Œæˆåœ°å€åˆ†é…å’Œå¤–éƒ¨å£°æ˜ä¸¤éƒ¨åˆ†çš„å·¥ä½œã€‚</p><h3 id="åœ°å€åˆ†é…">åœ°å€åˆ†é…</h3><p>åœ¨äº‘ç¯å¢ƒä¸­ï¼Œå½“ä½ è¯·æ±‚ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨æ—¶ï¼Œäº‘å¹³å°ä¼šè‡ªåŠ¨åˆ†é…ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨çš„ IP åœ°å€ç»™ä½ ï¼Œåº”ç”¨ç¨‹åºé€šè¿‡æ­¤ IP æ¥è®¿é—®ç»è¿‡è´Ÿè½½å‡è¡¡å¤„ç†çš„æœåŠ¡ã€‚</p><p>ä½¿ç”¨ MetalLB æ—¶ï¼ŒMetalLB ä¼šè‡ªå·±ä¸ºç”¨æˆ·çš„ LoadBalancer ç±»å‹ Service åˆ†é… IP åœ°å€ï¼Œå½“ç„¶è¯¥ IP åœ°å€ä¸æ˜¯å‡­ç©ºäº§ç”Ÿçš„ï¼Œéœ€è¦ç”¨æˆ·åœ¨é…ç½®ä¸­æä¾›ä¸€ä¸ª IP åœ°å€æ± ï¼ŒMetallb å°†ä¼šåœ¨å…¶ä¸­é€‰å–åœ°å€åˆ†é…ç»™æœåŠ¡ã€‚</p><h3 id="å¤–éƒ¨å£°æ˜">å¤–éƒ¨å£°æ˜</h3><p>MetalLB å°† IP åˆ†é…ç»™æŸä¸ªæœåŠ¡åï¼Œå®ƒéœ€è¦å¯¹å¤–å®£å‘Šæ­¤ IP åœ°å€ï¼Œå¹¶è®©å¤–éƒ¨ä¸»æœºå¯ä»¥è·¯ç”±åˆ°æ­¤ IPã€‚</p><p>MetalLB æ”¯æŒä¸¤ç§å£°æ˜æ¨¡å¼ï¼šLayer 2ï¼ˆ ARP / NDP ï¼‰æ¨¡å¼æˆ–è€… BGP æ¨¡å¼ã€‚</p><ol><li>Layer 2 æ¨¡å¼</li></ol><p><img src="https://kubernetes.github.io/ingress-nginx/images/baremetal/metallb.jpg" alt=""></p><p>åœ¨ä»»ä½•ä»¥å¤ªç½‘ç¯å¢ƒå‡å¯ä½¿ç”¨è¯¥æ¨¡å¼ã€‚å½“åœ¨ç¬¬äºŒå±‚å·¥ä½œæ—¶ï¼Œå°†æœ‰ä¸€å°æœºå™¨è·å¾— IP åœ°å€ï¼ˆå³æœåŠ¡çš„æ‰€æœ‰æƒï¼‰ã€‚MetalLB ä½¿ç”¨æ ‡å‡†çš„åœ°å€å‘ç°åè®®ï¼ˆå¯¹äº IPv4 æ˜¯ ARPï¼Œå¯¹äº IPv6 æ˜¯ NDPï¼‰å®£å‘Š IP åœ°å€ï¼Œä½¿å…¶åœ¨æœ¬åœ°ç½‘è·¯ä¸­å¯è¾¾ã€‚ä» LAN çš„è§’åº¦æ¥çœ‹ï¼Œä»…ä»…æ˜¯æŸå°æœºå™¨å¤šé…ç½®äº†ä¸€ä¸ª IP åœ°å€ã€‚</p><p>Layer 2 æ¨¡å¼ä¸‹ï¼Œæ¯ä¸ª Service ä¼šæœ‰é›†ç¾¤ä¸­çš„ä¸€ä¸ª Node æ¥è´Ÿè´£ã€‚æœåŠ¡çš„å…¥å£æµé‡å…¨éƒ¨ç»ç”±å•ä¸ªèŠ‚ç‚¹ï¼Œç„¶åè¯¥èŠ‚ç‚¹çš„ Kube-Proxy ä¼šæŠŠæµé‡å†è½¬å‘ç»™æœåŠ¡çš„ Podsã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¥æ¨¡å¼ä¸‹ MetalLB å¹¶æ²¡æœ‰çœŸæ­£æä¾›è´Ÿè½½å‡è¡¡å™¨ã€‚å°½ç®¡å¦‚æ­¤ï¼ŒMetalLB æä¾›äº†æ•…éšœè½¬ç§»åŠŸèƒ½ï¼Œå¦‚æœæŒæœ‰ IP çš„èŠ‚ç‚¹å‡ºç°æ•…éšœï¼Œåˆ™é»˜è®¤ 10 ç§’åå³å‘ç”Ÿæ•…éšœè½¬ç§»ï¼ŒIP ä¼šè¢«åˆ†é…ç»™å…¶å®ƒå¥åº·çš„èŠ‚ç‚¹ã€‚</p><p>Layer 2 æ¨¡å¼çš„ä¼˜ç¼ºç‚¹ï¼š</p><ul><li><p>Layer 2 æ¨¡å¼æ›´ä¸ºé€šç”¨ï¼Œä¸éœ€è¦ç”¨æˆ·æœ‰é¢å¤–çš„è®¾å¤‡ï¼›</p></li><li><p>Layer 2 æ¨¡å¼ä¸‹å­˜åœ¨å•ç‚¹é—®é¢˜ï¼ŒæœåŠ¡çš„æ‰€æœ‰å…¥å£æµé‡ç»ç”±å•ç‚¹ï¼Œå…¶ç½‘ç»œå¸¦å®½å¯èƒ½æˆä¸ºç“¶é¢ˆï¼›</p></li><li><p>ç”±äº Layer 2 æ¨¡å¼éœ€è¦ ARP/NDP å®¢æˆ·ç«¯é…åˆï¼Œå½“æ•…éšœè½¬ç§»å‘ç”Ÿæ—¶ï¼ŒMetalLB ä¼šå‘é€ ARP åŒ…æ¥å®£å‘Š MAC åœ°å€å’Œ IP æ˜ å°„å…³ç³»çš„å˜åŒ–ï¼Œåœ°å€åˆ†é…ç•¥ä¸ºç¹çã€‚</p></li></ul><ol start="2"><li>BGP æ¨¡å¼</li></ol><p>å½“åœ¨ç¬¬ä¸‰å±‚å·¥ä½œæ—¶ï¼Œé›†ç¾¤ä¸­æ‰€æœ‰æœºå™¨éƒ½å’Œä½ æ§åˆ¶çš„æœ€æ¥è¿‘çš„è·¯ç”±å™¨å»ºç«‹ BGP ä¼šè¯ï¼Œæ­¤ä¼šè¯è®©è·¯ç”±å™¨èƒ½å­¦ä¹ åˆ°å¦‚ä½•è½¬å‘é’ˆå¯¹ K8S æœåŠ¡ IP çš„æ•°æ®åŒ…ã€‚</p><p>é€šè¿‡ä½¿ç”¨ BGPï¼Œå¯ä»¥å®ç°çœŸæ­£çš„è·¨å¤šèŠ‚ç‚¹è´Ÿè½½å‡è¡¡ï¼ˆéœ€è¦è·¯ç”±å™¨æ”¯æŒ multipathï¼‰ï¼Œè¿˜å¯ä»¥åŸºäº BGP çš„ç­–ç•¥æœºåˆ¶å®ç°ç»†ç²’åº¦çš„æµé‡æ§åˆ¶ã€‚</p><p>å…·ä½“çš„è´Ÿè½½å‡è¡¡è¡Œä¸ºå’Œè·¯ç”±å™¨æœ‰å…³ï¼Œå¯ä¿è¯çš„å…±åŒè¡Œä¸ºæ˜¯ï¼šæ¯ä¸ªè¿æ¥ï¼ˆTCP æˆ– UDP ä¼šè¯ï¼‰çš„æ•°æ®åŒ…æ€»æ˜¯è·¯ç”±åˆ°åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šã€‚</p><p>BGP æ¨¡å¼çš„ä¼˜ç¼ºç‚¹ï¼š</p><ul><li><p>ä¸èƒ½ä¼˜é›…å¤„ç†æ•…éšœè½¬ç§»ï¼Œå½“æŒæœ‰æœåŠ¡çš„èŠ‚ç‚¹å®•æ‰åï¼Œæ‰€æœ‰æ´»åŠ¨è¿æ¥çš„å®¢æˆ·ç«¯å°†æ”¶åˆ° Connection reset by peer ï¼›</p></li><li><p>BGP è·¯ç”±å™¨å¯¹æ•°æ®åŒ…çš„æº IPã€ç›®çš„ IPã€åè®®ç±»å‹è¿›è¡Œç®€å•çš„å“ˆå¸Œï¼Œå¹¶ä¾æ®å“ˆå¸Œå€¼å†³å®šå‘ç»™å“ªä¸ª K8S èŠ‚ç‚¹ã€‚é—®é¢˜æ˜¯ K8S èŠ‚ç‚¹é›†æ˜¯ä¸ç¨³å®šçš„ï¼Œä¸€æ—¦ï¼ˆå‚ä¸ BGPï¼‰çš„èŠ‚ç‚¹å®•æ‰ï¼Œå¾ˆå¤§éƒ¨åˆ†çš„æ´»åŠ¨è¿æ¥éƒ½ä¼šå› ä¸º rehash è€Œåæ‰ã€‚</p></li></ul><p>BGP æ¨¡å¼é—®é¢˜çš„ç¼“å’Œæªæ–½ï¼š</p><ul><li><p>å°†æœåŠ¡ç»‘å®šåˆ°ä¸€éƒ¨åˆ†å›ºå®šçš„èŠ‚ç‚¹ä¸Šï¼Œé™ä½ rehash çš„æ¦‚ç‡ã€‚</p></li><li><p>åœ¨æµé‡ä½çš„æ—¶æ®µæ”¹å˜æœåŠ¡çš„éƒ¨ç½²ã€‚</p></li><li><p>å®¢æˆ·ç«¯æ·»åŠ é€æ˜é‡è¯•é€»è¾‘ï¼Œå½“å‘ç°è¿æ¥ TCP å±‚é”™è¯¯æ—¶è‡ªåŠ¨é‡è¯•ã€‚</p></li></ul><a id="more"></a><h2 id="éƒ¨ç½²-metallb">éƒ¨ç½² MetalLB</h2><h3 id="ç¯å¢ƒè¦æ±‚">ç¯å¢ƒè¦æ±‚</h3><p>æ ¹æ®éƒ¨ç½²æ¨¡å¼ä¸åŒï¼ŒMetalLB å¯èƒ½éœ€è¦ä»¥ä¸‹ç¯å¢ƒï¼š</p><ol><li><p>ä¸€ä¸ª Kubernetes é›†ç¾¤ï¼Œè¿è¡Œ Kubernetes 1.13.0 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚</p></li><li><p>Kubernetes é›†ç¾¤çš„ç½‘ç»œé…ç½®å¯ä»¥ä¸ MetalLB å…±å­˜ã€‚</p></li><li><p>æœ‰ä¸€äº›æä¾›ç»™ MetalLB åˆ†å‘çš„ IPv4 åœ°å€ã€‚</p></li><li><p>æ ¹æ®éƒ¨ç½²æ¨¡å¼ï¼Œå¯èƒ½éœ€è¦ä¸€ä¸ªæˆ–å¤šä¸ª BGP çš„è·¯ç”±å™¨ ã€‚</p></li></ol><p>MetalLB ç›®å‰æ”¯æŒç½‘ç»œæ’ä»¶èŒƒå›´</p><table><thead><tr><th>ç½‘ç»œæ’ä»¶</th><th>å…¼å®¹æ€§</th></tr></thead><tbody><tr><td>Calico</td><td>éƒ¨åˆ†æ”¯æŒï¼ˆæœ‰é™„åŠ æ–‡æ¡£ï¼‰</td></tr><tr><td>Flannel</td><td>æ”¯æŒ</td></tr><tr><td>Kube-router</td><td>ä¸æ”¯æŒ</td></tr><tr><td>Romana</td><td>æ”¯æŒï¼ˆæœ‰é™„åŠ æ–‡æ¡£ï¼‰</td></tr><tr><td>Weave Net</td><td>æ”¯æŒ</td></tr></tbody></table><blockquote><p>ä» Kubernetes 1.9 å¼€å§‹, Kube-Proxy é™¤äº†æ”¯æŒé»˜è®¤çš„ Iptables æ¨¡å¼ä¹‹å¤–ï¼Œè¿˜æ”¯æŒæ›´é«˜æ•ˆçš„ IPVS æ¨¡å¼ã€‚MetalLB å¯ä»¥åœ¨Kubenetes 1.13 æˆ–æ›´é«˜ç‰ˆæœ¬çš„ Kube-Proxy ä¸­ä½¿ç”¨ IPVS æ¨¡å¼ã€‚ä½†æ˜¯,å®ƒå°šæœªæ˜ç¡®æµ‹è¯•ï¼Œå› æ­¤é£é™©è‡ªè´Ÿã€‚å…·ä½“å†…å®¹å¯å‚è€ƒï¼š<a href="https://github.com/google/metallb/issues/153" target="_blank" rel="noopener">https://github.com/google/metallb/issues/153</a></p></blockquote><h3 id="å®‰è£…-metallb">å®‰è£… MetalLB</h3><p>å®‰è£… MetalLB ä¸€å…±æœ‰ä¸¤ç§æ–¹æ³•ï¼šä½¿ç”¨ Kubernetes YAML æ–‡ä»¶æˆ–ä½¿ç”¨ Helm åŒ…ç®¡ç†å™¨ã€‚</p><h4 id="ä½¿ç”¨-yaml-æ–‡ä»¶éƒ¨ç½²">ä½¿ç”¨ YAML æ–‡ä»¶éƒ¨ç½²</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ç›®å‰ MetalLB æœ€æ–°ç‰ˆæœ¬ä¸º 0.8.1</span><br><span class="line">$ kubectl apply -f https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;google&#x2F;metallb&#x2F;v0.8.1&#x2F;manifests&#x2F;metallb.yaml</span><br></pre></td></tr></table></figure><p>éƒ¨ç½²å®Œæˆåï¼Œå°†åœ¨ <code>metallb-system</code> å‘½åç©ºé—´ä¸‹å°† MetalLB éƒ¨ç½²åˆ°é›†ç¾¤ã€‚YAML æ–‡ä»¶ä¸­ä¸»è¦åŒ…å«ä»¥ä¸‹ä¸€äº›ç»„ä»¶ï¼š</p><ol><li><p><code>metallb-system/controller</code>ï¼Œè¿™æ˜¯å¤„ç† <code>IP</code> åœ°å€åˆ†é…çš„æ§åˆ¶å™¨ã€‚</p></li><li><p><code>metallb-system/speakerdaemonset</code> è¿™æ˜¯æ”¯æŒä½ é€‰æ‹©åè®®ä»¥ä½¿æœåŠ¡å¯è¾¾çš„ç»„ä»¶ã€‚</p></li><li><p><code>Controller</code> å’Œ <code>Speaker</code> çš„ <code>Service Accounts</code>ï¼Œä»¥åŠç»„ä»¶éœ€è¦è¿è¡Œçš„ <code>RBAC</code> æƒé™ã€‚</p></li></ol><blockquote><p>é€šè¿‡ YAML å®‰è£…æ–‡ä»¶éƒ¨ç½²å¹¶ä¸åŒ…å« MetalLB é…ç½®æ–‡ä»¶ï¼Œä½† MetalLB çš„ç»„ä»¶ä»èƒ½å¯åŠ¨ï¼Œä½†åœ¨ä½ å®šä¹‰å’Œéƒ¨ç½² <code>configmap</code> ä¹‹å‰å°†ä¿æŒç©ºé—²çŠ¶æ€ ã€‚</p></blockquote><h4 id="ä½¿ç”¨-helm-éƒ¨ç½²">ä½¿ç”¨ Helm éƒ¨ç½²</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ helm install --name metallb stable&#x2F;metallb</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ è¿˜ä¸çŸ¥é“ä»€ä¹ˆæ˜¯ Helmï¼Œå¯ä»¥å…ˆå‚è€ƒ <a href="https://mp.weixin.qq.com/s?__biz=MzI3MTI2NzkxMA==&amp;mid=2247486154&amp;idx=1&amp;sn=becd5dd0fadfe0b6072f5dfdc6fdf786&amp;chksm=eac52be3ddb2a2f555b8b1028db97aa3e92d0a4880b56f361e4b11cd252771147c44c08c8913&amp;token=1182029777&amp;lang=zh_CN#rd" target="_blank" rel="noopener">ã€ŒHelm å…¥é—¨æŒ‡å—ã€</a> ä¸€æ–‡ã€‚</p><h2 id="é…ç½®-metallb">é…ç½® MetalLB</h2><p>MetalLB å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ ¹æ®å…·ä½“çš„åœ°å€å’Œé€šå‘Šæ–¹å¼é…ç½®åä¸º <code>metallb-system/config</code> çš„ ConfigMapã€‚Controller ä¼šè¯»å–è¯¥ ConfigMapï¼Œå¹¶é‡æ–°åŠ è½½é…ç½®ã€‚</p><blockquote><p>é€šè¿‡ Helm å®‰è£…æ—¶ï¼ŒMetalLB è¯»å–çš„ ConfigMap åä¸º metallb-config ã€‚</p></blockquote><h3 id="é…ç½®-metallb-ä¸ºäºŒå±‚æ¨¡å¼">é…ç½® MetalLB ä¸ºäºŒå±‚æ¨¡å¼</h3><p>ç¬¬äºŒå±‚æ¨¡å¼æ˜¯æœ€ç®€å•çš„é…ç½®æ–¹å¼ï¼šåœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæ‚¨ä¸éœ€è¦ä»»ä½•ç‰¹å®šäºåè®®çš„é…ç½®ï¼Œåªéœ€è¦ IP åœ°å€ã€‚</p><p>ç¬¬äºŒå±‚æ¨¡å¼ä¸è¦æ±‚å°† IP ç»‘å®šåˆ°å·¥ä½œèŠ‚ç‚¹çš„ç½‘ç»œæ¥å£ã€‚å®ƒçš„å·¥ä½œåŸç†æ˜¯ç›´æ¥å“åº”æœ¬åœ°ç½‘ç»œä¸Šçš„ ARP è¯·æ±‚ï¼Œå°†æœºå™¨çš„ MAC åœ°å€æä¾›ç»™å®¢æˆ·ç«¯ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®é™…ä¾‹å­ï¼Œæˆ‘ä»¬å°†é…ç½®ä¸€ä¸ªç”± MetalLB äºŒå±‚æ¨¡å¼æ§åˆ¶çš„å¤–éƒ¨ IP æ®µä¸º 192.168.1.240 - 192.168.1.250ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ cat MetalLB-Layer2-Config.yaml</span><br><span class="line"></span><br><span class="line">kind: ConfigMap</span><br><span class="line">apiVersion: v1</span><br><span class="line">metadata:</span><br><span class="line">  name: config</span><br><span class="line">  namespace: metallb-system</span><br><span class="line">data:</span><br><span class="line">  config: |</span><br><span class="line">    address-pools:</span><br><span class="line">    - name: default</span><br><span class="line">      protocol: layer2</span><br><span class="line">      addresses:</span><br><span class="line">      - 192.168.0.10-192.168.0.100</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šè¿™é‡Œçš„ IP åœ°å€èŒƒå›´éœ€è¦è·Ÿé›†ç¾¤å®é™…æƒ…å†µç›¸å¯¹åº”ã€‚</p></blockquote><p>é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>kubectl apply -f MetalLB-Layer2-Config.yaml</code> å‘½ä»¤ä½¿é…ç½®ç”Ÿæ•ˆã€‚å¦‚æœä½ æƒ³çœ‹åˆ°è¯¦ç»†é…ç½®æ›´æ–°è¿‡ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ç±»ä¼¼å‘½ä»¤æŸ¥çœ‹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl logs -f [metallb-controller-pod]</span><br><span class="line">æˆ–è€…ã€€</span><br><span class="line">$ kubectl logs -l component&#x3D;speaker -n metallb-system</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªæœåŠ¡ç±»å‹ä¸º LoadBalancer çš„ Nginx æœåŠ¡æ¥éªŒè¯ä¸‹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">$ cat nginx-test.yaml</span><br><span class="line"></span><br><span class="line">apiVersion: apps&#x2F;v1beta2</span><br><span class="line">kind: Deployment</span><br><span class="line">metadata:</span><br><span class="line">  name: nginx</span><br><span class="line">spec:</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      app: nginx</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        app: nginx</span><br><span class="line">    spec:</span><br><span class="line">      containers:</span><br><span class="line">      - name: nginx</span><br><span class="line">        image: nginx:1</span><br><span class="line">        ports:</span><br><span class="line">        - name: http</span><br><span class="line">          containerPort: 80</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">  name: nginx</span><br><span class="line">spec:</span><br><span class="line">  ports:</span><br><span class="line">  - name: http</span><br><span class="line">    port: 80</span><br><span class="line">    protocol: TCP</span><br><span class="line">    targetPort: 80</span><br><span class="line">  selector:</span><br><span class="line">    app: nginx</span><br><span class="line">  type: LoadBalancer</span><br></pre></td></tr></table></figure><p>æœåŠ¡åˆ›å»ºå®Œæˆï¼Œè¿è¡Œ <code>kubectl apply -f nginx-test.yaml</code> å‘½ä»¤åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¯¹åº”æœåŠ¡ä¿¡æ¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl get pods nginx-68995d8957-bczhf -o wide</span><br><span class="line">NAME                     READY   STATUS    RESTARTS   AGE   IP            NODE       </span><br><span class="line">nginx-68995d8957-bczhf   2&#x2F;2     Running   0          19d   10.244.0.78   ubuntu-1  </span><br><span class="line"></span><br><span class="line">$ kubectl get svc</span><br><span class="line">NAME    TYPE           CLUSTER-IP      EXTERNAL-IP    PORT(S)        AGE</span><br><span class="line">nginx   LoadBalancer   10.97.187.100   192.168.0.10   80:32353&#x2F;TCP   179m</span><br></pre></td></tr></table></figure><p>ä»è¾“å‡ºç»“æœï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° LoadBalancer ç±»å‹çš„æœåŠ¡ï¼Œå¹¶ä¸”åˆ†é…çš„å¤–éƒ¨ IP åœ°å€æ˜¯åœ°å€æ± ä¸­çš„ç¬¬ä¸€ä¸ª IP <code>192.168.0.10</code>ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬é€šè¿‡ <code>curl http://192.168.0.10</code> å‘½ä»¤æ¥éªŒè¯ä¸‹ï¼Œå‘ç°å¯ä»¥æ­£å¸¸æ˜¾ç¤º Nginx çš„æ¬¢è¿ä¿¡æ¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Welcome to nginx!&lt;&#x2F;title&gt;</span><br><span class="line">................</span><br><span class="line">&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œ<code>MetalLB Layer 2</code> æ¨¡å¼çš„é…ç½®å°±ç»“æŸäº†ã€‚</p><h3 id="é…ç½®-metallb-ä¸º-bgp-æ¨¡å¼">é…ç½® MetalLB ä¸º BGP æ¨¡å¼</h3><p>å¯¹äºé…ç½®ä¸ºå…·æœ‰ä¸€ä¸ª <code>BGP</code> è·¯ç”±å™¨å’Œä¸€ä¸ª IP åœ°å€èŒƒå›´çš„ BGP æ¨¡å¼ï¼Œä½ éœ€è¦å…ˆå‡†å¤‡å¥½ä»¥ä¸‹ 4 æ¡é…ç½®ä¿¡æ¯ï¼š</p><ol><li><p>MetalLB åº”è¿æ¥çš„è·¯ç”±å™¨ IP åœ°å€ã€‚</p></li><li><p>è·¯ç”±å™¨çš„ AS å·ã€‚</p></li><li><p>MetalLB åº”è¯¥ä½¿ç”¨çš„ AS ç¼–å·ã€‚</p></li><li><p>IP åœ°å€èŒƒå›´ï¼Œè¡¨ç¤ºä¸º CIDR å‰ç¼€ã€‚</p></li></ol><p>ç”±äºè¿™ç§é…ç½®æ–¹å¼éœ€è¦å…·å¤‡ BGP åŠŸèƒ½çš„ç¡¬ä»¶è·¯ç”±å™¨æ”¯æŒï¼Œç›®å‰æˆ‘ä»¬ç¯å¢ƒä¸­ä¸å…·å¤‡æ­¤ç­‰æ¡ä»¶ã€‚è¿™é‡Œå°±ç®€å•è¯´ä¸‹ MetalLB å¯¹åº”çš„é…ç½®æ–¹å¼ï¼Œå…·ä½“å†…å®¹å°±ä¸å±•å¼€è®²è§£äº†ã€‚</p><p>ç”±äºå‰é¢å·²ç»å®‰è£…äº† MetalLB çš„ <code>Controller</code> å’Œ <code>Speaker</code>ï¼Œåªæ˜¯ä½¿ç”¨çš„æ˜¯ Layer 2 æ¨¡å¼ã€‚è¿™é‡Œåªéœ€è¦æ”¹ä¸º BGP æ¨¡å¼ï¼Œæˆ‘ä»¬ä¿®æ”¹ Configmap ä¸­ Config é…ç½®å°±å¯ä»¥äº†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># å‡å¦‚è¦ä¸º MetalLB æä¾›èŒƒå›´ 192.168.9.0&#x2F;24 å’Œ AS å· 65009ï¼Œå¹¶å°†å…¶è¿æ¥åˆ° 192.168.0.1 çš„ AS å·ä¸º 65000 çš„è·¯ç”±å™¨ã€‚</span><br><span class="line">$ cat MetalLB-BGP-Config.yaml</span><br><span class="line"></span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ConfigMap</span><br><span class="line">metadata:</span><br><span class="line">  namespace: metallb-system</span><br><span class="line">  name: config</span><br><span class="line">data:</span><br><span class="line">  config: |</span><br><span class="line">    peers:</span><br><span class="line">    - peer-address: 192.168.0.1</span><br><span class="line">      peer-asn: 65000</span><br><span class="line">      my-asn: 65009</span><br><span class="line">    address-pools:</span><br><span class="line">    - name: default</span><br><span class="line">      protocol: bgp</span><br><span class="line">      addresses:</span><br><span class="line">      #- 192.168.0.10-192.168.0.100</span><br><span class="line">      - 192.168.9.0&#x2F;24</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“">æ€»ç»“</h2><p>æœ¬æ–‡ç®€å•ä»‹ç»äº† MetalLB çš„ç”¨é€”ä»¥åŠ MetalLB çš„ä¸¤ç§éƒ¨ç½²æ¨¡å¼ï¼šLayer 2 æ¨¡å¼å’Œ BGP æ¨¡å¼ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¦‚æœæ¡ä»¶æ»¡è¶³ï¼Œæ¨èä½¿ç”¨ BGP æ¨¡å¼ã€‚</p><h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h2><ol><li><p><a href="http://www.google.com" target="_blank" rel="noopener">http://www.google.com</a></p></li><li><p><a href="https://blog.fleeto.us/post/intro-metallb/" target="_blank" rel="noopener">https://blog.fleeto.us/post/intro-metallb/</a></p></li><li><p><a href="https://ieevee.com/tech/2019/06/30/metallb.html" target="_blank" rel="noopener">https://ieevee.com/tech/2019/06/30/metallb.html</a></p></li><li><p><a href="https://blog.csdn.net/kunyus/article/details/88616653" target="_blank" rel="noopener">https://blog.csdn.net/kunyus/article/details/88616653</a></p></li><li><p><a href="https://vqiu.cn/metallb-si-you-ji-qun-loadbalancer/amp/" target="_blank" rel="noopener">https://vqiu.cn/metallb-si-you-ji-qun-loadbalancer/amp/</a></p></li><li><p><a href="https://sre.ink/metallb-kubernetes-loadbalancer-no-ipvs/" target="_blank" rel="noopener">https://sre.ink/metallb-kubernetes-loadbalancer-no-ipvs/</a></p></li><li><p><a href="https://blog.csdn.net/networken/article/details/85928369" target="_blank" rel="noopener">https://blog.csdn.net/networken/article/details/85928369</a></p></li><li><p><a href="https://blog.gmem.cc/external-lb-for-on-premise-k8s-cluster" target="_blank" rel="noopener">https://blog.gmem.cc/external-lb-for-on-premise-k8s-cluster</a></p></li><li><p><a href="https://leeif.me/2019/02/k8s-deploy-metallb-LoadBalancer.html" target="_blank" rel="noopener">https://leeif.me/2019/02/k8s-deploy-metallb-LoadBalancer.html</a></p></li><li><p><a href="https://mshk.top/2019/04/kubernetes-metallb-loadbalancer-nginx-ingress-controller/" target="_blank" rel="noopener">https://mshk.top/2019/04/kubernetes-metallb-loadbalancer-nginx-ingress-controller/</a></p></li></ol></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç§æœ‰äº‘è£¸é‡‘å±æ¶æ„ï¼ˆè¿™é‡Œæ˜¯ç›¸å¯¹äº‘ä¸Šç¯å¢ƒæ¥è¯´ï¼Œä¸æ˜¯è¯´æ— æ“ä½œç³»ç»Ÿï¼‰ä¸Šéƒ¨ç½²çš„ Kubernetes é›†ç¾¤ï¼Œé€šå¸¸æ˜¯æ— æ³•ä½¿ç”¨ LoadBalancer ç±»å‹çš„ Service çš„ã€‚å› ä¸º Kubernetes æœ¬èº«æ²¡æœ‰ä¸ºè£¸æœºç¾¤é›†æä¾›ç½‘ç»œè´Ÿè½½å‡è¡¡å™¨ï¼ˆç±»å‹ä¸º LoadBalancer çš„æœåŠ¡ï¼‰çš„å®ç°ã€‚å¦‚æœä½ çš„ Kubernetes é›†ç¾¤æ²¡æœ‰åœ¨å…¬æœ‰äº‘çš„ IaaS å¹³å°ï¼ˆGCPï¼ŒAWSï¼ŒAzure â€¦ï¼‰ä¸Šè¿è¡Œï¼Œåˆ™ LoadBalancers å°†åœ¨åˆ›å»ºæ—¶æ— é™æœŸåœ°ä¿æŒ â€œæŒ‚èµ·â€ çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´åªæœ‰å…¬æœ‰äº‘å‚å•†è‡ªå®¶çš„ Kubernetes æ”¯æŒ LoadBalancer ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ä»å¤–éƒ¨è®¿é—®è£¸æœº Kubernetes ç¾¤é›†ï¼Œç›®å‰åªèƒ½ä½¿ç”¨ &lt;code&gt;NodePort&lt;/code&gt; æˆ– &lt;code&gt;Ingress&lt;/code&gt; çš„æ–¹æ³•è¿›è¡ŒæœåŠ¡æš´éœ²ã€‚å‰è€…çš„ç¼ºç‚¹æ˜¯æ¯ä¸ªæš´éœ²çš„æœåŠ¡éœ€è¦å ç”¨æ‰€æœ‰èŠ‚ç‚¹çš„æŸä¸ªç«¯å£ï¼Œåè€…çš„ç¼ºç‚¹æ˜¯ä»…ä»…èƒ½æ”¯æŒ &lt;code&gt;HTTP&lt;/code&gt; åè®®ã€‚&lt;/p&gt;
&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯-MetalLB&quot;&gt;ä»€ä¹ˆæ˜¯ MetalLB&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;MetalLB&lt;/code&gt; æ˜¯ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨ï¼Œä¸“é—¨è§£å†³è£¸é‡‘å± Kubernetes é›†ç¾¤ä¸­æ— æ³•ä½¿ç”¨ &lt;code&gt;LoadBalancer&lt;/code&gt; ç±»å‹æœåŠ¡çš„ç—›ç‚¹ã€‚&lt;code&gt;MetalLB&lt;/code&gt; ä½¿ç”¨æ ‡å‡†åŒ–çš„è·¯ç”±åè®®ï¼Œä»¥ä¾¿è£¸é‡‘å± Kubernetes é›†ç¾¤ä¸Šçš„å¤–éƒ¨æœåŠ¡ä¹Ÿå°½å¯èƒ½åœ°å·¥ä½œã€‚å³ MetalLB èƒ½å¤Ÿå¸®åŠ©ä½ åœ¨è£¸é‡‘å± Kubernetes é›†ç¾¤ä¸­åˆ›å»º LoadBalancer ç±»å‹çš„ Kubernetes æœåŠ¡ï¼Œè¯¥é¡¹ç›®å‘å¸ƒäº 2017 å¹´åº•ï¼Œå½“å‰å¤„äº &lt;code&gt;Beta&lt;/code&gt; é˜¶æ®µã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¡¹ç›®åœ°å€ï¼š&lt;a href=&quot;https://github.com/danderson/metallb&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/danderson/metallb&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;MetalLB-å·¥ä½œåŸç†&quot;&gt;MetalLB å·¥ä½œåŸç†&lt;/h2&gt;
&lt;p&gt;MetalLB ä¼šåœ¨ Kubernetes å†…è¿è¡Œï¼Œç›‘æ§æœåŠ¡å¯¹è±¡çš„å˜åŒ–ï¼Œä¸€æ—¦ç›‘æµ‹åˆ°æœ‰æ–°çš„ LoadBalancer æœåŠ¡è¿è¡Œï¼Œå¹¶ä¸”æ²¡æœ‰å¯ç”³è¯·çš„è´Ÿè½½å‡è¡¡å™¨ä¹‹åï¼Œå°±ä¼šå®Œæˆåœ°å€åˆ†é…å’Œå¤–éƒ¨å£°æ˜ä¸¤éƒ¨åˆ†çš„å·¥ä½œã€‚&lt;/p&gt;
&lt;h3 id=&quot;åœ°å€åˆ†é…&quot;&gt;åœ°å€åˆ†é…&lt;/h3&gt;
&lt;p&gt;åœ¨äº‘ç¯å¢ƒä¸­ï¼Œå½“ä½ è¯·æ±‚ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨æ—¶ï¼Œäº‘å¹³å°ä¼šè‡ªåŠ¨åˆ†é…ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨çš„ IP åœ°å€ç»™ä½ ï¼Œåº”ç”¨ç¨‹åºé€šè¿‡æ­¤ IP æ¥è®¿é—®ç»è¿‡è´Ÿè½½å‡è¡¡å¤„ç†çš„æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ MetalLB æ—¶ï¼ŒMetalLB ä¼šè‡ªå·±ä¸ºç”¨æˆ·çš„ LoadBalancer ç±»å‹ Service åˆ†é… IP åœ°å€ï¼Œå½“ç„¶è¯¥ IP åœ°å€ä¸æ˜¯å‡­ç©ºäº§ç”Ÿçš„ï¼Œéœ€è¦ç”¨æˆ·åœ¨é…ç½®ä¸­æä¾›ä¸€ä¸ª IP åœ°å€æ± ï¼ŒMetallb å°†ä¼šåœ¨å…¶ä¸­é€‰å–åœ°å€åˆ†é…ç»™æœåŠ¡ã€‚&lt;/p&gt;
&lt;h3 id=&quot;å¤–éƒ¨å£°æ˜&quot;&gt;å¤–éƒ¨å£°æ˜&lt;/h3&gt;
&lt;p&gt;MetalLB å°† IP åˆ†é…ç»™æŸä¸ªæœåŠ¡åï¼Œå®ƒéœ€è¦å¯¹å¤–å®£å‘Šæ­¤ IP åœ°å€ï¼Œå¹¶è®©å¤–éƒ¨ä¸»æœºå¯ä»¥è·¯ç”±åˆ°æ­¤ IPã€‚&lt;/p&gt;
&lt;p&gt;MetalLB æ”¯æŒä¸¤ç§å£°æ˜æ¨¡å¼ï¼šLayer 2ï¼ˆ ARP / NDP ï¼‰æ¨¡å¼æˆ–è€… BGP æ¨¡å¼ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Layer 2 æ¨¡å¼&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://kubernetes.github.io/ingress-nginx/images/baremetal/metallb.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ä»»ä½•ä»¥å¤ªç½‘ç¯å¢ƒå‡å¯ä½¿ç”¨è¯¥æ¨¡å¼ã€‚å½“åœ¨ç¬¬äºŒå±‚å·¥ä½œæ—¶ï¼Œå°†æœ‰ä¸€å°æœºå™¨è·å¾— IP åœ°å€ï¼ˆå³æœåŠ¡çš„æ‰€æœ‰æƒï¼‰ã€‚MetalLB ä½¿ç”¨æ ‡å‡†çš„åœ°å€å‘ç°åè®®ï¼ˆå¯¹äº IPv4 æ˜¯ ARPï¼Œå¯¹äº IPv6 æ˜¯ NDPï¼‰å®£å‘Š IP åœ°å€ï¼Œä½¿å…¶åœ¨æœ¬åœ°ç½‘è·¯ä¸­å¯è¾¾ã€‚ä» LAN çš„è§’åº¦æ¥çœ‹ï¼Œä»…ä»…æ˜¯æŸå°æœºå™¨å¤šé…ç½®äº†ä¸€ä¸ª IP åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;Layer 2 æ¨¡å¼ä¸‹ï¼Œæ¯ä¸ª Service ä¼šæœ‰é›†ç¾¤ä¸­çš„ä¸€ä¸ª Node æ¥è´Ÿè´£ã€‚æœåŠ¡çš„å…¥å£æµé‡å…¨éƒ¨ç»ç”±å•ä¸ªèŠ‚ç‚¹ï¼Œç„¶åè¯¥èŠ‚ç‚¹çš„ Kube-Proxy ä¼šæŠŠæµé‡å†è½¬å‘ç»™æœåŠ¡çš„ Podsã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¯¥æ¨¡å¼ä¸‹ MetalLB å¹¶æ²¡æœ‰çœŸæ­£æä¾›è´Ÿè½½å‡è¡¡å™¨ã€‚å°½ç®¡å¦‚æ­¤ï¼ŒMetalLB æä¾›äº†æ•…éšœè½¬ç§»åŠŸèƒ½ï¼Œå¦‚æœæŒæœ‰ IP çš„èŠ‚ç‚¹å‡ºç°æ•…éšœï¼Œåˆ™é»˜è®¤ 10 ç§’åå³å‘ç”Ÿæ•…éšœè½¬ç§»ï¼ŒIP ä¼šè¢«åˆ†é…ç»™å…¶å®ƒå¥åº·çš„èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;Layer 2 æ¨¡å¼çš„ä¼˜ç¼ºç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Layer 2 æ¨¡å¼æ›´ä¸ºé€šç”¨ï¼Œä¸éœ€è¦ç”¨æˆ·æœ‰é¢å¤–çš„è®¾å¤‡ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Layer 2 æ¨¡å¼ä¸‹å­˜åœ¨å•ç‚¹é—®é¢˜ï¼ŒæœåŠ¡çš„æ‰€æœ‰å…¥å£æµé‡ç»ç”±å•ç‚¹ï¼Œå…¶ç½‘ç»œå¸¦å®½å¯èƒ½æˆä¸ºç“¶é¢ˆï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”±äº Layer 2 æ¨¡å¼éœ€è¦ ARP/NDP å®¢æˆ·ç«¯é…åˆï¼Œå½“æ•…éšœè½¬ç§»å‘ç”Ÿæ—¶ï¼ŒMetalLB ä¼šå‘é€ ARP åŒ…æ¥å®£å‘Š MAC åœ°å€å’Œ IP æ˜ å°„å…³ç³»çš„å˜åŒ–ï¼Œåœ°å€åˆ†é…ç•¥ä¸ºç¹çã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;BGP æ¨¡å¼&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å½“åœ¨ç¬¬ä¸‰å±‚å·¥ä½œæ—¶ï¼Œé›†ç¾¤ä¸­æ‰€æœ‰æœºå™¨éƒ½å’Œä½ æ§åˆ¶çš„æœ€æ¥è¿‘çš„è·¯ç”±å™¨å»ºç«‹ BGP ä¼šè¯ï¼Œæ­¤ä¼šè¯è®©è·¯ç”±å™¨èƒ½å­¦ä¹ åˆ°å¦‚ä½•è½¬å‘é’ˆå¯¹ K8S æœåŠ¡ IP çš„æ•°æ®åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡ä½¿ç”¨ BGPï¼Œå¯ä»¥å®ç°çœŸæ­£çš„è·¨å¤šèŠ‚ç‚¹è´Ÿè½½å‡è¡¡ï¼ˆéœ€è¦è·¯ç”±å™¨æ”¯æŒ multipathï¼‰ï¼Œè¿˜å¯ä»¥åŸºäº BGP çš„ç­–ç•¥æœºåˆ¶å®ç°ç»†ç²’åº¦çš„æµé‡æ§åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“çš„è´Ÿè½½å‡è¡¡è¡Œä¸ºå’Œè·¯ç”±å™¨æœ‰å…³ï¼Œå¯ä¿è¯çš„å…±åŒè¡Œä¸ºæ˜¯ï¼šæ¯ä¸ªè¿æ¥ï¼ˆTCP æˆ– UDP ä¼šè¯ï¼‰çš„æ•°æ®åŒ…æ€»æ˜¯è·¯ç”±åˆ°åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;BGP æ¨¡å¼çš„ä¼˜ç¼ºç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ä¸èƒ½ä¼˜é›…å¤„ç†æ•…éšœè½¬ç§»ï¼Œå½“æŒæœ‰æœåŠ¡çš„èŠ‚ç‚¹å®•æ‰åï¼Œæ‰€æœ‰æ´»åŠ¨è¿æ¥çš„å®¢æˆ·ç«¯å°†æ”¶åˆ° Connection reset by peer ï¼›&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;BGP è·¯ç”±å™¨å¯¹æ•°æ®åŒ…çš„æº IPã€ç›®çš„ IPã€åè®®ç±»å‹è¿›è¡Œç®€å•çš„å“ˆå¸Œï¼Œå¹¶ä¾æ®å“ˆå¸Œå€¼å†³å®šå‘ç»™å“ªä¸ª K8S èŠ‚ç‚¹ã€‚é—®é¢˜æ˜¯ K8S èŠ‚ç‚¹é›†æ˜¯ä¸ç¨³å®šçš„ï¼Œä¸€æ—¦ï¼ˆå‚ä¸ BGPï¼‰çš„èŠ‚ç‚¹å®•æ‰ï¼Œå¾ˆå¤§éƒ¨åˆ†çš„æ´»åŠ¨è¿æ¥éƒ½ä¼šå› ä¸º rehash è€Œåæ‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;BGP æ¨¡å¼é—®é¢˜çš„ç¼“å’Œæªæ–½ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å°†æœåŠ¡ç»‘å®šåˆ°ä¸€éƒ¨åˆ†å›ºå®šçš„èŠ‚ç‚¹ä¸Šï¼Œé™ä½ rehash çš„æ¦‚ç‡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨æµé‡ä½çš„æ—¶æ®µæ”¹å˜æœåŠ¡çš„éƒ¨ç½²ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å®¢æˆ·ç«¯æ·»åŠ é€æ˜é‡è¯•é€»è¾‘ï¼Œå½“å‘ç°è¿æ¥ TCP å±‚é”™è¯¯æ—¶è‡ªåŠ¨é‡è¯•ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Kubernetes" scheme="https://www.hi-linux.com/categories/kubernetes/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="Kubernetes" scheme="https://www.hi-linux.com/tags/Kubernetes/"/>
    
  </entry>
  
  <entry>
    <title>å†è§ Dockerï¼Œæ˜¯æ—¶å€™æ‹¥æŠ±ä¸‹ä¸€ä»£å®¹å™¨å·¥å…·äº†</title>
    <link href="https://www.hi-linux.com/posts/62714.html"/>
    <id>https://www.hi-linux.com/posts/62714.html</id>
    <published>2020-05-08T01:00:00.000Z</published>
    <updated>2020-05-08T07:01:17.891Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><h2 id="ä»€ä¹ˆæ˜¯-linux-å®¹å™¨">ä»€ä¹ˆæ˜¯ Linux å®¹å™¨ï¼Ÿ</h2><p><code>Linux</code> å®¹å™¨æ˜¯ç”± <code>Linux</code> å†…æ ¸æ‰€æä¾›çš„å…·æœ‰ç‰¹å®šéš”ç¦»åŠŸèƒ½çš„è¿›ç¨‹ï¼Œ<code>Linux</code> å®¹å™¨æŠ€æœ¯èƒ½å¤Ÿè®©ä½ å¯¹åº”ç”¨åŠå…¶æ•´ä¸ªè¿è¡Œæ—¶ç¯å¢ƒï¼ˆåŒ…æ‹¬å…¨éƒ¨æ‰€éœ€æ–‡ä»¶ï¼‰ä¸€èµ·è¿›è¡Œæ‰“åŒ…æˆ–éš”ç¦»ã€‚ä»è€Œè®©ä½ åœ¨ä¸åŒç¯å¢ƒï¼ˆå¦‚å¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§ç­‰ç¯å¢ƒï¼‰ä¹‹é—´è½»æ¾è¿ç§»åº”ç”¨çš„åŒæ—¶ï¼Œè¿˜å¯ä¿ç•™åº”ç”¨çš„å…¨éƒ¨åŠŸèƒ½ã€‚</p><p><code>Linux</code> å®¹å™¨è¿˜æœ‰åˆ©äºæ˜ç¡®åˆ’åˆ†èŒè´£èŒƒå›´ï¼Œå‡å°‘å¼€å‘å’Œè¿ç»´å›¢é˜Ÿé—´çš„å†²çªã€‚è¿™æ ·ï¼Œå¼€å‘äººå‘˜å¯ä»¥å…¨å¿ƒæŠ•å…¥åº”ç”¨å¼€å‘ï¼Œè€Œè¿ç»´å›¢é˜Ÿåˆ™å¯ä¸“æ³¨äºåŸºç¡€æ¶æ„ç»´æŠ¤ã€‚ç”±äº <code>Linux</code> å®¹å™¨åŸºäºå¼€æºæŠ€æœ¯æ„å»ºï¼Œè¿˜å°†ä¾¿äºä½ åœ¨æœªæ¥è½»æ¾é‡‡ç”¨å„ç±»æ›´æ–°ã€æ›´å¼ºçš„æŠ€æœ¯äº§å“ã€‚åŒ…æ‹¬ <code>CRI-O</code>ã€<code>Kubernetes</code> å’Œ <code>Docker</code> åœ¨å†…çš„å®¹å™¨æŠ€æœ¯ï¼Œå¯å¸®åŠ©ä½ çš„å›¢é˜Ÿæœ‰æ•ˆç®€åŒ–ã€åŠ é€Ÿå’Œç¼–æ’åº”ç”¨çš„å¼€å‘ä¸éƒ¨ç½²ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯-docker">ä»€ä¹ˆæ˜¯ Dockerï¼Ÿ</h2><p><code>Docker</code> æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼Œå±äº <code>Linux</code> å®¹å™¨çš„ä¸€ç§å°è£…ï¼Œ<code>Docker</code> æä¾›ç®€å•æ˜“ç”¨çš„å®¹å™¨ä½¿ç”¨æ¥å£ï¼Œè®©å¼€å‘è€…å¯ä»¥æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªå¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ <code>Linux</code> æœºå™¨ä¸Šã€‚å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šæœ‰ä»»ä½•æ¥å£ã€‚</p><p>Docker æ˜¯ç›®å‰æœ€æµè¡Œçš„ <code>Linux</code> å®¹å™¨è§£å†³æ–¹æ¡ˆï¼Œå³ä½¿ <code>Docker</code> æ˜¯ç›®å‰ç®¡ç† <code>Linux</code> å®¹å™¨çš„ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„å·¥å…·ï¼Œä½†å®ƒä¹Ÿæœ‰ä¸¤ä¸ªç¼ºç‚¹ï¼š</p><ol><li><p><code>Docker</code> éœ€è¦åœ¨ä½ çš„ç³»ç»Ÿä¸Šè¿è¡Œä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ã€‚</p></li><li><p><code>Docker</code> æ˜¯ä»¥ <code>root</code> èº«ä»½åœ¨ä½ çš„ç³»ç»Ÿä¸Šè¿è¡Œè¯¥å®ˆæŠ¤ç¨‹åºã€‚</p></li></ol><p>è¿™äº›ç¼ºç‚¹çš„å­˜åœ¨å¯èƒ½æœ‰ä¸€å®šçš„å®‰å…¨éšæ‚£ï¼Œä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œä¸‹ä¸€ä»£å®¹å™¨åŒ–å·¥å…· <code>Podman</code> å‡ºç°äº† ã€‚</p><h2 id="ä»€ä¹ˆæ˜¯-podman">ä»€ä¹ˆæ˜¯ Podman ï¼Ÿ</h2><p><img src="https://static.oschina.net/uploads/img/201808/31192253_l67X.png" alt=""></p><p><code>Podman</code> æ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨è¿è¡Œæ—¶é¡¹ç›®ï¼Œå¯åœ¨å¤§å¤šæ•° <code>Linux</code> å¹³å°ä¸Šä½¿ç”¨ã€‚<code>Podman</code> æä¾›ä¸ <code>Docker</code> éå¸¸ç›¸ä¼¼çš„åŠŸèƒ½ã€‚æ­£å¦‚å‰é¢æåˆ°çš„é‚£æ ·ï¼Œå®ƒä¸éœ€è¦åœ¨ä½ çš„ç³»ç»Ÿä¸Šè¿è¡Œä»»ä½•å®ˆæŠ¤è¿›ç¨‹ï¼Œå¹¶ä¸”å®ƒä¹Ÿå¯ä»¥åœ¨æ²¡æœ‰ <code>root</code> æƒé™çš„æƒ…å†µä¸‹è¿è¡Œã€‚</p><p><code>Podman</code> å¯ä»¥ç®¡ç†å’Œè¿è¡Œä»»ä½•ç¬¦åˆ <code>OCI</code>ï¼ˆOpen Container Initiativeï¼‰è§„èŒƒçš„å®¹å™¨å’Œå®¹å™¨é•œåƒã€‚<code>Podman</code> æä¾›äº†ä¸€ä¸ªä¸ <code>Docker</code> å…¼å®¹çš„å‘½ä»¤è¡Œå‰ç«¯æ¥ç®¡ç† <code>Docker</code> é•œåƒã€‚</p><blockquote><ol><li><p>Podman å®˜ç½‘åœ°å€ï¼š<a href="https://podman.io/" target="_blank" rel="noopener">https://podman.io/</a></p></li><li><p>Podman é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/containers/libpod" target="_blank" rel="noopener">https://github.com/containers/libpod</a></p></li></ol></blockquote><a id="more"></a><h2 id="å®‰è£…-podman">å®‰è£… Podman</h2><p><code>Podman</code> ç›®å‰å·²æ”¯æŒå¤§å¤šæ•°å‘è¡Œç‰ˆæœ¬é€šè¿‡è½¯ä»¶åŒ…æ¥è¿›è¡Œå®‰è£…ï¼Œä¸‹é¢æˆ‘ä»¬æ¥ä¸¾å‡ ä¸ªå¸¸ç”¨å‘è¡Œç‰ˆæœ¬çš„ä¾‹å­ã€‚</p><ul><li>Fedora / CentOS</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum -y install podman</span><br></pre></td></tr></table></figure><ul><li>Ubuntu</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update -qq</span><br><span class="line">$ sudo apt-get install -qq -y software-properties-common uidmap</span><br><span class="line">$ sudo add-apt-repository -y ppa:projectatomic&#x2F;ppa</span><br><span class="line">$ sudo apt-get update -qq</span><br><span class="line">$ sudo apt-get -qq -y install podman</span><br></pre></td></tr></table></figure><ul><li>MacOS</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ brew cask install podman</span><br></pre></td></tr></table></figure><ul><li>RHEL 7</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo subscription-manager repos --enable&#x3D;rhel-7-server-extras-rpms</span><br><span class="line">$ sudo yum -y install podman</span><br></pre></td></tr></table></figure><ul><li>Arch Linux</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo pacman -S podman</span><br></pre></td></tr></table></figure><p>æ›´å¤šç³»ç»Ÿçš„å®‰è£…æ–¹æ³•ï¼Œå¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://github.com/containers/libpod/blob/master/install.md" target="_blank" rel="noopener">https://github.com/containers/libpod/blob/master/install.md</a></p><h2 id="ä½¿ç”¨-podman">ä½¿ç”¨ Podman</h2><p>ä½¿ç”¨ <code>Podman</code> éå¸¸çš„ç®€å•ï¼Œ<code>Podman</code> çš„æŒ‡ä»¤è·Ÿ <code>Docker</code> å¤§å¤šæ•°éƒ½æ˜¯ç›¸åŒçš„ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹å‡ ä¸ªå¸¸ç”¨çš„ä¾‹å­ï¼š</p><h3 id="è¿è¡Œä¸€ä¸ªå®¹å™¨">è¿è¡Œä¸€ä¸ªå®¹å™¨</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ podman run -dt -p 8080:8080&#x2F;tcp  \</span><br><span class="line">-e HTTPD_VAR_RUN&#x3D;&#x2F;var&#x2F;run&#x2F;httpd  \</span><br><span class="line">-e HTTPD_MAIN_CONF_D_PATH&#x3D;&#x2F;etc&#x2F;httpd&#x2F;conf.d \</span><br><span class="line">-e HTTPD_MAIN_CONF_PATH&#x3D;&#x2F;etc&#x2F;httpd&#x2F;conf \</span><br><span class="line">-e HTTPD_CONTAINER_SCRIPTS_PATH&#x3D;&#x2F;usr&#x2F;share&#x2F;container-scripts&#x2F;httpd&#x2F; \</span><br><span class="line">registry.fedoraproject.org&#x2F;f27&#x2F;httpd &#x2F;usr&#x2F;bin&#x2F;run-httpd</span><br></pre></td></tr></table></figure><h3 id="åˆ—å‡ºè¿è¡Œçš„å®¹å™¨">åˆ—å‡ºè¿è¡Œçš„å®¹å™¨</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ podman ps -a</span><br></pre></td></tr></table></figure><h3 id="åˆ†æä¸€ä¸ªè¿è¡Œçš„å®¹å™¨">åˆ†æä¸€ä¸ªè¿è¡Œçš„å®¹å™¨</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ podman inspect -l | grep IPAddress\&quot;:</span><br><span class="line">&quot;SecondaryIPAddresses&quot;: null,</span><br><span class="line">&quot;IPAddress&quot;: &quot;&quot;,</span><br></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹ä¸€ä¸ªè¿è¡Œä¸­å®¹å™¨çš„æ—¥å¿—">æŸ¥çœ‹ä¸€ä¸ªè¿è¡Œä¸­å®¹å™¨çš„æ—¥å¿—</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ sudo podman logs --latest</span><br><span class="line">10.88.0.1 - - [07&#x2F;Feb&#x2F;2018:15:22:11 +0000] &quot;GET &#x2F; HTTP&#x2F;1.1&quot; 200 612 &quot;-&quot; &quot;curl&#x2F;7.55.1&quot; &quot;-&quot;</span><br><span class="line">10.88.0.1 - - [07&#x2F;Feb&#x2F;2018:15:22:30 +0000] &quot;GET &#x2F; HTTP&#x2F;1.1&quot; 200 612 &quot;-&quot; &quot;curl&#x2F;7.55.1&quot; &quot;-&quot;</span><br><span class="line">10.88.0.1 - - [07&#x2F;Feb&#x2F;2018:15:22:30 +0000] &quot;GET &#x2F; HTTP&#x2F;1.1&quot; 200 612 &quot;-&quot; &quot;curl&#x2F;7.55.1&quot; &quot;-&quot;</span><br><span class="line">10.88.0.1 - - [07&#x2F;Feb&#x2F;2018:15:22:31 +0000] &quot;GET &#x2F; HTTP&#x2F;1.1&quot; 200 612 &quot;-&quot; &quot;curl&#x2F;7.55.1&quot; &quot;-&quot;</span><br><span class="line">10.88.0.1 - - [07&#x2F;Feb&#x2F;2018:15:22:31 +0000] &quot;GET &#x2F; HTTP&#x2F;1.1&quot; 200 612 &quot;-&quot; &quot;curl&#x2F;7.55.1&quot; &quot;-&quot;</span><br></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹ä¸€ä¸ªè¿è¡Œå®¹å™¨ä¸­çš„è¿›ç¨‹èµ„æºä½¿ç”¨æƒ…å†µ">æŸ¥çœ‹ä¸€ä¸ªè¿è¡Œå®¹å™¨ä¸­çš„è¿›ç¨‹èµ„æºä½¿ç”¨æƒ…å†µ</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ sudo podman top &lt;container_id&gt;</span><br><span class="line">  UID   PID  PPID  C STIME TTY          TIME CMD</span><br><span class="line">    0 31873 31863  0 09:21 ?        00:00:00 nginx: master process nginx -g daemon off;</span><br><span class="line">  101 31889 31873  0 09:21 ?        00:00:00 nginx: worker process</span><br></pre></td></tr></table></figure><h3 id="åœæ­¢ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨">åœæ­¢ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo podman stop --latest</span><br></pre></td></tr></table></figure><h3 id="åˆ é™¤ä¸€ä¸ªå®¹å™¨">åˆ é™¤ä¸€ä¸ªå®¹å™¨</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo podman rm --latest</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šè¿™äº›ç‰¹æ€§åŸºæœ¬ä¸Šéƒ½å’Œ <code>Docker</code> ä¸€æ ·ï¼Œ<code>Podman</code> é™¤äº†å…¼å®¹è¿™äº›ç‰¹æ€§å¤–ï¼Œè¿˜æ”¯æŒäº†ä¸€äº›æ–°çš„ç‰¹æ€§ã€‚</p><h3 id="ç»™å®¹å™¨è®¾ç½®ä¸€ä¸ªæ£€æŸ¥ç‚¹">ç»™å®¹å™¨è®¾ç½®ä¸€ä¸ªæ£€æŸ¥ç‚¹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo podman container checkpoint &lt;container_id&gt;</span><br></pre></td></tr></table></figure><blockquote><p>éœ€è¦ CRIU 3.11 ä»¥ä¸Šç‰ˆæœ¬æ”¯æŒï¼ŒCRIU é¡¹ç›®åœ°å€ï¼š<a href="https://criu.org/" target="_blank" rel="noopener">https://criu.org/</a></p></blockquote><h3 id="æ ¹æ®æ£€æŸ¥ç‚¹ä½ç½®æ¢å¤å®¹å™¨">æ ¹æ®æ£€æŸ¥ç‚¹ä½ç½®æ¢å¤å®¹å™¨</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo podman container restore &lt;container_id&gt;</span><br></pre></td></tr></table></figure><h3 id="è¿ç§»å®¹å™¨">è¿ç§»å®¹å™¨</h3><p>Podman æ”¯æŒå°†å®¹å™¨ä»ä¸€å°æœºå™¨è¿ç§»åˆ°å¦ä¸€å°æœºå™¨ã€‚</p><p>é¦–å…ˆï¼Œåœ¨æºæœºå™¨ä¸Šå¯¹å®¹å™¨è®¾ç½®æ£€æŸ¥ç‚¹ï¼Œå¹¶å°†å®¹å™¨æ‰“åŒ…åˆ°æŒ‡å®šä½ç½®ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo podman container checkpoint &lt;container_id&gt; -e &#x2F;tmp&#x2F;checkpoint.tar.gz</span><br><span class="line">$ scp &#x2F;tmp&#x2F;checkpoint.tar.gz &lt;destination_system&gt;:&#x2F;tmp</span><br></pre></td></tr></table></figure><p>å…¶æ¬¡ï¼Œåœ¨ç›®æ ‡æœºå™¨ä¸Šä½¿ç”¨æºæœºå™¨ä¸Šä¼ è¾“è¿‡æ¥çš„æ‰“åŒ…æ–‡ä»¶å¯¹å®¹å™¨è¿›è¡Œæ¢å¤ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo podman container restore -i &#x2F;tmp&#x2F;checkpoint.tar.gz</span><br></pre></td></tr></table></figure><h3 id="é…ç½®åˆ«å">é…ç½®åˆ«å</h3><p>å¦‚æœä¹ æƒ¯äº†ä½¿ç”¨ <code>Docker</code> å‘½ä»¤ï¼Œå¯ä»¥ç›´æ¥ç»™ <code>Podman</code> é…ç½®ä¸€ä¸ªåˆ«åæ¥å®ç°æ— ç¼è½¬ç§»ã€‚ä½ åªéœ€è¦åœ¨ <code>.bashrc</code> ä¸‹åŠ å…¥ä»¥ä¸‹è¡Œå†…å®¹å³å¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ echo &quot;alias docker&#x3D;podman&quot; &gt;&gt; .bashrc</span><br><span class="line">$ source .bashrc</span><br></pre></td></tr></table></figure><h3 id="podman-å¦‚ä½•å®ç°å¼€æœºé‡å¯å®¹å™¨">Podman å¦‚ä½•å®ç°å¼€æœºé‡å¯å®¹å™¨</h3><p>ç”±äº <code>Podman</code> ä¸å†ä½¿ç”¨å®ˆæŠ¤è¿›ç¨‹ç®¡ç†æœåŠ¡ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡å®ˆæŠ¤è¿›ç¨‹å»å®ç°è‡ªåŠ¨é‡å¯å®¹å™¨çš„åŠŸèƒ½ã€‚é‚£å¦‚æœè¦å®ç°å¼€æœºè‡ªåŠ¨é‡å¯å®¹å™¨ï¼Œåˆè¯¥å¦‚ä½•å®ç°å‘¢ï¼Ÿ</p><p>å…¶å®æ–¹æ³•å¾ˆç®€å•ï¼Œç°åœ¨å¤§å¤šæ•°ç³»ç»Ÿéƒ½å·²ç»é‡‡ç”¨ <code>Systemd</code> ä½œä¸ºå®ˆæŠ¤è¿›ç¨‹ç®¡ç†å·¥å…·ã€‚è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ <code>Systemd</code> æ¥å®ç° <code>Podman</code> å¼€æœºé‡å¯å®¹å™¨ï¼Œè¿™é‡Œæˆ‘ä»¬ä»¥å¯åŠ¨ä¸€ä¸ª <code>Nginx</code> å®¹å™¨ä¸ºä¾‹å­ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆè¿è¡Œä¸€ä¸ª <code>Nginx</code> å®¹å™¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo podman run -t -d -p 80:80 --name nginx nginx</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œåœ¨å»ºç«‹ä¸€ä¸ª <code>Systemd</code> æœåŠ¡é…ç½®æ–‡ä»¶ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ vim &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;nginx_container.service</span><br><span class="line"></span><br><span class="line">[Unit]</span><br><span class="line">Description&#x3D;Podman Nginx Service</span><br><span class="line">After&#x3D;network.target</span><br><span class="line">After&#x3D;network-online.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type&#x3D;simple</span><br><span class="line">ExecStart&#x3D;&#x2F;usr&#x2F;bin&#x2F;podman start -a nginx</span><br><span class="line">ExecStop&#x3D;&#x2F;usr&#x2F;bin&#x2F;podman stop -t 10 nginx</span><br><span class="line">Restart&#x3D;always</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy&#x3D;multi-user.target</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œå¯ç”¨è¿™ä¸ª <code>Systemd</code> æœåŠ¡ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl daemon-reload</span><br><span class="line">$ sudo systemctl enable nginx_container.service</span><br><span class="line">$ sudo systemctl start nginx_container.service</span><br></pre></td></tr></table></figure><p>æœåŠ¡å¯ç”¨æˆåŠŸåï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>systemctl status</code> å‘½ä»¤æŸ¥çœ‹åˆ°è¿™ä¸ªæœåŠ¡çš„è¿è¡ŒçŠ¶å†µã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl status nginx_container.service</span><br><span class="line">â— nginx_container.service - Podman Nginx Service</span><br><span class="line">   Loaded: loaded (&#x2F;etc&#x2F;systemd&#x2F;system&#x2F;nginx_container.service; enabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since Sat 2019-08-20 20:59:26 UTC; 1min 41s ago</span><br><span class="line"> Main PID: 845 (podman)</span><br><span class="line">    Tasks: 16 (limit: 4915)</span><br><span class="line">   Memory: 37.6M</span><br><span class="line">   CGroup: &#x2F;system.slice&#x2F;nginx_container.service</span><br><span class="line">           â””â”€845 &#x2F;usr&#x2F;bin&#x2F;podman start -a nginx</span><br><span class="line"></span><br><span class="line">Aug 20 20:59:26 Ubuntu-dev.novalocal systemd[1]: Started Podman Nginx Service.</span><br></pre></td></tr></table></figure><p>ä¹‹åæ¯æ¬¡ç³»ç»Ÿé‡å¯å <code>Systemd</code> éƒ½ä¼šè‡ªåŠ¨å¯åŠ¨è¿™ä¸ªæœåŠ¡æ‰€å¯¹åº”çš„å®¹å™¨ã€‚</p><h2 id="å…¶å®ƒç›¸å…³å·¥å…·">å…¶å®ƒç›¸å…³å·¥å…·</h2><p><code>Podman</code> åªæ˜¯ <code>OCI</code> å®¹å™¨ç”Ÿæ€ç³»ç»Ÿè®¡åˆ’ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œä¸»è¦ä¸“æ³¨äºå¸®åŠ©ç”¨æˆ·ç»´æŠ¤å’Œä¿®æ”¹ç¬¦åˆ <code>OCI</code> è§„èŒƒå®¹å™¨é•œåƒã€‚å…¶å®ƒçš„ç»„ä»¶è¿˜æœ‰ <code>Buildah</code>ã€<code>Skopeo</code> ç­‰ã€‚</p><h3 id="buildah">Buildah</h3><p><img src="https://camo.githubusercontent.com/843f7639202a27bf5b6abc2afcc405e82804156a/68747470733a2f2f63646e2e7261776769742e636f6d2f636f6e7461696e6572732f6275696c6461682f6d61737465722f6c6f676f732f6275696c6461682d6c6f676f5f6c617267652e706e67" alt=""></p><p>è™½ç„¶ <code>Podman</code> ä¹Ÿå¯ä»¥æ”¯æŒç”¨æˆ·æ„å»º <code>Docker</code> é•œåƒï¼Œä½†æ˜¯æ„å»ºé€Ÿåº¦æ¯”è¾ƒæ…¢ã€‚å¹¶ä¸”é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨ <code>VFS</code> å­˜å‚¨é©±åŠ¨ç¨‹åºä¼šæ¶ˆè€—å¤§é‡ç£ç›˜ç©ºé—´ã€‚</p><p><code>Buildah</code> æ˜¯ä¸€ä¸ªä¸“æ³¨äºæ„å»º <code>OCI</code> å®¹å™¨é•œåƒçš„å·¥å…·ï¼Œ<code>Buildah</code> æ„å»ºé€Ÿåº¦éå¸¸å¿«å¹¶ä½¿ç”¨è¦†ç›–å­˜å‚¨é©±åŠ¨ç¨‹åºï¼Œå¯ä»¥èŠ‚çº¦å¤§é‡çš„ç©ºé—´ã€‚</p><p><code>Buildah</code> åŸºäº <code>fork-exec</code> æ¨¡å‹ï¼Œä¸ä»¥å®ˆæŠ¤è¿›ç¨‹è¿è¡Œã€‚<code>Buildah</code> æ”¯æŒ <code>Dockerfile</code> ä¸­çš„æ‰€æœ‰å‘½ä»¤ã€‚ä½ å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>Dockerfiles</code> æ¥æ„å»ºé•œåƒï¼Œå¹¶ä¸”ä¸éœ€è¦ä»»ä½• <code>root</code> æƒé™ã€‚ <code>Buildah</code> ä¹Ÿæ”¯æŒç”¨è‡ªå·±çš„è¯­æ³•æ–‡ä»¶æ„å»ºé•œåƒï¼Œå¯ä»¥å…è®¸å°†å…¶ä»–è„šæœ¬è¯­è¨€é›†æˆåˆ°æ„å»ºè¿‡ç¨‹ä¸­ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ <code>Buidah</code> è‡ªæœ‰è¯­æ³•æ„å»ºçš„ä¾‹å­ã€‚</p><p><img src="https://i.loli.net/2019/08/23/coEdGDYeFlMquUT.png" alt=""></p><p><code>Buildah</code> å’Œ <code>Podman</code> ä¹‹é—´çš„ä¸€ä¸ªä¸»è¦åŒºåˆ«æ˜¯ï¼š<code>Podman</code> ç”¨äºè¿è¡Œå’Œç®¡ç†å®¹å™¨ï¼Œ å…è®¸æˆ‘ä»¬ä½¿ç”¨ç†Ÿæ‚‰çš„å®¹å™¨ <code>CLI</code> å‘½ä»¤åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç®¡ç†å’Œç»´æŠ¤è¿™äº›é•œåƒå’Œå®¹å™¨ï¼Œè€Œ <code>Buildah</code> ä¸»ç”¨äºæ„å»ºå®¹å™¨ã€‚</p><blockquote><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/containers/buildah" target="_blank" rel="noopener">https://github.com/containers/buildah</a></p></blockquote><h3 id="skopeo">Skopeo</h3><p><img src="https://camo.githubusercontent.com/19ba0305d59474c3cada4b65d5812c8c4c59465c/68747470733a2f2f63646e2e7261776769742e636f6d2f636f6e7461696e6572732f736b6f70656f2f6d61737465722f646f63732f736b6f70656f2e737667" alt=""></p><p><code>Skopeo</code> æ˜¯ä¸€ä¸ªé•œåƒç®¡ç†å·¥å…·ï¼Œå…è®¸æˆ‘ä»¬é€šè¿‡ <code>Push</code>ã€<code>Pull</code>å’Œå¤åˆ¶é•œåƒæ¥å¤„ç† <code>Docker</code> å’Œç¬¦åˆ <code>OCI</code> è§„èŒƒçš„é•œåƒã€‚</p><blockquote><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/containers/skopeo" target="_blank" rel="noopener">https://github.com/containers/skopeo</a></p></blockquote><h2 id="å»¶ä¼¸é˜…è¯»">å»¶ä¼¸é˜…è¯»</h2><h3 id="ä»€ä¹ˆæ˜¯-oci">ä»€ä¹ˆæ˜¯ OCIï¼Ÿ</h3><p><code>OCI</code> (Open Container Initiative)ï¼Œæ˜¯ä¸€ä¸ªè½»é‡çº§ï¼Œå¼€æ”¾çš„æ²»ç†ç»“æ„ï¼ˆé¡¹ç›®ï¼‰ã€‚åœ¨ <code>Linux</code> åŸºé‡‘ä¼šçš„æ”¯æŒä¸‹æˆç«‹ï¼Œè‡´åŠ›äºå›´ç»•å®¹å™¨æ ¼å¼å’Œè¿è¡Œæ—¶åˆ›å»ºå¼€æ”¾çš„è¡Œä¸šæ ‡å‡†ã€‚</p><p><code>OCI</code> é¡¹ç›®ç”± <code>Docker</code>ã€<code>CoreOS</code> å’Œå®¹å™¨è¡Œä¸šä¸­çš„å…¶å®ƒé¢†å¯¼è€…åœ¨ 2015 å¹´ 6 æœˆçš„æ—¶å€™å¯åŠ¨ï¼Œ<code>OCI</code> çš„æŠ€æœ¯å§”å‘˜ä¼šæˆå‘˜åŒ…æ‹¬ <code>Red Hat</code>ã€<code>Microsoft</code>ã€<code>Docker</code>ã€<code>Cruise</code>ã€<code>IBM</code>ã€<code>Google</code>ã€<code>Red Hat</code> å’Œ <code>SUSE</code> ç­‰ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯-cri">ä»€ä¹ˆæ˜¯ CRIï¼Ÿ</h3><p><code>CRI</code>ï¼ˆContainer Runtime Interfaceï¼‰æ˜¯ <code>Kubernetes</code> v1.5 å¼•å…¥çš„å®¹å™¨è¿è¡Œæ—¶æ¥å£ï¼Œå®ƒå°† <code>Kubelet</code> ä¸å®¹å™¨è¿è¡Œæ—¶è§£è€¦ï¼Œå°†åŸæ¥å®Œå…¨é¢å‘ <code>Pod</code> çº§åˆ«çš„å†…éƒ¨æ¥å£æ‹†åˆ†æˆé¢å‘ <code>Sandbox</code> å’Œ <code>Container</code> çš„ <code>gRPC</code> æ¥å£ï¼Œå¹¶å°†é•œåƒç®¡ç†å’Œå®¹å™¨ç®¡ç†åˆ†ç¦»åˆ°ä¸åŒçš„æœåŠ¡ã€‚</p><p><img src="https://i.loli.net/2019/08/23/L8lM1KENGdxqmgn.png" alt=""></p><h3 id="ä»€ä¹ˆæ˜¯-cni">ä»€ä¹ˆæ˜¯ CNIï¼Ÿ</h3><p><code>CNI</code>ï¼ˆContainer Network Interfaceï¼‰æ˜¯ <code>CNCF</code> æ——ä¸‹çš„ä¸€ä¸ªé¡¹ç›®ï¼Œæ˜¯ <code>Google</code> å’Œ <code>CoreOS</code> ä¸»å¯¼åˆ¶å®šçš„å®¹å™¨ç½‘ç»œæ ‡å‡†ã€‚<code>CNI</code> åŒ…å«æ–¹æ³•è§„èŒƒã€å‚æ•°è§„èŒƒç­‰ï¼Œæ˜¯ <code>Linux</code> å®¹å™¨ç½‘ç»œé…ç½®çš„ä¸€ç»„æ ‡å‡†å’Œåº“ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®è¿™äº›æ ‡å‡†å’Œåº“æ¥å¼€å‘è‡ªå·±çš„å®¹å™¨ç½‘ç»œæ’ä»¶ã€‚<code>CNI</code> å·²ç»è¢« <code>Kubernetes</code>ã€<code>Mesos</code>ã€<code>Cloud Foundry</code>ã€<code>RKT</code> ç­‰ä½¿ç”¨ï¼ŒåŒæ—¶ <code>Calico</code>ã€<code>Weave</code> ç­‰é¡¹ç›®éƒ½åœ¨ä¸º CNI æä¾›æ’ä»¶ã€‚</p><p><img src="https://www.hi-linux.com/img/linux/cni.png" alt=""></p><h2 id="æ€»ç»“">æ€»ç»“</h2><p>æœ¬æ–‡ä»‹ç»ä¸‰ä¸ªäº†ç¬¦åˆ <code>CRI</code> æ ‡å‡†çš„å®¹å™¨å·¥å…· <code>Podman</code>ã€ <code>Buildah</code> å’Œ <code>Skopeo</code>ã€‚è¿™ä¸‰ä¸ªå·¥å…·éƒ½æ˜¯åŸºäº <code>*nix</code> ä¼ ç»Ÿçš„ <code>fork-exec</code> æ¨¡å‹ï¼Œè§£å†³äº†ç”±äº <code>Docker</code> å®ˆæŠ¤ç¨‹åºå¯¼è‡´çš„å¯åŠ¨å’Œå®‰å…¨é—®é¢˜ï¼Œæé«˜äº†å®¹å™¨çš„æ€§èƒ½å’Œå®‰å…¨ã€‚</p><h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2><ol><li><a href="https://igene.tw/podman-intro" target="_blank" rel="noopener">https://igene.tw/podman-intro</a></li><li><a href="https://zhuanlan.zhihu.com/p/77373246" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/77373246</a></li><li><a href="https://zhuanlan.zhihu.com/p/47706426" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/47706426</a></li><li><a href="https://xuanwo.io/2019/08/06/oci-intro/" target="_blank" rel="noopener">https://xuanwo.io/2019/08/06/oci-intro/</a></li><li><a href="https://www.jianshu.com/p/62e71584d1cb" target="_blank" rel="noopener">https://www.jianshu.com/p/62e71584d1cb</a></li><li><a href="https://kubernetes.feisky.xyz/cha-jian-kuo-zhan/cri" target="_blank" rel="noopener">https://kubernetes.feisky.xyz/cha-jian-kuo-zhan/cri</a></li><li><a href="https://blog.csdn.net/networken/article/details/98684527" target="_blank" rel="noopener">https://blog.csdn.net/networken/article/details/98684527</a></li><li><a href="https://www.zcfy.cc/article/demystifying-the-open-container-initiative-oci-specifications" target="_blank" rel="noopener">https://www.zcfy.cc/article/demystifying-the-open-container-initiative-oci-specifications</a></li></ol></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ä»€ä¹ˆæ˜¯-Linux-å®¹å™¨ï¼Ÿ&quot;&gt;ä»€ä¹ˆæ˜¯ Linux å®¹å™¨ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Linux&lt;/code&gt; å®¹å™¨æ˜¯ç”± &lt;code&gt;Linux&lt;/code&gt; å†…æ ¸æ‰€æä¾›çš„å…·æœ‰ç‰¹å®šéš”ç¦»åŠŸèƒ½çš„è¿›ç¨‹ï¼Œ&lt;code&gt;Linux&lt;/code&gt; å®¹å™¨æŠ€æœ¯èƒ½å¤Ÿè®©ä½ å¯¹åº”ç”¨åŠå…¶æ•´ä¸ªè¿è¡Œæ—¶ç¯å¢ƒï¼ˆåŒ…æ‹¬å…¨éƒ¨æ‰€éœ€æ–‡ä»¶ï¼‰ä¸€èµ·è¿›è¡Œæ‰“åŒ…æˆ–éš”ç¦»ã€‚ä»è€Œè®©ä½ åœ¨ä¸åŒç¯å¢ƒï¼ˆå¦‚å¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§ç­‰ç¯å¢ƒï¼‰ä¹‹é—´è½»æ¾è¿ç§»åº”ç”¨çš„åŒæ—¶ï¼Œè¿˜å¯ä¿ç•™åº”ç”¨çš„å…¨éƒ¨åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Linux&lt;/code&gt; å®¹å™¨è¿˜æœ‰åˆ©äºæ˜ç¡®åˆ’åˆ†èŒè´£èŒƒå›´ï¼Œå‡å°‘å¼€å‘å’Œè¿ç»´å›¢é˜Ÿé—´çš„å†²çªã€‚è¿™æ ·ï¼Œå¼€å‘äººå‘˜å¯ä»¥å…¨å¿ƒæŠ•å…¥åº”ç”¨å¼€å‘ï¼Œè€Œè¿ç»´å›¢é˜Ÿåˆ™å¯ä¸“æ³¨äºåŸºç¡€æ¶æ„ç»´æŠ¤ã€‚ç”±äº &lt;code&gt;Linux&lt;/code&gt; å®¹å™¨åŸºäºå¼€æºæŠ€æœ¯æ„å»ºï¼Œè¿˜å°†ä¾¿äºä½ åœ¨æœªæ¥è½»æ¾é‡‡ç”¨å„ç±»æ›´æ–°ã€æ›´å¼ºçš„æŠ€æœ¯äº§å“ã€‚åŒ…æ‹¬ &lt;code&gt;CRI-O&lt;/code&gt;ã€&lt;code&gt;Kubernetes&lt;/code&gt; å’Œ &lt;code&gt;Docker&lt;/code&gt; åœ¨å†…çš„å®¹å™¨æŠ€æœ¯ï¼Œå¯å¸®åŠ©ä½ çš„å›¢é˜Ÿæœ‰æ•ˆç®€åŒ–ã€åŠ é€Ÿå’Œç¼–æ’åº”ç”¨çš„å¼€å‘ä¸éƒ¨ç½²ã€‚&lt;/p&gt;
&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯-Dockerï¼Ÿ&quot;&gt;ä»€ä¹ˆæ˜¯ Dockerï¼Ÿ&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Docker&lt;/code&gt; æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼Œå±äº &lt;code&gt;Linux&lt;/code&gt; å®¹å™¨çš„ä¸€ç§å°è£…ï¼Œ&lt;code&gt;Docker&lt;/code&gt; æä¾›ç®€å•æ˜“ç”¨çš„å®¹å™¨ä½¿ç”¨æ¥å£ï¼Œè®©å¼€å‘è€…å¯ä»¥æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªå¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ &lt;code&gt;Linux&lt;/code&gt; æœºå™¨ä¸Šã€‚å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šæœ‰ä»»ä½•æ¥å£ã€‚&lt;/p&gt;
&lt;p&gt;Docker æ˜¯ç›®å‰æœ€æµè¡Œçš„ &lt;code&gt;Linux&lt;/code&gt; å®¹å™¨è§£å†³æ–¹æ¡ˆï¼Œå³ä½¿ &lt;code&gt;Docker&lt;/code&gt; æ˜¯ç›®å‰ç®¡ç† &lt;code&gt;Linux&lt;/code&gt; å®¹å™¨çš„ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„å·¥å…·ï¼Œä½†å®ƒä¹Ÿæœ‰ä¸¤ä¸ªç¼ºç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;Docker&lt;/code&gt; éœ€è¦åœ¨ä½ çš„ç³»ç»Ÿä¸Šè¿è¡Œä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;Docker&lt;/code&gt; æ˜¯ä»¥ &lt;code&gt;root&lt;/code&gt; èº«ä»½åœ¨ä½ çš„ç³»ç»Ÿä¸Šè¿è¡Œè¯¥å®ˆæŠ¤ç¨‹åºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™äº›ç¼ºç‚¹çš„å­˜åœ¨å¯èƒ½æœ‰ä¸€å®šçš„å®‰å…¨éšæ‚£ï¼Œä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œä¸‹ä¸€ä»£å®¹å™¨åŒ–å·¥å…· &lt;code&gt;Podman&lt;/code&gt; å‡ºç°äº† ã€‚&lt;/p&gt;
&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯-Podman-ï¼Ÿ&quot;&gt;ä»€ä¹ˆæ˜¯ Podman ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://static.oschina.net/uploads/img/201808/31192253_l67X.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Podman&lt;/code&gt; æ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨è¿è¡Œæ—¶é¡¹ç›®ï¼Œå¯åœ¨å¤§å¤šæ•° &lt;code&gt;Linux&lt;/code&gt; å¹³å°ä¸Šä½¿ç”¨ã€‚&lt;code&gt;Podman&lt;/code&gt; æä¾›ä¸ &lt;code&gt;Docker&lt;/code&gt; éå¸¸ç›¸ä¼¼çš„åŠŸèƒ½ã€‚æ­£å¦‚å‰é¢æåˆ°çš„é‚£æ ·ï¼Œå®ƒä¸éœ€è¦åœ¨ä½ çš„ç³»ç»Ÿä¸Šè¿è¡Œä»»ä½•å®ˆæŠ¤è¿›ç¨‹ï¼Œå¹¶ä¸”å®ƒä¹Ÿå¯ä»¥åœ¨æ²¡æœ‰ &lt;code&gt;root&lt;/code&gt; æƒé™çš„æƒ…å†µä¸‹è¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Podman&lt;/code&gt; å¯ä»¥ç®¡ç†å’Œè¿è¡Œä»»ä½•ç¬¦åˆ &lt;code&gt;OCI&lt;/code&gt;ï¼ˆOpen Container Initiativeï¼‰è§„èŒƒçš„å®¹å™¨å’Œå®¹å™¨é•œåƒã€‚&lt;code&gt;Podman&lt;/code&gt; æä¾›äº†ä¸€ä¸ªä¸ &lt;code&gt;Docker&lt;/code&gt; å…¼å®¹çš„å‘½ä»¤è¡Œå‰ç«¯æ¥ç®¡ç† &lt;code&gt;Docker&lt;/code&gt; é•œåƒã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Podman å®˜ç½‘åœ°å€ï¼š&lt;a href=&quot;https://podman.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://podman.io/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Podman é¡¹ç›®åœ°å€ï¼š&lt;a href=&quot;https://github.com/containers/libpod&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/containers/libpod&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Kubernetes" scheme="https://www.hi-linux.com/categories/kubernetes/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="Docker" scheme="https://www.hi-linux.com/tags/Docker/"/>
    
      <category term="Kubernetes" scheme="https://www.hi-linux.com/tags/Kubernetes/"/>
    
  </entry>
  
  <entry>
    <title>å†è§ NTPï¼Œæ˜¯æ—¶å€™æ‹¥æŠ±ä¸‹ä¸€ä»£æ—¶é—´åŒæ­¥æœåŠ¡ Chrony äº†</title>
    <link href="https://www.hi-linux.com/posts/44857.html"/>
    <id>https://www.hi-linux.com/posts/44857.html</id>
    <published>2020-05-08T01:00:00.000Z</published>
    <updated>2020-05-08T06:31:03.045Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><p><code>Chrony</code> æ˜¯ä¸€ä¸ªå¤šåŠŸèƒ½çš„ <code>NTP (Network Time Protocol)</code> å®ç°ï¼Œç±» <code>Unix</code> ç³»ç»Ÿä¸Š <code>NTP</code> å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„æ›¿ä»£å“ã€‚å®ƒå¯ä»¥é€šè¿‡ <code>NTP</code> æœåŠ¡æˆ–è€…ç±»ä¼¼ <code>GPS</code> æ—¶é’Ÿæ¥æ”¶å™¨çš„ç¡¬ä»¶çº§å‚è€ƒæ—¶é’Ÿæ¥åŒæ­¥ç³»ç»Ÿæ—¶é’Ÿï¼Œå…·æœ‰æ›´å¥½çš„æ—¶é’Ÿå‡†ç¡®åº¦ï¼Œå¹¶ä¸”å¯¹äºé‚£äº›é—´æ­‡æ€§äº’è”ç½‘è¿æ¥çš„ç³»ç»Ÿå¾ˆæœ‰å¸®åŠ©ã€‚<code>Chrony</code> æ˜¯å…è´¹å¼€æºçš„ï¼Œå¹¶ä¸”æ”¯æŒ <code>GNU/Linux</code> å’Œ <code>BSD</code> è¡ç”Ÿç‰ˆï¼ˆæ¯”å¦‚ï¼š<code>FreeBSD</code>ã€<code>NetBSD</code>ï¼‰ã€<code>macOS</code> å’Œ <code>Solaris</code> ç­‰ã€‚</p><p><code>Chrony</code> æœ‰ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼šä¸€ä¸ªæ˜¯ <code>chronyd</code> å®ˆæŠ¤è¿›ç¨‹ï¼Œä¸»è¦ç”¨äºè°ƒæ•´å†…æ ¸ä¸­è¿è¡Œçš„ç³»ç»Ÿæ—¶é—´å’Œæ—¶é—´æœåŠ¡å™¨åŒæ­¥ã€‚å®ƒç¡®å®šè®¡ç®—æœºå¢å‡æ—¶é—´çš„æ¯”ç‡ï¼Œå¹¶å¯¹æ­¤è¿›è¡Œè°ƒæ•´è¡¥å¿ã€‚å¦ä¸€ä¸ªæ˜¯ <code>chronyc</code>ï¼Œå®ƒæä¾›ä¸€ä¸ªç”¨æˆ·ç•Œé¢ï¼Œç”¨äºç›‘æ§æ€§èƒ½å¹¶è¿›è¡Œå¤šæ ·åŒ–çš„é…ç½®ã€‚<code>chronyc</code> å¯ä»¥åœ¨ <code>chronyd</code> å®ä¾‹æ§åˆ¶çš„è®¡ç®—æœºä¸Šå·¥ä½œï¼Œä¹Ÿå¯ä»¥åœ¨ä¸€å°ä¸åŒçš„è¿œç¨‹è®¡ç®—æœºä¸Šå·¥ä½œã€‚</p><p><strong>Chrony å’Œ NTPD ç²¾åº¦å¯¹æ¯”æµ‹è¯•</strong></p><p>æˆ‘ä»¬å¯ä»¥ä» <code>Chrony</code> çš„å®˜æ–¹ç½‘ç«™ä¸Šå¯ä»¥çœ‹åˆ°ä¸ <code>NTPD</code> å„ç»´åº¦è¯¦ç»†å¯¹æ¯”ï¼š</p><p><img src="https://www.hi-linux.com/img/linux/chrony-1.png" alt=""></p><p>ä»å…¶æµ‹è¯•ç»“æœä¸Šçœ‹ä¼¼ä¹æ˜¯å„ç»´åº¦æ€§èƒ½éƒ½å¯ä»¥åŠæ‰“ <code>NTPD</code>ã€‚å› æ­¤ <code>Chrony</code> å¯¹è‡ªèº«çš„æ•´ä½“è¯„ä»·è¿˜æ˜¯æ¯”è¾ƒé«˜çš„ã€‚</p><p><strong>Chrony ç›¸è¾ƒäº NTPD æœåŠ¡çš„ä¼˜åŠ¿</strong></p><ol><li><p>æ›´å¿«çš„åŒæ­¥åªéœ€è¦æ•°åˆ†é’Ÿè€Œéæ•°å°æ—¶æ—¶é—´ï¼Œä»è€Œæœ€å¤§ç¨‹åº¦çš„å‡å°‘æ—¶é—´å’Œé¢‘ç‡è¯¯å·®ï¼Œè¿™å¯¹äºå¹¶éå…¨å¤©è¿è¡Œçš„å°å¼è®¡ç®—æœºæˆ–ç³»ç»Ÿè€Œè¨€éå¸¸æœ‰ç”¨ã€‚</p></li><li><p>èƒ½å¤Ÿæ›´å¥½çš„å“åº”æ—¶é—´é¢‘ç‡çš„å¿«é€Ÿå˜åŒ–ï¼Œè¿™å¯¹äºå…·å¤‡ä¸ç¨³å®šæ—¶é’Ÿçš„è™šæ‹Ÿæœºæˆ–å¯¼è‡´æ—¶é’Ÿé¢‘ç‡åå¤å˜åŒ–çš„èŠ‚èƒ½æŠ€æœ¯è€Œè¨€éå¸¸æœ‰ç”¨ã€‚</p></li><li><p>åœ¨åˆå§‹åŒæ­¥åï¼Œå®ƒå¹¶ä¸ä¼šåœæ­¢æ—¶é’Ÿï¼Œä»¥é˜²å¯¹éœ€è¦ç³»ç»Ÿæ—¶é—´ä¿æŒå•è°ƒçš„ç¨‹åºé€ æˆå½±å“ã€‚</p></li><li><p>åœ¨åº”å¯¹ä¸´æ—¶éå¯¹ç§°å»¶è¿Ÿæ—¶ï¼Œï¼ˆä¾‹å¦‚ï¼šå¤§è§„æ¨¡ä¸‹è½½é€ æˆè¿æ¥é¥±å’Œæ—¶ï¼‰æä¾›äº†æ›´å¥½çš„ç¨³å®šæ€§ã€‚</p></li><li><p>æ— éœ€å¯¹æœåŠ¡å™¨è¿›è¡Œå®šæœŸè½®è¯¢ï¼Œå› æ­¤å…·å¤‡é—´æ­‡æ€§ç½‘ç»œè¿æ¥çš„ç³»ç»Ÿä»ç„¶å¯ä»¥å¿«é€ŸåŒæ­¥æ—¶é’Ÿã€‚</p></li></ol><a id="more"></a><h2 id="å®‰è£…-chrony">å®‰è£… Chrony</h2><p>ä» <code>Centos 7.x</code> å¼€å§‹çš„æœ€å°å‘è¡Œç‰ˆä¸­éƒ½å·²ç»é¢„è£…å¹¶å¼€å¯äº† <code>Chrony</code>ã€‚å¦‚æœä½ çš„ç³»ç»Ÿä¸Šæ²¡æœ‰å®‰è£… <code>Chrony</code>ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è½»æ¾å®‰è£…å®ƒã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ yum -y install chrony    <span class="comment"># [On CentOS/RHEL]</span></span><br><span class="line">$ apt install chrony       <span class="comment"># [On Debian/Ubuntu]</span></span><br><span class="line">$ dnf -y install chrony    <span class="comment"># [On Fedora 22+]</span></span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œæˆåï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥ <code>chronyd</code> çš„çŠ¶æ€ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl status chronyd     <span class="comment"># [On SystemD]</span></span><br><span class="line">$ /etc/init.d/chronyd status   <span class="comment"># [On Init]</span></span><br></pre></td></tr></table></figure><p>å¦‚æœè¦åœ¨å¼€æœºå¼•å¯¼æ—¶è‡ªåŠ¨å¯ç”¨ <code>Chrony</code> çš„å®ˆæŠ¤ç¨‹åºï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å®ç°ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl <span class="built_in">enable</span> chrony       <span class="comment"># [On SystemD]</span></span><br><span class="line">$ chkconfig --add chronyd       <span class="comment"># [On Init]</span></span><br></pre></td></tr></table></figure><h2 id="é…ç½®-chrony">é…ç½® Chrony</h2><p><code>Chrony</code> çš„é»˜è®¤é…ç½®æ–‡ä»¶ä¸º <code>/etc/chrony.conf</code>ï¼Œä¸‹é¢å°†ä»‹ç»ä¸€äº›å¸¸ç”¨çš„é…ç½®é¡¹ã€‚</p><ol><li>server hostname [option]</li></ol><p><code>server</code> æŒ‡ä»¤ç”¨äºæŒ‡å®šè¦åŒæ­¥çš„ <code>NTP</code> æœåŠ¡å™¨ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server 0.centos.pool.ntp.org iburst</span><br></pre></td></tr></table></figure><p>å…¶ä¸­çš„ <code>0.centos.pool.ntp.org</code> æ˜¯ <code>NTP</code> æœåŠ¡å™¨çš„åœ°å€ï¼Œé»˜è®¤æœ‰å››ç»„å®˜æ–¹çš„ <code>NTP</code> æœåŠ¡å™¨ã€‚ä½ ä¹Ÿå¯ä»¥ä¿®æ”¹ä¸ºè‡ªå®šä¹‰çš„æ—¶é—´æœåŠ¡å™¨ï¼Œä¾‹å¦‚ï¼š<code>ntp1.aliyun.com</code>ã€‚</p><p><code>iburst</code> æ˜¯å‚æ•°, ä¸€èˆ¬ç”¨æ­¤å‚æ•°å³å¯ã€‚è¯¥å‚æ•°çš„å«ä¹‰æ˜¯åœ¨å¤´å››æ¬¡ <code>NTP</code> è¯·æ±‚ä»¥ <code>2s</code> æˆ–è€…æ›´çŸ­çš„é—´éš”ï¼Œè€Œä¸æ˜¯ä»¥ <code>minpoll x</code> æŒ‡å®šçš„æœ€å°é—´éš”ï¼Œè¿™æ ·çš„è®¾ç½®å¯ä»¥è®© <code>chronyd</code> å¯åŠ¨æ—¶å¿«é€Ÿè¿›è¡Œä¸€æ¬¡åŒæ­¥ã€‚</p><p>å…¶ä»–çš„å‚æ•°æœ‰ <code>minpoll x</code> é»˜è®¤å€¼æ˜¯ 6ï¼Œä»£è¡¨ <code>64s</code>ã€‚<code>maxpoll x</code> é»˜è®¤å€¼æ˜¯ 9ï¼Œä»£è¡¨ <code>512s</code>ã€‚</p><ol start="2"><li>driftfile file</li></ol><p><code>Chrony</code> ä¼šæ ¹æ®å®é™…æ—¶é—´è®¡ç®—ä¿®æ­£å€¼ï¼Œå¹¶å°†è¡¥å¿å‚æ•°è®°å½•åœ¨è¯¥æŒ‡ä»¤æŒ‡å®šçš„æ–‡ä»¶é‡Œï¼Œé»˜è®¤ä¸º <code>driftfile /var/lib/chrony/drift</code>ã€‚</p><p>ä¸ <code>ntpd</code> æˆ–è€… <code>ntpdate</code> æœ€å¤§çš„åŒºåˆ«å°±æ˜¯ï¼Œ<code>Chrony</code> çš„ä¿®æ­£æ˜¯è¿ç»­çš„ï¼Œé€šè¿‡å‡æ…¢æ—¶é’Ÿæˆ–è€…åŠ å¿«æ—¶é’Ÿçš„æ–¹å¼è¿ç»­çš„ä¿®æ­£ã€‚è€Œ <code>ntpd</code> æˆ–è€… <code>ntpdate</code> æ­é… <code>Crontab</code> çš„æ ¡æ—¶å·¥å…·æ˜¯ç›´æ¥è°ƒæ•´æ—¶é—´ï¼Œä¼šå‡ºç°é—´æ–­ï¼Œå¹¶ä¸”ç›¸åŒæ—¶é—´å¯èƒ½ä¼šå‡ºç°ä¸¤æ¬¡ã€‚å› æ­¤ï¼Œè¯·æ”¾å¼ƒä½¿ç”¨ <code>ntpd</code>ã€<code>ntpdate</code> æ¥æ ¡æ—¶ã€‚</p><ol start="3"><li>makestep threshold limit</li></ol><p>æ­¤æŒ‡ä»¤ä½¿ <code>Chrony</code> æ ¹æ®éœ€è¦é€šè¿‡åŠ é€Ÿæˆ–å‡æ…¢æ—¶é’Ÿæ¥é€æ¸æ ¡æ­£ä»»ä½•æ—¶é—´åç§»ã€‚ä¾‹å¦‚ï¼š<code>makestep 1.0 3</code>ï¼Œå°±è¡¨ç¤ºå½“å¤´ä¸‰æ¬¡æ ¡æ—¶ï¼Œå¦‚æœæ—¶é—´ç›¸å·® <code>1.0s</code>, åˆ™è·³è·ƒå¼æ ¡æ—¶ã€‚</p><ol start="4"><li>rtcsync</li></ol><p>å¯ç”¨å†…æ ¸æ—¶é—´ä¸ <code>RTC</code> æ—¶é—´åŒæ­¥ (è‡ªåŠ¨å†™å›ç¡¬ä»¶)ã€‚</p><ol start="5"><li>logdir</li></ol><p>è¯¥å‚æ•°ç”¨äºæŒ‡å®š <code>Chrony</code> æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„ã€‚</p><ol start="6"><li>stratumweight</li></ol><p>è¯¥å‚æ•°ç”¨äºè®¾ç½®å½“ <code>chronyd</code> ä»å¯ç”¨æºä¸­é€‰æ‹©åŒæ­¥æºæ—¶ï¼Œæ¯ä¸ªå±‚åº”è¯¥æ·»åŠ å¤šå°‘è·ç¦»åˆ°åŒæ­¥è·ç¦»ã€‚é»˜è®¤æƒ…å†µä¸‹è®¾ç½®ä¸º 0ï¼Œè®© <code>chronyd</code> åœ¨é€‰æ‹©æºæ—¶å¿½ç•¥æºçš„å±‚çº§ã€‚</p><p>åŸºæœ¬ä¸Šå¸¸ç”¨çš„å‚æ•°å°±åªæœ‰è¿™å‡ ä¸ªäº†ï¼Œé€šå¸¸é»˜è®¤çš„é…ç½®æ–‡ä»¶å°±å¯ä»¥ç›´æ¥ä½¿ç”¨äº†ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¿®æ”¹å®Œæˆåçš„é…ç½®æ–‡ä»¶å†…å®¹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿™é‡Œåªä¿®æ”¹äº† server ä¸­çš„ NTP æœåŠ¡å™¨åœ°å€ï¼Œå¦‚æœç½‘ç»œç¯å¢ƒè‰¯å¥½å¯ä»¥ä½¿ç”¨é»˜è®¤é…ç½®</span></span><br><span class="line">server ntp1.aliyun.com iburst</span><br><span class="line">server ntp2.aliyun.com iburst</span><br><span class="line"></span><br><span class="line">driftfile /var/lib/chrony/drift</span><br><span class="line">makestep 1.0 3</span><br><span class="line">rtcsync</span><br><span class="line">logdir /var/<span class="built_in">log</span>/chrony</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨-chrony-å®¢æˆ·ç«¯ç¨‹åºè¿›è¡Œç®¡ç†">ä½¿ç”¨ Chrony å®¢æˆ·ç«¯ç¨‹åºè¿›è¡Œç®¡ç†</h2><ol><li>æ£€æŸ¥ Chrony æ˜¯å¦å®é™…åŒæ­¥</li></ol><p>ä¸ºäº†æ£€æŸ¥ <code>Chrony</code> æ˜¯å¦å®é™…åŒæ­¥ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒçš„å‘½ä»¤è¡Œç¨‹åº <code>chronyc</code> æ¥éªŒè¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ chronyc tracking </span><br><span class="line"></span><br><span class="line">Reference ID    : 78197314 (120.25.115.20)</span><br><span class="line">Stratum         : 3</span><br><span class="line">Ref time (UTC)  : Fri Jun 28 13:58:17 2019</span><br><span class="line">System time     : 0.000042858 seconds slow of NTP time</span><br><span class="line">Last offset     : -0.000187823 seconds</span><br><span class="line">RMS offset      : 0.001029734 seconds</span><br><span class="line">Frequency       : 17.614 ppm slow</span><br><span class="line">Residual freq   : +0.008 ppm</span><br><span class="line">Skew            : 5.552 ppm</span><br><span class="line">Root delay      : 0.034440458 seconds</span><br><span class="line">Root dispersion : 0.002149768 seconds</span><br><span class="line">Update interval : 64.1 seconds</span><br><span class="line">Leap status     : Normal</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¸»è¦å…³æ³¨ <code>Update interval</code> è¿™ä¸ªå‚æ•°, è¯´æ˜æœ€åä¸¤æ¬¡æ›´æ–°çš„æ—¶é—´é—´éš”æ˜¯ <code>64.1s</code>ã€‚ä»¥ä¸Šç»“æœä¸­çš„å…¶å®ƒå‚æ•°çš„å«ä¹‰åˆ†åˆ«æ˜¯ï¼š</p><ul><li><p>å¼•ç”¨ <code>ID</code> - è®¡ç®—æœºå½“å‰åŒæ­¥çš„å¼•ç”¨ <code>ID</code> å’Œåç§°ã€‚</p></li><li><p><code>Stratum</code> - è¿æ¥å‚è€ƒæ—¶é’Ÿçš„è®¡ç®—æœºçš„è·³æ•°ã€‚</p></li><li><p>å‚è€ƒæ—¶é—´ - è¿™æ˜¯å‚è€ƒæºçš„æœ€åä¸€æ¬¡æµ‹é‡çš„ <code>UTC</code> æ—¶é—´ã€‚</p></li><li><p>ç³»ç»Ÿæ—¶é—´ - æ¥è‡ªåŒæ­¥æœåŠ¡å™¨çš„ç³»ç»Ÿæ—¶é’Ÿå»¶è¿Ÿã€‚</p></li><li><p>æœ€åä¸€æ¬¡åç§» - ä¸Šæ¬¡æ—¶é’Ÿæ›´æ–°çš„ä¼°è®¡åç§»é‡ã€‚</p></li><li><p><code>RMS</code> åç§» - åç§»å€¼çš„é•¿æœŸå¹³å‡å€¼ã€‚</p></li><li><p>é¢‘ç‡ - å¦‚æœ <code>chronyd</code> æ²¡æœ‰çº æ­£å®ƒï¼Œé‚£ä¹ˆç³»ç»Ÿçš„æ—¶é’Ÿé”™è¯¯çš„é€Ÿç‡ã€‚å®ƒä»¥ <code>ppm</code> ï¼ˆç™¾ä¸‡åˆ†ç‡ï¼‰æä¾›ã€‚</p></li><li><p>æ®‹ä½™é¢‘ç‡ - æ®‹ä½™é¢‘ç‡è¡¨ç¤ºå‚è€ƒæºçš„æµ‹é‡å€¼ä¸å½“å‰ä½¿ç”¨çš„é¢‘ç‡ä¹‹é—´çš„å·®å¼‚ã€‚</p></li><li><p>åæ–œ - ä¼°è®¡é¢‘ç‡çš„è¯¯å·®ç•Œé™ã€‚</p></li><li><p>æ ¹å»¶è¿Ÿ - ç½‘ç»œè·¯å¾„å»¶è¿Ÿåˆ°è®¡ç®—æœºæ­£åœ¨åŒæ­¥çš„å±‚è®¡ç®—æœºçš„æ€»å’Œã€‚</p></li><li><p>è·³è·ƒçŠ¶æ€ - è¿™æ˜¯è·³è·ƒçŠ¶æ€ï¼Œå¯ä»¥å…·æœ‰ä»¥ä¸‹å€¼ä¹‹ä¸€ï¼šæ­£å¸¸ã€æ’å…¥ç§’ã€åˆ é™¤ç§’æˆ–ä¸åŒæ­¥ã€‚</p></li></ul><ol start="2"><li>æ˜¾ç¤ºæ‰€æœ‰ NTP æºæœåŠ¡å™¨çš„ä¿¡æ¯</li></ol><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ç¬¬äºŒä¸ªå‚æ•°ï¼Œ<code>*</code> ä»£è¡¨å½“å‰åŒæ­¥çš„æºï¼Œ<code>-</code> ä»£è¡¨é€šè¿‡ç»„åˆç®—æ³•è®¡ç®—åæ’é™¤çš„æºã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ chronyc sources -v</span><br><span class="line"></span><br><span class="line">210 Number of sources = 2</span><br><span class="line"></span><br><span class="line">  .-- Source mode  <span class="string">'^'</span> = server, <span class="string">'='</span> = peer, <span class="string">'#'</span> = <span class="built_in">local</span> clock.</span><br><span class="line"> / .- Source state <span class="string">'*'</span> = current synced, <span class="string">'+'</span> = combined , <span class="string">'-'</span> = not combined,</span><br><span class="line">| /   <span class="string">'?'</span> = unreachable, <span class="string">'x'</span> = time may be <span class="keyword">in</span> error, <span class="string">'~'</span> = time too variable.</span><br><span class="line">||                                                 .- xxxx [ yyyy ] +/- zzzz</span><br><span class="line">||      Reachability register (octal) -.           |  xxxx = adjusted offset,</span><br><span class="line">||      Log2(Polling interval) --.      |          |  yyyy = measured offset,</span><br><span class="line">||                                \     |          |  zzzz = estimated error.</span><br><span class="line">||                                 |    |           \</span><br><span class="line">MS Name/IP address         Stratum Poll Reach LastRx Last sample</span><br><span class="line">===============================================================================</span><br><span class="line">^* 120.25.115.20                 2   6    37    12    +85us[ -960us] +/-   20ms</span><br><span class="line">^- 203.107.6.88                  2   6    37    12   +262us[ +262us] +/-   21ms</span><br></pre></td></tr></table></figure><ol start="3"><li>æŸ¥çœ‹ NTP æœåŠ¡å™¨çš„åœ¨çº¿å’Œç¦»çº¿çŠ¶æ€</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ chronyc activity</span><br></pre></td></tr></table></figure><ol start="4"><li>æŸ¥çœ‹ Chrony æœåŠ¡çš„æ—¥å¿—</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ journalctl -u chronyd</span><br></pre></td></tr></table></figure><ol start="5"><li>æ£€æŸ¥ NTP è®¿é—®æ˜¯å¦å¯¹ç‰¹å®šä¸»æœºå¯ç”¨</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ chronyc accheck</span><br></pre></td></tr></table></figure><ol start="6"><li>è¯¥å‘½ä»¤ä¼šæ˜¾ç¤ºæœ‰å¤šå°‘ NTP æºåœ¨çº¿/ç¦»çº¿</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ chronyc activity</span><br></pre></td></tr></table></figure><ol start="7"><li>æ‰‹åŠ¨æ·»åŠ ä¸€å°æ–°çš„ NTP æœåŠ¡å™¨</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ chronyc add server</span><br></pre></td></tr></table></figure><ol start="8"><li>åœ¨å®¢æˆ·ç«¯æŠ¥å‘Šå·²è®¿é—®åˆ°æœåŠ¡å™¨</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ chronyc clients</span><br></pre></td></tr></table></figure><ol start="9"><li>æ‰‹åŠ¨ç§»é™¤ NTP æœåŠ¡å™¨æˆ–å¯¹ç­‰æœåŠ¡å™¨</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ chronyc delete</span><br></pre></td></tr></table></figure><ol start="10"><li>æ‰‹åŠ¨è®¾ç½®å®ˆæŠ¤è¿›ç¨‹æ—¶é—´</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ chronyc settime</span><br></pre></td></tr></table></figure><ol start="11"><li>æ ¡å‡†æ—¶é—´æœåŠ¡å™¨ï¼Œæ˜¾ç¤ºç³»ç»Ÿæ—¶é—´ä¿¡æ¯</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ chronyc tracking</span><br></pre></td></tr></table></figure><ol start="12"><li>æ£€æŸ¥ NTP è®¿é—®æ˜¯å¦å¯¹ç‰¹å®šä¸»æœºå¯ç”¨</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ chronyc accheck</span><br></pre></td></tr></table></figure><ol start="13"><li>æŸ¥çœ‹æ—¶é—´åŒæ­¥æº</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ chronyc sources -v</span><br></pre></td></tr></table></figure><ol start="14"><li>æŸ¥çœ‹æ—¶é—´åŒæ­¥æºçŠ¶æ€</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ chronyc sourcestats -v</span><br></pre></td></tr></table></figure><p><code>Chrony</code> å®¢æˆ·ç«¯ç¨‹åºçš„åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œè¿œä¸æ­¢ä¸Šé¢ä»‹ç»è¿™äº›ã€‚ä¸ä½†æ”¯æŒå‘½ä»¤è¡Œæ¨¡å¼ï¼Œè€Œä¸”è¿˜æ”¯æŒäº¤äº’æ¨¡å¼ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤š <code>Chrony</code> å®¢æˆ·ç«¯ç¨‹åºçš„ä½¿ç”¨æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ <code>man  chronyc</code> å‘½ä»¤è·å–æ›´å¤šå¸®åŠ©ã€‚</p><h2 id="ä½¿ç”¨-chrony-ä½œä¸º-ntp-æœåŠ¡å™¨">ä½¿ç”¨ Chrony ä½œä¸º NTP æœåŠ¡å™¨</h2><p>è¦å°† <code>Chrony</code> ä½œä¸ºä¸€ä¸ª <code>NTP</code> æœåŠ¡å™¨ï¼Œæ–¹æ³•å¾ˆç®€å•ã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦ä¿®æ”¹ <code>/etc/chrony.conf</code> æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹é…ç½®å³å¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯¹äºå®‰å…¨è¦æ±‚æ¯”è¾ƒé«˜çš„ï¼Œè¿™é‡Œå¯ä»¥é™åˆ¶è°èƒ½è®¿é—®æœ¬æœºæä¾›çš„ NTP æœåŠ¡ã€‚</span></span><br><span class="line">allow 192.168.1.0/24</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½® chronyd ç›‘å¬åœ¨å“ªä¸ªç½‘ç»œæ¥å£</span></span><br><span class="line">bindcmdaddress 0.0.0.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™ä¸ªåœ°æ–¹å¾ˆé‡è¦ï¼Œå¦‚æœæœåŠ¡å™¨æœ¬èº«ä¹Ÿä¸èƒ½åŒæ­¥æ—¶é—´ï¼Œé‚£ä¹ˆå°±ç”¨æœ¬åœ°æ—¶é—´æ›¿ä»£ï¼Œå±‚çº§ä¸º 10</span></span><br><span class="line"><span class="built_in">local</span> stratum 10</span><br></pre></td></tr></table></figure><p>å…¶æ¬¡ï¼Œé‡å¯ <code>Chronyd</code> æœåŠ¡ï¼Œä»¥åŠ è½½æ–°çš„é…ç½®ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl restart chronyd</span><br></pre></td></tr></table></figure><p><code>Chronyd</code> æœåŠ¡å¯åŠ¨æˆåŠŸåï¼Œä¼šç›‘å¬ä»¥ä¸‹ä¸¤ä¸ªç«¯å£ã€‚</p><ul><li><p>ç«¯å£ <code>123/udp</code> ä¸ºæ ‡å‡†çš„ <code>NTP</code> ç›‘å¬ç«¯å£ï¼Œå¦‚æœè¦å¯¹å¤–æä¾› <code>NTP Server</code> åŠŸèƒ½ï¼Œå¿…é¡»å¼€å¯é˜²ç«å¢™å’Œç›‘å¬åœ°å€ä¸ºå¤–éƒ¨å¯è®¿é—®åœ°å€ã€‚å¦‚éœ€ä¿®æ”¹ï¼Œä½ å¯ä»¥é€šè¿‡é…ç½® <code>port</code> å‚æ•°æ¥ä¿®æ”¹ã€‚</p></li><li><p>ç«¯å£ <code>323/udp</code> ä¸ºé»˜è®¤çš„ç®¡ç†ç«¯å£ã€‚å¦‚éœ€ä¿®æ”¹ï¼Œä½ å¯ä»¥é€šè¿‡é…ç½® <code>cmdport</code> å‚æ•°æ¥ä¿®æ”¹ã€‚</p></li></ul><p>æœ€åï¼Œä¿®æ”¹é˜²ç«å¢™è®¾ç½®ï¼Œä»¥æ”¾è¡Œå¯¹ <code>123/udp</code> çš„è¯·æ±‚ï¼Œè¿™é‡Œä»¥ <code>CentOS 7</code> çš„ <code>Firewalld</code> ä¸ºä¾‹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ firewall-cmd --zone=public --add-port=123/udp --permanent</span><br><span class="line">$ firewall-cmd --reload</span><br></pre></td></tr></table></figure><h2 id="å»¶ä¼¸é˜…è¯»">å»¶ä¼¸é˜…è¯»</h2><h3 id="ä¸€äº›å¯ç”¨çš„å…¬å…±-ntp-æœåŠ¡">ä¸€äº›å¯ç”¨çš„å…¬å…± NTP æœåŠ¡</h3><p>å…¬å…± <code>NTP</code> æœåŠ¡ç½‘ä¸Šå¾ˆå¤šï¼Œä½†å›½å†…ç¯å¢ƒä¸‹æœ€å¥½ç”¨çš„åº”è¯¥è¿˜å±é˜¿é‡Œäº‘çš„å…¬ç½‘ <code>NTP</code> æœåŠ¡ã€‚</p><p><img src="https://i.loli.net/2019/10/31/TKhznvkqWb3ydxr.png" alt=""></p><h3 id="ä¸€äº›æ—¶é—´ç›¸å…³çš„æ¦‚å¿µä»‹ç»">ä¸€äº›æ—¶é—´ç›¸å…³çš„æ¦‚å¿µä»‹ç»</h3><ol><li>GMTã€UTCã€CSTã€DST æ—¶é—´</li></ol><ul><li><p><code>UTC</code> æ•´ä¸ªåœ°çƒåˆ†ä¸ºäºŒåå››æ—¶åŒºï¼Œæ¯ä¸ªæ—¶åŒºéƒ½æœ‰è‡ªå·±çš„æœ¬åœ°æ—¶é—´ã€‚åœ¨å›½é™…æ— çº¿ç”µé€šä¿¡åœºåˆï¼Œä¸ºäº†ç»Ÿä¸€èµ·è§ï¼Œä½¿ç”¨ä¸€ä¸ªç»Ÿä¸€çš„æ—¶é—´ï¼Œç§°ä¸ºé€šç”¨åè°ƒæ—¶ (<code>UTC, Universal Time Coordinated</code>)ã€‚</p></li><li><p><code>GMT</code> æ ¼æ—å¨æ²»æ ‡å‡†æ—¶é—´ (<code>Greenwich Mean Time</code>) æŒ‡ä½äºè‹±å›½ä¼¦æ•¦éƒŠåŒºçš„çš‡å®¶æ ¼æ—å°¼æ²»å¤©æ–‡å°çš„æ ‡å‡†æ—¶é—´ï¼Œå› ä¸ºæœ¬åˆå­åˆçº¿è¢«å®šä¹‰åœ¨é€šè¿‡é‚£é‡Œçš„ç»çº¿ã€‚( <code>UTC</code> ä¸ <code>GMT</code> æ—¶é—´åŸºæœ¬ç›¸åŒ)</p></li><li><p><code>CST</code> ä¸­å›½æ ‡å‡†æ—¶é—´ (<code>China Standard Time</code>)</p></li><li><p><code>GMT</code> + 8 = <code>UTC</code> + 8 = <code>CST</code></p></li><li><p><code>DST</code> å¤ä»¤æ—¶ (<code>Daylight Saving Time</code>) æŒ‡åœ¨å¤å¤©å¤ªé˜³å‡èµ·çš„æ¯”è¾ƒæ—©æ—¶ï¼Œå°†æ—¶é—´æ‹¨å¿«ä¸€å°æ—¶ï¼Œä»¥ææ—©æ—¥å…‰çš„ä½¿ç”¨ã€‚ï¼ˆä¸­å›½ä¸ä½¿ç”¨ï¼‰</p></li></ul><ol start="2"><li>ç¡¬ä»¶æ—¶é—´å’Œç³»ç»Ÿæ—¶é—´</li></ol><ul><li><p>ç¡¬ä»¶æ—¶é—´ï¼š<code>RTC (Real-Time Clock)</code> æˆ– <code>CMOS</code> æ—¶é—´ï¼Œä¸€èˆ¬åœ¨ä¸»æ¿ä¸Šé ç”µæ± ä¾›ç”µï¼ŒæœåŠ¡å™¨æ–­ç”µåä¹Ÿä¼šç»§ç»­è¿è¡Œã€‚ä»…ä¿å­˜æ—¥æœŸæ—¶é—´æ•°å€¼ï¼Œæ— æ³•ä¿å­˜æ—¶åŒºå’Œå¤ä»¤æ—¶è®¾ç½®ã€‚</p></li><li><p>ç³»ç»Ÿæ—¶é—´ï¼šä¸€èˆ¬åœ¨æœåŠ¡å™¨å¯åŠ¨æ—¶å¤åˆ¶ <code>RTC</code> æ—¶é—´ï¼Œä¹‹åç‹¬ç«‹è¿è¡Œï¼Œä¿å­˜äº†æ—¶é—´ã€æ—¶åŒºå’Œå¤ä»¤æ—¶è®¾ç½®ã€‚</p></li></ul><h3 id="ä¸€äº›è®¾ç½®æ—¶åŒºå’Œæ—¶é—´çš„å‘½ä»¤">ä¸€äº›è®¾ç½®æ—¶åŒºå’Œæ—¶é—´çš„å‘½ä»¤â€‹</h3><ol><li>æŸ¥çœ‹å½“å‰ç³»ç»Ÿæ—¶åŒº</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç›´æ¥ä½¿ç”¨ timedatectl å‘½ä»¤ä¹Ÿç­‰åŒäºä»¥ä¸‹å‘½ä»¤</span></span><br><span class="line">$ timedatectl status</span><br><span class="line">      Local time: Fri 2018-2-29 13:31:04 CST</span><br><span class="line">  Universal time: Fri 2018-2-29 05:31:04 UTC</span><br><span class="line">        RTC time: Fri 2018-2-29 08:17:20</span><br><span class="line">       Time zone: Asia/Shanghai (CST, +0800)</span><br><span class="line">     NTP enabled: yes</span><br><span class="line">NTP synchronized: yes</span><br><span class="line"> RTC <span class="keyword">in</span> <span class="built_in">local</span> TZ: no</span><br><span class="line">      DST active: n/a</span><br></pre></td></tr></table></figure><ol start="2"><li>è®¾ç½®å½“å‰ç³»ç»Ÿæ—¶åŒº</li></ol><p>å¦‚æœä½ å½“å‰çš„æ—¶åŒºä¸æ­£ç¡®ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ“ä½œè®¾ç½®ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„æ—¶åŒº</span></span><br><span class="line">$ timedatectl list-timezones</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ä¸Šæµ·å¯ç”¨æ—¶åŒº</span></span><br><span class="line">$ timedatectl list-timezones |  grep  -E <span class="string">"Asia/S.*"</span></span><br><span class="line">Asia/Sakhalin</span><br><span class="line">Asia/Samarkand</span><br><span class="line">Asia/Seoul</span><br><span class="line">Asia/Shanghai</span><br><span class="line">Asia/Singapore</span><br><span class="line">Asia/Srednekolymsk</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®å½“å‰ç³»ç»Ÿä¸º Asia/Shanghai ä¸Šæµ·æ—¶åŒº</span></span><br><span class="line">$ timedatectl <span class="built_in">set</span>-timezone Asia/Shanghai</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®å®Œæ—¶åŒºåï¼Œåœ¨å¼ºåˆ¶åŒæ­¥ä¸‹ç³»ç»Ÿæ—¶é’Ÿ</span></span><br><span class="line">$ chronyc -a makestep</span><br><span class="line">200 OK</span><br></pre></td></tr></table></figure><ol start="3"><li>æ˜¾ç¤ºç³»ç»Ÿçš„å½“å‰æ—¶é—´å’Œæ—¥æœŸ</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ timedatectl <span class="built_in">set</span>-time <span class="string">"YYYY-MM-DD HH:MM:SS"</span></span><br><span class="line">$ timedatectl <span class="built_in">set</span>-time <span class="string">"YYYY-MM-DD"</span></span><br><span class="line">$ timedatectl <span class="built_in">set</span>-time <span class="string">"HH:MM:SS"</span></span><br></pre></td></tr></table></figure><ol start="4"><li>ä¿®æ”¹å½“å‰æ—¥æœŸæ—¶é—´</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯ä»¥åªä¿®æ”¹å…¶ä¸­ä¸€ä¸ª</span></span><br><span class="line">$ timedatectl <span class="built_in">set</span>-time <span class="string">"2019-10-31 15:50:00"</span></span><br></pre></td></tr></table></figure><ol start="5"><li>è®¾ç½®ç¡¬ä»¶æ—¶é—´</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¡¬ä»¶æ—¶é—´é»˜è®¤ä¸º UTCï¼Œä¸‹é¢ä¸¤æ¡å‘½ä»¤æ•ˆæœç­‰åŒ</span></span><br><span class="line">$ timedatectl <span class="built_in">set</span>-local-rtc 1</span><br><span class="line">$ hwclock --systohc --localtime</span><br></pre></td></tr></table></figure><ol start="6"><li>å¯ç”¨æˆ–è€…ç¦æ­¢ NTP æ—¶é—´åŒæ­¥</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># yes æˆ– noï¼Œ1 æˆ– 0 ä¹Ÿå¯ä»¥</span></span><br><span class="line">$ timedatectl <span class="built_in">set</span>-ntp yes/no</span><br><span class="line">$ timedatectl <span class="built_in">set</span>-ntp <span class="literal">true</span>/flase</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2><ol><li><p><a href="http://www.google.com" target="_blank" rel="noopener">http://www.google.com</a></p></li><li><p><a href="https://url.cn/5RYX5Ob" target="_blank" rel="noopener">https://url.cn/5RYX5Ob</a></p></li><li><p><a href="https://chegva.com/3265.html" target="_blank" rel="noopener">https://chegva.com/3265.html</a></p></li><li><p><a href="https://blog.gnuers.org/?p=1483" target="_blank" rel="noopener">https://blog.gnuers.org/?p=1483</a></p></li><li><p><a href="https://yq.aliyun.com/articles/503151" target="_blank" rel="noopener">https://yq.aliyun.com/articles/503151</a></p></li><li><p><a href="http://tswblog.com/article/linux/chrony/" target="_blank" rel="noopener">http://tswblog.com/article/linux/chrony/</a></p></li><li><p><a href="https://www.cnblogs.com/cloudos/p/NTP.html" target="_blank" rel="noopener">https://www.cnblogs.com/cloudos/p/NTP.html</a></p></li><li><p><a href="https://www.itsfun.tk/better-ntp-server-chrony/" target="_blank" rel="noopener">https://www.itsfun.tk/better-ntp-server-chrony/</a></p></li><li><p><a href="https://www.mnstory.net/2018/12/09/chrony-ntp-date-sync/" target="_blank" rel="noopener">https://www.mnstory.net/2018/12/09/chrony-ntp-date-sync/</a></p></li><li><p><a href="https://www.howtoing.com/install-chrony-in-centos-ubuntu-linux" target="_blank" rel="noopener">https://www.howtoing.com/install-chrony-in-centos-ubuntu-linux</a></p></li></ol></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;Chrony&lt;/code&gt; æ˜¯ä¸€ä¸ªå¤šåŠŸèƒ½çš„ &lt;code&gt;NTP (Network Time Protocol)&lt;/code&gt; å®ç°ï¼Œç±» &lt;code&gt;Unix&lt;/code&gt; ç³»ç»Ÿä¸Š &lt;code&gt;NTP&lt;/code&gt; å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„æ›¿ä»£å“ã€‚å®ƒå¯ä»¥é€šè¿‡ &lt;code&gt;NTP&lt;/code&gt; æœåŠ¡æˆ–è€…ç±»ä¼¼ &lt;code&gt;GPS&lt;/code&gt; æ—¶é’Ÿæ¥æ”¶å™¨çš„ç¡¬ä»¶çº§å‚è€ƒæ—¶é’Ÿæ¥åŒæ­¥ç³»ç»Ÿæ—¶é’Ÿï¼Œå…·æœ‰æ›´å¥½çš„æ—¶é’Ÿå‡†ç¡®åº¦ï¼Œå¹¶ä¸”å¯¹äºé‚£äº›é—´æ­‡æ€§äº’è”ç½‘è¿æ¥çš„ç³»ç»Ÿå¾ˆæœ‰å¸®åŠ©ã€‚&lt;code&gt;Chrony&lt;/code&gt; æ˜¯å…è´¹å¼€æºçš„ï¼Œå¹¶ä¸”æ”¯æŒ &lt;code&gt;GNU/Linux&lt;/code&gt; å’Œ &lt;code&gt;BSD&lt;/code&gt; è¡ç”Ÿç‰ˆï¼ˆæ¯”å¦‚ï¼š&lt;code&gt;FreeBSD&lt;/code&gt;ã€&lt;code&gt;NetBSD&lt;/code&gt;ï¼‰ã€&lt;code&gt;macOS&lt;/code&gt; å’Œ &lt;code&gt;Solaris&lt;/code&gt; ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Chrony&lt;/code&gt; æœ‰ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼šä¸€ä¸ªæ˜¯ &lt;code&gt;chronyd&lt;/code&gt; å®ˆæŠ¤è¿›ç¨‹ï¼Œä¸»è¦ç”¨äºè°ƒæ•´å†…æ ¸ä¸­è¿è¡Œçš„ç³»ç»Ÿæ—¶é—´å’Œæ—¶é—´æœåŠ¡å™¨åŒæ­¥ã€‚å®ƒç¡®å®šè®¡ç®—æœºå¢å‡æ—¶é—´çš„æ¯”ç‡ï¼Œå¹¶å¯¹æ­¤è¿›è¡Œè°ƒæ•´è¡¥å¿ã€‚å¦ä¸€ä¸ªæ˜¯ &lt;code&gt;chronyc&lt;/code&gt;ï¼Œå®ƒæä¾›ä¸€ä¸ªç”¨æˆ·ç•Œé¢ï¼Œç”¨äºç›‘æ§æ€§èƒ½å¹¶è¿›è¡Œå¤šæ ·åŒ–çš„é…ç½®ã€‚&lt;code&gt;chronyc&lt;/code&gt; å¯ä»¥åœ¨ &lt;code&gt;chronyd&lt;/code&gt; å®ä¾‹æ§åˆ¶çš„è®¡ç®—æœºä¸Šå·¥ä½œï¼Œä¹Ÿå¯ä»¥åœ¨ä¸€å°ä¸åŒçš„è¿œç¨‹è®¡ç®—æœºä¸Šå·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Chrony å’Œ NTPD ç²¾åº¦å¯¹æ¯”æµ‹è¯•&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä» &lt;code&gt;Chrony&lt;/code&gt; çš„å®˜æ–¹ç½‘ç«™ä¸Šå¯ä»¥çœ‹åˆ°ä¸ &lt;code&gt;NTPD&lt;/code&gt; å„ç»´åº¦è¯¦ç»†å¯¹æ¯”ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.hi-linux.com/img/linux/chrony-1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;ä»å…¶æµ‹è¯•ç»“æœä¸Šçœ‹ä¼¼ä¹æ˜¯å„ç»´åº¦æ€§èƒ½éƒ½å¯ä»¥åŠæ‰“ &lt;code&gt;NTPD&lt;/code&gt;ã€‚å› æ­¤ &lt;code&gt;Chrony&lt;/code&gt; å¯¹è‡ªèº«çš„æ•´ä½“è¯„ä»·è¿˜æ˜¯æ¯”è¾ƒé«˜çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Chrony ç›¸è¾ƒäº NTPD æœåŠ¡çš„ä¼˜åŠ¿&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æ›´å¿«çš„åŒæ­¥åªéœ€è¦æ•°åˆ†é’Ÿè€Œéæ•°å°æ—¶æ—¶é—´ï¼Œä»è€Œæœ€å¤§ç¨‹åº¦çš„å‡å°‘æ—¶é—´å’Œé¢‘ç‡è¯¯å·®ï¼Œè¿™å¯¹äºå¹¶éå…¨å¤©è¿è¡Œçš„å°å¼è®¡ç®—æœºæˆ–ç³»ç»Ÿè€Œè¨€éå¸¸æœ‰ç”¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;èƒ½å¤Ÿæ›´å¥½çš„å“åº”æ—¶é—´é¢‘ç‡çš„å¿«é€Ÿå˜åŒ–ï¼Œè¿™å¯¹äºå…·å¤‡ä¸ç¨³å®šæ—¶é’Ÿçš„è™šæ‹Ÿæœºæˆ–å¯¼è‡´æ—¶é’Ÿé¢‘ç‡åå¤å˜åŒ–çš„èŠ‚èƒ½æŠ€æœ¯è€Œè¨€éå¸¸æœ‰ç”¨ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨åˆå§‹åŒæ­¥åï¼Œå®ƒå¹¶ä¸ä¼šåœæ­¢æ—¶é’Ÿï¼Œä»¥é˜²å¯¹éœ€è¦ç³»ç»Ÿæ—¶é—´ä¿æŒå•è°ƒçš„ç¨‹åºé€ æˆå½±å“ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨åº”å¯¹ä¸´æ—¶éå¯¹ç§°å»¶è¿Ÿæ—¶ï¼Œï¼ˆä¾‹å¦‚ï¼šå¤§è§„æ¨¡ä¸‹è½½é€ æˆè¿æ¥é¥±å’Œæ—¶ï¼‰æä¾›äº†æ›´å¥½çš„ç¨³å®šæ€§ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ— éœ€å¯¹æœåŠ¡å™¨è¿›è¡Œå®šæœŸè½®è¯¢ï¼Œå› æ­¤å…·å¤‡é—´æ­‡æ€§ç½‘ç»œè¿æ¥çš„ç³»ç»Ÿä»ç„¶å¯ä»¥å¿«é€ŸåŒæ­¥æ—¶é’Ÿã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/categories/Linux/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="æŠ€å·§" scheme="https://www.hi-linux.com/tags/%E6%8A%80%E5%B7%A7/"/>
    
      <category term="NTP" scheme="https://www.hi-linux.com/tags/NTP/"/>
    
  </entry>
  
  <entry>
    <title>çœ‹ä¸šç•Œå¤§ç¥æ˜¯å¦‚ä½•è¿›è¡Œç‹¬ç«‹æ€è€ƒçš„ï¼åšä¸ºæŠ€æœ¯äººï¼Œä½ å…·å¤‡è¿™æ ·çš„èƒ½åŠ›å—ï¼Ÿ</title>
    <link href="https://www.hi-linux.com/posts/34120.html"/>
    <id>https://www.hi-linux.com/posts/34120.html</id>
    <published>2020-05-06T01:00:00.000Z</published>
    <updated>2020-05-06T04:39:24.993Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><p>è¿™æ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„ä¸–ç•Œï¼Œè¿™ä¸ªä¸–ç•Œä¸Šæœ‰å¾ˆå¤šå„å¼å„æ ·çš„è§‚ç‚¹å’Œæ€ç»´æ–¹å¼ï¼Œä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜çš„æˆ‘ï¼Œä¹Ÿä¼šæœ‰ç¨‹åºå‘˜çš„æ€ç»´æ–¹å¼ï¼Œç¨‹åºå‘˜çš„æ€ç»´æ–¹å¼æ›´æ¥è¿‘æ•°å­¦çš„æ€ç»´æ–¹å¼ï¼Œæ•°å­¦çš„æ€ç»´æ–¹å¼è®©å¯ä»¥å¾ˆå®¹æ˜“åœ°ç†æ¸…æ¥šè¿™ä¸ªæ··ä¹±çš„ä¸–ç•Œï¼Œå…¶å®ï¼Œå¹¶ä¸éœ€è¦å¤ªå¤æ‚çš„æ•°å­¦é€»è¾‘ï¼Œåªéœ€è¦ä½¿ç”¨ä¸€äº›ç®€å•çš„æ•°å­¦æ–¹æ³•ï¼Œå°±å¯ä»¥å¤§å¹…æå‡è‡ªå·±çš„è®¤è¯†èƒ½åŠ›ï¼Œæ‰€ä»¥ï¼Œåœ¨è¿™é‡Œï¼Œè®°å½•ä¸€ç¯‡æˆ‘è‡ªå·±çš„æ€ç»´æ–¹å¼ï¼Œä¸€æ–¹é¢ç»™å¤§å®¶åšä¸ªå‚è€ƒï¼Œå¦ä¸€æ–¹é¢ä¹Ÿä¾›æ›´é«˜é˜¶çš„äººç»™æˆ‘è¿›è¡ŒæŒ‡æ­£ã€‚ç®—æ˜¯ â€œå¼€æºæˆ‘çš„æ€ç»´æ–¹å¼â€ï¼Œå¼€æ”¾ä¸ä»…ä»…æ˜¯ä¸ºäº†è¾“å‡ºï¼Œæ›´æ˜¯ä¸ºäº†çœ‹çœ‹æœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹å¼ã€‚</p><p>æˆ‘çš„æ€ç»´æ–¹å¼ä¸­ï¼Œä½¿ç”¨æ•°å­¦é€»è¾‘çš„æ–¹å¼è¿›è¡Œæ€è€ƒï¼Œé€šå¸¸æ¥è¯´ï¼Œæˆ‘ä¼šä½¿ç”¨äº”æ­¥æ€è€ƒçš„æ–¹å¼ï¼š</p><h3 id="ç¬¬ä¸€æ­¥ä¿¡æ¯æ•°æ®å¯è€ƒè¯">ç¬¬ä¸€æ­¥ï¼šä¿¡æ¯æ•°æ®å¯è€ƒè¯</h3><p>å¦‚æœä¸€ä¸ªè§‚ç‚¹æˆ–æ˜¯ä¸€ä¸ªè§è§£çš„æ•°æ®æ˜¯é”™è¯¯çš„ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆåé¢çš„è§‚ç‚¹å…¨æ˜¯é”™çš„ï¼Œæ‰€ä»¥ï¼Œé¦–è¦çš„æ˜¯è¦è¿›è¡Œæ•°æ®çš„æŸ¥è¯æˆ–è€ƒè¯ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœä¸€ç¯‡æ–‡ç« çš„ä½œè€…è¶³å¤Ÿä¸¥è°¨çš„è¯ï¼Œä»–çš„éœ€è¦ç»™ä»–çš„æ•°æ®å»ºç«‹ç›¸å…³çš„å¼•ç”¨æˆ–æ˜¯å¯ä»¥è€ƒè¯çš„æ–¹æ³•æ–¹å¼ã€‚å¦‚æœä¸€ç¯‡æ–‡ç« ä¸­å‡ºç°çš„æ˜¯ï¼Œâ€œæœ‰å…³ä¸“å®¶è¡¨æ˜â€ã€â€œç¾å›½ç§‘å­¦å®¶è¯æ˜â€ã€â€œç»æµå­¦å®¶æŒ‡å‡ºâ€ï¼Œä½†æ˜¯æ²¡æœ‰ä»»å‡ºå¤„ï¼Œä¹Ÿæ²¡æœ‰ç‚¹æ˜è¿™ä¸ªä¸“å®¶æˆ–æ˜¯ç§‘å­¦å®¶çš„åå­—ï¼Œæˆ–æ˜¯ï¼Œä¹Ÿæ²¡æœ‰è¯´æ˜æˆ–å¼•ç”¨è®©è¯»è€…å¯ä»¥è‡ªå·±å»éªŒè¯çš„æ–¹æ³•ã€‚é‚£ä¹ˆï¼Œå…¶å¼•ç”¨çš„è¯æˆ–æ˜¯æ•°æ®æ˜¯æ— æ³•è€ƒè¯çš„ï¼Œå¦‚æœæ˜¯æ— æ³•è€ƒè¯çš„ï¼Œé‚£ä¹ˆï¼Œè¿™ç¯‡æ–‡ç« çš„æ°´ä»½å°±éå¸¸å¤§äº†ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå½“æˆ‘è¯»åˆ°ä¸€ç¯‡æ–‡ç« ä¸­çš„ä¸œè¥¿æ²¡æœ‰å¯è€ƒè¯çš„æ¥æºæˆ–æ˜¯æ–¹æ³•æ—¶ï¼Œé€šå¸¸æ¥è¯´ï¼Œæˆ‘å°±ä¸ä¼šå†è¯»äº†ï¼Œå› ä¸ºè¿™ç¯‡æ–‡ç« çš„ä»·å€¼å·²ç»ä¸å¤§äº†ï¼Œå¦‚æœæˆ‘å…³å¿ƒè¿™ç¯‡æ–‡ç« ä¸­çš„ä¸œè¥¿ï¼Œæˆ‘ä¼šæ”¹ä¸ºè‡ªå·±å»æŸ¥æ‰¾çš„æ–¹å¼ï¼Œè™½ç„¶å˜â€œé‡â€äº†ï¼Œä½†æ˜¯å¾ˆå®‰å…¨ã€‚ï¼ˆæ‰€ä»¥ï¼Œåƒ Wikipedia è¿™æ ·çš„ç½‘ç«™æ˜¯æˆ‘ç»å¸¸å»è·å¾—ä¿¡æ¯çš„åœ°æ–¹ï¼Œå› ä¸ºä¿¡æ¯å¯ä»¥è¢«è€ƒè¯æ˜¯å…¶åŸºæœ¬ä»·å€¼è§‚ï¼‰</p><h3 id="ç¬¬äºŒæ­¥å¤„ç†é›†åˆå’Œå…¶åŒ…å«å…³ç³»">ç¬¬äºŒæ­¥ï¼šå¤„ç†é›†åˆå’Œå…¶åŒ…å«å…³ç³»</h3><p>è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„äººäººéƒ½ä¼šçš„æ•°å­¦é€»è¾‘ã€‚æ¯”å¦‚ï¼šå“²å­¦å®¶æ˜¯äººï¼ŒæŸæ‹‰å›¾æ˜¯å“²å­¦å®¶ï¼Œæ‰€ä»¥ï¼ŒæŸæ‹‰å›¾æ˜¯äººã€‚å°±æ˜¯ä¸€ä¸ªåœ¨åŒ…å«å…³ç³»ä¸‹çš„æ¨ç†ã€‚ä½ ä¸è¦å°çœ‹è¿™ä¸ªç®€å•çš„é€»è¾‘ï¼Œå…¶å®å¾ˆå¤šäººå¹¶ä¸ä¼šå¾ˆå¥½çš„åº”ç”¨ï¼Œç›¸åï¼Œå½“æ„Ÿæƒ…æ”¯é…äº†ä»–ä»¬ä»¥åï¼Œä»–ä»¬ä¼šä»¥ç‚¹ä»£é¢ï¼Œä»¥ç‰¹ä¾‹ä»£æ›¿æ™®éæ€§ã€‚æ¯”å¦‚ï¼Œåœ°å›¾ç‚®å°±æ˜¯ä¸€ç§ï¼Œä»–ä»¬çœ‹åˆ°äº†å¤šä¸ªæ¡ˆä¾‹ï¼Œä»–ä»¬å°±å¼€å§‹æŠŠè¿™ä¸ªæ¡ˆä¾‹ä¸Šå‡ä¸Šæ›´å¤§çš„èŒƒå›´ï¼Œæ¯”å¦‚ï¼šæ²³å—äººæ–°ç–†äººéƒ½æ˜¯å°å·ï¼Œä¸Šæµ·äººéƒ½æ˜¯å°å¸‚æ°‘ã€‚æ—¥æœ¬äººéƒ½æ˜¯å˜æ€å’Œåäººç±»â€¦â€¦ç­‰ç­‰ã€‚é™¤äº†è¿™äº›åœ°å›¾ç‚®å¤–ï¼Œè¿˜æœ‰å¦å®šæ•´ä¸ªäººçš„ï¼Œæ¯”å¦‚ä¸€ä¸ªäººçŠ¯äº†ä¸ªé”™æˆ–æ˜¯æ€§æ ¼ä¸Šæœ‰ç¼ºé™·ï¼Œå°±ä¼šæŠŠæ•´ä¸ªäººå…¨ç›˜å¦å®šæ‰ï¼Œå‘˜å·¥æŠ¢ä¸ªæœˆé¥¼å°±ä¸Šå‡åˆ°å…¶ä»·å€¼è§‚æœ‰é—®é¢˜â€¦â€¦ã€‚åœ¨æ•°å­¦çš„é€»è¾‘åŒ…å«ä¸­ï¼Œè¶…é›†çš„å®šä¹‰å¯ä»¥é€‚ç”¨äºå­é›†ï¼Œé€šè¿‡å­é›†çš„ç‰¹å¾å¯ä»¥å¯¹è¶…é›†è¿›è¡Œæ¢ç´¢ï¼Œä½†æ˜¯æ²¡æ³•å®šä¹‰è¶…é›†ã€‚å¦å¤–ï¼Œé›†åˆçš„å¤§å°ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„äº‹ï¼Œ<a href="https://zh.wikipedia.org/wiki/%E5%80%96%E5%AD%98%E8%80%85%E5%81%8F%E5%B7%AE" target="_blank" rel="noopener">å¹¸å­˜è€…åå·®</a>ä¼šæ˜¯ä¸€ä¸ªå¾ˆå®¹æ˜“è®©äººæ‰ä¸‹å»çš„é™·é˜±ï¼Œå› ä¸ºå¯èƒ½ä¼šæœ‰å¾ˆå¤§çš„æ ·æœ¬é›†å¯èƒ½åœ¨ä½ çš„è§†çº¿ç›²åŒºã€‚</p><a id="more"></a><h3 id="ç¬¬ä¸‰æ­¥å¤„ç†é€»è¾‘å› æœå…³ç³»">ç¬¬ä¸‰æ­¥ï¼šå¤„ç†é€»è¾‘å› æœå…³ç³»</h3><p>æ‰€è°“å› æœå…³ç³»ï¼Œå…¶å®å°±æ˜¯åˆ†è¾¨å……åˆ†æ¡ä»¶ã€å¿…è¦æ¡ä»¶å’Œå……åˆ†å¿…è¦æ¡ä»¶ï¼Œç„¶åå¤„ç†å…¶ä¸­çš„é€»è¾‘æ˜¯å¦æœ‰å…³è”æ€§ï¼Œè€Œä¸”æœ‰éå¸¸å¼ºçš„å› æœå…³ç³»ã€‚æ²¡æœ‰èƒ½åŠ›åˆ†è¾¨å……åˆ†å¿…è¦æ¡ä»¶å¤„ç†å› æœå…³ç³»æ˜¯å¾ˆå¤šäººçš„ç¡¬ä¼¤ã€‚å°±åƒæˆ‘åœ¨ã€Š<a href="https://coolshell.cn/articles/19271.html" target="_blank" rel="noopener">åŠªåŠ›å°±ä¼šæˆåŠŸ</a>ã€‹ä¸­è¯´çš„ä¸€æ ·ï¼Œâ€œåŠªåŠ›â€ å’Œ â€œæˆåŠŸâ€æ˜¯å¦æœ‰å› æœå…³ç³»ï¼Ÿå„ç§é€»è¾‘æ··æ·†ã€æ¦‚å¿µå·æ¢ã€æ¨¡ç³Šå› æœã€ä¼¼æ˜¯è€Œéå…¨æ˜¯åœ¨è¿™é‡Œã€‚æ¯”å¦‚ï¼šæ©è€³ç›—é“ƒã€åˆ»èˆŸæ±‚å‰‘å°±æ˜¯å› æœå…³ç³»æ··ä¹±çš„è¡¨ç°ã€‚äººä»¬ä¼šç»å¸¸åœ°æ··æ·†ä¸¤ä¸ªçœ‹æ¥ä¸€èµ·å‘ç”Ÿï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å…³è”åœ¨ä¸€èµ·çš„äº‹ã€‚å› æœå…³ç³»æ˜¯æœ€å®¹æ˜“è¢«æ¨¡ç³Šå’Œå·æ¢çš„ï¼Œæ¯”å¦‚ï¼šå¾ˆå¤šäººéƒ½å®¹æ˜“æ··æ·†â€œåŠ ç­â€å°±ä¼šæœ‰â€œäº§å‡ºâ€ï¼Œæ··æ·†äº†â€œè¡ŒåŠ¨â€å°±ä¼šæœ‰â€œç»“æœâ€ï¼Œæ··æ·†äº†â€œæŠµåˆ¶â€å°±ä¼šèµ¢å¾—â€œå°Šé‡â€ï¼Œæ··æ·†äº†â€œæ‰¹è¯„â€ç­‰äºâ€œåå¯¹â€â€¦â€¦ç­‰ç­‰ã€‚é™¤äº†è¿™äº›ä»¥å¤–ï¼Œå¾®ä¿¡å…¬ä¼—å·é‡Œçš„å¾ˆå¤šæ—¶è¯„æ–‡ç« ï¼Œä»–ä»¬çš„æ–‡ç« ä¸­çš„ç»“è®ºå’Œå…¶è®ºæ®æ˜¯æ²¡æœ‰å› æœå…³ç³»çš„ï¼Œå¥½å¤šæ–‡ç« å°±æ˜¯æ··æ·†ã€æ¨¡ç³Šã€å·æ¢â€¦â€¦<strong>å› æœå…³ç³»å‡ºé—®é¢˜çš„æ–‡ç« è¯»å¤šäº†æ˜¯å¯¹å¤§è„‘æœ‰æŸä¼¤çš„ï¼Œè¦å°½é‡è¿œç¦»ã€‚</strong></p><h3 id="ç¬¬å››æ­¥æ‰¾åˆ°é è°±çš„åŸºå‡†çº¿">ç¬¬å››æ­¥ï¼šæ‰¾åˆ°é è°±çš„åŸºå‡†çº¿</h3><p>å°±åƒæˆ‘ä»¬å†™ä»£ç ä¸€æ ·ï¼Œæˆ‘ä»¬éƒ½æ˜¯ä¼šå»æ‰¾ä¸€äº›æœ€ä½³å®è·µæˆ–æ˜¯ä¸šå†…æ ‡å‡†ï¼ŒåŸå› æ˜¯å› ä¸ºï¼Œè¿™æ ·çš„ä¸œè¥¿éƒ½æ˜¯ç»è¿‡é•¿æ—¶é—´è¢«è¿™ä¸ªä¸–ç•Œä¸Šå¾ˆå¤šäºº Review è¿‡çš„ï¼Œæ˜¯å€¼å¾—ä¾èµ–å’Œé è°±çš„ï¼Œä»–ä»¬ä¼šè€ƒè™‘åˆ°å¾ˆå¤šä½ æ²¡æœ‰è€ƒè™‘è¿‡çš„é—®é¢˜ã€‚æ‰€ä»¥ï¼Œä½ ä¹Ÿä¼šçœ‹åˆ°å¾ˆå¤šæ—¶è¯„éƒ½ä¼šæ‰¾æ¬§ç¾å‘è¾¾å›½å®¶çš„ä½œå‚è€ƒçš„åšæ³•ï¼Œå› ä¸ºæ¯•ç«Ÿäººå®¶çš„æ–‡åŒ–æ˜¯ç›¸å¯¹æ¯”è¾ƒæ–‡æ˜ã€ç§‘å­¦ã€å¼€æ”¾å’Œå…ˆè¿›çš„ã€‚æ‰¾åˆ°ä¸–ç•Œæˆ–æ˜¯å›½é™…çš„é€šè¡Œæ ‡å‡†ï¼Œä¼šæ›´å®¹æ˜“è®©äººè¿›æ­¥ã€‚æ¯”å¦‚ï¼šä»¥å¼€æ”¾åŒ…å®¹åŠ å¼ºæ²Ÿé€šçš„å¿ƒæ€ï¼Œå°±ä¼šæ¯”å°é—­æŠµåˆ¶æ•Œå¯¹çš„å¿ƒæ€è¦å¥½å¾—å¤šå¾—å¤šï¼Œæ™ºè€…å»ºæ¡¥ï¼Œæ„šè€…å»ºå¢™ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¼€å§‹å‘ç°ï¼Œæœ‰ä¸€äº›äº‹ä¸Šï¼Œæœ‰åˆ©äºè‡ªå·±çš„å°±å¯¹æ ‡ï¼Œä¸åˆ©äºè‡ªå·±çš„å°±ä¸å¯¹æ ‡ï¼Œè€Œä¸”ï¼Œé™¤äº†å¥½çš„äº‹ï¼Œä¸å¥½çš„äº‹ä¹Ÿåœ¨æ‰¾æ¬§ç¾ä½œå¯¹æ ‡ï¼Œäºæ˜¯å¼€å§‹ â€œå¤šåŸºå‡†çº¿â€ å’Œ â€œä¹±åŸºå‡†çº¿â€ï¼Œè¿™ç§æ–¹å¼éœ€è¦æˆ‘ä»¬å°å¿ƒåˆ†è¾¨ã€‚</p><h3 id="ç¬¬äº”æ­¥æ›´ä¸ºæ·±å…¥å’Œé«˜ç»´çš„æ€è€ƒ">ç¬¬äº”æ­¥ï¼šæ›´ä¸ºæ·±å…¥å’Œé«˜ç»´çš„æ€è€ƒ</h3><p>å¦‚æœä¸€ä»¶äº‹æƒ…åªåœ¨è¡¨é¢ä¸Šè¿›è¡Œæ€è€ƒå…¶å®åªæ˜¯ä¸€ç§æµ…åº¦æ€è€ƒï¼Œåœ¨ Amazonï¼Œçº¿ä¸Šç³»ç»Ÿå‡ºç°æ•…éšœçš„æ—¶å€™ï¼Œéœ€è¦å†™ä¸€ä¸ª Correction of Errors çš„æŠ¥å‘Šï¼Œå…¶ä¸­éœ€è¦Ask 5 Whysï¼ˆå‚çœ‹ Wikipedia çš„ <a href="https://en.wikipedia.org/wiki/Five_whys" target="_blank" rel="noopener">Five Whys è¯æ¡</a>ï¼‰ï¼Œè¿™ç§æ€è€ƒæ–¹å¼å¯ä»¥è®©ä½ ä¸æ–­è¿½é—®åˆ°æ·±å±‚æ¬¡çš„æœ¬è´¨é—®é¢˜ï¼Œä¼šè®©ä½ è‡ªå·±åšå¤§é‡çš„è°ƒæŸ¥å’Œç ”ç©¶ï¼Œè®©ä½ ä¸ä¼šæˆä¸ºä¸€ä¸ªåªä¼šåœ¨è¡¨é¢ä¸Šè¿›è¡Œæ€è€ƒçš„ç®€å•åŠ¨ç‰©ã€‚æ¯”å¦‚ï¼šå½“ä½ çœ‹åˆ°æœ‰å‡ºä¹ä½ æ„æ–™çš„äº‹ä»¶å‘ç”Ÿæ—¶ï¼ˆæ¯”å¦‚è´Ÿé¢çš„æš´åŠ›äº‹ä»¶ï¼‰ï¼Œä½ éœ€è¦é—®ä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆä¼šå‘ç”Ÿï¼ŒåŸå› æ˜¯ä»€ä¹ˆï¼Ÿç„¶åç½—åˆ—å°½å¯èƒ½å…¨çš„åŸå› ï¼Œå†ä¸æ–­åœ°è¿½é—®å¹¶æ‹·è¯ä¸‹å»ï¼ˆè¿™è·Ÿå†™ç¨‹åºä¸€æ ·ï¼Œéœ€è¦ä»æ­£å‘æ¡ˆä¾‹å’Œè´Ÿå‘æ¡ˆä¾‹è¿›è¡Œè€ƒè™‘åˆ†æï¼Œæ‰å¯èƒ½å†™å‡ºå¥å£®æ€§å¾ˆå¼ºçš„ä»£ç ï¼‰ï¼Œæˆ‘ä»¬æ‰ä¼šå¾—å‡ºä¸€ä¸ªæ¯”è¾ƒå¥å£®çš„ç­”æ¡ˆæˆ–ç»“æ„ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä¸Šè¿°çš„è¿™äº”ç§æ€ç»´æ–¹å¼ä¸‹ï¼Œä½ çš„æ€è€ƒæ˜¯ä¸å¯èƒ½å¿«å¾—èµ·æ¥çš„ï¼Œè¿™æ˜¯ä¸€ä¸ª â€œæ…¢æ€è€ƒâ€ï¼ˆæ³¨ï¼šå¦‚æœè¯»è¿‡ã€Š<a href="https://book.douban.com/subject/10785583/" target="_blank" rel="noopener">æ€è€ƒï¼Œå¿«ä¸æ…¢</a>ã€‹è¿™æœ¬ä¹¦çš„äººå°±çŸ¥é“æˆ‘åœ¨è¯´ä»€ä¹ˆï¼‰ï¼Œç‹¬ç«‹æ€è€ƒæ˜¯éœ€è¦ä½¿ç”¨å¤§è„‘ä¸­çš„â€œæ…¢ç³»ç»Ÿâ€ï¼Œæ…¢ç³»ç»Ÿæ˜¯åäººæ€§çš„ï¼Œæ‰€ä»¥ï¼Œèƒ½çœŸæ­£åšåˆ°ç‹¬ç«‹æ€è€ƒçš„äººå¾ˆå°‘ã€‚æ›´å¤šçš„äººçš„â€œç‹¬ç«‹æ€è€ƒâ€å…¶å®åªä¸è¿‡æ˜¯æ¯«æ— ç« æ³•çš„ä¹±æ€è€ƒç½¢äº†ã€‚</p><p>é€šè¿‡ä¸Šè¿°çš„è¿™äº”ç‚¹ï¼Œæˆ‘ç›¸ä¿¡ä½ æ˜¯å¾ˆå®¹æ˜“è¯†åˆ«æˆ–æ˜¯åˆ†è¾¨å‡ºå“ªäº›ä¿¡æ¯æ˜¯é è°±çš„ï¼Œå“ªäº›ä¿¡æ¯æ˜¯å¾ˆæ‰¯çš„ï¼Œç”šè‡³ä¼šæ”¹å–„ä½ è‡ªå·±çš„è¨€è®ºå’Œæ€è€ƒã€‚ä½†æ˜¯ï¼Œ<strong>è¯·æ³¨æ„ï¼Œè¿™äº›æ–¹æ³•å¹¶ä¸èƒ½è®©ä½ è·å¾—çœŸç†æˆ–æ˜¯çœŸç›¸ã€‚</strong></p><p>ä½†æ˜¯è¿™ä¹Ÿå¤Ÿäº†ï¼Œä¸€ä¸ªäººå¦‚æœæ‹¥æœ‰äº†èƒ½å¤Ÿåˆ†è¾¨æ˜¯éçš„èƒ½åŠ›ï¼Œä¹Ÿæ˜¯å¾ˆä¸é”™çš„äº†ã€‚è™½ç„¶ä¸çŸ¥é“äº‹å®æ˜¯ä»€ä¹ˆï¼Œä½†æ˜¯ä½ ä¹Ÿä¸ä¼šç›²ä»å’Œåä¿¡ï¼Œä»è€Œä¸ä¼šè¢«äººç…½åŠ¨ï¼Œè€Œæˆä¸ºå¹•åé»‘æ‰‹çš„çš„ä¸€åªâ€œè‚‰é¸¡â€ã€‚</p><p>å¤šè¯´ä¸¤å¥ï¼Œä¸‹é¢æ˜¯ä¸€äº›æˆ‘ä¸ªäººçš„ä¸€äº›å®è·µï¼š</p><ul><li><p>å½“æ–°é—»æŠ¥é“æŠ¥é“çš„ä¸æ˜¯å®¢è§‚äº‹å®ï¼Œè€Œæ˜¯åŠ å…¥äº†å¾ˆå¤šè§‚ç‚¹ï¼Œé‚£ä¹ˆè¿™ç¯‡æ–°é—»æŠ¥é“æ˜¯ä¸å¯ä¿¡çš„ã€‚</p></li><li><p>å¯¹äºè¯„è®ºæ€§çš„æ–‡ç« ï¼Œæ²¡æœ‰å……è¶³æƒå¨å¯ä¿¡çš„è®ºæ®æ—¶ï¼Œä¸èƒ½å®Œå…¨ç›¸ä¿¡ã€‚</p></li><li><p>ä¸æ˜¯å½“äº‹äººï¼Œä¸æ˜¯è§è¯äººï¼Œè¿˜è¦è£…ä½œè‡ªå·±æ˜¯çŸ¥æƒ…çš„â€¦â€¦ä¸çŸ¥é“è¿™ç§äººçš„è‡ªä¿¡æ€ä¹ˆæ¥çš„ï¼Ÿ</p></li><li><p>ä¿¡æ¯ä¸å…¬å¼€çš„ï¼Œå¹¶æœ‰æ„å±è”½ä¿¡æ¯çš„ï¼Œä¸èƒ½ä½œä¸ºå¯ä¿¡çš„ä¿¡æ¯æºã€‚</p></li><li><p>å½“å‡ºç°å¤§æ˜¯æˆ–æ˜¯å¤§éçš„äº‹æ—¶ï¼Œä¸€å®šè¦éå¸¸å°å¿ƒï¼Œè¿™ä¸ªä¸–ç•Œä¸å­˜åœ¨å®Œå…¨çš„ç¾å’Œå®Œå…¨çš„ä¸‘ï¼Œè¿™æ ·çš„è§‚ç‚¹é€šå¸¸æ¥è¯´éƒ½æ˜¯å±é™©çš„ï¼Œæ­¤æ—¶è¦å¤šçœ‹çœ‹ä¸åŒè§’åº¦çš„æŠ¥é“å’Œè¯„è®ºï¼Œè¦å¤šæ”¶é›†ä¸€äº›ä¿¡æ¯ï¼Œè¿˜è¦å¤šé—®é—®ä¸ºä»€ä¹ˆã€‚</p></li></ul><p>æ¬¢è¿å¤§å®¶åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œå‘Šè¯‰æˆ‘ä¸€äº›ä½ çš„å®è·µå’Œæ€ç»´æ–¹å¼ã€‚</p><blockquote><p>æœ¬æ–‡è½¬è½½è‡ªï¼šã€Œé…·å£³ã€ï¼ŒåŸæ–‡ï¼š<a href="https://url.cn/5MGMoTP%EF%BC%8C%E7%89%88%E6%9D%83%E5%BD%92%E5%8E%9F%E4%BD%9C%E8%80%85%E6%89%80%E6%9C%89%E3%80%82%E6%AC%A2%E8%BF%8E%E6%8A%95%E7%A8%BF%EF%BC%8C%E6%8A%95%E7%A8%BF%E9%82%AE%E7%AE%B1:" target="_blank" rel="noopener">https://url.cn/5MGMoTPï¼Œç‰ˆæƒå½’åŸä½œè€…æ‰€æœ‰ã€‚æ¬¢è¿æŠ•ç¨¿ï¼ŒæŠ•ç¨¿é‚®ç®±:</a> <code>editor@hi-linux.com</code> ã€‚</p></blockquote></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿™æ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„ä¸–ç•Œï¼Œè¿™ä¸ªä¸–ç•Œä¸Šæœ‰å¾ˆå¤šå„å¼å„æ ·çš„è§‚ç‚¹å’Œæ€ç»´æ–¹å¼ï¼Œä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜çš„æˆ‘ï¼Œä¹Ÿä¼šæœ‰ç¨‹åºå‘˜çš„æ€ç»´æ–¹å¼ï¼Œç¨‹åºå‘˜çš„æ€ç»´æ–¹å¼æ›´æ¥è¿‘æ•°å­¦çš„æ€ç»´æ–¹å¼ï¼Œæ•°å­¦çš„æ€ç»´æ–¹å¼è®©å¯ä»¥å¾ˆå®¹æ˜“åœ°ç†æ¸…æ¥šè¿™ä¸ªæ··ä¹±çš„ä¸–ç•Œï¼Œå…¶å®ï¼Œå¹¶ä¸éœ€è¦å¤ªå¤æ‚çš„æ•°å­¦é€»è¾‘ï¼Œåªéœ€è¦ä½¿ç”¨ä¸€äº›ç®€å•çš„æ•°å­¦æ–¹æ³•ï¼Œå°±å¯ä»¥å¤§å¹…æå‡è‡ªå·±çš„è®¤è¯†èƒ½åŠ›ï¼Œæ‰€ä»¥ï¼Œåœ¨è¿™é‡Œï¼Œè®°å½•ä¸€ç¯‡æˆ‘è‡ªå·±çš„æ€ç»´æ–¹å¼ï¼Œä¸€æ–¹é¢ç»™å¤§å®¶åšä¸ªå‚è€ƒï¼Œå¦ä¸€æ–¹é¢ä¹Ÿä¾›æ›´é«˜é˜¶çš„äººç»™æˆ‘è¿›è¡ŒæŒ‡æ­£ã€‚ç®—æ˜¯ â€œå¼€æºæˆ‘çš„æ€ç»´æ–¹å¼â€ï¼Œå¼€æ”¾ä¸ä»…ä»…æ˜¯ä¸ºäº†è¾“å‡ºï¼Œæ›´æ˜¯ä¸ºäº†çœ‹çœ‹æœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘çš„æ€ç»´æ–¹å¼ä¸­ï¼Œä½¿ç”¨æ•°å­¦é€»è¾‘çš„æ–¹å¼è¿›è¡Œæ€è€ƒï¼Œé€šå¸¸æ¥è¯´ï¼Œæˆ‘ä¼šä½¿ç”¨äº”æ­¥æ€è€ƒçš„æ–¹å¼ï¼š&lt;/p&gt;
&lt;h3 id=&quot;ç¬¬ä¸€æ­¥ï¼šä¿¡æ¯æ•°æ®å¯è€ƒè¯&quot;&gt;ç¬¬ä¸€æ­¥ï¼šä¿¡æ¯æ•°æ®å¯è€ƒè¯&lt;/h3&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ªè§‚ç‚¹æˆ–æ˜¯ä¸€ä¸ªè§è§£çš„æ•°æ®æ˜¯é”™è¯¯çš„ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆåé¢çš„è§‚ç‚¹å…¨æ˜¯é”™çš„ï¼Œæ‰€ä»¥ï¼Œé¦–è¦çš„æ˜¯è¦è¿›è¡Œæ•°æ®çš„æŸ¥è¯æˆ–è€ƒè¯ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœä¸€ç¯‡æ–‡ç« çš„ä½œè€…è¶³å¤Ÿä¸¥è°¨çš„è¯ï¼Œä»–çš„éœ€è¦ç»™ä»–çš„æ•°æ®å»ºç«‹ç›¸å…³çš„å¼•ç”¨æˆ–æ˜¯å¯ä»¥è€ƒè¯çš„æ–¹æ³•æ–¹å¼ã€‚å¦‚æœä¸€ç¯‡æ–‡ç« ä¸­å‡ºç°çš„æ˜¯ï¼Œâ€œæœ‰å…³ä¸“å®¶è¡¨æ˜â€ã€â€œç¾å›½ç§‘å­¦å®¶è¯æ˜â€ã€â€œç»æµå­¦å®¶æŒ‡å‡ºâ€ï¼Œä½†æ˜¯æ²¡æœ‰ä»»å‡ºå¤„ï¼Œä¹Ÿæ²¡æœ‰ç‚¹æ˜è¿™ä¸ªä¸“å®¶æˆ–æ˜¯ç§‘å­¦å®¶çš„åå­—ï¼Œæˆ–æ˜¯ï¼Œä¹Ÿæ²¡æœ‰è¯´æ˜æˆ–å¼•ç”¨è®©è¯»è€…å¯ä»¥è‡ªå·±å»éªŒè¯çš„æ–¹æ³•ã€‚é‚£ä¹ˆï¼Œå…¶å¼•ç”¨çš„è¯æˆ–æ˜¯æ•°æ®æ˜¯æ— æ³•è€ƒè¯çš„ï¼Œå¦‚æœæ˜¯æ— æ³•è€ƒè¯çš„ï¼Œé‚£ä¹ˆï¼Œè¿™ç¯‡æ–‡ç« çš„æ°´ä»½å°±éå¸¸å¤§äº†ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå½“æˆ‘è¯»åˆ°ä¸€ç¯‡æ–‡ç« ä¸­çš„ä¸œè¥¿æ²¡æœ‰å¯è€ƒè¯çš„æ¥æºæˆ–æ˜¯æ–¹æ³•æ—¶ï¼Œé€šå¸¸æ¥è¯´ï¼Œæˆ‘å°±ä¸ä¼šå†è¯»äº†ï¼Œå› ä¸ºè¿™ç¯‡æ–‡ç« çš„ä»·å€¼å·²ç»ä¸å¤§äº†ï¼Œå¦‚æœæˆ‘å…³å¿ƒè¿™ç¯‡æ–‡ç« ä¸­çš„ä¸œè¥¿ï¼Œæˆ‘ä¼šæ”¹ä¸ºè‡ªå·±å»æŸ¥æ‰¾çš„æ–¹å¼ï¼Œè™½ç„¶å˜â€œé‡â€äº†ï¼Œä½†æ˜¯å¾ˆå®‰å…¨ã€‚ï¼ˆæ‰€ä»¥ï¼Œåƒ Wikipedia è¿™æ ·çš„ç½‘ç«™æ˜¯æˆ‘ç»å¸¸å»è·å¾—ä¿¡æ¯çš„åœ°æ–¹ï¼Œå› ä¸ºä¿¡æ¯å¯ä»¥è¢«è€ƒè¯æ˜¯å…¶åŸºæœ¬ä»·å€¼è§‚ï¼‰&lt;/p&gt;
&lt;h3 id=&quot;ç¬¬äºŒæ­¥ï¼šå¤„ç†é›†åˆå’Œå…¶åŒ…å«å…³ç³»&quot;&gt;ç¬¬äºŒæ­¥ï¼šå¤„ç†é›†åˆå’Œå…¶åŒ…å«å…³ç³»&lt;/h3&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„äººäººéƒ½ä¼šçš„æ•°å­¦é€»è¾‘ã€‚æ¯”å¦‚ï¼šå“²å­¦å®¶æ˜¯äººï¼ŒæŸæ‹‰å›¾æ˜¯å“²å­¦å®¶ï¼Œæ‰€ä»¥ï¼ŒæŸæ‹‰å›¾æ˜¯äººã€‚å°±æ˜¯ä¸€ä¸ªåœ¨åŒ…å«å…³ç³»ä¸‹çš„æ¨ç†ã€‚ä½ ä¸è¦å°çœ‹è¿™ä¸ªç®€å•çš„é€»è¾‘ï¼Œå…¶å®å¾ˆå¤šäººå¹¶ä¸ä¼šå¾ˆå¥½çš„åº”ç”¨ï¼Œç›¸åï¼Œå½“æ„Ÿæƒ…æ”¯é…äº†ä»–ä»¬ä»¥åï¼Œä»–ä»¬ä¼šä»¥ç‚¹ä»£é¢ï¼Œä»¥ç‰¹ä¾‹ä»£æ›¿æ™®éæ€§ã€‚æ¯”å¦‚ï¼Œåœ°å›¾ç‚®å°±æ˜¯ä¸€ç§ï¼Œä»–ä»¬çœ‹åˆ°äº†å¤šä¸ªæ¡ˆä¾‹ï¼Œä»–ä»¬å°±å¼€å§‹æŠŠè¿™ä¸ªæ¡ˆä¾‹ä¸Šå‡ä¸Šæ›´å¤§çš„èŒƒå›´ï¼Œæ¯”å¦‚ï¼šæ²³å—äººæ–°ç–†äººéƒ½æ˜¯å°å·ï¼Œä¸Šæµ·äººéƒ½æ˜¯å°å¸‚æ°‘ã€‚æ—¥æœ¬äººéƒ½æ˜¯å˜æ€å’Œåäººç±»â€¦â€¦ç­‰ç­‰ã€‚é™¤äº†è¿™äº›åœ°å›¾ç‚®å¤–ï¼Œè¿˜æœ‰å¦å®šæ•´ä¸ªäººçš„ï¼Œæ¯”å¦‚ä¸€ä¸ªäººçŠ¯äº†ä¸ªé”™æˆ–æ˜¯æ€§æ ¼ä¸Šæœ‰ç¼ºé™·ï¼Œå°±ä¼šæŠŠæ•´ä¸ªäººå…¨ç›˜å¦å®šæ‰ï¼Œå‘˜å·¥æŠ¢ä¸ªæœˆé¥¼å°±ä¸Šå‡åˆ°å…¶ä»·å€¼è§‚æœ‰é—®é¢˜â€¦â€¦ã€‚åœ¨æ•°å­¦çš„é€»è¾‘åŒ…å«ä¸­ï¼Œè¶…é›†çš„å®šä¹‰å¯ä»¥é€‚ç”¨äºå­é›†ï¼Œé€šè¿‡å­é›†çš„ç‰¹å¾å¯ä»¥å¯¹è¶…é›†è¿›è¡Œæ¢ç´¢ï¼Œä½†æ˜¯æ²¡æ³•å®šä¹‰è¶…é›†ã€‚å¦å¤–ï¼Œé›†åˆçš„å¤§å°ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„äº‹ï¼Œ&lt;a href=&quot;https://zh.wikipedia.org/wiki/%E5%80%96%E5%AD%98%E8%80%85%E5%81%8F%E5%B7%AE&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å¹¸å­˜è€…åå·®&lt;/a&gt;ä¼šæ˜¯ä¸€ä¸ªå¾ˆå®¹æ˜“è®©äººæ‰ä¸‹å»çš„é™·é˜±ï¼Œå› ä¸ºå¯èƒ½ä¼šæœ‰å¾ˆå¤§çš„æ ·æœ¬é›†å¯èƒ½åœ¨ä½ çš„è§†çº¿ç›²åŒºã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/categories/Linux/"/>
    
    
      <category term="æŠ€å·§" scheme="https://www.hi-linux.com/tags/%E6%8A%80%E5%B7%A7/"/>
    
      <category term="æ€æƒ³" scheme="https://www.hi-linux.com/tags/%E6%80%9D%E6%83%B3/"/>
    
  </entry>
  
  <entry>
    <title>æ¨èä¸€æ¬¾å‘½ä»¤è¡Œä¸‹æœ€å¿«çš„æ–‡æœ¬æœç´¢ç¥å™¨ RipGrep</title>
    <link href="https://www.hi-linux.com/posts/29245.html"/>
    <id>https://www.hi-linux.com/posts/29245.html</id>
    <published>2018-09-17T01:00:00.000Z</published>
    <updated>2018-09-17T02:18:53.000Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><p>Ripgrep æ˜¯å‘½ä»¤è¡Œä¸‹ä¸€ä¸ªåŸºäºè¡Œçš„æœç´¢å·¥å…·ï¼ŒRipGrep ä½¿ç”¨ Rust å¼€å‘ï¼Œå¯ä»¥åœ¨å¤šå¹³å°ä¸‹è¿è¡Œï¼Œæ”¯æŒ Macã€Linux å’Œ Windows ç­‰å¹³å°ã€‚RipGrep ä¸ The Silver Searcherã€Ack å’Œ GNU Grep çš„åŠŸèƒ½ç±»ä¼¼ã€‚</p><p>RipGrep å®˜æ–¹å·ç§°æ¯”å…¶å®ƒç±»ä¼¼å·¥å…·åœ¨æœç´¢é€Ÿåº¦ä¸Šå¿«ä¸Š N å€ï¼ŒVSCode ä¹Ÿä» <a href="https://code.visualstudio.com/updates/v1_11#_text-search-improvements" target="_blank" rel="noopener">1.11 ç‰ˆæœ¬</a>å¼€å§‹é»˜è®¤å°† RipGrep åšä¸ºå…¶æœç´¢å·¥å…·ï¼Œç”±æ­¤å…¶åŠŸèƒ½å¼ºå¤§å¯è§ä¸€æ–‘ã€‚</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/BurntSushi/ripgrep" target="_blank" rel="noopener">https://github.com/BurntSushi/ripgrep</a></p><p><strong>Ripgrep æ”¯æŒçš„ä¸€äº›ç‰¹æ€§</strong></p><ul><li>è‡ªåŠ¨é€’å½’æœç´¢ ï¼ˆgrep éœ€è¦ -Rï¼‰ã€‚</li><li>è‡ªåŠ¨å¿½ç•¥ .gitignore ä¸­çš„æ–‡ä»¶ä»¥åŠäºŒè¿›åˆ¶æ–‡ä»¶å’Œéšè—æ–‡ä»¶ã€‚</li><li>å¯ä»¥æœç´¢æŒ‡å®šæ–‡ä»¶ç±»å‹ï¼Œå¦‚ï¼š<code>rg -tpy foo</code> åˆ™é™å®šåªæœç´¢ Python æ–‡ä»¶ï¼Œ<code>rg -Tjs foo</code> åˆ™æ’é™¤æ‰ JS æ–‡ä»¶ã€‚</li><li>æ”¯æŒå¤§éƒ¨åˆ† Grep çš„ ç‰¹æ€§ï¼Œä¾‹å¦‚ï¼šæ˜¾ç¤ºæœç´¢ç»“æœçš„ä¸Šä¸‹æ–‡ã€æ”¯æŒå¤šä¸ªæ¨¡å¼æœç´¢ã€é«˜äº®åŒ¹é…çš„æœç´¢ç»“æœä»¥åŠæ”¯æŒ Unicode ç­‰ã€‚</li><li>æ”¯æŒå„ç§æ–‡æœ¬ç¼–ç æ ¼å¼ï¼Œå¦‚ï¼šUTF-8ã€UTF-16ã€latin-1ã€GBKã€EUC-JPã€Shift_JIS ç­‰ã€‚</li><li>æ”¯æŒæœç´¢å¸¸è§æ ¼å¼çš„å‹ç¼©æ–‡ä»¶ï¼Œå¦‚ï¼šgzipã€xzã€lzmaã€bzip2ã€lz4 ç­‰ã€‚</li><li>è‡ªåŠ¨é«˜äº®åŒ¹é…çš„ç»“æœã€‚</li></ul><a id="more"></a><p><strong>Ripgrep å®˜æ–¹æ€§èƒ½åŸºå‡†æµ‹è¯•ç»“æœ</strong></p><ul><li>æœç´¢æ•´ä¸ª Linux å†…æ ¸æºä»£ç </li></ul><table><thead><tr><th>Tool</th><th>Command</th><th>Line count</th><th>Time</th></tr></thead><tbody><tr><td>ripgrep (Unicode)</td><td><code>rg -n -w '[A-Z]+_SUSPEND'</code></td><td>450</td><td><strong>0.106s</strong></td></tr><tr><td><a href="https://www.kernel.org/pub/software/scm/git/docs/git-grep.html" target="_blank" rel="noopener">git grep</a></td><td><code>LC_ALL=C git grep -E -n -w '[A-Z]+_SUSPEND'</code></td><td>450</td><td>0.553s</td></tr><tr><td><a href="https://github.com/ggreer/the_silver_searcher" target="_blank" rel="noopener">The Silver Searcher</a></td><td><code>ag -w '[A-Z]+_SUSPEND'</code></td><td>450</td><td>0.589s</td></tr><tr><td><a href="https://www.kernel.org/pub/software/scm/git/docs/git-grep.html" target="_blank" rel="noopener">git grep (Unicode)</a></td><td><code>LC_ALL=en_US.UTF-8 git grep -E -n -w '[A-Z]+_SUSPEND'</code></td><td>450</td><td>2.266s</td></tr><tr><td><a href="https://github.com/svent/sift" target="_blank" rel="noopener">sift</a></td><td><code>sift --git -n -w '[A-Z]+_SUSPEND'</code></td><td>450</td><td>3.505s</td></tr><tr><td><a href="https://github.com/petdance/ack2" target="_blank" rel="noopener">ack</a></td><td><code>ack -w '[A-Z]+_SUSPEND'</code></td><td>1878</td><td>6.823s</td></tr><tr><td><a href="https://github.com/monochromegane/the_platinum_searcher" target="_blank" rel="noopener">The Platinum Searcher</a></td><td><code>pt -w -e '[A-Z]+_SUSPEND'</code></td><td>450</td><td>14.208s</td></tr></tbody></table><table><thead><tr><th>Tool</th><th>Command</th><th>Line count</th><th>Time</th></tr></thead><tbody><tr><td>ripgrep</td><td><code>rg -L -u -tc -n -w '[A-Z]+_SUSPEND'</code></td><td>404</td><td><strong>0.079s</strong></td></tr><tr><td><a href="https://github.com/gvansickle/ucg" target="_blank" rel="noopener">ucg</a></td><td><code>ucg --type=cc -w '[A-Z]+_SUSPEND'</code></td><td>390</td><td>0.163s</td></tr><tr><td><a href="https://www.gnu.org/software/grep/" target="_blank" rel="noopener">GNU grep</a></td><td><code>egrep -R -n --include='*.c' --include='*.h' -w '[A-Z]+_SUSPEND'</code></td><td>404</td><td>0.611s</td></tr></tbody></table><ul><li>åœ¨å•ä¸ªå¤§æ–‡ä»¶ä¸Šå¯¹ Ripgrep å’Œ GNU Grep è¿›è¡Œæ¯”è¾ƒï¼Œæ–‡ä»¶å¤§å°å¤§çº¦ 9.3Gã€‚</li></ul><table><thead><tr><th>Tool</th><th>Command</th><th>Line count</th><th>Time</th></tr></thead><tbody><tr><td>ripgrep</td><td><code>rg -w 'Sherlock [A-Z]\w+'</code></td><td>5268</td><td><strong>2.108s</strong></td></tr><tr><td><a href="https://www.gnu.org/software/grep/" target="_blank" rel="noopener">GNU grep</a></td><td><code>LC_ALL=C egrep -w 'Sherlock [A-Z]\w+'</code></td><td>5268</td><td>7.014s</td></tr></tbody></table><p><strong>Ripgrep æ•ˆæœå›¾</strong></p><p><img src="https://www.hi-linux.com/img/linux/ripgrep.png" alt=""></p><h3 id="å®‰è£…-ripgrep">å®‰è£… Ripgrep</h3><p>Ripgrep å…·æœ‰è‰¯å¥½è·¨å¹³å°ç‰¹æ€§ï¼Œæ”¯æŒåœ¨ Linuxã€macOSã€Windows ç­‰å¤šç§å¹³å°ä¸‹å®‰è£…ã€‚å®˜æ–¹ä¹Ÿæä¾›äº†å„å¹³å°å¯¹åº”çš„äºŒè¿›åˆ¶ç‰ˆæœ¬ï¼Œä¸‹é¢æˆ‘ä»¬ä»¥ Linux å¹³å°ä¸ºä¾‹ä½¿ç”¨äºŒè¿›åˆ¶ç‰ˆæœ¬è¿›è¡Œå®‰è£…ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ wget  https://github.com/BurntSushi/ripgrep/releases/download/0.10.0/ripgrep-0.10.0-x86_64-unknown-linux-musl.tar.gz</span><br><span class="line">$ tar xzvf ripgrep-0.10.0-x86_64-unknown-linux-musl.tar.gz</span><br><span class="line">$ cp ripgrep-0.10.0-x86_64-unknown-linux-musl/rg  /usr/<span class="built_in">local</span>/bin/</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ ä½¿ç”¨å…¶å®ƒå¹³å°ï¼Œæ–¹æ³•ä¸å…¶ç±»ä¼¼ã€‚ä½ å¯æ ¹æ®å®é™…æƒ…å†µåœ¨å®˜æ–¹<a href="https://github.com/BurntSushi/ripgrep/releases" target="_blank" rel="noopener">ä¸‹è½½é¡µé¢</a>ä¸‹è½½å¯¹åº”ç‰ˆæœ¬è¿›è¡Œå®‰è£…ã€‚å½“ç„¶å®˜æ–¹ä¹Ÿæä¾›äº†å…¶å®ƒå¤šç§å¤šæ ·çš„å®‰è£…æ–¹å¼ï¼Œå…·ä½“å¯å‚è€ƒå®˜æ–¹<a href="https://github.com/BurntSushi/ripgrep#installation" target="_blank" rel="noopener">å®‰è£…æ–‡æ¡£</a>ã€‚</p><h3 id="ripgrep-è¯­æ³•æ ¼å¼">Ripgrep è¯­æ³•æ ¼å¼</h3><ul><li>æ•´ä½“è¯­æ³•æ ¼å¼</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">USAGE:</span><br><span class="line"></span><br><span class="line">    rg [OPTIONS] PATTERN [PATH ...]</span><br><span class="line">    rg [OPTIONS] [-e PATTERN ...] [-f PATTERNFILE ...] [PATH ...]</span><br><span class="line">    rg [OPTIONS] --files [PATH ...]</span><br><span class="line">    rg [OPTIONS] --<span class="built_in">type</span>-list</span><br><span class="line">    <span class="built_in">command</span> | rg [OPTIONS] PATTERN</span><br><span class="line"></span><br><span class="line">ARGS:</span><br><span class="line">    &lt;PATTERN&gt;</span><br><span class="line">            A regular expression used <span class="keyword">for</span> searching. To match a pattern beginning with a</span><br><span class="line">            dash, use the -e/--regexp flag.</span><br><span class="line"></span><br><span class="line">            For example, to search <span class="keyword">for</span> the literal <span class="string">'-foo'</span>, you can use this flag:</span><br><span class="line"></span><br><span class="line">                rg -e -foo</span><br><span class="line"></span><br><span class="line">            You can also use the special <span class="string">'--'</span> delimiter to indicate that no more flags</span><br><span class="line">            will be provided. Namely, the following is equivalent to the above:</span><br><span class="line"></span><br><span class="line">                rg -- -foo</span><br><span class="line"></span><br><span class="line">    &lt;PATH&gt;...</span><br><span class="line">            A file or directory to search. Directories are searched recursively. Paths specified on</span><br><span class="line">            the <span class="built_in">command</span> line override glob and ignore rules.</span><br></pre></td></tr></table></figure><ul><li>æ”¯æŒçš„å‘½ä»¤è¡Œé€‰é¡¹</li></ul><p>è¿™é‡Œæˆ‘ä»¬æŠŠä¸€äº›å¸¸ç”¨é€‰é¡¹åšä¸‹ä»‹ç»ã€‚</p><table><thead><tr><th>é€‰é¡¹</th><th>è¯´æ˜</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>-A, --after-context <code>&lt;NUM&gt;</code></td><td>æ˜¾ç¤ºåŒ¹é…å†…å®¹åçš„ <code>&lt;NUM&gt;</code> è¡Œã€‚</td><td>ä¼šè¦†ç›– <code>--context</code> é€‰é¡¹ã€‚</td></tr><tr><td>-B, --before-context <code>&lt;NUM&gt;</code></td><td>æ˜¾ç¤ºåŒ¹é…å†…å®¹å‰çš„ <code>&lt;NUM&gt;</code> è¡Œã€‚</td><td>ä¼šè¦†ç›– <code>--context</code> é€‰é¡¹ã€‚</td></tr><tr><td>-b, --byte-offset</td><td>æ˜¾ç¤ºåŒ¹é…å†…å®¹åœ¨æ–‡ä»¶ä¸­çš„å­—èŠ‚åç§»ã€‚</td><td>å’Œ <code>-o</code> ä¸€èµ·ä½¿ç”¨æ—¶åªæ‰“å°åç§»ã€‚</td></tr><tr><td>-s, --case-sensitive</td><td>å¯ç”¨å¤§å°å†™æ•æ„Ÿã€‚</td><td>ä¼šè¦†ç›– <code>-i(--ignore case)</code> å’Œ <code>-S(--smart case)</code> é€‰é¡¹ã€‚</td></tr><tr><td>â€“color <code>&lt;WHEN&gt;</code></td><td>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨é¢œè‰²ï¼Œé»˜è®¤å€¼ä¸ºï¼šautoã€‚å¯é€‰å€¼æœ‰ï¼šneverã€autoã€alwaysã€ansiã€‚</td><td>å¦‚æœ <code>--vimgre</code> é€‰é¡¹è¢«ä½¿ç”¨ï¼Œé‚£ä¹ˆé»˜è®¤å€¼æ˜¯ neverã€‚</td></tr><tr><td>â€“column</td><td>æ˜¾ç¤ºåŒ¹é…æ‰€åœ¨åˆ—æ•° (ä» 1 å¼€å§‹)ã€‚</td><td>å¦‚æœä¸æ˜¾ç¤ºåˆ—å·å¯ç”¨ <code>--no-column</code> å–æ¶ˆæ‰ã€‚</td></tr><tr><td>-C, --context <code>&lt;NUM&gt;</code></td><td>æ˜¾ç¤ºåŒ¹é…å†…å®¹çš„å‰é¢å’Œåé¢çš„ <code>&lt;NUM&gt;</code> è¡Œã€‚</td><td>è¯¥é€‰é¡¹ä¼šè¦†ç›– <code>-B</code> å’Œ <code>-A</code> é€‰é¡¹ã€‚</td></tr><tr><td>â€“context-separator <code>&lt;SEPARATOR&gt;</code></td><td>åœ¨è¾“å‡ºç»“æœä¸­åˆ†éš”éè¿ç»­çš„è¾“å‡ºè¡Œ ã€‚</td><td>å¯ä»¥ä½¿ç”¨<code>\x7F</code> æˆ– <code>\t</code>ï¼Œé»˜è®¤æ˜¯ <code>--</code>ã€‚</td></tr><tr><td>-c, --count</td><td>åªæ˜¾ç¤ºåŒ¹é…ç»“æœçš„æ€»è¡Œæ•°ã€‚</td><td>å¦‚æœåªæœ‰ä¸€ä¸ªæ–‡ä»¶ç»™ Ripgrepï¼Œé‚£ä¹ˆåªæ‰“å°åŒ¹é…ç»“æœçš„æ€»è¡Œæ•°ã€‚å¯ä»¥ç”¨ <code>--with-filename</code> æ¥å¼ºåˆ¶æ‰“å°æ–‡ä»¶åï¼Œè¯¥é€‰é¡¹ä¼šè¦†ç›– <code>--count-matches</code> é€‰é¡¹ã€‚</td></tr><tr><td>â€“count-matches</td><td>åªæ˜¾ç¤ºåŒ¹é…ç»“æœçš„æ€»æ¬¡æ•°ã€‚</td><td>å¯ä»¥ç”¨ <code>--with-filename</code> æ¥å¼ºåˆ¶åœ¨åªæœ‰ä¸€ä¸ªæ–‡ä»¶æ—¶ä¹Ÿè¾“å‡ºæ–‡ä»¶åã€‚</td></tr><tr><td>â€“debug</td><td>æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ã€‚</td><td></td></tr><tr><td>â€“dfa-size-limit <code>&lt;NUM+SUFFIX?&gt;</code></td><td>æŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼ DFA çš„ä¸Šé™ï¼Œé»˜è®¤ä¸º 10Mã€‚</td><td>è¯¥é€‰é¡¹å…è®¸æ¥å—ä¸ <code>--max-filesize</code> ç›¸åŒå¤§å°çš„åç¼€æ ‡å¿—ã€‚</td></tr><tr><td>-E, --encoding <code>&lt;ENCODING&gt;</code></td><td>æŒ‡å®šæ–‡æœ¬ç¼–ç æ ¼å¼, é»˜è®¤æ˜¯ autoã€‚</td><td>æ›´å¤šç¼–ç æ ¼å¼å‚è€ƒï¼š<a href="https://encoding.spec.whatwg.org/#concept-encoding-get" target="_blank" rel="noopener">https://encoding.spec.whatwg.org/#concept-encoding-get</a></td></tr><tr><td>-f, --file <code>&lt;PATTERNFILE&gt;</code>â€¦</td><td>ä»æ–‡ä»¶ä¸­è¯»å…¥æœç´¢æ¨¡å¼, ä¸€è¡Œä¸€ä¸ªæ¨¡å¼ã€‚</td><td>ç»“åˆ <code>-e/--regexp</code> å‚æ•°å¯å¤šä¸ªæ–‡ä»¶ä¸€èµ·ç»„åˆä½¿ç”¨ï¼Œæ‰€æœ‰ç»„åˆä¼šè¢«åŒ¹é…ã€‚</td></tr><tr><td>â€“files</td><td>æ‰“å°æ‰€æœ‰å°†è¢«æœç´¢çš„æ–‡ä»¶è·¯å¾„ã€‚</td><td>ä»¥ <code>rg &lt;options&gt; --files [PATH...]</code> æ–¹å¼ä½¿ç”¨ï¼Œä¸èƒ½å¢åŠ æœç´¢æ¨¡å¼ã€‚</td></tr><tr><td>-l, --files-with-matches</td><td>åªæ‰“å°æœ‰åŒ¹é…çš„æ–‡ä»¶åã€‚</td><td>è¯¥é€‰é¡¹ä¼šè¦†ç›– <code>--files-without-match</code>ã€‚</td></tr><tr><td>â€“files-without-match</td><td>åªæ‰“å°æ— åŒ¹é…çš„æ–‡ä»¶åã€‚</td><td>è¯¥é€‰é¡¹ä¼šè¦†ç›– <code>--file-with-matches</code>ã€‚</td></tr><tr><td>-F, --fixed-strings</td><td>æŠŠæœç´¢æ¨¡å¼å½“æˆå¸¸è§„æ–‡å­—è€Œéæ­£åˆ™è¡¨è¾¾å¼ã€‚</td><td>è¯¥é€‰é¡¹å¯ä»¥ç”¨<code>--no-fixed-strings</code> æ¥ç¦æ­¢ã€‚</td></tr><tr><td>-L, --follow</td><td>è¯¥é€‰é¡¹ä¼šé€’å½’æœç´¢ç¬¦å·é“¾æ¥ï¼Œé»˜è®¤æ˜¯å…³é—­çš„ã€‚</td><td>è¯¥é€‰é¡¹å¯ä»¥ç”¨ <code>--no-follow</code> é€‰é¡¹æ¥æ‰‹åŠ¨å…³é—­ã€‚</td></tr><tr><td>-g, --glob <code>&lt;GLOB&gt;</code>â€¦</td><td>åŒ…å«æˆ–æ’é™¤ç”¨äºæœç´¢åŒ¹é…ç»™å®šçš„æ–‡ä»¶å’Œç›®å½•ï¼Œå¯ä»¥ç”¨ ! æ¥å–åã€‚</td><td>è¯¥é€‰é¡¹å¯ä»¥å¤šæ¬¡ä½¿ç”¨ï¼Œä¼šåŒ¹é… .gitignore ä¸­çš„è§„åˆ™ã€‚</td></tr><tr><td>-h, --help</td><td>æ‰“å°å¸®åŠ©ä¿¡æ¯ã€‚</td><td></td></tr><tr><td>â€“heading</td><td>æ‰“å°æ–‡ä»¶ååˆ°åŒ¹é…å†…å®¹çš„ä¸Šæ–¹è€Œä¸æ˜¯åœ¨åŒä¸€è¡Œã€‚</td><td>è¯¥é€‰é¡¹æ˜¯é»˜è®¤å¯ç”¨çš„ï¼Œå¯ä»¥ç”¨ <code>--no-heading</code> æ¥å…³é—­ã€‚</td></tr><tr><td>â€“hidden</td><td>å¯ç”¨æœç´¢éšè—æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚</td><td>é»˜è®¤æƒ…å†µä¸‹æ˜¯å¿½ç•¥æœç´¢éšè—æ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„, å¯ç”¨ <code>--no-hidden</code> æ¥å…³é—­ã€‚</td></tr><tr><td>â€“iglob <code>&lt;GLOB&gt;</code>â€¦</td><td>ä½œç”¨åŒ <code>--glob</code>, ä½†è¿™ä¸ªé€‰é¡¹å¤§å°å†™ä¸æ•æ„Ÿã€‚</td><td></td></tr><tr><td>-i, --ignore-case</td><td>æŒ‡å®šæœç´¢æ¨¡å¼ä¸­çš„å¤§å°å†™ä¸æ•æ„Ÿã€‚</td><td>è¯¥é€‰é¡¹ä¼šè¢« <code>-s/--case-sensitive</code> æˆ– <code>-S/--smart-case</code> è¦†ç›–ã€‚</td></tr><tr><td>â€“ignore-file <code>&lt;PATH&gt;</code>â€¦</td><td>æŒ‡å®šæœç´¢æ—¶éœ€å¿½ç•¥çš„è·¯å¾„ï¼Œæ ¼å¼åŒ <code>.gitignore</code>, å¯åŒæ—¶æŒ‡å®šå¤šä¸ªã€‚</td><td>å¦‚æœå­˜åœ¨å¤šä¸ª <code>--ignore-file</code> æ ‡è®°æ—¶ï¼Œåé¢ä¼˜å…ˆçº§ä¼šæ›´é«˜ã€‚</td></tr><tr><td>-v, --invert-match</td><td>åå‘åŒ¹é…ï¼Œæ˜¾ç¤ºä¸ç»™å®šæ¨¡å¼ä¸åŒ¹é…çš„è¡Œã€‚</td><td></td></tr><tr><td>-n, --line-number</td><td>æ˜¾ç¤ºåŒ¹é…å†…å®¹æ‰€åœ¨æ–‡ä»¶çš„è¡Œæ•°ï¼Œè¯¥é€‰é¡¹é»˜è®¤æ˜¯æ‰“å¼€çš„ã€‚</td><td></td></tr><tr><td>-x, --line-regexp</td><td>åªæ˜¾ç¤ºæ•´è¡Œéƒ½åŒ¹é…æœç´¢æ¨¡å¼çš„è¡Œã€‚</td><td>è¯¥é€‰é¡¹ä¼šè¦†ç›– <code>--word-regexp</code>ã€‚</td></tr><tr><td>-M, --max-columns <code>&lt;NUM&gt;</code></td><td>ä¸æ‰“å°é•¿äº <code>&lt;NUM&gt;</code> ä¸­æŒ‡å®šèŠ‚å­—å¤§å°çš„åŒ¹é…è¡Œå†…å®¹ï¼Œåªæ˜¾ç¤ºè¯¥è¡Œçš„åŒ¹é…æ•°ã€‚</td><td></td></tr><tr><td>-m, --max-count <code>&lt;NUM&gt;</code></td><td>é™åˆ¶ä¸€ä¸ªæ–‡ä»¶ä¸­æœ€å¤š <code>&lt;NUM&gt;</code> è¡Œè¢«åŒ¹é…ã€‚</td><td></td></tr><tr><td>â€“max-depth <code>&lt;NUM&gt;</code></td><td>é™åˆ¶æ–‡ä»¶å¤¹é€’å½’æœç´¢æ·±åº¦ã€‚</td><td>å¦‚ï¼š<code>rg --max-depth 0 dir/</code> åˆ™è¡¨ç¤ºä¸æ‰§è¡Œä»»ä½•æœç´¢ã€‚</td></tr><tr><td>â€“max-filesize <code>&lt;NUM+SUFFIX?&gt;</code></td><td>æœç´¢æ—¶å¿½ç•¥å¤§äº <code>&lt;NUM&gt;</code> byte çš„æ–‡ä»¶ã€‚</td><td>SUFFIX çš„å•ä½å¯ä»¥æ˜¯ï¼šKã€Mã€Gï¼Œé»˜è®¤æ˜¯ï¼šbyteã€‚</td></tr><tr><td>â€“mmap</td><td>å°½é‡ä½¿ç”¨ Memory Maps è¿›è¡Œæœç´¢ï¼Œè¿™æ ·é€Ÿåº¦ä¼šæ›´å¿«ã€‚è¯¥é€‰é¡¹æ˜¯é»˜è®¤è¡Œä¸ºã€‚</td><td>å¦‚æœä½¿ç”¨ <code>--mmap</code> æœç´¢æ–‡ä»¶æ—¶ Ripgrep å‘ç”Ÿæ„å¤–ä¸­æ­¢ï¼Œå¯ä½¿ç”¨ <code>--no-mmap</code> é€‰é¡¹å…³é—­å®ƒã€‚</td></tr><tr><td>â€“no-config</td><td>ä¸è¯»å– configuration æ–‡ä»¶, å¹¶å¿½ç•¥ RIPGREP_CONFIG_PATH å˜é‡ã€‚</td><td></td></tr><tr><td>â€“no-filename</td><td>ä¸è¦æ‰“å°åŒ¹é…æ–‡ä»¶çš„æ–‡ä»¶åã€‚</td><td></td></tr><tr><td>â€“no-heading</td><td>ä¸åœ¨æ¯ä¸ªåŒ¹é…è¡Œä¸Šæ–¹æ‰“å°æ–‡ä»¶åï¼Œè€Œæ˜¯åœ¨åŒ¹é…è¡Œçš„åŒä¸€è¡Œä¸Šæ‰“å°ã€‚</td><td></td></tr><tr><td>â€“no-ignore</td><td>ä¸è¯»å–å¿½ç•¥æ–‡ä»¶ï¼Œå¦‚ï¼š.gitignoreã€.ignore ç­‰ã€‚</td><td>è¯¥é€‰é¡¹å¯ä»¥ç”¨ <code>--ignore</code> å…³é—­ã€‚</td></tr><tr><td>â€“no-ignore-global</td><td>ä¸è¯»å–å…¨å±€çš„ ignore æ–‡ä»¶ï¼Œæ¯”å¦‚: <code>$HOME/.config/git/ignore</code>ã€‚</td><td>è¯¥é€‰é¡¹å¯ä»¥ç”¨ <code>--ignore-global</code> å…³é—­ã€‚</td></tr><tr><td>â€“no-ignore-messages</td><td>å–æ¶ˆè§£æ .ignroeã€.gitignore æ–‡ä»¶ä¸­ç›¸å…³é”™è¯¯ä¿¡æ¯ã€‚</td><td>è¯¥é€‰é¡¹å¯é€šè¿‡ <code>--ignore-messages</code> å…³é—­ã€‚</td></tr><tr><td>â€“no-ignore-parent</td><td>ä¸è¯»å–çˆ¶æ–‡ä»¶å¤¹é‡Œçš„ .gitignoreã€.ignore æ–‡ä»¶ã€‚</td><td>è¯¥é€‰é¡¹å¯é€šè¿‡ <code>--ignore-parent</code> å…³é—­ã€‚</td></tr><tr><td>â€“no-ignore-vcs</td><td>ä¸è¯»å–ç‰ˆæœ¬æ§åˆ¶å™¨ä¸­çš„ .ignore æ–‡ä»¶ã€‚</td><td>è¯¥é€‰é¡¹å¯é€šè¿‡ <code>--ignore-vcs</code> å…³é—­ã€‚</td></tr><tr><td>-N, --no-line-number</td><td>ä¸æ‰“å°åŒ¹é…è¡Œæ•°ã€‚</td><td></td></tr><tr><td>â€“no-messages</td><td>ä¸æ‰“å°æ‰“å¼€å’Œè¯»å–æ–‡ä»¶æ—¶ç›¸å…³é”™è¯¯ä¿¡æ¯ã€‚</td><td></td></tr><tr><td>-0, --null</td><td>åœ¨æ‰“å°çš„æ–‡ä»¶è·¯å¾„ååŠ ä¸€ä¸ª NUL å­—ç¬¦ã€‚</td><td>è¿™å¯¹äºç»“åˆ Xargs ä½¿ç”¨æ—¶æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚</td></tr><tr><td>-o, --only-matching</td><td>åªæ‰“å°åŒ¹é…çš„å†…å®¹ï¼Œè€Œä¸æ˜¯æ•´è¡Œã€‚</td><td></td></tr><tr><td>â€“passthru</td><td>åŒæ—¶æ‰“å°æ–‡ä»¶ä¸­åŒ¹é…å’Œä¸åŒ¹é…çš„è¡Œã€‚</td><td></td></tr><tr><td>â€“path-separator <code>&lt;SEPARATOR&gt;</code></td><td>è·¯å¾„åˆ†éš”ç¬¦ï¼Œåœ¨ Linux ä¸Šé»˜è®¤æ˜¯ /ï¼ŒWindows ä¸Šé»˜è®¤æ˜¯ \ ã€‚</td><td></td></tr><tr><td>â€“pre <code>&lt;COMMAND&gt;</code></td><td>ç”¨ <code>&lt;COMMAND&gt;</code> å¤„ç†æ–‡ä»¶åï¼Œå¹¶å°†ç»“æœä¼ é€’ç»™ Ripgrepã€‚</td><td>è¯¥é€‰é¡¹å­˜åœ¨ä¸€å®šçš„æ€§èƒ½æŸè€—ã€‚</td></tr><tr><td>-p, --pretty</td><td>è¯¥é€‰é¡¹æ˜¯ <code>--color always --heading --line-number</code> çš„åˆ«åã€‚</td><td></td></tr><tr><td>-q, --quiet</td><td>è¯¥é€‰é¡¹ä¸ä¼šæ‰“å°åˆ°æ ‡å‡†è¾“å‡º, å¦‚æœåŒ¹é…å‘ç°æ—¶å°±åœæ­¢æœç´¢ã€‚</td><td>å½“ RipGrep ç”¨äº exit ä»£ç æ—¶è¯¥é€‰é¡¹éå¸¸æœ‰ç”¨ã€‚</td></tr><tr><td>â€“regex-size-limit <code>&lt;NUM+SUFFIX?&gt;</code></td><td>è®¾ç½®å·²ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼çš„ä¸Šé™ï¼Œé»˜è®¤é™åˆ¶ä¸º10Mã€‚</td><td></td></tr><tr><td>-e, --regexp <code>&lt;PATTERN&gt;</code>â€¦</td><td>ä½¿ç”¨æ­£åˆ™æ¥åŒ¹é…æœç´¢æ¡ä»¶ã€‚</td><td>è¯¥é€‰é¡¹å¯ä»¥å¤šæ¬¡ä½¿ç”¨ï¼Œå¯æ‰“å°åŒ¹é…ä»»ä½•æ¨¡å¼çš„è¡Œã€‚</td></tr><tr><td>-r, --replace <code>&lt;REPLACEMENT_TEXT&gt;</code></td><td>ç”¨ç›¸åº”æ–‡ä»¶å†…å®¹ä»£æ›¿åŒ¹é…å†…å®¹æ‰“å°å‡ºæ¥ã€‚</td><td></td></tr><tr><td>-z, --search-zip</td><td>åœ¨ gzã€bz2ã€xzã€lzmaã€lz4 æ–‡ä»¶ç±»å‹ä¸­æœç´¢ã€‚</td><td>è¯¥é€‰é¡¹å¯é€šè¿‡ <code>--no-search-zip</code> å…³é—­ã€‚</td></tr><tr><td>-S, --smart-case</td><td>å¦‚æœå…¨å°å†™ï¼Œåˆ™å¤§å°å†™ä¸æ•æ„Ÿï¼Œå¦åˆ™å¤§å°å†™æ•æ„Ÿã€‚</td><td>è¯¥é€‰é¡¹å¯é€šè¿‡ <code>-s/--case-sensitive</code> å’Œ <code>-i/--ignore-case</code> æ¥å…³é—­ã€‚</td></tr><tr><td>â€“sort <code>&lt;SORTBY&gt;</code></td><td>å°†è¾“å‡ºç»“æœæŒ‰å‡åºè¿›è¡Œæ’åºï¼Œå¯æ’åºç±»å‹æœ‰ï¼špathã€modifiedã€accessedã€created ã€‚</td><td></td></tr><tr><td>â€“sortr <code>&lt;SORTBY&gt;</code></td><td>å°†è¾“å‡ºç»“æœæŒ‰é™åºè¿›è¡Œæ’åºï¼Œå¯æ’åºç±»å‹æœ‰ï¼špathã€modifiedã€accessedã€created ã€‚</td><td></td></tr><tr><td>â€“stats</td><td>æ‰“å°å‡ºç»Ÿè®¡ç»“æœã€‚</td><td></td></tr><tr><td>-a, --text</td><td>æœç´¢äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</td><td>è¯¥é€‰é¡¹å¯é€šè¿‡ <code>--no-text</code> å…³é—­ã€‚</td></tr><tr><td>-j, --threads <code>&lt;NUM&gt;</code></td><td>æœç´¢æ—¶è¦ä½¿ç”¨çš„çº¿ç¨‹æ•°ã€‚</td><td></td></tr><tr><td>-t, --type <code>&lt;TYPE&gt;</code>â€¦</td><td>åªæœç´¢æŒ‡å®šçš„æ–‡ä»¶ç±»å‹ã€‚</td><td>å¯ä»¥é€šè¿‡ <code>--type-list</code> æ¥åˆ—å‡ºæ”¯æŒçš„æ–‡ä»¶ç±»å‹ã€‚</td></tr><tr><td>â€“type-add <code>&lt;TYPE_SPEC&gt;</code>â€¦</td><td>æ·»åŠ ä¸€ç§æ–‡ä»¶ç±»å‹ã€‚</td><td></td></tr><tr><td>â€“type-clear <code>&lt;TYPE&gt;</code>â€¦</td><td>æ¸…é™¤é»˜è®¤çš„æ–‡ä»¶ç±»å‹ã€‚</td><td></td></tr><tr><td>â€“type-list</td><td>åˆ—å‡ºæ‰€æœ‰å†…ç½®æ–‡ä»¶ç±»å‹ã€‚</td><td></td></tr><tr><td>-T, --type-not <code>&lt;TYPE&gt;</code>â€¦</td><td>ä¸è¦æœç´¢æŸç§æ–‡ä»¶ç±»å‹ã€‚</td><td></td></tr><tr><td>-u, --unrestricted</td><td><code>-u</code> æœç´¢.gitignore é‡Œçš„æ–‡ä»¶, <code>-uu</code> æœç´¢éšè—æ–‡ä»¶ï¼Œ<code>-uuu</code> æœç´¢äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</td><td></td></tr><tr><td>-V, --version</td><td>æ‰“å°ç‰ˆæœ¬ä¿¡æ¯ã€‚</td><td></td></tr><tr><td>â€“vimgrep</td><td>æ¯ä¸€æ¬¡åŒ¹é…éƒ½å•ç‹¬æ‰“å°ä¸€è¡Œï¼Œå¦‚æœä¸€è¡Œæœ‰å¤šæ¬¡åŒ¹é…ä¼šæ‰“å°æˆå¤šè¡Œã€‚</td><td></td></tr><tr><td>-H, --with-filename</td><td>æ‰“å°åŒ¹é…çš„æ–‡ä»¶è·¯å¾„ï¼Œè¯¥é€‰é¡¹é»˜è®¤æ‰“å¼€ã€‚</td><td>è¯¥é€‰é¡¹å¯é€šè¿‡ <code>--no-filename</code> å…³é—­ã€‚</td></tr><tr><td>-w, --word-regexp</td><td>æŠŠæœç´¢å‚æ•°ä½œä¸ºå•ç‹¬å•è¯åŒ¹é…ã€‚</td><td>è¯¥é€‰é¡¹ä¼šè¦†ç›– <code>--line-regexp</code> é€‰é¡¹ã€‚</td></tr></tbody></table><p>æ›´å¤šå‘½ä»¤è¡Œé€‰é¡¹ï¼Œå¯é€šè¿‡ <code>rg --help</code> è‡ªè¡ŒæŸ¥çœ‹ã€‚</p><h3 id="ripgrep-ä½¿ç”¨å®ä¾‹">Ripgrep ä½¿ç”¨å®ä¾‹</h3><h4 id="æœç´¢æŒ‡å®šæ–‡ä»¶ä¸­åŒ…å«å…³é”®å­—çš„å†…å®¹">æœç´¢æŒ‡å®šæ–‡ä»¶ä¸­åŒ…å«å…³é”®å­—çš„å†…å®¹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ rg <span class="string">'github.com'</span>  README.md</span><br><span class="line">1:&lt;h1 align=<span class="string">"center"</span>&gt;&lt;a title=<span class="string">"New Â«NexTÂ» 6.0.0 version [Reloaded]"</span> href=<span class="string">"https://github.com/theme-next/hexo-theme-next"</span>&gt;NexT&lt;/a&gt;&lt;/h1&gt;</span><br><span class="line">6:[![mnt-image]](https://github.com/theme-next/hexo-theme-next)</span><br><span class="line">21:More NexT examples [here](https://github.com/iissnan/hexo-theme-next/issues/119).</span><br><span class="line">41:   $ curl -s https://api.github.com/repos/iissnan/hexo-theme-next/releases/latest | grep tarball_url | cut -d <span class="string">'"'</span> -f 4 | wget -i - -O- | tar -zx -C themes/next --strip-components=1</span><br><span class="line">51:   $ curl -L https://api.github.com/repos/iissnan/hexo-theme-next/tarball/v5.1.2 | tar -zxv -C themes/next --strip-components=1</span><br><span class="line">57:   $ git <span class="built_in">clone</span> --branch v5.1.2 https://github.com/iissnan/hexo-theme-next themes/next</span><br><span class="line">67:   $ curl -L https://api.github.com/repos/iissnan/hexo-theme-next/tarball | tar -zxv -C themes/next --strip-components=1</span><br><span class="line">73:   $ git <span class="built_in">clone</span> https://github.com/iissnan/hexo-theme-next themes/next</span><br><span class="line">110:For those who also encounter **Error: Cannot find module <span class="string">'hexo-util'</span>** [issue](https://github.com/iissnan/hexo-theme-next/issues/1490), please check your NPM version.</span><br><span class="line">128:<span class="comment">### Theme configurations using Hexo data files ([#328](https://github.com/iissnan/hexo-theme-next/issues/328))</span></span><br><span class="line">282:NexT uses [Tomorrow Theme](https://github.com/chriskempson/tomorrow-theme) with 5 themes <span class="keyword">for</span> you to choose from.</span><br><span class="line">288:Head over to [Tomorrow Theme](https://github.com/chriskempson/tomorrow-theme) <span class="keyword">for</span> more details.</span><br><span class="line">367:[download-latest-url]: https://github.com/iissnan/hexo-theme-next/archive/master.zip</span><br><span class="line">368:[releases-latest-url]: https://github.com/iissnan/hexo-theme-next/releases/latest</span><br><span class="line">369:[releases-url]: https://github.com/iissnan/hexo-theme-next/releases</span><br><span class="line">370:[tags-url]: https://github.com/iissnan/hexo-theme-next/tags</span><br><span class="line">371:[commits-url]: https://github.com/iissnan/hexo-theme-next/commits/master</span><br></pre></td></tr></table></figure><h4 id="æœç´¢æŒ‡å®šæ–‡ä»¶ä¸­åŒ…å«ä»¥å…³é”®å­—å¼€å¤´çš„å•è¯çš„å†…å®¹">æœç´¢æŒ‡å®šæ–‡ä»¶ä¸­åŒ…å«ä»¥å…³é”®å­—å¼€å¤´çš„å•è¯çš„å†…å®¹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ rg <span class="string">'lang\w+'</span> README.md</span><br><span class="line">154:<span class="comment">### Multiple languages support, including:</span></span><br><span class="line">168:Default language is English.</span><br><span class="line">171:language: en</span><br><span class="line">172:<span class="comment"># language: zh-Hans</span></span><br><span class="line">173:<span class="comment"># language: zh-hk</span></span><br><span class="line">174:<span class="comment"># language: zh-tw</span></span><br><span class="line">175:<span class="comment"># language: ru</span></span><br><span class="line">176:<span class="comment"># language: fr-FR</span></span><br><span class="line">177:<span class="comment"># language: de</span></span><br><span class="line">178:<span class="comment"># language: ja</span></span><br><span class="line">179:<span class="comment"># language: id</span></span><br><span class="line">180:<span class="comment"># language: pt</span></span><br><span class="line">181:<span class="comment"># language: pt-BR</span></span><br></pre></td></tr></table></figure><h4 id="æœç´¢æŒ‡å®šæ–‡ä»¶ä¸­åŒ…å«ä»¥å…³é”®å­—å¼€å¤´çš„å†…å®¹">æœç´¢æŒ‡å®šæ–‡ä»¶ä¸­åŒ…å«ä»¥å…³é”®å­—å¼€å¤´çš„å†…å®¹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ rg <span class="string">'hexo\w*'</span> README.md</span><br><span class="line">1:&lt;h1 align=<span class="string">"center"</span>&gt;&lt;a title=<span class="string">"New Â«NexTÂ» 6.0.0 version [Reloaded]"</span> href=<span class="string">"https://github.com/theme-next/hexo-theme-next"</span>&gt;NexT&lt;/a&gt;&lt;/h1&gt;</span><br><span class="line">3:&lt;p align=<span class="string">"center"</span>&gt;NexT is a high quality elegant &lt;a href=<span class="string">"http://hexo.io"</span>&gt;Hexo&lt;/a&gt; theme. It is crafted from scratch, with love.&lt;/p&gt;</span><br><span class="line">6:[![mnt-image]](https://github.com/theme-next/hexo-theme-next)</span><br><span class="line">9:[![hexo-image]][hexo-url]</span><br><span class="line">21:More NexT examples [here](https://github.com/iissnan/hexo-theme-next/issues/119).</span><br><span class="line">25:**1.** Change dir to **hexo root** directory. There must be `node_modules`, `<span class="built_in">source</span>`, `themes` and other directories:</span><br><span class="line">27:   $ <span class="built_in">cd</span> hexo</span><br><span class="line">41:   $ curl -s https://api.github.com/repos/iissnan/hexo-theme-next/releases/latest | grep tarball_url | cut -d <span class="string">'"'</span> -f 4 | wget -i - -O- | tar -zx -C themes/next --strip-components=1</span><br><span class="line">51:   $ curl -L https://api.github.com/repos/iissnan/hexo-theme-next/tarball/v5.1.2 | tar -zxv -C themes/next --strip-components=1</span><br><span class="line">57:   $ git <span class="built_in">clone</span> --branch v5.1.2 https://github.com/iissnan/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure><h4 id="æœç´¢æŒ‡å®šç›®å½•åŠå­ç›®ä¸­åŒ…å«å…³é”®å­—çš„å†…å®¹">æœç´¢æŒ‡å®šç›®å½•åŠå­ç›®ä¸­åŒ…å«å…³é”®å­—çš„å†…å®¹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ rg <span class="string">'github.com'</span> ./</span><br><span class="line">./src/scrollspy.js</span><br><span class="line">6:* Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)</span><br><span class="line"></span><br><span class="line">./src/affix.js</span><br><span class="line">6: * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)</span><br><span class="line"></span><br><span class="line">./src/js.cookie.js</span><br><span class="line">3: * https://github.com/js-cookie/js-cookie</span><br></pre></td></tr></table></figure><h4 id="æœç´¢ä»¥å…³é”®å­—ä¸ºç‹¬ç«‹å•è¯çš„å†…å®¹">æœç´¢ä»¥å…³é”®å­—ä¸ºç‹¬ç«‹å•è¯çš„å†…å®¹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ rg -w <span class="string">'github.com'</span> ./</span><br><span class="line">./bower.json</span><br><span class="line">36:    <span class="string">"url"</span> : <span class="string">"http://github.com/julianshapiro/velocity.git"</span></span><br><span class="line"></span><br><span class="line">./velocity.ui.js</span><br><span class="line">58:        var abortError = <span class="string">"Velocity UI Pack: You need to update Velocity (jquery.velocity.js) to a newer version. Visit http://github.com/julianshapiro/velocity."</span>;</span><br><span class="line"></span><br><span class="line">./velocity.js</span><br><span class="line">442:    /* IE detection. Gist: https://gist.github.com/julianshapiro/9098609 */</span><br><span class="line">463:    /* rAF shim. Gist: https://gist.github.com/julianshapiro/9497513 */</span><br><span class="line">472:            /* Technique by Erik Moller. MIT license: https://gist.github.com/paulirish/1579671 */</span><br><span class="line">480:    /* Array compacting. Copyright Lo-Dash. MIT License: https://github.com/lodash/lodash/blob/master/LICENSE.txt */</span><br><span class="line">522:        /* Copyright Martin Bohm. MIT License: https://gist.github.com/Tomalak/818a78a226a0738eaade */</span><br></pre></td></tr></table></figure><h4 id="æœç´¢åŒ…å«å…³é”®å­—å†…å®¹çš„æ–‡ä»¶å¹¶ä¸”åªæ‰“å°æ–‡ä»¶å">æœç´¢åŒ…å«å…³é”®å­—å†…å®¹çš„æ–‡ä»¶å¹¶ä¸”åªæ‰“å°æ–‡ä»¶å</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ rg -w <span class="string">'github.com'</span> ./ -l</span><br><span class="line">./velocity.js</span><br><span class="line">./bower.json</span><br><span class="line">./velocity.ui.js</span><br><span class="line">./velocity.ui.min.js</span><br></pre></td></tr></table></figure><h4 id="åœ¨æŒ‡å®šæ–‡ä»¶ç±»å‹æ ¼å¼ä¸º-js-çš„æ–‡ä»¶ä¸­æœç´¢åŒ…å«å…³é”®å­—çš„å†…å®¹">åœ¨æŒ‡å®šæ–‡ä»¶ç±»å‹æ ¼å¼ä¸º JS çš„æ–‡ä»¶ä¸­æœç´¢åŒ…å«å…³é”®å­—çš„å†…å®¹</h4><p>RipGrep å®ç°çš„æ–¹å¼å­˜åœ¨å¤šç§å¤šæ ·ï¼Œè¿™é‡Œä»‹ç»æ¯”è¾ƒå¸¸ç”¨çš„ä¸¤ç§ã€‚</p><ul><li>ç¬¬ä¸€ç§ï¼šä½¿ç”¨ <code>--type</code> é€‰é¡¹æŒ‡å®šæ–‡ä»¶ç±»å‹ã€‚</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ rg <span class="string">'function writeOnCanvas'</span> --<span class="built_in">type</span> js</span><br><span class="line"><span class="built_in">source</span>/lib/Han/dist/han.js</span><br><span class="line">1726:<span class="keyword">function</span> writeOnCanvas( text, font ) &#123;</span><br></pre></td></tr></table></figure><ul><li>ç¬¬äºŒç§ï¼šä½¿ç”¨ <code>--glob</code> é€‰é¡¹æ¥é€šé…éœ€è¦çš„æ–‡ä»¶ç±»å‹ã€‚</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ rg  <span class="string">'function writeOnCanvas'</span> -g <span class="string">'*.js'</span></span><br><span class="line"><span class="built_in">source</span>/lib/Han/dist/han.js</span><br><span class="line">1726:<span class="keyword">function</span> writeOnCanvas( text, font ) &#123;</span><br></pre></td></tr></table></figure><p>å¦‚æœè¦åŒæ—¶æœç´¢å¤šä¸ªæ–‡ä»¶ç±»å‹å¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ rg <span class="string">'Hanzi'</span> -g <span class="string">'*.&#123;js,css&#125;'</span></span><br><span class="line">han.min.js</span><br><span class="line">2:/*! Han.css: the CSS typography framework optimised <span class="keyword">for</span> Hanzi */</span><br><span class="line"></span><br><span class="line">han.js</span><br><span class="line">3: * Han.css: the CSS typography framework optimised <span class="keyword">for</span> Hanzi</span><br><span class="line">48:  // Address Hanzi and Western script mixed spacing</span><br><span class="line">426:    /* Hanzi and Western mixed spacing </span><br><span class="line"></span><br><span class="line">han.css</span><br><span class="line">4:/*! Han.css: the CSS typography framework optimised <span class="keyword">for</span> Hanzi */</span><br><span class="line"></span><br><span class="line">han.min.css</span><br><span class="line">4:/*! Han.css: the CSS typography framework optimised <span class="keyword">for</span> Hanzi */</span><br></pre></td></tr></table></figure><h4 id="åœ¨å½“å‰ç›®ä¸‹å¹¶ä¸”ä¸åŒ…å«æ–‡ä»¶ç±»å‹æ ¼å¼ä¸º-css-çš„æ–‡ä»¶ä¸­æœç´¢åŒ…å«å…³é”®å­—çš„å†…å®¹">åœ¨å½“å‰ç›®ä¸‹å¹¶ä¸”ä¸åŒ…å«æ–‡ä»¶ç±»å‹æ ¼å¼ä¸º CSS çš„æ–‡ä»¶ä¸­æœç´¢åŒ…å«å…³é”®å­—çš„å†…å®¹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ rg <span class="string">'revertVowel'</span> --<span class="built_in">type</span>-not css</span><br><span class="line"><span class="built_in">source</span>/lib/Han/dist/han.min.js</span><br><span class="line">(this[<span class="string">"comb-liga-zhuyin"</span>]=O.substZhuyinCombLiga(this.context)),this&#125;,revertVowelCombLiga:<span class="function"><span class="title">function</span></span>()&#123;try&#123;this[<span class="string">"comb-liga-vowel"</span>].revert(<span class="string">"all"</span>)&#125;catch(a)&#123;&#125;<span class="built_in">return</span> this&#125;,revertVowelICombLiga:<span class="function"><span class="title">function</span></span>()&#123;try&#123;this[<span class="string">"comb-liga-vowel-i"</span>].revert(<span class="string">"all"</span>)&#125;catch(a)&#123;&#125;<span class="built_in">return</span> this&#125;,revertZhuyinCombLiga:<span class="function"><span class="title">function</span></span>()&#123;try&#123;this[<span class="string">"comb-liga-zhuyin"</span>].revert(<span class="string">"all"</span>)&#125;catch(a)&#123;&#125;<span class="built_in">return</span> this&#125;,revertCombLigaWithPUA:<span class="function"><span class="title">function</span></span>()&#123;try&#123;this[<span class="string">"comb-liga-vowel"</span>].revert(<span class="string">"all"</span>),this[<span class="string">"comb-liga-vowel-i"</span>].revert(<span class="string">"all"</span>),this[<span class="string">"comb-liga-zhuyin"</span>].revert(<span class="string">"all"</span>)&#125;catch(a)&#123;&#125;<span class="built_in">return</span> this&#125;,substInaccurateChar:<span class="function"><span class="title">function</span></span>()&#123;<span class="built_in">return</span> this[<span class="string">"inaccurate-char"</span>]=O.substInaccurateChar(this.context),this&#125;,revertInaccurateChar:<span class="function"><span class="title">function</span></span>()&#123;try&#123;this[<span class="string">"inaccurate-char"</span>].revert(<span class="string">"all"</span>)&#125;catch(a)&#123;&#125;<span class="built_in">return</span> this&#125;&#125;),a.addEventListener(<span class="string">"DOMContentLoaded"</span>,<span class="function"><span class="title">function</span></span>()&#123;var a;K.classList.contains(<span class="string">"han-init"</span>)?O.init():(a=J.querySelector(<span class="string">".han-init-context"</span>))&amp;&amp;(O.init=O(a).render())&#125;),(<span class="string">"undefined"</span>==typeof b||b===!1)&amp;&amp;(a.Han=O),O&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span>/lib/Han/dist/han.js</span><br><span class="line">2939:  revertVowelCombLiga: <span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">2946:  revertVowelICombLiga: <span class="function"><span class="title">function</span></span>() &#123;</span><br></pre></td></tr></table></figure><p>ä½ ä¹Ÿå¯ä»¥ç”¨ä¸‹é¢çš„æ›´ç®€æ´çš„å†™æ³•æ¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rg &#39;revertVowel&#39; -Tcss</span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œå…³é”®å­—æœç´¢">ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œå…³é”®å­—æœç´¢</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ rg -e <span class="string">"noConf.*lict"</span> ./</span><br><span class="line">./js.cookie.js</span><br><span class="line">21:api.noConflict = <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line"></span><br><span class="line">./scrollspy.js</span><br><span class="line">166:  $.fn.scrollspy.noConflict = <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line"></span><br><span class="line">./affix.js</span><br><span class="line">139:  $.fn.affix.noConflict = <span class="function"><span class="title">function</span></span> () &#123;</span><br></pre></td></tr></table></figure><h4 id="æœç´¢åŒ¹é…å…³é”®å­—çš„å†…å®¹åŠæ˜¾ç¤ºå…¶ä¸Šä¸‹å†…å®¹å„ä¸¤è¡Œ">æœç´¢åŒ¹é…å…³é”®å­—çš„å†…å®¹åŠæ˜¾ç¤ºå…¶ä¸Šä¸‹å†…å®¹å„ä¸¤è¡Œ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$  rg -e <span class="string">"noConf.*lict"</span>  -C2</span><br><span class="line">js.cookie.js</span><br><span class="line">19-var OldCookies = window.Cookies;</span><br><span class="line">20-var api = window.Cookies = factory();</span><br><span class="line">21:api.noConflict = <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">22-window.Cookies = OldCookies;</span><br><span class="line">23-<span class="built_in">return</span> api;</span><br><span class="line"></span><br><span class="line">scrollspy.js</span><br><span class="line">164-  // =====================</span><br><span class="line">165-</span><br><span class="line">166:  $.fn.scrollspy.noConflict = <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">167-    $.fn.scrollspy = old</span><br><span class="line">168-    <span class="built_in">return</span> this</span><br><span class="line"></span><br><span class="line">affix.js</span><br><span class="line">137-  // =================</span><br><span class="line">138-</span><br><span class="line">139:  $.fn.affix.noConflict = <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">140-    $.fn.affix = old</span><br><span class="line">141-    <span class="built_in">return</span> this</span><br></pre></td></tr></table></figure><h4 id="æœç´¢ä¸åŒ…å«å…³é”®å­—çš„å†…å®¹">æœç´¢ä¸åŒ…å«å…³é”®å­—çš„å†…å®¹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ rg -v <span class="string">"hexo"</span> merge-configs.js</span><br><span class="line">2:</span><br><span class="line">3:var merge = require(<span class="string">'./merge'</span>);</span><br><span class="line">4:</span><br><span class="line">5:/**</span><br><span class="line">8: */</span><br><span class="line">12:    <span class="keyword">if</span> ( data &amp;&amp; data.next ) &#123;</span><br><span class="line">13:      <span class="keyword">if</span> ( data.next.override ) &#123;</span><br><span class="line">15:      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">17:      &#125;</span><br><span class="line">18:    &#125;</span><br><span class="line">19:  &#125;</span><br><span class="line">20:&#125;);</span><br><span class="line">21:</span><br><span class="line">30:&#125;);</span><br></pre></td></tr></table></figure><h4 id="æœç´¢å…³é”®å­—å¹¶åªæ˜¾ç¤ºå…³é”®å­—éƒ¨åˆ†çš„å†…å®¹">æœç´¢å…³é”®å­—å¹¶åªæ˜¾ç¤ºå…³é”®å­—éƒ¨åˆ†çš„å†…å®¹</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ rg -e <span class="string">"hexo.*warn"</span> -o ./</span><br><span class="line">./tags/lazy-image.js</span><br><span class="line">12:hexo.log.warn</span><br><span class="line"></span><br><span class="line">./merge-configs.js</span><br><span class="line">23:hexo.log.warn</span><br><span class="line">24:hexo.log.warn</span><br><span class="line">25:hexo.log.warn</span><br><span class="line">26:hexo.log.warn</span><br><span class="line">27:hexo.log.warn</span><br><span class="line">28:hexo.log.warn</span><br><span class="line">29:hexo.log.warn</span><br><span class="line"></span><br><span class="line">./tags/button.js</span><br><span class="line">13:hexo.log.warn</span><br><span class="line"></span><br><span class="line">./tags/full-image.js</span><br><span class="line">12:hexo.log.warn</span><br></pre></td></tr></table></figure><h4 id="æœç´¢å…³é”®å­—å¹¶å¿½ç•¥å…³é”®å­—å¤§å°å†™çš„å†…å®¹">æœç´¢å…³é”®å­—å¹¶å¿½ç•¥å…³é”®å­—å¤§å°å†™çš„å†…å®¹</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ rg -ie &quot;Return.*&quot; merge.js</span><br><span class="line">103:var root &#x3D; freeGlobal || freeSelf || Function(&#39;return this&#39;)();</span><br><span class="line">120:    return freeProcess &amp;&amp; freeProcess.binding(&#39;util&#39;);</span><br><span class="line">134: * @returns &#123;Object&#125; Returns &#96;map&#96;.</span><br><span class="line">137:  &#x2F;&#x2F; Don&#39;t return &#96;map.set&#96; because it&#39;s not chainable in IE 11.</span><br><span class="line">139:  return map;</span><br><span class="line">148: * @returns &#123;Object&#125; Returns &#96;set&#96;.</span><br><span class="line">151:  &#x2F;&#x2F; Don&#39;t return &#96;set.add&#96; because it&#39;s not chainable in IE 11.</span><br></pre></td></tr></table></figure><h4 id="æŠŠå…³é”®å­—å½“æˆå¸¸é‡å­—ç¬¦è¿›è¡Œæœç´¢">æŠŠå…³é”®å­—å½“æˆå¸¸é‡å­—ç¬¦è¿›è¡Œæœç´¢</h4><p>å…³é”®å­—ä¸­åŒ…å« <code>.(){}*+</code> ç±»ä¼¼å­—ç¬¦æ—¶ï¼Œä¸éœ€è¦æ‰‹åŠ¨è½¬ä¹‰ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ rg -F <span class="string">"i++)"</span> ./</span><br><span class="line">./tags/exturl.js</span><br><span class="line">27:  <span class="keyword">for</span> (; i &lt; len; i++) &#123;</span><br><span class="line"></span><br><span class="line">./tags/group-pictures.js</span><br><span class="line">795:    <span class="keyword">for</span> (var i = 0; i &lt; rows; i++) &#123;</span><br><span class="line">805:    <span class="keyword">for</span> (var i = 0; i &lt; rows.length; i++) &#123;</span><br><span class="line">825:    <span class="keyword">for</span> (var i = 0; i &lt; pictures.length; i++) &#123;</span><br></pre></td></tr></table></figure><p>å¦‚æœè¦æœç´¢çš„å­—ç¬¦æ˜¯ä»¥ <code>-</code> å¼€å¤´æ—¶ï¼Œè¦ç”¨ <code>--</code> æ¥ä½œä¸ºåˆ†éš”ç¬¦ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ rg -- -1 merge.js</span><br><span class="line">190:  var index &#x3D; -1,</span><br><span class="line">210:  var index &#x3D; -1,</span><br><span class="line">233:  var index &#x3D; -1,</span><br><span class="line">255:  var index &#x3D; -1,</span><br><span class="line">317:  var index &#x3D; -1,</span><br><span class="line">348:  var index &#x3D; -1,</span><br><span class="line">435:  var index &#x3D; -1,</span><br><span class="line">533:  var index &#x3D; -1,</span><br><span class="line">605:  return assocIndexOf(this.__data__, key) &gt; -1;</span><br><span class="line">645:  var index &#x3D; -1,</span><br><span class="line">889: * @returns &#123;number&#125; Returns the index of the matched value, else &#96;-1&#96;.</span><br><span class="line">898:  return -1;</span><br></pre></td></tr></table></figure><p>æˆ–è€…ä½¿ç”¨ <code>-e</code> å‚æ•°ä¹Ÿå¯ä»¥è¾¾åˆ°ç±»ä¼¼ç›®çš„ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ rg -e <span class="string">"-1"</span> <span class="built_in">source</span>/js</span><br><span class="line"><span class="built_in">source</span>/js/src/js.cookie.js</span><br><span class="line">113:cookie = cookie.slice(1, -1);</span><br><span class="line">155:expires: -1</span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span>/js/src/motion.js</span><br><span class="line">190:    cursor: -1,</span><br><span class="line">223:        getMistLineSettings(<span class="variable">$logoLineBottom</span>, <span class="string">'-100%'</span>)</span><br></pre></td></tr></table></figure><h4 id="æ‰“å°å½“å‰ç›®ä¸‹æ‰€æœ‰å°†è¢«æœç´¢çš„æ–‡ä»¶åˆ—è¡¨">æ‰“å°å½“å‰ç›®ä¸‹æ‰€æœ‰å°†è¢«æœç´¢çš„æ–‡ä»¶åˆ—è¡¨</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ rg --files</span><br><span class="line">merge.js</span><br><span class="line">merge-configs.js</span><br><span class="line">tags/lazy-image.js</span><br><span class="line">tags/center-quote.js</span><br><span class="line">tags/tabs.js</span><br><span class="line">tags/note.js</span><br><span class="line">tags/button.js</span><br><span class="line">tags/full-image.js</span><br><span class="line">tags/group-pictures.js</span><br><span class="line">tags/label.js</span><br><span class="line">tags/exturl.js</span><br></pre></td></tr></table></figure><h4 id="è¾“å‡ºæ‰€æœ‰å†…ç½®å¯è¯†åˆ«æ–‡ä»¶ç±»å‹">è¾“å‡ºæ‰€æœ‰å†…ç½®å¯è¯†åˆ«æ–‡ä»¶ç±»å‹</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$ rg --type-list</span><br><span class="line">agda: *.agda, *.lagda</span><br><span class="line">aidl: *.aidl</span><br><span class="line">amake: *.bp, *.mk</span><br><span class="line">asciidoc: *.adoc, *.asc, *.asciidoc</span><br><span class="line">asm: *.S, *.asm, *.s</span><br><span class="line">ats: *.ats, *.dats, *.hats, *.sats</span><br><span class="line">avro: *.avdl, *.avpr, *.avsc</span><br><span class="line">awk: *.awk</span><br><span class="line">bazel: *.bzl, BUILD, WORKSPACE</span><br><span class="line">bitbake: *.bb, *.bbappend, *.bbclass, *.conf, *.inc</span><br><span class="line">bzip2: *.bz2</span><br><span class="line">c: *.H, *.c, *.cats, *.h</span><br><span class="line">cabal: *.cabal</span><br><span class="line">cbor: *.cbor</span><br><span class="line">ceylon: *.ceylon</span><br><span class="line">clojure: *.clj, *.cljc, *.cljs, *.cljx</span><br><span class="line">cmake: *.cmake, CMakeLists.txt</span><br><span class="line">coffeescript: *.coffee</span><br><span class="line">config: *.cfg, *.conf, *.config, *.ini</span><br><span class="line">cpp: *.C, *.H, *.cc, *.cpp, *.cxx, *.h, *.hh, *.hpp, *.hxx, *.inl</span><br><span class="line">creole: *.creole</span><br><span class="line">crystal: *.cr, Projectfile</span><br><span class="line">cs: *.cs</span><br><span class="line">......</span><br></pre></td></tr></table></figure><h4 id="è‡ªå®šä¹‰æœç´¢æ–‡ä»¶ç±»å‹">è‡ªå®šä¹‰æœç´¢æ–‡ä»¶ç±»å‹</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒRipgrep é™„å¸¦äº†ä¸€å †é¢„å®šä¹‰çš„ç±»å‹ã€‚ é€šå¸¸ï¼Œè¿™äº›ç±»å‹å¯¹åº”äºä¼—æ‰€å‘¨çŸ¥çš„å…¬å…±æ ¼å¼ã€‚ æ‚¨ä¹Ÿå¯ä»¥å®šä¹‰è‡ªå·±çš„ç±»å‹ï¼Œä¾‹å¦‚ï¼šæ‚¨å¯èƒ½ç»å¸¸æœç´¢ Web ç±»å‹æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å« Javascriptã€HTML å’Œ CSS ç±»å‹çš„æ–‡ä»¶ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ rg --type-add &#39;web:*.html&#39; --type-add &#39;web:*.css&#39; --type-add &#39;web:*.js&#39; -tweb display</span><br><span class="line">han.css</span><br><span class="line">28:  display: block;</span><br><span class="line">34:  display: inline-block;</span><br><span class="line">37:  display: none;</span><br><span class="line">45:  display: none;</span><br><span class="line">174:  display: table; &#x2F;* 1 *&#x2F;</span><br><span class="line"></span><br><span class="line">han.js</span><br><span class="line">442:    &#x2F;&#x2F; The feature displays the following characters</span><br><span class="line">446:    &#39;display-as&#39;: &#123;</span><br><span class="line">1732:  canvas.style.display &#x3D; &#39;none&#39;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ç›´æ¥ç®€å†™æˆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rg --type-add &#39;web:*.&#123;html,css,js&#125;&#39; -tweb display</span><br></pre></td></tr></table></figure><p>ä¸è¿‡æœ‰ä¸€ç‚¹æ˜¯è¦æ³¨æ„çš„ï¼Œä¸Šé¢å¢åŠ çš„ Web ç±»å‹æ–‡ä»¶æ˜¯ä¸´æ—¶çš„ï¼Œåªå¯¹å½“å‰å‘½ä»¤æœ‰æ•ˆã€‚å¦‚æœéœ€è¦é•¿æœŸä½¿ç”¨è‡ªå®šä¹‰çš„ç±»å‹ï¼Œä½ å¯ä»¥æ–°å¢ä¸€ä¸ªåˆ«åæ¥åœ¨æ¯æ¬¡è¿è¡Œ RipGrep æ—¶è‡ªåŠ¨å¢åŠ å¯¹åº”çš„æ–‡ä»¶ç±»å‹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ alias rg&#x3D;&quot;rg --type-add &#39;web:*.&#123;html,css,js&#125;&#39;&quot;</span><br></pre></td></tr></table></figure><p>å½“ç„¶è¿˜æœ‰å¦ä¸€ç§æ–¹æ³•æ¥è¾¾åˆ°ç±»ä¼¼çš„ç›®çš„ï¼Œé‚£å°±æ˜¯ä½¿ç”¨ RipGrep çš„é…ç½®æ–‡ä»¶ï¼ŒRipGrep çš„é…ç½®æ–‡ä»¶é»˜è®¤ä¸º <code>$HOME/.ripgreprc</code>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ cat <span class="variable">$HOME</span>/.ripgreprc</span><br><span class="line"><span class="comment"># Don't let ripgrep vomit really long lines to my terminal.</span></span><br><span class="line">--max-columns=150</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add my 'web' type.</span></span><br><span class="line">--<span class="built_in">type</span>-add</span><br><span class="line">web:*.&#123;html,css,js&#125;*</span><br><span class="line"></span><br><span class="line"><span class="comment"># Using glob patterns to include/exclude files or folders</span></span><br><span class="line">--glob=!git/*</span><br><span class="line"></span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">--glob</span><br><span class="line">!git/*</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the colors.</span></span><br><span class="line">--colors=line:none</span><br><span class="line">--colors=line:style:bold</span><br><span class="line"></span><br><span class="line"><span class="comment"># Because who cares about case!?</span></span><br><span class="line">--smart-case</span><br></pre></td></tr></table></figure><h4 id="å°†åŒ…å«å…³é”®å­—çš„å†…å®¹åœ¨æŸ¥æ‰¾ç»“æœä¸­è¿›è¡Œæ›¿æ¢">å°†åŒ…å«å…³é”®å­—çš„å†…å®¹åœ¨æŸ¥æ‰¾ç»“æœä¸­è¿›è¡Œæ›¿æ¢</h4><p>RipGrep æä¾›äº†ä¸€ä¸ªåœ¨æŸ¥æ‰¾è¿‡ç¨‹ä¸­ç›´æ¥å°†å…³é”®å­—å†…å®¹è¿›è¡Œæ›¿æ¢çš„åŠŸèƒ½ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå°†å…³é”®å­—ä¸­éƒ¨åˆ†å†…å®¹çš„å°å†™å­—æ¯è½¬å¤§å†™å­—æ¯çš„ä¾‹å­ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ rg browse README.md --replace Browse</span><br><span class="line">305:<span class="comment"># can be any image format supported by web Browsers (JPEG,PNG,GIF,SVG,..)</span></span><br><span class="line">322:![Browser-image]</span><br><span class="line">324:[![Browser Stack](.github/Browserstack_logo.png)](https://www.Browserstack.com/)</span><br><span class="line">325:&gt;**BrowserStack** is a cloud-based cross-Browser testing tool that enables developers to <span class="built_in">test</span> their websites across various Browsers on different operating systems and mobile devices, without requiring users to install virtual machines, devices or emulators.</span><br><span class="line">343:[Browser-image]: https://img.shields.io/badge/Browser-%20chrome%20%7C%20firefox%20%7C%20opera%20%7C%20safari%20%7C%20ie%20%3E%3D%209-lightgrey.svg</span><br><span class="line">344:[Browser-url]: https://www.Browserstack.com</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ç»“æœå®è´¨ä¸Šåªæ˜¯åœ¨æ ‡å‡†è¾“å‡ºä¸­è¿›è¡Œæ›¿æ¢ï¼Œå¹¶ä¸ä¼šå¯¹å®é™…æ–‡ä»¶è¿›è¡Œä¿®æ”¹ã€‚å¦‚æœä½ éœ€è¦å¯¹å®é™…æ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œä½ å¯ä»¥ç»“åˆ Sed å‘½ä»¤æ¥è¾¾åˆ°ç›®çš„ã€‚</p><ul><li>å¦‚æœä½ ä½¿ç”¨ GNU Sed (CentOSã€Ubuntu ç­‰å„ç§ Linux å‘è¡Œç‰ˆ)ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ã€‚</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rg browse --files-with-matches | xargs sed -i <span class="string">'s/browse/Browse/g'</span></span><br></pre></td></tr></table></figure><ul><li>å¦‚æœæ‚¨ä½¿ç”¨ BSD Sedï¼ˆ macOS å’Œ FreeBSDï¼‰ï¼Œåˆ™å¿…é¡»å°†ä»¥ä¸Šå‘½ä»¤ä¿®æ”¹ä¸ºä»¥ä¸‹å‘½ä»¤ã€‚</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rg browse --files-with-matches | xargs sed -i <span class="string">''</span> <span class="string">'s/browse/Browse/g'</span></span><br></pre></td></tr></table></figure><blockquote><p>BSD Sed ä¸­çš„ -i æ ‡å¿—éœ€è¦æä¾›æ–‡ä»¶æ‰©å±•åä»¥å¯¹æ‰€æœ‰å·²ä¿®æ”¹çš„æ–‡ä»¶è¿›è¡Œå¤‡ä»½ï¼Œè¿™é‡ŒæŒ‡å®šç©ºå­—ç¬¦ä¸²å¯é˜²æ­¢è¿›è¡Œæ–‡ä»¶å¤‡ä»½ã€‚</p></blockquote><ul><li>å¦‚æœæ‚¨çš„æ–‡ä»¶è·¯å¾„ä¸­åŒ…å«ç©ºæ ¼ï¼Œåˆ™éœ€è¦ä½¿ç”¨ NUL ç»ˆç»“ç¬¦åˆ†éš”æ–‡ä»¶è·¯å¾„ã€‚è¿™é‡Œå°±éœ€è¦ä½¿ç”¨ <code>-0</code> å‚æ•°æ¥å‘Šè¯‰ Ripgrep åœ¨æ¯ä¸ªè·¯å¾„ä¹‹é—´è¾“å‡º NUL å­—èŠ‚ï¼Œå¹¶å‘Šè¯‰ Xargs è¯»å–ç”± NUL å­—èŠ‚åˆ†éš”çš„è·¯å¾„ã€‚</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rg Browse --files-with-matches -0 | xargs -0 sed -i &#39;&#39; &#39;s&#x2F;Browse&#x2F;browse&#x2F;g&#39;</span><br></pre></td></tr></table></figure><h4 id="ç›´æ¥åœ¨å‹ç¼©æ–‡ä»¶ä¸­æœç´¢åŒ…å«å…³é”®å­—çš„å†…å®¹">ç›´æ¥åœ¨å‹ç¼©æ–‡ä»¶ä¸­æœç´¢åŒ…å«å…³é”®å­—çš„å†…å®¹</h4><p>Ripgrep ç›®å‰ä»…æ”¯æŒ gzipã€bzip2ã€lzmaã€lz4 å’Œ xz è¿™å‡ ç§å‹ç¼©æ ¼å¼ï¼Œå¹¶ä¸”éœ€è¦åœ¨ç³»ç»Ÿä¸Šå·²å®‰è£…ç›¸åº”çš„ gzipï¼Œbzip2 å’Œ xz å·¥å…·åŒ…ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒRipgrep æ˜¯é€šè¿‡ Shelling åˆ°å¦ä¸€ä¸ªè¿›ç¨‹æ¥è¿›è¡Œè§£å‹ç¼©çš„ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ rg -z license UNLICENSE.gz</span><br><span class="line">24:For more information, please refer to &lt;http://unlicense.org/&gt;</span><br></pre></td></tr></table></figure><blockquote><p>Ripgrep ç›®å‰ä¸ä¼šæœç´¢å­˜æ¡£æ ¼å¼ï¼Œå› æ­¤ä¼šè·³è¿‡ *.tar.gz æ–‡ä»¶ã€‚</p></blockquote><h4 id="è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½">è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½</h4><p>RipGrep æä¾›çš„äºŒè¿›åˆ¶åŒ…ä¸­é»˜è®¤æä¾›äº† SHELL è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ï¼Œåªéœ€æ ¹æ®ä¸åŒ SHELL æ”¾åˆ°å¯¹åº”ç›®å½•å³å¯ä½¿ç”¨äº†ã€‚</p><ul><li>Bash</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ mv rg.bash <span class="variable">$XDG_CONFIG_HOME</span>/bash_completion/</span><br><span class="line">æˆ–è€…</span><br><span class="line">$ mv rg.bash /etc/bash_completion.d/</span><br></pre></td></tr></table></figure><ul><li>ZSH</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mv _rg <span class="variable">$fpath</span>/</span><br></pre></td></tr></table></figure><ul><li>Fish</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mv rg.fish <span class="variable">$HOME</span>/.config/fish/completions/</span><br></pre></td></tr></table></figure><h3 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h3><p><a href="http://www.google.com" target="_blank" rel="noopener">http://www.google.com</a><br><a href="http://t.cn/ROI5tMv" target="_blank" rel="noopener">http://t.cn/ROI5tMv</a><br><a href="http://t.cn/Rs3caWW" target="_blank" rel="noopener">http://t.cn/Rs3caWW</a><br><a href="http://t.cn/Rs3F6Ty" target="_blank" rel="noopener">http://t.cn/Rs3F6Ty</a></p></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Ripgrep æ˜¯å‘½ä»¤è¡Œä¸‹ä¸€ä¸ªåŸºäºè¡Œçš„æœç´¢å·¥å…·ï¼ŒRipGrep ä½¿ç”¨ Rust å¼€å‘ï¼Œå¯ä»¥åœ¨å¤šå¹³å°ä¸‹è¿è¡Œï¼Œæ”¯æŒ Macã€Linux å’Œ Windows ç­‰å¹³å°ã€‚RipGrep ä¸ The Silver Searcherã€Ack å’Œ GNU Grep çš„åŠŸèƒ½ç±»ä¼¼ã€‚&lt;/p&gt;
&lt;p&gt;RipGrep å®˜æ–¹å·ç§°æ¯”å…¶å®ƒç±»ä¼¼å·¥å…·åœ¨æœç´¢é€Ÿåº¦ä¸Šå¿«ä¸Š N å€ï¼ŒVSCode ä¹Ÿä» &lt;a href=&quot;https://code.visualstudio.com/updates/v1_11#_text-search-improvements&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;1.11 ç‰ˆæœ¬&lt;/a&gt;å¼€å§‹é»˜è®¤å°† RipGrep åšä¸ºå…¶æœç´¢å·¥å…·ï¼Œç”±æ­¤å…¶åŠŸèƒ½å¼ºå¤§å¯è§ä¸€æ–‘ã€‚&lt;/p&gt;
&lt;p&gt;é¡¹ç›®åœ°å€ï¼š&lt;a href=&quot;https://github.com/BurntSushi/ripgrep&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/BurntSushi/ripgrep&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Ripgrep æ”¯æŒçš„ä¸€äº›ç‰¹æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‡ªåŠ¨é€’å½’æœç´¢ ï¼ˆgrep éœ€è¦ -Rï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è‡ªåŠ¨å¿½ç•¥ .gitignore ä¸­çš„æ–‡ä»¶ä»¥åŠäºŒè¿›åˆ¶æ–‡ä»¶å’Œéšè—æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;å¯ä»¥æœç´¢æŒ‡å®šæ–‡ä»¶ç±»å‹ï¼Œå¦‚ï¼š&lt;code&gt;rg -tpy foo&lt;/code&gt; åˆ™é™å®šåªæœç´¢ Python æ–‡ä»¶ï¼Œ&lt;code&gt;rg -Tjs foo&lt;/code&gt; åˆ™æ’é™¤æ‰ JS æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒå¤§éƒ¨åˆ† Grep çš„ ç‰¹æ€§ï¼Œä¾‹å¦‚ï¼šæ˜¾ç¤ºæœç´¢ç»“æœçš„ä¸Šä¸‹æ–‡ã€æ”¯æŒå¤šä¸ªæ¨¡å¼æœç´¢ã€é«˜äº®åŒ¹é…çš„æœç´¢ç»“æœä»¥åŠæ”¯æŒ Unicode ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒå„ç§æ–‡æœ¬ç¼–ç æ ¼å¼ï¼Œå¦‚ï¼šUTF-8ã€UTF-16ã€latin-1ã€GBKã€EUC-JPã€Shift_JIS ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒæœç´¢å¸¸è§æ ¼å¼çš„å‹ç¼©æ–‡ä»¶ï¼Œå¦‚ï¼šgzipã€xzã€lzmaã€bzip2ã€lz4 ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;è‡ªåŠ¨é«˜äº®åŒ¹é…çš„ç»“æœã€‚&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/categories/Linux/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="æŠ€å·§" scheme="https://www.hi-linux.com/tags/%E6%8A%80%E5%B7%A7/"/>
    
  </entry>
  
  <entry>
    <title>æ‰‹æŠŠæ‰‹æ•™ä½ æ‰“é€ é«˜æ•ˆçš„ Kubernetes å‘½ä»¤è¡Œç»ˆç«¯</title>
    <link href="https://www.hi-linux.com/posts/44953.html"/>
    <id>https://www.hi-linux.com/posts/44953.html</id>
    <published>2018-09-13T01:00:00.000Z</published>
    <updated>2018-09-13T02:34:56.000Z</updated>
    
    <content type="html"><![CDATA[<div id="vip-container"><p>Kubernetes ä½œä¸ºäº‘åŸç”Ÿæ—¶ä»£çš„æ“ä½œç³»ç»Ÿï¼Œç†Ÿæ‚‰å’Œä½¿ç”¨å®ƒæ˜¯æ¯åç”¨æˆ·çš„å¿…å¤‡æŠ€èƒ½ã€‚æœ¬æ–‡å°†ä»‹ç»ä¸€äº›æé«˜æ“ä½œ Kubernetes æ•ˆç‡çš„æŠ€å·§ä»¥åŠå¦‚ä½•æ‰“é€ ä¸€ä¸ªé«˜æ•ˆçš„ Kubernetes å‘½ä»¤è¡Œç»ˆç«¯çš„æ–¹æ³•ã€‚</p><h3 id="kubectl-è‡ªåŠ¨è¡¥å…¨">Kubectl è‡ªåŠ¨è¡¥å…¨</h3><p>Kubectl è¿™ä¸ªå‘½ä»¤è¡Œå·¥å…·éå¸¸é‡è¦ï¼Œä¸ä¹‹ç›¸å…³çš„å‘½ä»¤ä¹Ÿå¾ˆå¤šã€‚æˆ‘ä»¬ä¹Ÿè®°ä¸ä½é‚£ä¹ˆå¤šçš„å‘½ä»¤ï¼Œè€Œä¸”ä¹Ÿä¼šç»å¸¸å†™é”™ï¼Œæ‰€ä»¥å‘½ä»¤è¡Œè‡ªåŠ¨è¡¥å…¨æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚Kubectl å·¥å…·æœ¬èº«å°±æ”¯æŒè‡ªåŠ¨è¡¥å…¨ï¼Œåªéœ€ç®€å•è®¾ç½®ä¸€ä¸‹å³å¯ã€‚</p><ul><li>Bash ç”¨æˆ·</li></ul><p>å¤§å¤šæ•°ç”¨æˆ·çš„ Shell ä½¿ç”¨çš„æ˜¯ Bashï¼ŒLinux ç³»ç»Ÿå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥è®¾ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">"source &lt;(kubectl completion bash)"</span> &gt;&gt; ~/.bashrc</span><br><span class="line">$ <span class="built_in">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure><p>å¦‚æœå‘ç°ä¸èƒ½è‡ªåŠ¨è¡¥å…¨ï¼Œå¯ä»¥å°è¯•å®‰è£… <code>bash-completion</code> ç„¶ååˆ·æ–°å³å¯ï¼</p><ul><li>ZSH ç”¨æˆ·</li></ul><p>å¦‚æœä½ ä½¿ç”¨çš„ Shell æ˜¯ ZSHï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥è®¾ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">"source &lt;(kubectl completion zsh)"</span> &gt;&gt; ~/.zshrc</span><br><span class="line">$ <span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="äº¤äº’å¼-kubernetes-å®¢æˆ·ç«¯">äº¤äº’å¼ Kubernetes å®¢æˆ·ç«¯</h3><h4 id="kube-prompt">Kube-prompt</h4><p>Kube-prompt å¯ä»¥è®©ä½ åœ¨å‘½ä»¤è¡Œä¸‹æ¥å—ä¸ Kubectl ç›¸åŒçš„å‘½ä»¤ï¼Œå¹¶ä¸”ä¸éœ€è¦æä¾› Kubectlå‰ç¼€ã€‚Kube-prompt è¿˜æäº†äº¤äº’å¼ä¼šè¯ä¸‹çš„å‘½ä»¤æç¤ºã€è‡ªåŠ¨è¡¥å…¨ç­‰åŠŸèƒ½ã€‚</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/c-bata/kube-prompt" target="_blank" rel="noopener">https://github.com/c-bata/kube-prompt</a></p><p><strong>å®‰è£… Kube-prompt</strong></p><p>Kube-prompt ä½¿ç”¨ Go è¯­è¨€å¼€å‘ï¼Œå¤©ç”Ÿè‰¯å¥½çš„è·¨å¹³å°æ€§ã€‚å®‰è£…èµ·æ¥éå¸¸ç®€å•ï¼Œåªéœ€ä¸‹è½½å„å¹³å°å¯¹åº”çš„äºŒè¿›åˆ¶ç‰ˆæœ¬å°±å¯ä»¥å¼€ç®±å³ç”¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Linux</span><br><span class="line">$ wget https:&#x2F;&#x2F;github.com&#x2F;c-bata&#x2F;kube-prompt&#x2F;releases&#x2F;download&#x2F;v1.0.3&#x2F;kube-prompt_v1.0.3_linux_amd64.zip</span><br><span class="line">$ unzip kube-prompt_v1.0.3_linux_amd64.zip</span><br><span class="line"></span><br><span class="line"># macOS (darwin)</span><br><span class="line">$ wget https:&#x2F;&#x2F;github.com&#x2F;c-bata&#x2F;kube-prompt&#x2F;releases&#x2F;download&#x2F;v1.0.3&#x2F;kube-prompt_v1.0.3_darwin_amd64.zip</span><br><span class="line">$ unzip kube-prompt_v1.0.3_darwin_amd64.zip</span><br><span class="line"></span><br><span class="line"># ç»™ kube-prompt åŠ ä¸Šæ‰§è¡Œæƒé™å¹¶ç§»åŠ¨å¸¸ç”¨çš„å¯æœç´¢è·¯å¾„ã€‚</span><br><span class="line">$ chmod +x kube-prompt</span><br><span class="line">$ sudo mv .&#x2F;kube-prompt &#x2F;usr&#x2F;local&#x2F;bin&#x2F;kube-prompt</span><br></pre></td></tr></table></figure><p><strong>Kube-prompt ä½¿ç”¨æ•ˆæœå›¾</strong></p><p><img src="https://www.hi-linux.com/img/linux/kube-prompt.gif" alt=""></p><h4 id="kube-shell">Kube-shell</h4><p>Kube-shell å¯ä»¥ä¸º Kubectl æä¾›è‡ªåŠ¨çš„å‘½ä»¤æç¤ºå’Œè¡¥å…¨ï¼ŒKube-shell ä¸ Kube-prompt çš„ä½¿ç”¨æ–¹æ³•ç±»ä¼¼ã€‚</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/cloudnativelabs/kube-shell" target="_blank" rel="noopener">https://github.com/cloudnativelabs/kube-shell</a></p><p><strong>Kube-shell ç‰¹æ€§</strong></p><ul><li>å‘½ä»¤æç¤ºï¼Œç»™å‡ºå‘½ä»¤çš„ä½¿ç”¨è¯´æ˜ã€‚</li><li>è‡ªåŠ¨è¡¥å…¨ï¼Œåˆ—å‡ºå¯é€‰å‘½ä»¤å¹¶å¯ä»¥é€šè¿‡ TAB é”®è‡ªåŠ¨è¡¥å…¨ï¼Œæ”¯æŒæ¨¡ç³Šæœç´¢ã€‚</li><li>æ”¯æŒè¯­æ³•é«˜äº®ã€‚</li><li>ä½¿ç”¨ TAB é”®å¯ä»¥åˆ—å‡ºå¯é€‰çš„å¯¹è±¡ã€‚</li><li>æ”¯æŒ VIM æ¨¡å¼ã€‚</li></ul><p><strong>å®‰è£… Kube-shell</strong></p><p>Kube-shell å®‰è£…éå¸¸çš„ç®€å•ï¼Œä½¿ç”¨ PIP å°±å¯ä»¥ä¸€é”®å®‰è£…äº†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install kube-shell</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨ï¼škube-shell å¿…é¡»ç”¨ root ç”¨æˆ·è¿è¡Œã€‚å¦‚æœæ˜¯æ™®é€šç”¨æˆ·è¿è¡Œä¼šæŠ¥ <code>/bin/sh: 1: kubectl: not found</code> é”™è¯¯ã€‚å³ä½¿ä½¿ç”¨äº† <code>sudo  kube-shell</code> åŒæ ·ä¹Ÿæ˜¯ä¸è¡Œçš„ã€‚</p></blockquote><p><strong>Kube-shell ä½¿ç”¨æ•ˆæœå›¾</strong></p><p><img src="https://www.hi-linux.com/img/linux/kube-shell.gif" alt=""></p><blockquote><p>æ³¨ï¼šKube-prompt å’Œ Kube-shell æˆ‘éƒ½ä½¿ç”¨è¿‡ï¼Œæ›´æ¨è Kube-promptã€‚Go çš„åŸç”Ÿæ€§æ›´å¥½ä¸€äº›ï¼Œå¹¶ä¸” Kube-prompt ä¹Ÿä¸éœ€è¦ root æƒé™ã€‚</p></blockquote><h3 id="kubectl-aliases">Kubectl Aliases</h3><p>Kubectl Aliases æ˜¯ä¸€ä¸ªé€šè¿‡ç¼–ç¨‹æ–¹å¼ç”Ÿæˆçš„ Kubectl åˆ«åè„šæœ¬ã€‚å¦‚æœä½ éœ€è¦é¢‘ç¹åœ°ä½¿ç”¨ Kubectl å’Œ Kubernetes API è¿›è¡Œäº¤äº’ï¼Œä½¿ç”¨åˆ«åå°†ä¼šä¸ºä½ èŠ‚çœå¤§é‡çš„æ—¶é—´ã€‚</p><p>é¡¹ç›®åœ°å€: <a href="https://github.com/ahmetb/kubectl-aliases" target="_blank" rel="noopener">https://github.com/ahmetb/kubectl-aliases</a></p><p><strong>å®‰è£… Kubectl Aliases</strong></p><p>Kubectl Aliases å°±åªæ˜¯ä¸€ä¸ª SHELL è„šæœ¬ï¼Œä½ åªéœ€ç›´æ¥ä¸‹è½½ <code>.kubectl_aliases</code> æ–‡ä»¶å¹¶å°†å…¶ä¿å­˜åœ¨ <code>$HOME</code> ç›®å½•ä¸­ï¼Œç„¶ååœ¨ <code>SHELL</code> é…ç½®æ–‡ä»¶ä¸­è°ƒç”¨å³å¯ã€‚</p><ul><li>ä¸‹è½½è„šæœ¬</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> <span class="variable">$HOME</span></span><br><span class="line">$ wget https://raw.githubusercontent.com/ahmetb/kubectl-alias/master/.kubectl_aliases</span><br></pre></td></tr></table></figure><ul><li>é…ç½® SHELL</li></ul><p>Bash ç”¨æˆ·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ vim ~/.bashrc</span><br><span class="line"></span><br><span class="line">[ -f ~/.kubectl_aliases ] &amp;&amp; <span class="built_in">source</span> ~/.kubectl_aliases</span><br></pre></td></tr></table></figure><p>ZSH ç”¨æˆ·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ vim ~/.zshrc</span><br><span class="line"></span><br><span class="line">[ -f ~/.kubectl_aliases ] &amp;&amp; <span class="built_in">source</span> ~/.kubectl_aliases</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ æƒ³åœ¨è¿è¡Œä¹‹å‰æ‰“å°å®Œæ•´çš„ Kubectl å‘½ä»¤ï¼Œå¯ä»¥åŠ ä¸Šä»¥ä¸‹è¡Œã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">kubectl</span></span>() &#123; <span class="built_in">echo</span> <span class="string">"+ kubectl <span class="variable">$@</span>"</span>; <span class="built_in">command</span> kubectl <span class="variable">$@</span>; &#125;</span><br></pre></td></tr></table></figure><p><strong>Kubectl åˆ«åç”Ÿæˆè§„åˆ™</strong></p><p><img src="https://www.hi-linux.com/img/linux/kubectl-alias.jpeg" alt=""></p><p><strong>Kubectl åˆ«åä½¿ç”¨ç¤ºä¾‹</strong></p><ul><li>ç®€å•åˆ«åç¤ºä¾‹</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kd â†’ kubectl describe</span><br></pre></td></tr></table></figure><ul><li>é«˜çº§åˆ«åç¤ºä¾‹</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kgdepallw â†’ kubectl get deployment â€“all-namespaces â€“watch</span><br></pre></td></tr></table></figure><h3 id="kubeval">Kubeval</h3><p>å¦‚æœä½ æ‰‹åŠ¨å†™ Kubernetes manifest æ–‡ä»¶ï¼Œæ£€æŸ¥ manifest æ–‡ä»¶çš„è¯­æ³•æ˜¯å¦æœ‰è¯¯æ˜¯å¾ˆå›°éš¾çš„ï¼Œç‰¹åˆ«æ˜¯å½“ä½ æœ‰å¤šä¸ªä¸åŒç‰ˆæœ¬çš„ Kubernetes é›†ç¾¤æ—¶ï¼Œç¡®è®¤é…ç½®æ–‡ä»¶è¯­æ³•æ˜¯å¦æ­£ç¡®æ›´æ˜¯éš¾ä¸ŠåŠ éš¾ã€‚</p><p>Kubeval æ˜¯ä¸€ä¸ªç”¨äºæ ¡éªŒ Kubernetes YAML æˆ– JSON é…ç½®æ–‡ä»¶çš„å·¥å…·ï¼Œæ”¯æŒå¤šä¸ª Kubernetes ç‰ˆæœ¬ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è§£å†³ä¸å°‘çš„éº»çƒ¦ã€‚</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/garethr/kubeval" target="_blank" rel="noopener">https://github.com/garethr/kubeval</a></p><p><strong>Kubeval å®‰è£…</strong></p><p>Kubeval åŒæ ·æ˜¯ä¸€æ¬¾ä½¿ç”¨ Go è¯­è¨€å¼€å‘ï¼Œå¤©ç”Ÿè‰¯å¥½çš„è·¨å¹³å°æ€§ã€‚å®‰è£…èµ·æ¥éå¸¸ç®€å•ï¼Œåªéœ€ä¸‹è½½å„å¹³å°å¯¹åº”çš„äºŒè¿›åˆ¶ç‰ˆæœ¬å°±å¯ä»¥å¼€ç®±å³ç”¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Linux</span><br><span class="line">$ wget https:&#x2F;&#x2F;github.com&#x2F;garethr&#x2F;kubeval&#x2F;releases&#x2F;download&#x2F;0.7.1&#x2F;kubeval-linux-amd64.tar.gz</span><br><span class="line">$ tar xf kubeval-linux-amd64.tar.gz</span><br><span class="line"></span><br><span class="line"># macOS (darwin)</span><br><span class="line">$ wget https:&#x2F;&#x2F;github.com&#x2F;garethr&#x2F;kubeval&#x2F;releases&#x2F;download&#x2F;0.7.1&#x2F;kubeval-darwin-amd64.tar.gz</span><br><span class="line">$ tar xf kubeval-darwin-amd64.tar.gz</span><br><span class="line"></span><br><span class="line"># ç»™ kubeval åŠ ä¸Šæ‰§è¡Œæƒé™å¹¶ç§»åŠ¨å¸¸ç”¨çš„å¯æœç´¢è·¯å¾„ã€‚</span><br><span class="line">$ chmod +x kubeval</span><br><span class="line">$ sudo mv kubeval &#x2F;usr&#x2F;local&#x2F;bin</span><br></pre></td></tr></table></figure><p><strong>Kubeval ä½¿ç”¨ç¤ºä¾‹</strong></p><ul><li>Kubernetes manifest æ–‡ä»¶æ­£å¸¸çš„æƒ…å†µ</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ kubeval nginx-deployment.yaml</span><br><span class="line">The document nginx-deployment.yaml contains a valid Deployment</span><br></pre></td></tr></table></figure><ul><li>Kubernetes manifest æ–‡ä»¶ä¸æ­£å¸¸çš„æƒ…å†µ</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ kubeval nginx.yaml</span><br><span class="line"></span><br><span class="line">The document nginx.yaml contains an invalid Deployment</span><br><span class="line">---&gt; spec.replicas: Invalid type. Expected: integer, given: string</span><br></pre></td></tr></table></figure><h3 id="å…¶å®ƒä¸€äº›å®ç”¨å·¥å…·">å…¶å®ƒä¸€äº›å®ç”¨å·¥å…·</h3><p>ä¸‹é¢è¿™å‡ ä¸ªå·¥å…·ä¹ŸæŒºä¸é”™çš„ï¼Œä½¿ç”¨èµ·æ¥éƒ½å¾ˆç®€å•ã€‚å°±ä¸å±•å¼€è®²äº†ï¼Œå¦‚æœæœ‰å…´è¶£å¯ä»¥å»çœ‹ä¸‹å®˜æ–¹æ–‡æ¡£å…·ä½“çš„ä½¿ç”¨æ–¹æ³•ã€‚</p><ul><li>Kube-ps1</li></ul><p>è¯¥å·¥å…·ä¸»è¦ä½œç”¨ä¸ºå‘½ä»¤è¡Œç»ˆç«¯å¢åŠ ä¸€ä¸ªæç¤ºç¬¦ã€‚</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/jonmosco/kube-ps1" target="_blank" rel="noopener">https://github.com/jonmosco/kube-ps1</a></p><p>Kube-ps1 ä½¿ç”¨æ•ˆæœå›¾</p><p><img src="https://www.hi-linux.com/img/linux/kube-ps1.gif" alt=""></p><ul><li>Kubectx</li></ul><p>è¯¥å·¥å…·ä¸»è¦ä½œç”¨æ˜¯å¿«é€Ÿåœ¨å¤šä¸ª Kubernetes é›†ç¾¤ä¸­åˆ‡æ¢ã€‚</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/ahmetb/kubectx" target="_blank" rel="noopener">https://github.com/ahmetb/kubectx</a></p><p>Kubectx ä½¿ç”¨æ•ˆæœå›¾</p><p><img src="https://www.hi-linux.com/img/linux/kubectx-demo.gif" alt=""></p><ul><li>Kubens</li></ul><p>è¯¥å·¥å…·å¯ä»¥å¸®åŠ©æ‚¨å¿«é€Ÿçš„åœ¨ Kubernetes çš„å¤šä¸ªå‘½åç©ºé—´ä¹‹é—´åˆ‡æ¢ã€‚</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/ahmetb/kubectx" target="_blank" rel="noopener">https://github.com/ahmetb/kubectx</a></p><p>Kubens ä½¿ç”¨æ•ˆæœå›¾</p><p><img src="https://www.hi-linux.com/img/linux/kubens-demo.gif" alt=""></p><h3 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h3><p><a href="http://www.google.com" target="_blank" rel="noopener">http://www.google.com</a><br><a href="http://t.cn/RD6vxGf" target="_blank" rel="noopener">http://t.cn/RD6vxGf</a><br><a href="http://t.cn/RD6vbc1" target="_blank" rel="noopener">http://t.cn/RD6vbc1</a></p></div><script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script><script>var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if (!isMobile) {    var btw = new BTWPlugin();    btw.init({        "id": "vip-container",        "blogId": "10135-1588830050631-449",        "name": "ã€Œå¥‡å¦™çš„ Linux ä¸–ç•Œã€",        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",        "keyword": "VIP"    });}</script>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Kubernetes ä½œä¸ºäº‘åŸç”Ÿæ—¶ä»£çš„æ“ä½œç³»ç»Ÿï¼Œç†Ÿæ‚‰å’Œä½¿ç”¨å®ƒæ˜¯æ¯åç”¨æˆ·çš„å¿…å¤‡æŠ€èƒ½ã€‚æœ¬æ–‡å°†ä»‹ç»ä¸€äº›æé«˜æ“ä½œ Kubernetes æ•ˆç‡çš„æŠ€å·§ä»¥åŠå¦‚ä½•æ‰“é€ ä¸€ä¸ªé«˜æ•ˆçš„ Kubernetes å‘½ä»¤è¡Œç»ˆç«¯çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;h3 id=&quot;Kubectl-è‡ªåŠ¨è¡¥å…¨&quot;&gt;Kubectl è‡ªåŠ¨è¡¥å…¨&lt;/h3&gt;
&lt;p&gt;Kubectl è¿™ä¸ªå‘½ä»¤è¡Œå·¥å…·éå¸¸é‡è¦ï¼Œä¸ä¹‹ç›¸å…³çš„å‘½ä»¤ä¹Ÿå¾ˆå¤šã€‚æˆ‘ä»¬ä¹Ÿè®°ä¸ä½é‚£ä¹ˆå¤šçš„å‘½ä»¤ï¼Œè€Œä¸”ä¹Ÿä¼šç»å¸¸å†™é”™ï¼Œæ‰€ä»¥å‘½ä»¤è¡Œè‡ªåŠ¨è¡¥å…¨æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚Kubectl å·¥å…·æœ¬èº«å°±æ”¯æŒè‡ªåŠ¨è¡¥å…¨ï¼Œåªéœ€ç®€å•è®¾ç½®ä¸€ä¸‹å³å¯ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Bash ç”¨æˆ·&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¤§å¤šæ•°ç”¨æˆ·çš„ Shell ä½¿ç”¨çš„æ˜¯ Bashï¼ŒLinux ç³»ç»Ÿå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥è®¾ç½®ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;source &amp;lt;(kubectl completion bash)&quot;&lt;/span&gt; &amp;gt;&amp;gt; ~/.bashrc&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;built_in&quot;&gt;source&lt;/span&gt; ~/.bashrc&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¦‚æœå‘ç°ä¸èƒ½è‡ªåŠ¨è¡¥å…¨ï¼Œå¯ä»¥å°è¯•å®‰è£… &lt;code&gt;bash-completion&lt;/code&gt; ç„¶ååˆ·æ–°å³å¯ï¼&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ZSH ç”¨æˆ·&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœä½ ä½¿ç”¨çš„ Shell æ˜¯ ZSHï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æ¥è®¾ç½®ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;source &amp;lt;(kubectl completion zsh)&quot;&lt;/span&gt; &amp;gt;&amp;gt; ~/.zshrc&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;built_in&quot;&gt;source&lt;/span&gt; ~/.zshrc&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="Kubernetes" scheme="https://www.hi-linux.com/categories/kubernetes/"/>
    
    
      <category term="Linux" scheme="https://www.hi-linux.com/tags/Linux/"/>
    
      <category term="Kubernetes" scheme="https://www.hi-linux.com/tags/Kubernetes/"/>
    
  </entry>
  
</feed>
