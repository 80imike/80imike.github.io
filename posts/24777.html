<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="Linux,运维,Nginx,Zabbix,Centos,Ansible,MySQL,Python,Docker,ELK,Haproxy,Git,Nodejs,安全,技术">
    <link rel="shortcut icon" href="/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <title>
        
          Vagrantfile 配置技巧 - 运维之美
        
    </title>

    <link rel="canonical" href="https://www.hi-linux.com/posts/24777.html">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS --> 
    <link rel="stylesheet" href="/css/beantech.min.css">
    
    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css">

    <link rel="stylesheet" href="/css/widget.css">

    <link rel="stylesheet" href="/css/rocket.css">

    <link rel="stylesheet" href="/css/signature.css">

    <link rel="stylesheet" href="/css/toc.css">

    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('/img/header_img/article.jpg')
            /*post*/
        
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#技巧" title="技巧">技巧</a>
                            
                              <a class="tag" href="/tags/#Vagrant" title="Vagrant">Vagrant</a>
                            
                        </div>
                        <h1>Vagrantfile 配置技巧</h1>
                        <h2 class="subheading"></h2>
                        <span class="meta">
                            Posted by Mike on
                            2016-03-15
                        </span>
                    </div>
                


                </div>
            </div>
        </div>
    </div>
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">运维之美</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Modify by Yu-Hsuan Yen -->

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <p>Vagrantfile，官方解释是这样的：The primary function of the Vagrantfile is to describe the type of machine required for a project, and how to configure and provision these machines。简单来说就是配置这个虚拟主机网络连接方式，端口转发，同步文件夹，以及怎么和puppet，chef结合的一个配置文件。执行完$ vagrant init后,在工作目录中,你会发现此文件。</p>
<h3 id="note配置版本说明">NOTE：配置版本说明：</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> |config|</span><br><span class="line">  <span class="comment"># ...</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<blockquote>
<p>当前支持的两个版本:“1&quot;和&quot;2”. “1”：描述是Vagrant 1.0.x的配置（如看到Vagrant::Config.run do |config| 此也为Vagrant 1.0.x 的配置）；“2”：描述的是1.1+ leading up to 2.0.x的配置。vagrant 1.1+ 的Vagrantfiles能够与vagrant 1.0.x的Vagrantfiles保持向后兼容，也大幅引入新的功能和配置选项。</p>
</blockquote>
<h3 id="vagrant基本设定">Vagrant基本设定<a id="more"></a></h3>
<h4 id="设定vm的名称及记忆体">设定VM的名称及记忆体</h4>
<p>用你最喜欢的编辑器打开vagrantfile，vagrantfile是个有着详细解释的设定档，在这个档案中所有的设定都被Vagrant::Config.run的Block包起来，在一开始只会有box的设定：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config.vm.box = <span class="string">"ubuntu-12-10"</span></span><br></pre></td></tr></table></figure>
<p>这告诉了Vagrant要去使用哪个Box作为环境，也就是你一开始输入varant init Box名称时所指定的Box，如果没有输入Box名称的话就会是预设的base，Virtual Box本身提供了VBoxManage这个command line tool让你可以设定你的VM，用modifyvm这个指令让你可以设定VM的名称及记忆体大小等等，这里说的名称指的是在Virtual Box中显示的名称，我们也可以在vagrantfile中进行设定，在你的vagrantfile中加入这行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config.vm.customize  [ <span class="string">"modifyvm"</span> ,  :id ,  <span class="string">"--name"</span> ,  <span class="string">"Mike"</span> ,  <span class="string">"--memory"</span> ,  <span class="string">"512"</span> ]</span><br></pre></td></tr></table></figure>
<p>这行设定档意思就是呼叫VBoxManage的modifyvm的指令，设定VM的名称为Mike，而设定VM的记忆体大小为512MB，你可以照这这种作法为你的VM设定好不同的设定。</p>
<h4 id="设定hostname">设定Hostname</h4>
<p>设定hostname非常简单，设定中加入下面这行就好</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config.vm.host_name = <span class="string">"Mike-App"</span></span><br></pre></td></tr></table></figure>
<p>设定hostname非常重要，有很多服务都仰赖着hostname来做为辨识，例如Puppet或是Chef，一般一些监控服务像是New Relic之类的也都是以hostname来做为辨识。</p>
<h3 id="配置网络">配置网络</h3>
<p>本文将提供2种版本的常用配置，其中版本2的配置经过实践验证。</p>
<h4 id="端口转发">端口转发</h4>
<p>假设虚拟机的80端口提供web服务，此处将通过访问物理机的8080端口转发到虚拟机的80端口，来实现web的访。开启host_only可直接访问虚拟机端口。</p>
<p>版本&quot;2&quot;：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> |config|</span><br><span class="line">  config.vm.network :forwarded_port, guest: 80, host: 8080</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<blockquote>
<p>guest:80 表示虚拟机中的80端口，host:8080表示映射到宿主机的8080端口。</p>
</blockquote>
<p>版本&quot;1&quot;:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Vagrant::Config.run <span class="keyword">do</span> |config|</span><br><span class="line">  <span class="comment"># Forward guest port 80 to host port 8080</span></span><br><span class="line">  config.vm.forward_port 80, 8080</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h4 id="桥接网络">桥接网络</h4>
<p>公共网络，局域网DHCP服务器自动分配IP。如果需要将虚拟机作为当前局域网中的一台计算机，由局域网进行DHCP，那么在Vagrantfile中配置：</p>
<p>版本&quot;2&quot;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> |config|</span><br><span class="line">  config.vm.network :public_network</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>版本&quot;1&quot;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Vagrant::Config.run <span class="keyword">do</span> |config|</span><br><span class="line">  config.vm.network :bridged</span><br><span class="line">end</span><br><span class="line">  $ VBoxManage list bridgedifs | grep ^Name    <span class="comment">#可通过此命令查看本机的网卡</span></span><br><span class="line">    Name:            eth0</span><br><span class="line"></span><br><span class="line">指定网卡，配置可写为如下：</span><br><span class="line"></span><br><span class="line">Vagrant::Config.run <span class="keyword">do</span> |config|</span><br><span class="line">  config.vm.network :bridged, :bridge =&gt; <span class="string">"eth0"</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h4 id="私有网络">私有网络</h4>
<p>允许多个虚拟机通过主机通过网络互相通信，vagrant允许用户分配一个静态IP，然后使用私有网络设置。</p>
<p>Vagrant默认是使用端口映射方式将虚拟机的端口映射本地从而实现类似<a href="http://localhost:80" target="_blank" rel="noopener">http://localhost:80</a>这种访问方式，这种方式比较麻烦。如果需要自己自由的访问虚拟机，但是别人不需要访问虚拟机，可以使用private_network，比起端口映射新开和修改端口的时候都得编辑相比较而言，host-only模式显得方便多了。</p>
<p>打开Vagrantfile，将下面这行的注释去掉(移除#)并保存：</p>
<p>版本&quot;2&quot;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> |config|</span><br><span class="line">  config.vm.network :private_network, ip: <span class="string">"192.168.50.4"</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>版本&quot;1&quot;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Vagrant::Config.run <span class="keyword">do</span> |config|</span><br><span class="line">  config.vm.network :hostonly, <span class="string">"192.168.50.4"</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>重启虚拟机，这样我们就能用 192.168.50.4访问这台机器了，你可以把IP 改成其他地址，只要不产生冲突就行。多台虚拟机的话需要互相访问的话，设置在相同网段即可。</p>
<h3 id="同步文件夹">同步文件夹</h3>
<p>默认的，vagrant将共享你的工作目录(即Vagrantfile所在的目录)到虚拟机中的/vagrant,所以一般不需配置即可，如你需要可配置：</p>
<p>版本&quot;1&quot;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config.vm.share_folder <span class="string">"v-data"</span>, <span class="string">"/data"</span>, <span class="string">"data"</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>把这一行的注释去掉，如上所说，第一个是个标志，第二个是你虚拟机里挂载的目录，第三个就是物理机的目录了，位置相对于Vagrantfile。这个目录是777的，可以随意修改删除，所有操作在虚拟机和本机都是同步的。</p>
</blockquote>
<p>版本&quot;2&quot;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> |config|</span><br><span class="line">  <span class="comment"># other config here</span></span><br><span class="line">  config.vm.synced_folder <span class="string">"src/"</span>, <span class="string">"/srv/website"</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<blockquote>
<p>第一个参数&quot;src/“是你的宿主机目录，可以用相对目录(位置相对于Vagrantfile)，这里也可以使用绝对路径，比如：“d:/www/”。第二个参数”/srv/website&quot;是客户机的挂载的绝对目录。</p>
</blockquote>
<h3 id="vagrant和shell">vagrant和shell</h3>
<p>实现在虚拟机启动的时候自运行需要的shell命令或脚本</p>
<h4 id="版本quot2quot">版本&quot;2&quot;</h4>
<ul>
<li>内嵌脚本：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> |config|</span><br><span class="line">  config.vm.provision :shell,</span><br><span class="line">    :inline =&gt; <span class="string">"echo Hello, World"</span></span><br><span class="line">end</span><br><span class="line"></span><br><span class="line"><span class="comment">#复杂点的调用如下：</span></span><br><span class="line"><span class="variable">$script</span> = &lt;&lt;SCRIPT</span><br><span class="line"><span class="built_in">echo</span> I am provisioning...</span><br><span class="line">date &gt; /etc/vagrant_provisioned_at</span><br><span class="line">SCRIPT</span><br><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> |config|</span><br><span class="line">  config.vm.provision :shell, :inline =&gt; <span class="variable">$script</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<ul>
<li>外部脚本:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> |config|</span><br><span class="line">  config.vm.provision :shell, :path =&gt; <span class="string">"script.sh"</span>      <span class="comment">#脚本的路径相对于项目根，也可使用绝对路径</span></span><br><span class="line">end</span><br><span class="line"></span><br><span class="line"><span class="comment">#脚本可传递参数：</span></span><br><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> |config|</span><br><span class="line">  config.vm.provision :shell <span class="keyword">do</span> |s|</span><br><span class="line">    s.inline = <span class="string">"echo <span class="variable">$1</span>"</span></span><br><span class="line">    s.args   = <span class="string">"'hello, world!'"</span></span><br><span class="line">  end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h4 id="版本quot1quot">版本&quot;1&quot;:</h4>
<ul>
<li>内部脚本：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> Vagrant::Config.run <span class="keyword">do</span> |config|</span><br><span class="line">  config.vm.provision :shell, :inline =&gt; <span class="string">"echo abc &gt; /tmp/test"</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<ul>
<li>外部脚本：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Vagrant::Config.run <span class="keyword">do</span> |config|</span><br><span class="line">  config.vm.provision :shell, :path =&gt; <span class="string">"test.sh"</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<ul>
<li>脚本可传递参数：</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Vagrant::Config.run <span class="keyword">do</span> |config|</span><br><span class="line">  config.vm.provision :shell <span class="keyword">do</span> |shell|</span><br><span class="line">    shell.inline = <span class="string">"echo <span class="variable">$1</span> &gt; /tmp/test"</span></span><br><span class="line">    shell.args = <span class="string">"'this is test'"</span></span><br><span class="line">  end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h4 id="实例">实例</h4>
<p>虽然不是必须，但是如果有需要在启动时运行一些脚本(环境的安装或者有些服务的启动需要在完成目录映射之后进行)，可以编辑脚本，类似如下(摘自Vagrant Document)：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env bash</span></span><br><span class="line">	</span><br><span class="line">apt-get update</span><br><span class="line">apt-get install -y apache2</span><br><span class="line">rm -rf /var/www</span><br><span class="line">ln -fs /vagrant /var/www</span><br></pre></td></tr></table></figure>
<p>保存在和Vagrantfile相同目录，文件名自取(<a href="http://xn--boot-f96g.sh" target="_blank" rel="noopener">如boot.sh</a>），然后在Vagrantfile中添加：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">config.vm.provision :shell, :path =&gt; <span class="string">"boot.sh"</span></span><br></pre></td></tr></table></figure>
<p>当初次使用基本的设置都完成则之后，则可以使用 vagrant up启动虚拟机</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Bringing machine <span class="string">'default'</span> up with <span class="string">'virtualbox'</span> provider...</span><br><span class="line">[default] Setting the name of the VM...</span><br><span class="line">[default] Clearing any previously <span class="built_in">set</span> forwarded ports...</span><br><span class="line">[default] Creating shared folders metadata...</span><br><span class="line">[default] Clearing any previously <span class="built_in">set</span> network interfaces...</span><br><span class="line">[default] Preparing network interfaces based on configuration...</span><br><span class="line">[default] You are trying to forward to privileged ports (ports &lt; = 1024). Most operating systems restrict this to only privileged process (typicallyprocesses running as an administrative user). This is a warning <span class="keyword">in</span> <span class="keyword">case</span></span><br><span class="line">the port forwarding doesn<span class="string">'t work. If any problems occur, please try a port higher than 1024.</span></span><br><span class="line"><span class="string">[default] Forwarding ports...</span></span><br><span class="line"><span class="string">[default] -- 22 =&gt; &lt;strong&gt;2222&lt;/strong&gt; (adapter 1)</span></span><br><span class="line"><span class="string">[default] -- 80 =&gt; 8080 (adapter 1)</span></span><br><span class="line"><span class="string">[default] Booting VM...</span></span><br><span class="line"><span class="string">[default] Waiting for VM to boot. This can take a few minutes.</span></span><br><span class="line"><span class="string">[default] VM booted and ready for use!</span></span><br><span class="line"><span class="string">[default] The guest additions on this VM do not match the installed version of VirtualBox! In most cases this is fine, but in rare cases it can cause things such as shared folders to not work properly. If you see shared folder errors, please update the guest additions within the virtual machine and reload your VM.</span></span><br><span class="line"><span class="string">	</span></span><br><span class="line"><span class="string">Guest Additions Version: 4.1.18</span></span><br><span class="line"><span class="string">VirtualBox Version: 4.2</span></span><br><span class="line"><span class="string">[default] Mounting shared folders...</span></span><br><span class="line"><span class="string">[default] -- /var/www</span></span><br><span class="line"><span class="string">[default] -- /vagrant</span></span><br><span class="line"><span class="string">[default] Running provisioner: shell...</span></span><br></pre></td></tr></table></figure>
<h3 id="vagrant和puppet">vagrant和puppet</h3>
<p>puppet相关介绍:<a href="http://xuclv.blog.51cto.com/blog/5503169/1154261" target="_blank" rel="noopener">http://xuclv.blog.51cto.com/blog/5503169/1154261</a></p>
<ul>
<li>vagrant调用puppet单独使用</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> |config|</span><br><span class="line">  config.vm.provision :puppet <span class="keyword">do</span> |puppet|</span><br><span class="line">    puppet.manifests_path = <span class="string">"my_manifests"</span><span class="comment">#路径相对于项目根，如无配置此项，默认为manifests</span></span><br><span class="line">    puppet.manifest_file = <span class="string">"default.pp"</span>      <span class="comment">#如无配置此项，默认为default.pp</span></span><br><span class="line">    puppet.module_path = <span class="string">"modules"</span>        <span class="comment">#路径相对于根</span></span><br><span class="line">    puppet.options = <span class="string">"--verbose --debug"</span></span><br><span class="line">  end</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">默认配置的目录结构：</span><br><span class="line"> $ tree</span><br><span class="line">  .</span><br><span class="line">  |-- Vagrantfile</span><br><span class="line">  |-- manifests</span><br><span class="line">  |   |-- default.pp</span><br></pre></td></tr></table></figure>
<ul>
<li>vagrant让puppet作为代理，连接Puppet master</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span>|config|</span><br><span class="line">config.vm.provision :puppet_server <span class="keyword">do</span>|puppet|</span><br><span class="line">puppet.puppet_server = <span class="string">"puppet.example.com"</span><span class="comment">#master域名</span></span><br><span class="line">puppet.puppet_node = <span class="string">"node.example.com"</span><span class="comment">#传递给puppet服务器节点的名称。默认为”puppet“</span></span><br><span class="line">puppet.options = <span class="string">"--verbose --debug"</span><span class="comment">#选项</span></span><br><span class="line">end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<blockquote>
<p>NOTE：<br>
版本1配置差别不大，不再详述，区别：<code>Vagrant.configure(&quot;2&quot;) do |config|</code>改为<code>Vagrant::Config.run do |config|</code><br>
以上Vagrantfile配置完毕后，可<code>$vagrant reload</code>重启虚拟机以来实现配置生效</p>
</blockquote>
<ul>
<li>官方实例：</li>
</ul>
<p>1.进入工作目录<br>
2.修改Vagrantfile</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$vim</span> Vagrantfile    </span><br><span class="line"><span class="comment">#启用或添加如下行：</span></span><br><span class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> |config|</span><br><span class="line">  config.vm.provision :puppet    <span class="comment">#这里没有配置pp文件等的路径，全部采用默认</span></span><br><span class="line">  end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>3.创建puppet的主目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$mkdir</span> manifests</span><br></pre></td></tr></table></figure>
<p>4.配置pp文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ vim manifests/default.pp</span><br><span class="line"><span class="comment"># Basic Puppet Apache manifest</span></span><br><span class="line">class apache &#123;</span><br><span class="line">  <span class="built_in">exec</span> &#123; <span class="string">'apt-get update'</span>:</span><br><span class="line">    <span class="built_in">command</span> =&gt; <span class="string">'/usr/bin/apt-get update'</span></span><br><span class="line">  &#125;</span><br><span class="line">  package &#123; <span class="string">"apache2"</span>:</span><br><span class="line">    ensure =&gt; present,</span><br><span class="line">  &#125;</span><br><span class="line">  service &#123; <span class="string">"apache2"</span>:</span><br><span class="line">    ensure =&gt; running,</span><br><span class="line">    require =&gt; Package[<span class="string">"apache2"</span>],</span><br><span class="line">  &#125;</span><br><span class="line">  file &#123; <span class="string">'/var/www'</span>:</span><br><span class="line">    ensure =&gt; link,</span><br><span class="line">    target =&gt; <span class="string">"/vagrant"</span>,</span><br><span class="line">    notify =&gt; Service[<span class="string">'apache2'</span>],</span><br><span class="line">    force  =&gt; <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">include apache</span><br></pre></td></tr></table></figure>
<p>5.重启虚拟机</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#重启后可看到虚拟机中已经安装好了apache</span></span><br><span class="line">$ vagrant reload</span><br></pre></td></tr></table></figure>
<h3 id="多虚拟机配置">多虚拟机配置</h3>
<ul>
<li>配置语法</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">VAGRANTFILE_API_VERSION = <span class="string">"2"</span>    <span class="comment">#定义版本</span></span><br><span class="line">Vagrant.configure(VAGRANTFILE_API_VERSION) <span class="keyword">do</span> |config|  <span class="comment">#使用内部2版本</span></span><br><span class="line">  config.vm.define :debian1 <span class="keyword">do</span> |debian1|   <span class="comment">#定义第一台虚拟机，||里面就类似一个变量设置参数时使用 </span></span><br><span class="line">     debian1.vm.box = <span class="string">"debian1"</span>             <span class="comment">#设置box名为debian1</span></span><br><span class="line">     debian1.vm.host_name = <span class="string">"debian1"</span>      <span class="comment">#设置hostname为debian1</span></span><br><span class="line">     debian1.vm.network :private_network, ip: <span class="string">"192.168.1.11"</span> <span class="comment">#设置网络为内部网络 ip为192.168.1.11</span></span><br><span class="line">  end</span><br><span class="line">  config.vm.define :debian2 <span class="keyword">do</span> |debian2|</span><br><span class="line">     debian2.vm.box = <span class="string">"debian2"</span></span><br><span class="line">     debian2.vm.host_name = <span class="string">"debian2"</span></span><br><span class="line">     debian2.vm.network :private_network, ip: <span class="string">"192.168.1.12"</span></span><br><span class="line">  end</span><br><span class="line">  config.vm.define :debian3 <span class="keyword">do</span> |debian3|</span><br><span class="line">     debian3.vm.box = <span class="string">"debian3"</span></span><br><span class="line">     debian3.vm.host_name = <span class="string">"debian3"</span></span><br><span class="line">     debian3.vm.network :private_network, ip: <span class="string">"192.168.1.13"</span></span><br><span class="line">  end</span><br><span class="line"></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<blockquote>
<p>这里定义一个debian1、debian2、debian3三个虚拟机，并设置主机名、私有网络和IP地址。<br>
注意：配置前关闭虚拟机，配置完后打开虚拟机。注意define用法，原单台机器的设定必须先清除或是注解掉。</p>
</blockquote>
<ul>
<li>实例</li>
</ul>
<p>让我们开始打造多机器环境</p>
<p>现在我们要建立多个VM，并且让他们互相沟通，一台Application、一台DB。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">config.vm.define:app <span class="keyword">do</span> |app_config| </span><br><span class="line">    app_config.vm.customize  [ <span class="string">"modifyvm"</span> ,  :id ,  <span class="string">"--name"</span> ,  <span class="string">"app"</span> ,  <span class="string">"--memory"</span> ,  <span class="string">"512"</span> ] </span><br><span class="line">    app_config.vm.box  =  <span class="string">"ubuntu-12-10"</span> </span><br><span class="line">    app_config.vm.host_name  =  <span class="string">"app"</span> </span><br><span class="line">    app_config.vm.network  :hostonly ,  <span class="string">"33.33.13.10"</span> </span><br><span class="line">end </span><br><span class="line">config.vm.define:db <span class="keyword">do</span> |db_config| </span><br><span class="line">  db_config.vm.customize  [ <span class="string">"modifyvm"</span> ,  :id ,  <span class="string">"--name"</span> ,  <span class="string">"db"</span> ,  <span class="string">"--memory"</span> ,  <span class="string">"512"</span> ] </span><br><span class="line">  db_config.vm.box  =  <span class="string">"ubuntu-12-10"</span> </span><br><span class="line">  db_config.vm.host_name  =  <span class="string">"db"</span> </span><br><span class="line">  db_config.vm.network  :hostonly ,  <span class="string">"33.33.13.11"</span> </span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>这边的设定了app以及db两个VM的，并且给予不同的hostname和IP，设定好了以后再使用vagrant up将机器跑起来：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$vagrant</span>  up </span><br><span class="line">[ app ]  Importing  base  box  <span class="string">'ubuntu-12-10'</span> . . . </span><br><span class="line">[ app ]  Matching  MAC  address  <span class="keyword">for</span>  NAT  networking . . . </span><br><span class="line">[ app ]  Clearing  any  previously  <span class="built_in">set</span>  forwarded  ports . . . </span><br><span class="line">[ app ]  Forwarding  ports . . . </span><br><span class="line">[ app ]  --  22  =&gt;  2222  ( adapter  1 ) </span><br><span class="line">[ app ]  --  80  =&gt;  8080  ( adapter  1 ) </span><br><span class="line">[ app ]  Creating  shared  folders  metadata . . . </span><br><span class="line">[ app ]  Clearing  any  previously  <span class="built_in">set</span>  network  interfaces . . . </span><br><span class="line">[ app ]  Preparing  network  interfaces  based  on  configuration . . . </span><br><span class="line">[ app ]  Running  any  VM  customizations . . . </span><br><span class="line">[ app ]  Booting  VM . . . </span><br><span class="line">[ app ]  Waiting  <span class="keyword">for</span>  VM  to  boot .  This  can  take  a  few  minutes . </span><br><span class="line">[ app ]  VM  booted  and  ready  <span class="keyword">for</span>  use! </span><br><span class="line">[ app ]  Configuring  and  enabling  network  interfaces . . . </span><br><span class="line">[ app ]  Setting  host  name . . . </span><br><span class="line">[ app ]  Mounting  shared  folders . . . </span><br><span class="line">[ app ]  --  v - root :  /vagrant </span><br><span class="line">[db] Importing base box <span class="string">'ubuntu-12-10'</span>... </span><br><span class="line">[db] Matching MAC address <span class="keyword">for</span> NAT networking... </span><br><span class="line">[db] Clearing any previously <span class="built_in">set</span> forwarded ports... </span><br><span class="line">[db] Fixed port collision <span class="keyword">for</span> 22 =&gt; 2222. Now on port 2200. </span><br><span class="line">[db] Fixed port collision <span class="keyword">for</span> 22 =&gt; 2222. Now on port 2201. </span><br><span class="line">[db] Forwarding ports... </span><br><span class="line">[db] -- 22 =&gt; 2201 (adapter 1) </span><br><span class="line">[db] Creating shared folders metadata... </span><br><span class="line">[db] Clearing any previously <span class="built_in">set</span> network interfaces... </span><br><span class="line">[db] Preparing network interfaces based on configuration... </span><br><span class="line">[db] Running any VM customizations... </span><br><span class="line">[db] Booting VM... </span><br><span class="line">[db] Waiting <span class="keyword">for</span> VM to boot . This can take a few minutes. </span><br><span class="line">[db] VM booted and ready <span class="keyword">for</span> use! </span><br><span class="line">[db] Configuring and enabling network interfaces... </span><br><span class="line">[db] Setting host name... </span><br><span class="line">[db] Mounting shared folders... </span><br><span class="line">[db] -- v-root: / vagrant</span><br></pre></td></tr></table></figure>
<p>看到上面的信息完后，你就可以跟刚刚一样使用ssh连到VM里，多虚拟机环境下须加上你所指定的角色告诉你要连线的机器是哪一台：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$vagrant</span> ssh app </span><br><span class="line">vagrant@app :~ $ </span><br><span class="line"></span><br><span class="line"><span class="variable">$vagrant</span> ssh db </span><br><span class="line">vagrant@db :~ $</span><br></pre></td></tr></table></figure>
<p>验证VM之间的访问，让我们使用ssh登入db的机器，然后在db的机器上使用ssh来连线到app的机器(预设密码就是vagrant)：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$vagrant</span> ssh db </span><br><span class="line">vagrant @db :~ $  ssh  33 . 33 . 13 . 10 </span><br><span class="line">The  authenticity  of  host  <span class="string">'33.33.13.10 (33.33.13.10)'</span>  can <span class="string">'t be established. </span></span><br><span class="line"><span class="string">ECDSA key fingerprint is a7:71:36:4c: 01:4a:38:a2:fc:fa:ea:d7:67:63:3c:40. </span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no)? yes </span></span><br><span class="line"><span class="string">Warning: Permanently added '</span> 33 . 33 . 13 . 10 <span class="string">' (ECDSA) to the list of known hosts. </span></span><br><span class="line"><span class="string">vagrant@33.33.13.10'</span> s  password : </span><br><span class="line">vagrant @app :~ $</span><br></pre></td></tr></table></figure>
<h3 id="其它技巧">其它技巧</h3>
<p>使用 Apache/Nginx 时会出现诸如图片修改后但页面刷新仍然是旧文件的情况，是由于静态文件缓存造成的。需要对虚拟机里的 Apache/Nginx 配置文件进行修改：</p>
<ul>
<li>Apache 配置添加:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EnableSendfile off</span><br></pre></td></tr></table></figure>
<ul>
<li>Nginx 配置添加:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sendfile off;</span><br></pre></td></tr></table></figure>
                

                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/posts/20834.html" data-toggle="tooltip" data-placement="top" title="批量杀死 MySQL 连接的几种方法">&larr; Previous Post</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/posts/10407.html" data-toggle="tooltip" data-placement="top" title="JBOSS 6 中发布数据源">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                <!-- duoshuo Share start -->
                
                <!-- 多说 Share end-->

                <!-- 多说评论框 start -->
                
                <!-- 多说评论框 end -->

                <!-- disqus comment start -->
                
                <!-- disqus comment end -->

                
                    <!-- disqus 评论框 start -->
                    <div class="comment">
                        <div id="lv-container" data-id="city" data-uid="MTAyMC8yNzg2My80NDQw"></div>
                    </div>
                    <!-- disqus 评论框 end -->
                

            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

  
    <style>
      span.toc-nav-number{
        display: none
      }
    </style>
  
    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#note配置版本说明"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">NOTE：配置版本说明：</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vagrant基本设定"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">Vagrant基本设定</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#设定vm的名称及记忆体"><span class="toc-nav-number">2.1.</span> <span class="toc-nav-text">设定VM的名称及记忆体</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#设定hostname"><span class="toc-nav-number">2.2.</span> <span class="toc-nav-text">设定Hostname</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#配置网络"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">配置网络</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#端口转发"><span class="toc-nav-number">3.1.</span> <span class="toc-nav-text">端口转发</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#桥接网络"><span class="toc-nav-number">3.2.</span> <span class="toc-nav-text">桥接网络</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#私有网络"><span class="toc-nav-number">3.3.</span> <span class="toc-nav-text">私有网络</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#同步文件夹"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">同步文件夹</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vagrant和shell"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">vagrant和shell</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#版本quot2quot"><span class="toc-nav-number">5.1.</span> <span class="toc-nav-text">版本&quot;2&quot;</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#版本quot1quot"><span class="toc-nav-number">5.2.</span> <span class="toc-nav-text">版本&quot;1&quot;:</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#实例"><span class="toc-nav-number">5.3.</span> <span class="toc-nav-text">实例</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vagrant和puppet"><span class="toc-nav-number">6.</span> <span class="toc-nav-text">vagrant和puppet</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#多虚拟机配置"><span class="toc-nav-number">7.</span> <span class="toc-nav-text">多虚拟机配置</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#其它技巧"><span class="toc-nav-number">8.</span> <span class="toc-nav-text">其它技巧</span></a></li></ol>
        
        </div>
      </aside>
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#技巧" title="技巧">技巧</a>
                        
                          <a class="tag" href="/tags/#Vagrant" title="Vagrant">Vagrant</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">

                    
                        <li><a href="http://www.mike.org.cn/" target="_blank">简单.生活</a></li>
                    
                        <li><a href="http://shang.qq.com/wpa/qunwpa?idkey=ea4c43493c2269428ac6ef6141de4b6d78e5ab2d41380ca4099b833b62884ee9" target="_blank">技术交流群</a></li>
                    
                        <li><a href="" target="_blank"></a></li>
                    
                        <li><a href="" target="_blank"></a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>






    <!-- 来必力City版公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
       (function(d, s) {
           var j, e = d.getElementsByTagName(s)[0];
    
           if (typeof LivereTower === 'function') { return; }
    
           j = d.createElement(s);
           j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
           j.async = true;
    
           e.parentNode.insertBefore(j, e);
       })(document, 'script');
    </script>
    <noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
    <!-- 来必力City版 公共JS代码 end -->



<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'ℬ'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                    <li>
                        <a href="/atom.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                
                
                
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/80imike">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="http://weibo.com/2093524665">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Mike 2018 | Hosted by <a href="https://pages.coding.me" style="font-weight: bold">Coding Pages</a>
                    <br>
                    Theme by <a href="http://beantech.org">BeanTech</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span> 
                    re-Ported by <a href="http://www.huweihuang.com">胡伟煌</a> | 
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=huweihuang&repo=hexo-theme-huweihuang&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js"></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://www.hi-linux.com/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->




<!-- Baidu Tongji -->






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>
<!-- Image to hack wechat -->
<img src="https://www.hi-linux.com/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
