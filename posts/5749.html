<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="Linux,运维,Nginx,Zabbix,Centos,Ansible,MySQL,Python,Docker,ELK,Haproxy,Git,Nodejs,安全,技术">
    <link rel="shortcut icon" href="/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <title>
        
          MySQL Explain 使用指南 - 奇妙的 Linux 世界
        
    </title>

    <link rel="canonical" href="https://www.hi-linux.com/posts/5749.html">

    <!-- Bootstrap Core CSS -->
    
<link rel="stylesheet" href="/css/bootstrap.min.css">


    <!-- Custom CSS --> 
    
<link rel="stylesheet" href="/css/beantech.min.css">

    
    <!-- Pygments Highlight CSS -->
    
<link rel="stylesheet" href="/css/highlight.css">


    
<link rel="stylesheet" href="/css/widget.css">


    
<link rel="stylesheet" href="/css/rocket.css">


    
<link rel="stylesheet" href="/css/signature.css">


    
<link rel="stylesheet" href="/css/toc.css">


    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="奇妙的 Linux 世界" type="application/atom+xml">
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('/img/header_img/building.jpg')
            /*post*/
        
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#技巧" title="技巧">技巧</a>
                            
                              <a class="tag" href="/tags/#Linux" title="Linux">Linux</a>
                            
                              <a class="tag" href="/tags/#MySQL" title="MySQL">MySQL</a>
                            
                        </div>
                        <h1>MySQL Explain 使用指南</h1>
                        <h2 class="subheading"></h2>
                        <span class="meta">
                            Posted by Mike on
                            2020-05-24
                        </span>
                    </div>
                


                </div>
            </div>
        </div>
    </div>
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">奇妙的 Linux 世界</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Modify by Yu-Hsuan Yen -->

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <div id="vip-container"><p>MySQL的 explain 命令语句提供了如何执行 SQL 语句的信息，解析 SQL 语句的执行计划并展示，explain 支持 select、delete、insert、replace 和 update 等语句，也支持对分区表的解析。通常 explain 用来获取 select 语句的执行计划，通过 explain 展示的信息我们可以了解到表查询的顺序，表连接的方式等，并根据这些信息判断 select 执行效率，决定是否添加索引或改写 SQL 语句优化表连接方式以提高执行效率。本文参考官方文档：EXPLAIN Output Format 对 explain 输出的内容进行说明，同时也对自己之前使用 explain 不清晰的方面进行总结。</p>
<p>本文使用的 MySQL 版本为官方社区版 5.7.24。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:(none)&gt; select version();</span><br><span class="line">+------------+</span><br><span class="line">| version()  |</span><br><span class="line">+------------+</span><br><span class="line">| 5.7.24-log |</span><br><span class="line">+------------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.066s</span><br></pre></td></tr></table></figure>
<h2><span id="主要用法">主要用法</span></h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; EXPLAIN | DESCRIBE &#125; [EXTENDED | PARTITIONS | FORMAT&#x3D;[TRADITIONAL | JSON]] SQL_STATEMENT;</span><br></pre></td></tr></table></figure>
<ol>
<li>
<p>EXPLAIN 和 DESCRIBE(可以简写成 DESC)都可以用来查看语句的执行计划，但通常使用 EXPLAIN 较多；</p>
</li>
<li>
<p>FORMAT 选项可以指定执行计划输出信息为 JSON 格式，而且包含一些更详细的指标说明；</p>
</li>
<li>
<p>EXTENDED 和 PARTITIONS 选项可以输出更详细选项说明，语法上是为了兼容低版本 MySQL，未来会废弃，默认使用 EXPLAIN 命令即可。</p>
</li>
</ol>
<h2><span id="测试数据">测试数据</span></h2>
<p>本文基于 MySQL 官方示例数据库 employee：Example Databases 进行解析说明，使用到的表如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">-- employees：</span><br><span class="line">mysql root@localhost:employees&gt; show create table employees\G;</span><br><span class="line">***************************[ 1. row ]***************************</span><br><span class="line">Table        | employees</span><br><span class="line">Create Table | CREATE TABLE &#96;employees&#96; (</span><br><span class="line">  &#96;emp_no&#96; int(11) NOT NULL,</span><br><span class="line">  &#96;birth_date&#96; date NOT NULL,</span><br><span class="line">  &#96;first_name&#96; varchar(14) NOT NULL,</span><br><span class="line">  &#96;last_name&#96; varchar(16) NOT NULL,</span><br><span class="line">  &#96;gender&#96; enum(&#39;M&#39;,&#39;F&#39;) NOT NULL,</span><br><span class="line">  &#96;hire_date&#96; date NOT NULL,</span><br><span class="line">  PRIMARY KEY (&#96;emp_no&#96;),</span><br><span class="line">  KEY &#96;idx_first_last&#96; (&#96;first_name&#96;,&#96;last_name&#96;),</span><br><span class="line">  KEY &#96;idx_birth_hire&#96; (&#96;birth_date&#96;,&#96;hire_date&#96;)</span><br><span class="line">) ENGINE&#x3D;InnoDB DEFAULT CHARSET&#x3D;utf8</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.008s</span><br><span class="line"></span><br><span class="line">-- dept_emp：</span><br><span class="line">mysql root@localhost:employees&gt; show create table dept_emp\G;</span><br><span class="line">***************************[ 1. row ]***************************</span><br><span class="line">Table        | dept_emp</span><br><span class="line">Create Table | CREATE TABLE &#96;dept_emp&#96; (</span><br><span class="line">  &#96;emp_no&#96; int(11) NOT NULL,</span><br><span class="line">  &#96;dept_no&#96; char(4) NOT NULL,</span><br><span class="line">  &#96;from_date&#96; date NOT NULL,</span><br><span class="line">  &#96;to_date&#96; date NOT NULL,</span><br><span class="line">  PRIMARY KEY (&#96;emp_no&#96;,&#96;dept_no&#96;),</span><br><span class="line">  KEY &#96;dept_no&#96; (&#96;dept_no&#96;),</span><br><span class="line">  CONSTRAINT &#96;dept_emp_ibfk_1&#96; FOREIGN KEY (&#96;emp_no&#96;) REFERENCES &#96;employees&#96; (&#96;emp_no&#96;) ON DELETE CASCADE,</span><br><span class="line">  CONSTRAINT &#96;dept_emp_ibfk_2&#96; FOREIGN KEY (&#96;dept_no&#96;) REFERENCES &#96;departments&#96; (&#96;dept_no&#96;) ON DELETE CASCADE</span><br><span class="line">) ENGINE&#x3D;InnoDB DEFAULT CHARSET&#x3D;utf8</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.010s</span><br><span class="line"></span><br><span class="line">-- departments：</span><br><span class="line">mysql root@localhost:employees&gt; show create table departments\G;</span><br><span class="line">***************************[ 1. row ]***************************</span><br><span class="line">Table        | departments</span><br><span class="line">Create Table | CREATE TABLE &#96;departments&#96; (</span><br><span class="line">  &#96;dept_no&#96; char(4) NOT NULL,</span><br><span class="line">  &#96;dept_name&#96; varchar(40) NOT NULL,</span><br><span class="line">  PRIMARY KEY (&#96;dept_no&#96;),</span><br><span class="line">  UNIQUE KEY &#96;dept_name&#96; (&#96;dept_name&#96;)</span><br><span class="line">) ENGINE&#x3D;InnoDB DEFAULT CHARSET&#x3D;utf8</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.012s</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h2><span id="输出说明">输出说明</span></h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select count(*) from employees;</span><br><span class="line">+----+-------------+-----------+------------+-------+---------------+---------+---------+--------+--------+----------+-------------+</span><br><span class="line">| id | select_type | table     | partitions | type  | possible_keys | key     | key_len | ref    | rows   | filtered | Extra       |</span><br><span class="line">+----+-------------+-----------+------------+-------+---------------+---------+---------+--------+--------+----------+-------------+</span><br><span class="line">| 1  | SIMPLE      | employees | &lt;null&gt;     | index | &lt;null&gt;        | PRIMARY | 4       | &lt;null&gt; | 299512 | 100.0    | Using index |</span><br><span class="line">+----+-------------+-----------+------------+-------+---------------+---------+---------+--------+--------+----------+-------------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.026s</span><br></pre></td></tr></table></figure>
<p>通过以上示例语句得出 explain 输出有 12 个字段，主要说明如下表：</p>
<p><img src="https://i.loli.net/2019/09/25/Lp2vShJgtlMEqK6.png" alt></p>
<h3><span id="id">id</span></h3>
<p>id 为 select 标识符，语句在执行计划当中的执行顺序。id 值的出现有如下几种情况：</p>
<ol>
<li>
<p>id 值全相同，则按由上到下顺序执行；</p>
</li>
<li>
<p>id 值全不相同，则按 id 值大小，由大到小顺序执行；</p>
</li>
<li>
<p>id 值部分相同，部分不相同，则同组 id 值大的优先执行(组内 id 值相同的顺序执行)。</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">-- id 全相同</span><br><span class="line">mysql root@localhost:employees&gt; explain select * from employees e,dept_emp d,departments de where e.emp_no &#x3D; d.emp_no and de.dept_name &#x3D; &#39;Human</span><br><span class="line">                                Resources&#39;;</span><br><span class="line"></span><br><span class="line">+----+-------------+-------+------------+-------+---------------+-----------+---------+--------------------+--------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key       | key_len | ref                | rows   | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+-----------+---------+--------------------+--------+----------+-------------+</span><br><span class="line">| 1  | SIMPLE      | de    | &lt;null&gt;     | const | dept_name     | dept_name | 122     | const              | 1      | 100.0    | Using index |</span><br><span class="line">| 1  | SIMPLE      | e     | &lt;null&gt;     | ALL   | PRIMARY       | &lt;null&gt;    | &lt;null&gt;  | &lt;null&gt;             | 299512 | 100.0    | &lt;null&gt;      |</span><br><span class="line">| 1  | SIMPLE      | d     | &lt;null&gt;     | ref   | PRIMARY       | PRIMARY   | 4       | employees.e.emp_no | 1      | 100.0    | &lt;null&gt;      |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+-----------+---------+--------------------+--------+----------+-------------+</span><br><span class="line">3 rows in set</span><br><span class="line">Time: 0.018s</span><br><span class="line"></span><br><span class="line">-- id 全不相同</span><br><span class="line">mysql root@localhost:employees&gt; explain select * from employees e where e.emp_no &#x3D; (select d.emp_no from dept_emp d where d.dept_no &#x3D; (select de.d</span><br><span class="line">                                ept_no from departments de where de.dept_name &#x3D; &#39;Development&#39;) and d.emp_no &#x3D; 10023);</span><br><span class="line">+----+-------------+-------+------------+-------+-----------------+-----------+---------+-------------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys   | key       | key_len | ref         | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+-------+-----------------+-----------+---------+-------------+------+----------+-------------+</span><br><span class="line">| 1  | PRIMARY     | e     | &lt;null&gt;     | const | PRIMARY         | PRIMARY   | 4       | const       | 1    | 100.0    | &lt;null&gt;      |</span><br><span class="line">| 2  | SUBQUERY    | d     | &lt;null&gt;     | const | PRIMARY,dept_no | PRIMARY   | 16      | const,const | 1    | 100.0    | Using index |</span><br><span class="line">| 3  | SUBQUERY    | de    | &lt;null&gt;     | const | dept_name       | dept_name | 122     | const       | 1    | 100.0    | Using index |</span><br><span class="line">+----+-------------+-------+------------+-------+-----------------+-----------+---------+-------------+------+----------+-------------+</span><br><span class="line">3 rows in set</span><br><span class="line">Time: 0.027s</span><br><span class="line"></span><br><span class="line">-- id 部分相同，部分不相同</span><br><span class="line">mysql root@localhost:employees&gt; explain select * from^Iemployees e where^Ie.emp_no in (select d.emp_no from dept_emp d where d.dept_no &#x3D; (select d</span><br><span class="line">                                e.dept_no from departments de where de.dept_name &#x3D; &#39;Human Resources&#39;));</span><br><span class="line">+----+-------------+-------+------------+--------+-----------------+-----------+---------+--------------------+-------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type   | possible_keys   | key       | key_len | ref                | rows  | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+--------+-----------------+-----------+---------+--------------------+-------+----------+-------------+</span><br><span class="line">| 1  | PRIMARY     | d     | &lt;null&gt;     | ref    | PRIMARY,dept_no | dept_no   | 12      | const              | 33212 | 100.0    | Using index |</span><br><span class="line">| 1  | PRIMARY     | e     | &lt;null&gt;     | eq_ref | PRIMARY         | PRIMARY   | 4       | employees.d.emp_no | 1     | 100.0    | &lt;null&gt;      |</span><br><span class="line">| 3  | SUBQUERY    | de    | &lt;null&gt;     | const  | dept_name       | dept_name | 122     | const              | 1     | 100.0    | Using index |</span><br><span class="line">+----+-------------+-------+------------+--------+-----------------+-----------+---------+--------------------+-------+----------+-------------+</span><br><span class="line">3 rows in set</span><br><span class="line">Time: 0.020s</span><br></pre></td></tr></table></figure>
<h3><span id="select_type">select_type</span></h3>
<p>select_type 为表查询的类型，根据官方文档总结几种常见类型如下表：</p>
<p><img src="https://i.loli.net/2019/09/25/zWs5YpGgiMQmtvB.png" alt></p>
<ol>
<li>SIMPLE：最常见的查询类型，通常情况下没有子查询、union 查询就是 SIMPLE 类型。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select * from employees where emp_no &#x3D; 10001;</span><br><span class="line">+----+-------------+-----------+------------+-------+---------------+---------+---------+-------+------+----------+--------+</span><br><span class="line">| id | select_type | table     | partitions | type  | possible_keys | key     | key_len | ref   | rows | filtered | Extra  |</span><br><span class="line">+----+-------------+-----------+------------+-------+---------------+---------+---------+-------+------+----------+--------+</span><br><span class="line">| 1  | SIMPLE      | employees | &lt;null&gt;     | const | PRIMARY       | PRIMARY | 4       | const | 1    | 100.0    | &lt;null&gt; |</span><br><span class="line">+----+-------------+-----------+------------+-------+---------------+---------+---------+-------+------+----------+--------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.019s</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>PRIMARY 和 SUBQUERY：在含有子查询的语句中会出现。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select * from dept_emp d where d.dept_no &#x3D; (select de.dept_no from departments de where de.dept_name &#x3D; &#39;De</span><br><span class="line">                                velopment&#39;);</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+-----------+---------+-------+--------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key       | key_len | ref   | rows   | filtered | Extra       |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+-----------+---------+-------+--------+----------+-------------+</span><br><span class="line">| 1  | PRIMARY     | d     | &lt;null&gt;     | ref   | dept_no       | dept_no   | 12      | const | 148054 | 100.0    | Using where |</span><br><span class="line">| 2  | SUBQUERY    | de    | &lt;null&gt;     | const | dept_name     | dept_name | 122     | const | 1      | 100.0    | Using index |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+-----------+---------+-------+--------+----------+-------------+</span><br><span class="line">2 rows in set</span><br><span class="line">Time: 0.021s</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>UNION 和 UNION RESULT：在有 union 查询的语句中出现。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select * from departments where dept_no &#x3D; &#39;d005&#39; union select * from departments where dept_no &#x3D; &#39;d004&#39;;</span><br><span class="line">+--------+--------------+-------------+------------+-------+---------------+---------+---------+--------+--------+----------+-----------------+</span><br><span class="line">| id     | select_type  | table       | partitions | type  | possible_keys | key     | key_len | ref    | rows   | filtered | Extra           |</span><br><span class="line">+--------+--------------+-------------+------------+-------+---------------+---------+---------+--------+--------+----------+-----------------+</span><br><span class="line">| 1      | PRIMARY      | departments | &lt;null&gt;     | const | PRIMARY       | PRIMARY | 12      | const  | 1      | 100.0    | &lt;null&gt;          |</span><br><span class="line">| 2      | UNION        | departments | &lt;null&gt;     | const | PRIMARY       | PRIMARY | 12      | const  | 1      | 100.0    | &lt;null&gt;          |</span><br><span class="line">| &lt;null&gt; | UNION RESULT | &lt;union1,2&gt;  | &lt;null&gt;     | ALL   | &lt;null&gt;        | &lt;null&gt;  | &lt;null&gt;  | &lt;null&gt; | &lt;null&gt; | &lt;null&gt;   | Using temporary |</span><br><span class="line">+--------+--------------+-------------+------------+-------+---------------+---------+---------+--------+--------+----------+-----------------+</span><br><span class="line">3 rows in set</span><br><span class="line">Time: 0.020s</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>DEPENDENT UNION 和 DEPENDENT SUBQUERY：当语句中子查询和 union 查询依赖外部查询会出现。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select * from employees e where e.emp_no in (select d.emp_no from dept_emp d where d.from_date &#x3D; &#39;1986-06-</span><br><span class="line">                                26&#39; union select d.emp_no from dept_emp d where d.from_date &#x3D; &#39;1996-08-03&#39;);</span><br><span class="line">+--------+--------------------+------------+------------+------+---------------+---------+---------+--------+--------+----------+-----------------+</span><br><span class="line">| id     | select_type        | table      | partitions | type | possible_keys | key     | key_len | ref    | rows   | filtered | Extra          |</span><br><span class="line">+--------+--------------------+------------+------------+------+---------------+---------+---------+--------+--------+----------+-----------------+</span><br><span class="line">| 1      | PRIMARY            | e          | &lt;null&gt;     | ALL  | &lt;null&gt;        | &lt;null&gt;  | &lt;null&gt;  | &lt;null&gt; | 299512 | 100.0    | Using where    |</span><br><span class="line">| 2      | DEPENDENT SUBQUERY | d          | &lt;null&gt;     | ref  | PRIMARY       | PRIMARY | 4       | func   | 1      |  10.0    | Using where    |</span><br><span class="line">| 3      | DEPENDENT UNION    | d          | &lt;null&gt;     | ref  | PRIMARY       | PRIMARY | 4       | func   | 1      |  10.0    | Using where    |</span><br><span class="line">| &lt;null&gt; | UNION RESULT       | &lt;union2,3&gt; | &lt;null&gt;     | ALL  | &lt;null&gt;        | &lt;null&gt;  | &lt;null&gt;  | &lt;null&gt; | &lt;null&gt; | &lt;null&gt;   | Using temporary|</span><br><span class="line">+--------+--------------------+------------+------------+------+---------------+---------+---------+--------+--------+----------+-----------------+</span><br><span class="line">4 rows in set</span><br><span class="line">Time: 0.022s</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>DERIVED：当查询涉及生成临时表时出现。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select * from (select * from departments limit 5) de;</span><br><span class="line">+----+-------------+-------------+------------+-------+---------------+-----------+---------+--------+------+----------+-------------+</span><br><span class="line">| id | select_type | table       | partitions | type  | possible_keys | key       | key_len | ref    | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+-------------+------------+-------+---------------+-----------+---------+--------+------+----------+-------------+</span><br><span class="line">| 1  | PRIMARY     | &lt;derived2&gt;  | &lt;null&gt;     | ALL   | &lt;null&gt;        | &lt;null&gt;    | &lt;null&gt;  | &lt;null&gt; | 5    | 100.0    | &lt;null&gt;      |</span><br><span class="line">| 2  | DERIVED     | departments | &lt;null&gt;     | index | &lt;null&gt;        | dept_name | 122     | &lt;null&gt; | 9    | 100.0    | Using index |</span><br><span class="line">+----+-------------+-------------+------------+-------+---------------+-----------+---------+--------+------+----------+-------------+</span><br><span class="line">2 rows in set</span><br><span class="line">Time: 0.012s</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>table</li>
</ol>
<p>指执行计划当中当前是从哪张表获取数据，如果为表指定了别名，则显示别名，如果没有涉及对表的数据读取，则显示 NULL，还有如下几种情形：</p>
<ul>
<li>
<p>&lt;unionM,N&gt;：数据来自union查询的id为M和N的结果集；</p>
</li>
<li>
<p>：数据来自派生表id为N的结果集；</p>
</li>
<li>
<p>：数据来自子查询id为N的结果集。</p>
</li>
</ul>
<ol start="7">
<li>partitions</li>
</ol>
<p>指执行计划中当前从分区表哪个表分区获取数据，如果不是分区表，则显示为 NULL。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">-- 示例数据库 employees 的分区表 salaries</span><br><span class="line">mysql root@localhost:employees&gt; show create table salaries;</span><br><span class="line">+----------+-----------------------------------------------------------------+</span><br><span class="line">| Table    | Create Table                                                    |</span><br><span class="line">+----------+-----------------------------------------------------------------+</span><br><span class="line">| salaries | CREATE TABLE &#96;salaries&#96; (                                       |</span><br><span class="line">|          |   &#96;emp_no&#96; int(11) NOT NULL,                                    |</span><br><span class="line">|          |   &#96;salary&#96; int(11) NOT NULL,                                    |</span><br><span class="line">|          |   &#96;from_date&#96; date NOT NULL,                                    |</span><br><span class="line">|          |   &#96;to_date&#96; date NOT NULL,                                      |</span><br><span class="line">|          |   PRIMARY KEY (&#96;emp_no&#96;,&#96;from_date&#96;)                            |</span><br><span class="line">|          | ) ENGINE&#x3D;InnoDB DEFAULT CHARSET&#x3D;utf8                            |</span><br><span class="line">|          | &#x2F;*!50500 PARTITION BY RANGE  COLUMNS(from_date)                 |</span><br><span class="line">|          | (PARTITION p01 VALUES LESS THAN (&#39;1985-12-31&#39;) ENGINE &#x3D; InnoDB, |</span><br><span class="line">|          |  PARTITION p02 VALUES LESS THAN (&#39;1986-12-31&#39;) ENGINE &#x3D; InnoDB, |</span><br><span class="line">|          |  PARTITION p03 VALUES LESS THAN (&#39;1987-12-31&#39;) ENGINE &#x3D; InnoDB, |</span><br><span class="line">|          |  PARTITION p04 VALUES LESS THAN (&#39;1988-12-31&#39;) ENGINE &#x3D; InnoDB, |</span><br><span class="line">|          |  PARTITION p05 VALUES LESS THAN (&#39;1989-12-31&#39;) ENGINE &#x3D; InnoDB, |</span><br><span class="line">|          |  PARTITION p06 VALUES LESS THAN (&#39;1990-12-31&#39;) ENGINE &#x3D; InnoDB, |</span><br><span class="line">|          |  PARTITION p07 VALUES LESS THAN (&#39;1991-12-31&#39;) ENGINE &#x3D; InnoDB, |</span><br><span class="line">|          |  PARTITION p08 VALUES LESS THAN (&#39;1992-12-31&#39;) ENGINE &#x3D; InnoDB, |</span><br><span class="line">|          |  PARTITION p09 VALUES LESS THAN (&#39;1993-12-31&#39;) ENGINE &#x3D; InnoDB, |</span><br><span class="line">|          |  PARTITION p10 VALUES LESS THAN (&#39;1994-12-31&#39;) ENGINE &#x3D; InnoDB, |</span><br><span class="line">|          |  PARTITION p11 VALUES LESS THAN (&#39;1995-12-31&#39;) ENGINE &#x3D; InnoDB, |</span><br><span class="line">|          |  PARTITION p12 VALUES LESS THAN (&#39;1996-12-31&#39;) ENGINE &#x3D; InnoDB, |</span><br><span class="line">|          |  PARTITION p13 VALUES LESS THAN (&#39;1997-12-31&#39;) ENGINE &#x3D; InnoDB, |</span><br><span class="line">|          |  PARTITION p14 VALUES LESS THAN (&#39;1998-12-31&#39;) ENGINE &#x3D; InnoDB, |</span><br><span class="line">|          |  PARTITION p15 VALUES LESS THAN (&#39;1999-12-31&#39;) ENGINE &#x3D; InnoDB, |</span><br><span class="line">|          |  PARTITION p16 VALUES LESS THAN (&#39;2000-12-31&#39;) ENGINE &#x3D; InnoDB, |</span><br><span class="line">|          |  PARTITION p17 VALUES LESS THAN (&#39;2001-12-31&#39;) ENGINE &#x3D; InnoDB, |</span><br><span class="line">|          |  PARTITION p18 VALUES LESS THAN (&#39;2002-12-31&#39;) ENGINE &#x3D; InnoDB, |</span><br><span class="line">|          |  PARTITION p19 VALUES LESS THAN (MAXVALUE) ENGINE &#x3D; InnoDB) *&#x2F;  |</span><br><span class="line">+----------+-----------------------------------------------------------------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.018s</span><br><span class="line"></span><br><span class="line">mysql root@localhost:employees&gt; explain select * from salaries where from_date &gt; &#39;1985-12-31&#39; and from_date &lt; &#39;1990-12-31&#39;;</span><br><span class="line">+----+-------------+----------+---------------------+------+---------------+--------+---------+--------+--------+----------+-------------+</span><br><span class="line">| id | select_type | table    | partitions          | type | possible_keys | key    | key_len | ref    | rows   | filtered | Extra       |</span><br><span class="line">+----+-------------+----------+---------------------+------+---------------+--------+---------+--------+--------+----------+-------------+</span><br><span class="line">| 1  | SIMPLE      | salaries | p02,p03,p04,p05,p06 | ALL  | &lt;null&gt;        | &lt;null&gt; | &lt;null&gt;  | &lt;null&gt; | 384341 | 11.11    | Using where |</span><br><span class="line">+----+-------------+----------+---------------------+------+---------------+--------+---------+--------+--------+----------+-------------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.023s</span><br></pre></td></tr></table></figure>
<h3><span id="type">type</span></h3>
<p>type 应该被认为是解读执行计划当中最重要的部分，根据 type 显示的内容可以判断语句总体的查询效率。主要有以下几种类型：</p>
<ol>
<li>system：表只有一行(系统表)，是 const 的一种特殊情况。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">-- 测试表 departments_1 生成：</span><br><span class="line">mysql root@localhost:employees&gt; create table departments_1 as select * from departments where dept_no&#x3D;&#39;d005&#39;;</span><br><span class="line">Query OK, 1 row affected</span><br><span class="line">Time: 0.107s </span><br><span class="line"></span><br><span class="line">mysql root@localhost:employees&gt; alter table departments_1 add primary key(dept_no);</span><br><span class="line">Query OK, 0 rows affected</span><br><span class="line"></span><br><span class="line">mysql root@localhost:employees&gt; create index idx_dept_name on departments_1(dept_name);</span><br><span class="line">Query OK, 0 rows affected</span><br><span class="line"></span><br><span class="line">mysql root@localhost:employees&gt; show create table departments_1\G;</span><br><span class="line">***************************[ 1. row ]***************************</span><br><span class="line">Table        | departments_1</span><br><span class="line">Create Table | CREATE TABLE &#96;departments_1&#96; (</span><br><span class="line">  &#96;dept_no&#96; char(4) NOT NULL,</span><br><span class="line">  &#96;dept_name&#96; varchar(40) DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (&#96;dept_no&#96;),</span><br><span class="line">  KEY &#96;idx_dept_name&#96; (&#96;dept_name&#96;)</span><br><span class="line">) ENGINE&#x3D;InnoDB DEFAULT CHARSET&#x3D;utf8</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.010s</span><br><span class="line"></span><br><span class="line">-- 系统表：</span><br><span class="line">mysql root@localhost:employees&gt; explain select * from mysql.proxies_priv;</span><br><span class="line">+----+-------------+--------------+------------+--------+---------------+--------+---------+--------+------+----------+--------+</span><br><span class="line">| id | select_type | table        | partitions | type   | possible_keys | key    | key_len | ref    | rows | filtered | Extra  |</span><br><span class="line">+----+-------------+--------------+------------+--------+---------------+--------+---------+--------+------+----------+--------+</span><br><span class="line">| 1  | SIMPLE      | proxies_priv | &lt;null&gt;     | system | &lt;null&gt;        | &lt;null&gt; | &lt;null&gt;  | &lt;null&gt; | 1    | 100.0    | &lt;null&gt; |</span><br><span class="line">+----+-------------+--------------+------------+--------+---------------+--------+---------+--------+------+----------+--------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.023s</span><br><span class="line"></span><br><span class="line">-- 普通表：</span><br><span class="line">mysql root@localhost:employees&gt; explain select * from (select * from departments_1 where dept_no &#x3D; &#39;d005&#39; limit 1) de;</span><br><span class="line">+----+-------------+---------------+------------+--------+---------------+---------+---------+--------+------+----------+--------+</span><br><span class="line">| id | select_type | table         | partitions | type   | possible_keys | key     | key_len | ref    | rows | filtered | Extra  |</span><br><span class="line">+----+-------------+---------------+------------+--------+---------------+---------+---------+--------+------+----------+--------+</span><br><span class="line">| 1  | PRIMARY     | &lt;derived2&gt;    | &lt;null&gt;     | system | &lt;null&gt;        | &lt;null&gt;  | &lt;null&gt;  | &lt;null&gt; | 1    | 100.0    | &lt;null&gt; |</span><br><span class="line">| 2  | DERIVED     | departments_1 | &lt;null&gt;     | const  | PRIMARY       | PRIMARY | 12      | const  | 1    | 100.0    | &lt;null&gt; |</span><br><span class="line">+----+-------------+---------------+------------+--------+---------------+---------+---------+--------+------+----------+--------+</span><br><span class="line">2 rows in set</span><br><span class="line">Time: 0.015s</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>const：对于主键或者唯一索引键的等值查询，只返回一行数据。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select * from departments_1 where dept_no &#x3D; &#39;d005&#39;;</span><br><span class="line">+----+-------------+---------------+------------+-------+---------------+---------+---------+-------+------+----------+--------+</span><br><span class="line">| id | select_type | table         | partitions | type  | possible_keys | key     | key_len | ref   | rows | filtered | Extra  |</span><br><span class="line">+----+-------------+---------------+------------+-------+---------------+---------+---------+-------+------+----------+--------+</span><br><span class="line">| 1  | SIMPLE      | departments_1 | &lt;null&gt;     | const | PRIMARY       | PRIMARY | 12      | const | 1    | 100.0    | &lt;null&gt; |</span><br><span class="line">+----+-------------+---------------+------------+-------+---------------+---------+---------+-------+------+----------+--------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.018s</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>eq_ref：对于前表的每一行数据，都只能匹配当前表唯一一行数据。除了 system 与 const 之外这是最好的一种连接查询类型，主键或者是非空唯一索引的所有部分都可以在连接时被使用，通常使用的是’='操作符，比较值可以是一个常量，也可以是一个在该表之前读取该表的字段表达式。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">explain select * from departments d,departments_1 d1 where d.dept_no &#x3D; d1.dept_no;</span><br><span class="line">+----+-------------+-------+------------+--------+---------------+---------------+---------+----------------------+------+----------+-------------+</span><br><span class="line">| id | select_type | table | partitions | type   | possible_keys | key           | key_len | ref                  | rows | filtered | Extra      |</span><br><span class="line">+----+-------------+-------+------------+--------+---------------+---------------+---------+----------------------+------+----------+-------------+</span><br><span class="line">| 1  | SIMPLE      | d1    | &lt;null&gt;     | index  | PRIMARY       | idx_dept_name | 123     | &lt;null&gt;               | 1    | 100.0    | Using index|</span><br><span class="line">| 1  | SIMPLE      | d     | &lt;null&gt;     | eq_ref | PRIMARY       | PRIMARY       | 12      | employees.d1.dept_no | 1    | 100.0    | &lt;null&gt;     |</span><br><span class="line">+----+-------------+-------+------------+--------+---------------+---------------+---------+----------------------+------+----------+-------------+</span><br><span class="line">2 rows in set</span><br><span class="line">Time: 0.037s</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>ref：对于前表的每一行数据，都从当前表读取所有匹配索引值的行。与 eq_ref 相比，连接查询字段不是主键或者唯一索引，又或者是复合索引的部分左前缀，如果连接查询匹配的是少量几行数据，ref 是个不同错的选择，通常使用的运算符是’=’、’&lt;=‘或者’&gt;='等。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select * from dept_emp where dept_no &#x3D;&#39;d005&#39;;</span><br><span class="line">+----+-------------+----------+------------+------+---------------+---------+---------+-------+--------+----------+--------+</span><br><span class="line">| id | select_type | table    | partitions | type | possible_keys | key     | key_len | ref   | rows   | filtered | Extra  |</span><br><span class="line">+----+-------------+----------+------------+------+---------------+---------+---------+-------+--------+----------+--------+</span><br><span class="line">| 1  | SIMPLE      | dept_emp | &lt;null&gt;     | ref  | dept_no       | dept_no | 12      | const | 148054 | 100.0    | &lt;null&gt; |</span><br><span class="line">+----+-------------+----------+------------+------+---------------+---------+---------+-------+--------+----------+--------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.059s</span><br><span class="line"></span><br><span class="line">mysql root@localhost:employees&gt; explain select * from dept_emp d,departments_1 d1 where d.dept_no &#x3D; d1.dept_no;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+---------+---------+----------------------+-------+----------+--------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key     | key_len | ref                  | rows  | filtered | Extra  |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+---------+---------+----------------------+-------+----------+--------+</span><br><span class="line">| 1  | SIMPLE      | d1    | &lt;null&gt;     | ALL  | &lt;null&gt;        | &lt;null&gt;  | &lt;null&gt;  | &lt;null&gt;               | 1     | 100.0    | &lt;null&gt; |</span><br><span class="line">| 1  | SIMPLE      | d     | &lt;null&gt;     | ref  | dept_no       | dept_no | 12      | employees.d1.dept_no | 41392 | 100.0    | &lt;null&gt; |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+---------+---------+----------------------+-------+----------+--------+</span><br><span class="line">2 rows in set</span><br><span class="line">Time: 0.012s</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>ref_or_null：同ref类型，但是包含了对NULL值的搜索。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select dept_name from departments_1 where dept_name &#x3D; &#39;d005&#39; or dept_name is null;</span><br><span class="line">+----+-------------+---------------+------------+-------------+---------------+---------------+---------+-------+------+----------+--------------------------+</span><br><span class="line">| id | select_type | table         | partitions | type        | possible_keys | key           | key_len | ref   | rows | filtered | Extra                   |</span><br><span class="line">+----+-------------+---------------+------------+-------------+---------------+---------------+---------+-------+------+----------+--------------------------+</span><br><span class="line">| 1  | SIMPLE      | departments_1 | &lt;null&gt;     | ref_or_null | idx_dept_name | idx_dept_name | 123     | const | 2    | 100.0    | Using where; Using index |</span><br><span class="line">+----+-------------+---------------+------------+-------------+---------------+---------------+---------+-------+------+----------+--------------------------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.011s</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>index_merge：使用了索引合并优化进行查询。如果查询指定条件涉及对多个索引的使用时，会将多个索引合并操作。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select * from dept_emp where emp_no &#x3D; 10001 or dept_no &#x3D; (select dept_no from departments_1);</span><br><span class="line">+----+-------------+---------------+------------+-------------+-----------------+-----------------+---------+--------+--------+----------+-------------------------------------------+</span><br><span class="line">| id | select_type | table         | partitions | type        | possible_keys   | key             | key_len | ref    | rows   | filtered | Extra                                    |</span><br><span class="line">+----+-------------+---------------+------------+-------------+-----------------+-----------------+---------+--------+--------+----------+-------------------------------------------+</span><br><span class="line">| 1  | PRIMARY     | dept_emp      | &lt;null&gt;     | index_merge | PRIMARY,dept_no | PRIMARY,dept_no | 4,12    | &lt;null&gt; | 148055 | 100.0    | Using union(PRIMARY,dept_no); Using where |</span><br><span class="line">| 2  | SUBQUERY    | departments_1 | &lt;null&gt;     | index       | &lt;null&gt;          | idx_dept_name   | 123     | &lt;null&gt; | 1      | 100.0    | Using index                               |</span><br><span class="line">+----+-------------+---------------+------------+-------------+-----------------+-----------------+---------+--------+--------+----------+-------------------------------------------+</span><br><span class="line">2 rows in set</span><br><span class="line">Time: 0.014s</span><br></pre></td></tr></table></figure>
<ol start="7">
<li>range：使用索引扫描条件指定范围内的数据。常用的操作符有 ‘&gt;’、’&lt;’、‘is null’、‘between’、‘in’ 和 ‘like’ 等。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select de.* from dept_emp de,departments_1 d where de.dept_no &#x3D; d.dept_no and de.emp_no &lt; 10010;</span><br><span class="line">+----+-------------+-------+------------+-------+-----------------+---------------+---------+--------+------+----------+----------------------------------------------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys   | key           | key_len | ref    | rows | filtered | Extra                                             |</span><br><span class="line">+----+-------------+-------+------------+-------+-----------------+---------------+---------+--------+------+----------+----------------------------------------------------+</span><br><span class="line">| 1  | SIMPLE      | d     | &lt;null&gt;     | index | PRIMARY         | idx_dept_name | 123     | &lt;null&gt; | 1    | 100.0    | Using index                                       |</span><br><span class="line">| 1  | SIMPLE      | de    | &lt;null&gt;     | range | PRIMARY,dept_no | PRIMARY       | 4       | &lt;null&gt; | 9    |  12.5    | Using where; Using join buffer (Block Nested Loop) |</span><br><span class="line">+----+-------------+-------+------------+-------+-----------------+---------------+---------+--------+------+----------+----------------------------------------------------+</span><br><span class="line">2 rows in set</span><br><span class="line">Time: 0.019s</span><br></pre></td></tr></table></figure>
<ol start="8">
<li>index：使用索引全扫描。类似于全表扫描，只是扫描对象是索引，出现于以下两种情况：</li>
</ol>
<ul>
<li>
<p>如果索引是覆盖索引，即索引包含查询所需要的所有表数据，就只扫描索引，并且在 Extra 中出现 Using index。通常情况下扫描索引比打描表要更快，因为索引一般比表来的小；</p>
</li>
<li>
<p>全表扫描采用索引的顺序来读取数据，本质上还是全表扫描，并且在 Extra 中不会出现 Using index，避免再进行排序消耗性能，因为索引本身就是排序好的。</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select dept_name from departments_1;</span><br><span class="line">+----+-------------+---------------+------------+-------+---------------+---------------+---------+--------+------+----------+-------------+</span><br><span class="line">| id | select_type | table         | partitions | type  | possible_keys | key           | key_len | ref    | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+---------------+------------+-------+---------------+---------------+---------+--------+------+----------+-------------+</span><br><span class="line">| 1  | SIMPLE      | departments_1 | &lt;null&gt;     | index | &lt;null&gt;        | idx_dept_name | 123     | &lt;null&gt; | 1    | 100.0    | Using index |</span><br><span class="line">+----+-------------+---------------+------------+-------+---------------+---------------+---------+--------+------+----------+-------------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.020s</span><br></pre></td></tr></table></figure>
<ol start="9">
<li>all：使用全表扫描。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; drop index idx_dept_name on departments_1;</span><br><span class="line">Query OK, 0 rows affected</span><br><span class="line">Time: 0.052s</span><br><span class="line"></span><br><span class="line">mysql root@localhost:employees&gt; explain select * from departments_1;</span><br><span class="line">+----+-------------+---------------+------------+------+---------------+--------+---------+--------+------+----------+--------+</span><br><span class="line">| id | select_type | table         | partitions | type | possible_keys | key    | key_len | ref    | rows | filtered | Extra  |</span><br><span class="line">+----+-------------+---------------+------------+------+---------------+--------+---------+--------+------+----------+--------+</span><br><span class="line">| 1  | SIMPLE      | departments_1 | &lt;null&gt;     | ALL  | &lt;null&gt;        | &lt;null&gt; | &lt;null&gt;  | &lt;null&gt; | 1    | 100.0    | &lt;null&gt; |</span><br><span class="line">+----+-------------+---------------+------------+------+---------------+--------+---------+--------+------+----------+--------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.018s</span><br></pre></td></tr></table></figure>
<p>通过以上各种主要类型的分析，可以总结出各个类型性能排序(从左到右性能从高到低)：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system &gt; const &gt; eq_ref &gt; ref &gt; range &gt; index &gt; all</span><br></pre></td></tr></table></figure>
<h3><span id="possible_keys">possible_keys</span></h3>
<p>显示了 MySQL 在查找当前表中数据的时候可能使用到的索引，如果该字段值为 NULL，则表明没有相关索引可用。</p>
<h3><span id="key">key</span></h3>
<p>显示了 MySQL 在实际查找数据时决定使用的索引，如果该字段值为 NULL，则表明没有使用索引。</p>
<h3><span id="key_len">key_len</span></h3>
<p>显示了 MySQL 实际使用索引的键大小，单位字节。可以通过 key_len 的大小判断评估复合索引使用了哪些部分，如果 key 字段值为 NULL，则 key_len 的值也为 NULL。</p>
<p>几种常见字段类型索引长度大小如下，假设字符编码为 UTF8：</p>
<ul>
<li>
<p>字段属性是否允许 NULL，如果允许 NULL，则需要额外增加一个字节；</p>
</li>
<li>
<p>字符型：</p>
<ul>
<li>char(n)：3n个字节</li>
<li>varchar(n)：3n+2个字节</li>
</ul>
</li>
<li>
<p>数值型：</p>
<ul>
<li>tinyint：1 个字节</li>
<li>int：4 个字节</li>
<li>bigint：8 个字节</li>
</ul>
</li>
<li>
<p>时间型：</p>
<ul>
<li>date：3 个字节</li>
<li>datetime：5 个字节+秒精度字节</li>
<li>timestamp：4 个字节+秒精度字节</li>
<li>秒精度字节(最大 6 位)：
<ul>
<li>1~2位：1 个字节</li>
<li>3~4位：2 个字节</li>
<li>5~6位：3 个字节</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3><span id="ref">ref</span></h3>
<p>显示哪些常量或者字段被用于查询索引列键值，以获取表中数据行。</p>
<ol>
<li>
<p>如果是常量等值查询，则显示为 const；</p>
</li>
<li>
<p>如果是连接查询，则被驱动表的该字段会显示驱动表的所关联字段；</p>
</li>
<li>
<p>如果条件当中使用函数表达式，或者值导致条件字段发生隐式转换，这里显示为 func。</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select * from departments d,departments_1 d1 where d.dept_no &#x3D; d1.dept_no;</span><br><span class="line">+----+-------------+-------+------------+--------+---------------+---------+---------+----------------------+------+----------+--------+</span><br><span class="line">| id | select_type | table | partitions | type   | possible_keys | key     | key_len | ref                  | rows | filtered | Extra  |</span><br><span class="line">+----+-------------+-------+------------+--------+---------------+---------+---------+----------------------+------+----------+--------+</span><br><span class="line">| 1  | SIMPLE      | d1    | &lt;null&gt;     | ALL    | PRIMARY       | &lt;null&gt;  | &lt;null&gt;  | &lt;null&gt;               | 1    | 100.0    | &lt;null&gt; |</span><br><span class="line">| 1  | SIMPLE      | d     | &lt;null&gt;     | eq_ref | PRIMARY       | PRIMARY | 12      | employees.d1.dept_no | 1    | 100.0    | &lt;null&gt; |</span><br><span class="line">+----+-------------+-------+------------+--------+---------------+---------+---------+----------------------+------+----------+--------+</span><br><span class="line">2 rows in set</span><br><span class="line">Time: 0.038s</span><br></pre></td></tr></table></figure>
<h3><span id="rows">rows</span></h3>
<p>显示预估需要查询的行数。对 InnoDB 表来说这是个预估值，并非是个准确值。</p>
<h3><span id="filtered">filtered</span></h3>
<p>显示按表条件过滤的表行的估计百分比。</p>
<h3><span id="extra">Extra</span></h3>
<p>显示查询时的额外信息。常见的有如下几种：</p>
<ol>
<li>Using index</li>
</ol>
<p>仅查询索引树就可以获取到所需要的数据行，而不需要读取表中实际的数据行。通常适用于 select 字段就是查询使用索引的一部分，即使用了覆盖索引。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select dept_name from departments_1;</span><br><span class="line">+----+-------------+---------------+------------+-------+---------------+---------------+---------+--------+------+----------+-------------+</span><br><span class="line">| id | select_type | table         | partitions | type  | possible_keys | key           | key_len | ref    | rows | filtered | Extra       |</span><br><span class="line">+----+-------------+---------------+------------+-------+---------------+---------------+---------+--------+------+----------+-------------+</span><br><span class="line">| 1  | SIMPLE      | departments_1 | &lt;null&gt;     | index | &lt;null&gt;        | idx_dept_name | 123     | &lt;null&gt; | 1    | 100.0    | Using index |</span><br><span class="line">+----+-------------+---------------+------------+-------+---------------+---------------+---------+--------+------+----------+-------------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.015s</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>Using index condition</li>
</ol>
<p>显示采用了Index Condition Pushdown (ICP) 特性通过索引去表中获取数据。关于ICP特性可以参考官方文档：Index Condition Pushdown Optimization。简单说法如下：</p>
<ul>
<li>
<p>如果开启 ICP 特性，部分 where 条件部分可以下推到存储引擎通过索引进行过滤，ICP 可以减少存储引擎访问基表的次数；</p>
</li>
<li>
<p>如果没有开启 ICP 特性，则存储引擎根据索引需要直接访问基表获取数据并返回给 server 层进行 where 条件的过滤。</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-- employees表创建复合索引idx_birth_hire</span><br><span class="line">mysql root@localhost:employees&gt; create index idx_birth_hire on employees(birth_date,hire_date);</span><br><span class="line">Query OK, 0 rows affected</span><br><span class="line">Time: 0.768s</span><br><span class="line"></span><br><span class="line">mysql root@localhost:employees&gt; explain select * from employees where birth_date &#x3D; &#39;1960-01-01&#39; and hire_date &gt; &#39;1980-01-01&#39;;</span><br><span class="line">+----+-------------+-----------+------------+-------+----------------+----------------+---------+--------+------+----------+-----------------------+</span><br><span class="line">| id | select_type | table     | partitions | type  | possible_keys  | key            | key_len | ref    | rows | filtered | Extra                |</span><br><span class="line">+----+-------------+-----------+------------+-------+----------------+----------------+---------+--------+------+----------+-----------------------+</span><br><span class="line">| 1  | SIMPLE      | employees | &lt;null&gt;     | range | idx_birth_hire | idx_birth_hire | 6       | &lt;null&gt; | 63   | 100.0    | Using index condition |</span><br><span class="line">+----+-------------+-----------+------------+-------+----------------+----------------+---------+--------+------+----------+-----------------------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.016s</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>Using index for group-by</li>
</ol>
<p>跟 Using index 访问表的方式类似，显示 MySQL 通过索引就可以完成对 GROUP BY 或 DISTINCT 字段的查询，而无需再访问表中的数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select distinct dept_no from dept_emp;</span><br><span class="line">+----+-------------+----------+------------+-------+-----------------+---------+---------+--------+------+----------+--------------------------+</span><br><span class="line">| id | select_type | table    | partitions | type  | possible_keys   | key     | key_len | ref    | rows | filtered | Extra                    |</span><br><span class="line">+----+-------------+----------+------------+-------+-----------------+---------+---------+--------+------+----------+--------------------------+</span><br><span class="line">| 1  | SIMPLE      | dept_emp | &lt;null&gt;     | range | PRIMARY,dept_no | dept_no | 12      | &lt;null&gt; | 9    | 100.0    | Using index for group-by |</span><br><span class="line">+----+-------------+----------+------------+-------+-----------------+---------+---------+--------+------+----------+--------------------------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.020s</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>Using where</li>
</ol>
<p>显示 MySQL 通过索引条件定位之后还需要返回表中获得所需要的数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select * from employees where birth_date &lt; &#39;1970-01-01&#39;;</span><br><span class="line">+----+-------------+-----------+------------+------+----------------+--------+---------+--------+--------+----------+-------------+</span><br><span class="line">| id | select_type | table     | partitions | type | possible_keys  | key    | key_len | ref    | rows   | filtered | Extra       |</span><br><span class="line">+----+-------------+-----------+------------+------+----------------+--------+---------+--------+--------+----------+-------------+</span><br><span class="line">| 1  | SIMPLE      | employees | &lt;null&gt;     | ALL  | idx_birth_hire | &lt;null&gt; | &lt;null&gt;  | &lt;null&gt; | 299512 | 50.0     | Using where |</span><br><span class="line">+----+-------------+-----------+------------+------+----------------+--------+---------+--------+--------+----------+-------------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.016s</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>Impossible WHERE</li>
</ol>
<p>where 子句的条件永远都不可能为真。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select * from employees where 1 &#x3D; 0;</span><br><span class="line">+----+-------------+--------+------------+--------+---------------+--------+---------+--------+--------+----------+------------------+</span><br><span class="line">| id | select_type | table  | partitions | type   | possible_keys | key    | key_len | ref    | rows   | filtered | Extra            |</span><br><span class="line">+----+-------------+--------+------------+--------+---------------+--------+---------+--------+--------+----------+------------------+</span><br><span class="line">| 1  | SIMPLE      | &lt;null&gt; | &lt;null&gt;     | &lt;null&gt; | &lt;null&gt;        | &lt;null&gt; | &lt;null&gt;  | &lt;null&gt; | &lt;null&gt; | &lt;null&gt;   | Impossible WHERE |</span><br><span class="line">+----+-------------+--------+------------+--------+---------------+--------+---------+--------+--------+----------+------------------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.015s</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>Using join buffer (Block Nested Loop), Using join buffer (Batched Key Access)</li>
</ol>
<p>在表联接过程当中，将先前表的部分数据读取到 join buffer 缓冲区中，然后从缓冲区中读取数据与当前表进行连接。主要有两种算法：Block Nested Loop和Batched Key Access，关于这两种算法说明可以参考官方文档：Block Nested-Loop and Batched Key Access Joins，也可以参考另一篇博文说明：MySQL 查询优化之 Block Nested-Loop 与 Batched Key Access Joins。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">-- Block Nested Loop</span><br><span class="line">mysql root@localhost:employees&gt; explain select * from employees e,dept_emp d where e.emp_no &gt; 10001 and e.emp_no &lt;&gt; d.emp_no;</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+--------+--------+----------+----------------------------------------------------+</span><br><span class="line">| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref    | rows   | filtered | Extra                                             |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+--------+--------+----------+----------------------------------------------------+</span><br><span class="line">| 1  | SIMPLE      | e     | &lt;null&gt;     | range | PRIMARY       | PRIMARY | 4       | &lt;null&gt; | 149756 | 100.0    | Using where                                       |</span><br><span class="line">| 1  | SIMPLE      | d     | &lt;null&gt;     | ALL   | &lt;null&gt;        | &lt;null&gt;  | &lt;null&gt;  | &lt;null&gt; | 331143 |  90.0    | Using where; Using join buffer(Block Nested Loop) |</span><br><span class="line">+----+-------------+-------+------------+-------+---------------+---------+---------+--------+--------+----------+----------------------------------------------------+</span><br><span class="line">2 rows in set</span><br><span class="line">Time: 0.020s</span><br><span class="line"></span><br><span class="line">-- Batched Key Access</span><br><span class="line">mysql root@localhost:employees&gt; explain SELECT &#x2F;*+ bka(a)*&#x2F; a.gender, b.dept_no FROM employees a, dept_emp b WHERE a.birth_date &#x3D; b.from_date;</span><br><span class="line">+----+-------------+-------+------------+------+----------------+----------------+---------+-----------------------+--------+----------+----------------------------------------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys  | key            | key_len | ref                   | rows   | filtered | Extra                                 |</span><br><span class="line">+----+-------------+-------+------------+------+----------------+----------------+---------+-----------------------+--------+----------+----------------------------------------+</span><br><span class="line">| 1  | SIMPLE      | b     | &lt;null&gt;     | ALL  | &lt;null&gt;         | &lt;null&gt;         | &lt;null&gt;  | &lt;null&gt;                | 331143 | 100.0    | &lt;null&gt;                                |</span><br><span class="line">| 1  | SIMPLE      | a     | &lt;null&gt;     | ref  | idx_birth_hire | idx_birth_hire | 3       | employees.b.from_date | 63     | 100.0    | Using join buffer (Batched Key Access) |</span><br><span class="line">+----+-------------+-------+------------+------+----------------+----------------+---------+-----------------------+--------+----------+----------------------------------------+</span><br><span class="line">2 rows in set</span><br><span class="line">Time: 0.014s</span><br></pre></td></tr></table></figure>
<ol start="7">
<li>Using MRR</li>
</ol>
<p>读取数据采用多范围读 (Multi-Range Read) 的优化策略。关于MRR特性也可以参考官方文档：Multi-Range Read Optimization</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; set optimizer_switch&#x3D;&#39;mrr&#x3D;on,mrr_cost_based&#x3D;off&#39;;</span><br><span class="line">Query OK, 0 rows affected</span><br><span class="line">Time: 0.001s</span><br><span class="line">mysql root@localhost:employees&gt; explain select * from employees where birth_date &#x3D; &#39;1970-01-01&#39; and hire_date &gt; &#39;1990-01-01&#39;;</span><br><span class="line">+----+-------------+-----------+------------+-------+----------------+----------------+---------+--------+------+----------+----------------------------------+</span><br><span class="line">| id | select_type | table     | partitions | type  | possible_keys  | key            | key_len | ref    | rows | filtered | Extra                           |</span><br><span class="line">+----+-------------+-----------+------------+-------+----------------+----------------+---------+--------+------+----------+----------------------------------+</span><br><span class="line">| 1  | SIMPLE      | employees | &lt;null&gt;     | range | idx_birth_hire | idx_birth_hire | 6       | &lt;null&gt; | 1    | 100.0    | Using index condition; Using MRR |</span><br><span class="line">+----+-------------+-----------+------------+-------+----------------+----------------+---------+--------+------+----------+----------------------------------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.014s</span><br></pre></td></tr></table></figure>
<ol start="8">
<li>Range checked for each record (index map: N)</li>
</ol>
<p>MySQL 在获取数据时发现在没有索引可用，但当获取部分先前表字段值时发现可以采用当前表某些索引来获取数据。index map展示的是一个掩码值，如 index map:0x19，对应二进制值为 11001，表示当前表索引编号为 1、4 和 5 号索引可能被用来获取数据，索引编号通过 SHOW INDEX 语句获得。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select * from employees e,dept_emp d where e.emp_no &gt; d.emp_no;</span><br><span class="line">+----+-------------+-------+------------+------+---------------+--------+---------+--------+--------+----------+------------------------------------------------+</span><br><span class="line">| id | select_type | table | partitions | type | possible_keys | key    | key_len | ref    | rows   | filtered | Extra                                         |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+--------+---------+--------+--------+----------+------------------------------------------------+</span><br><span class="line">| 1  | SIMPLE      | d     | &lt;null&gt;     | ALL  | PRIMARY       | &lt;null&gt; | &lt;null&gt;  | &lt;null&gt; | 331143 | 100.0    | &lt;null&gt;                                        |</span><br><span class="line">| 1  | SIMPLE      | e     | &lt;null&gt;     | ALL  | PRIMARY       | &lt;null&gt; | &lt;null&gt;  | &lt;null&gt; | 299512 |  33.33   | Range checked for each record (index map: 0x1) |</span><br><span class="line">+----+-------------+-------+------------+------+---------------+--------+---------+--------+--------+----------+------------------------------------------------+</span><br><span class="line">2 rows in set</span><br><span class="line">Time: 0.038s</span><br></pre></td></tr></table></figure>
<ol start="9">
<li>Select tables optimized away</li>
</ol>
<p>MySQL 优化器能够确定以下两点：</p>
<ul>
<li>
<p>最多只有一行记录被返回；</p>
</li>
<li>
<p>为了获取这一行数据，有一定的结果集需要获取。</p>
</li>
</ul>
<p>当语句在优化器阶段过程中可以获取查询结果(如获取行数，只需要读取相应索引数据)，而无需再返回表中查询数据，可能会出现 Select tables optimized away。例如针对 MyISAM 引擎的表，使用 select count(*) 获取表的总行数，而且又没有 where 子句或者条件总是为真，也没有 GROUP BY 子句时，其实就包含了以上的条件且隐式含有 GROUP BY 分组的效果。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">-- 创建 MyISAM 引擎的 employees 表</span><br><span class="line">mysql root@localhost:employees&gt; create table employees_myisam like employees;</span><br><span class="line">Query OK, 0 rows affected</span><br><span class="line">Time: 0.040s</span><br><span class="line">mysql root@localhost:employees&gt; insert into employees_myisam select * from employees;</span><br><span class="line">Query OK, 300024 rows affected</span><br><span class="line">Time: 5.023s</span><br><span class="line">mysql root@localhost:employees&gt; alter table employees_myisam engine&#x3D;MyISAM;</span><br><span class="line">Query OK, 300024 rows affected</span><br><span class="line">Time: 1.515s</span><br><span class="line"></span><br><span class="line">-- 获取执行 count(*) 查询行数执行计划</span><br><span class="line">mysql root@localhost:employees&gt; explain select count(*) from employees_myisam;</span><br><span class="line">+----+-------------+--------+------------+--------+---------------+--------+---------+--------+--------+----------+------------------------------+</span><br><span class="line">| id | select_type | table  | partitions | type   | possible_keys | key    | key_len | ref    | rows   | filtered | Extra                        |</span><br><span class="line">+----+-------------+--------+------------+--------+---------------+--------+---------+--------+--------+----------+------------------------------+</span><br><span class="line">| 1  | SIMPLE      | &lt;null&gt; | &lt;null&gt;     | &lt;null&gt; | &lt;null&gt;        | &lt;null&gt; | &lt;null&gt;  | &lt;null&gt; | &lt;null&gt; | &lt;null&gt;   | Select tables optimized away |</span><br><span class="line">+----+-------------+--------+------------+--------+---------------+--------+---------+--------+--------+----------+------------------------------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.024s</span><br></pre></td></tr></table></figure>
<ol start="10">
<li>Using temporary</li>
</ol>
<p>MySQL 需要创建临时表来存放查询结果集。通常发生在有 GROUP BY 或 ORDER BY 子句的语句当中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select hire_date from employees group by hire_date;</span><br><span class="line">+----+-------------+-----------+------------+-------+----------------+----------------+---------+--------+--------+----------+----------------------------------------------+</span><br><span class="line">| id | select_type | table     | partitions | type  | possible_keys  | key            | key_len | ref    | rows   | filtered | Extra</span><br><span class="line">                          |</span><br><span class="line">+----+-------------+-----------+------------+-------+----------------+----------------+---------+--------+--------+----------+----------------------------------------------+</span><br><span class="line">| 1  | SIMPLE      | employees | &lt;null&gt;     | index | idx_birth_hire | idx_birth_hire | 6       | &lt;null&gt; | 299512 | 100.0    | Using index; Using temporary; Using filesort |</span><br><span class="line">+----+-------------+-----------+------------+-------+----------------+----------------+---------+--------+--------+----------+----------------------------------------------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.018s</span><br></pre></td></tr></table></figure>
<ol start="11">
<li>Using filesort</li>
</ol>
<p>MySQL 需要对获取的数据进行额外的一次排序操作，无法通过索引的排序完成。通常发生在有 ORDER BY 子句的语句当中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql root@localhost:employees&gt; explain select * from employees order by hire_date;</span><br><span class="line">+----+-------------+-----------+------------+------+---------------+--------+---------+--------+--------+----------+----------------+</span><br><span class="line">| id | select_type | table     | partitions | type | possible_keys | key    | key_len | ref    | rows   | filtered | Extra          |</span><br><span class="line">+----+-------------+-----------+------------+------+---------------+--------+---------+--------+--------+----------+----------------+</span><br><span class="line">| 1  | SIMPLE      | employees | &lt;null&gt;     | ALL  | &lt;null&gt;        | &lt;null&gt; | &lt;null&gt;  | &lt;null&gt; | 299512 | 100.0    | Using filesort |</span><br><span class="line">+----+-------------+-----------+------------+------+---------------+--------+---------+--------+--------+----------+----------------+</span><br><span class="line">1 row in set</span><br><span class="line">Time: 0.015s</span><br></pre></td></tr></table></figure>
<h2><span id="总结">总结</span></h2>
<p>以上内容总结了 MySQL 获取执行计划 explain 命令执行时输出的主要字段说明，还有许多未仔细说明的参数和选项，以后还需多多实践总结。可以看出 explain 命令输出内容当中比较重要的是：</p>
<ol>
<li>
<p>type：展示了表的查询/连接类型，体现查询效率；</p>
</li>
<li>
<p>key/key_len：实际使用了什么索引，使用了哪些部分索引；</p>
</li>
<li>
<p>Extra：对执行计划步骤额外的说明，采用了哪些查询特性。</p>
</li>
</ol>
<h2><span id="参考">参考</span></h2>
<ol>
<li>
<p><a href="https://dev.mysql.com/doc/refman/5.7/en/explain-output.html" target="_blank" rel="noopener">https://dev.mysql.com/doc/refman/5.7/en/explain-output.html</a></p>
</li>
<li>
<p><a href="https://dev.mysql.com/doc/index-other.html" target="_blank" rel="noopener">https://dev.mysql.com/doc/index-other.html</a></p>
</li>
<li>
<p><a href="https://blog.csdn.net/u012410733/article/details/66472157" target="_blank" rel="noopener">https://blog.csdn.net/u012410733/article/details/66472157</a></p>
</li>
<li>
<p><a href="https://blog.csdn.net/wanbin6470398/article/details/82425620" target="_blank" rel="noopener">https://blog.csdn.net/wanbin6470398/article/details/82425620</a></p>
</li>
<li>
<p><a href="https://blog.csdn.net/tianya9704/article/details/80067860" target="_blank" rel="noopener">https://blog.csdn.net/tianya9704/article/details/80067860</a></p>
</li>
</ol>
<blockquote>
<p>来源：博客园</p>
<p>原文：<a href="https://tinyurl.com/y26xecs7" target="_blank" rel="noopener">https://tinyurl.com/y26xecs7</a></p>
<p>题图：来自谷歌图片搜索</p>
<p>版权：本文版权归原作者所有</p>
<p>投稿：欢迎投稿，邮箱: <a href="mailto:editor@hi-linux.com">editor@hi-linux.com</a></p>
</blockquote>
</div>

			<script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script>
			<script>
			var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);
			if (!isMobile) {
			    var btw = new BTWPlugin();
			    btw.init({
			        "id": "vip-container",
			        "blogId": "10135-1588830050631-449",
			        "name": "「奇妙的 Linux 世界」",
			        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",
			        "keyword": "VIP"
			    });
			}
			</script>
		
                

                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/posts/45902.html" data-toggle="tooltip" data-placement="top" title="别让自己的选择，限制了你的未来">&larr; Previous Post</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/posts/2831.html" data-toggle="tooltip" data-placement="top" title="如何优雅的回退 Git 误操作">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                <!-- duoshuo Share start -->
                
                <!-- 多说 Share end-->

                <!-- 多说评论框 start -->
                
                <!-- 多说评论框 end -->

                <!-- disqus comment start -->
                
                <!-- disqus comment end -->

                
                    <!-- disqus 评论框 start -->
                    <div class="comment">
                        <div id="lv-container" data-id="city" data-uid="MTAyMC8yNzg2My80NDQw"></div>
                    </div>
                    <!-- disqus 评论框 end -->
                

            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

  
    <style>
      span.toc-nav-number{
        display: none
      }
    </style>
  
    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">主要用法</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">测试数据</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">输出说明</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">3.1.</span> <span class="toc-nav-text">id</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">3.2.</span> <span class="toc-nav-text">select_type</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">3.3.</span> <span class="toc-nav-text">type</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">3.4.</span> <span class="toc-nav-text">possible_keys</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">3.5.</span> <span class="toc-nav-text">key</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">3.6.</span> <span class="toc-nav-text">key_len</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">3.7.</span> <span class="toc-nav-text">ref</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">3.8.</span> <span class="toc-nav-text">rows</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">3.9.</span> <span class="toc-nav-text">filtered</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">3.10.</span> <span class="toc-nav-text">Extra</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">总结</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">参考</span></a></li></ol>
        
        </div>
      </aside>
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#技巧" title="技巧">技巧</a>
                        
                          <a class="tag" href="/tags/#Linux" title="Linux">Linux</a>
                        
                          <a class="tag" href="/tags/#MySQL" title="MySQL">MySQL</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">

                    
                        <li><a href="http://www.mike.org.cn/" target="_blank">简单.生活</a></li>
                    
                        <li><a href="http://shang.qq.com/wpa/qunwpa?idkey=ea4c43493c2269428ac6ef6141de4b6d78e5ab2d41380ca4099b833b62884ee9" target="_blank">技术交流群</a></li>
                    
                        <li><a href="" target="_blank"></a></li>
                    
                        <li><a href="" target="_blank"></a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>






    <!-- 来必力City版公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
       (function(d, s) {
           var j, e = d.getElementsByTagName(s)[0];
    
           if (typeof LivereTower === 'function') { return; }
    
           j = d.createElement(s);
           j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
           j.async = true;
    
           e.parentNode.insertBefore(j, e);
       })(document, 'script');
    </script>
    <noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
    <!-- 来必力City版 公共JS代码 end -->



<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'ℬ'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                    <li>
                        <a href="/atom.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                
                
                
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/80imike">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="http://weibo.com/2093524665">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Mike 2021 | Hosted by <a href="https://pages.coding.me" target="_blank" rel="noopener" style="font-weight: bold">Coding Pages</a>
                    <br>
                    Theme by <a href="http://beantech.org" target="_blank" rel="noopener">BeanTech</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span> 
                    re-Ported by <a href="http://www.huweihuang.com" target="_blank" rel="noopener">胡伟煌</a> | 
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=huweihuang&repo=hexo-theme-huweihuang&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->

<script src="/js/jquery.min.js"></script>


<!-- Bootstrap Core JavaScript -->

<script src="/js/bootstrap.min.js"></script>


<!-- Custom Theme JavaScript -->

<script src="/js/hux-blog.min.js"></script>



<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://www.hi-linux.com/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->




<!-- Baidu Tongji -->






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>
<!-- Image to hack wechat -->
<img src="https://www.hi-linux.com/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

<script>(function(w,d, s, id) {w.webpushr=w.webpushr||function(){(w.webpushr.q=w.webpushr.q||[]).push(arguments)};var js, fjs = d.getElementsByTagName(s)[0];js = d.createElement(s); js.id = id;js.src = 'https://cdn.webpushr.com/app.min.js';fjs.parentNode.appendChild(js);}(window,document, 'script', 'webpushr-jssdk'));webpushr('init','BF9JK7xV9kjWTdMx2lr6RWaPfXV7wNuZaVAJ1bfIGoBNJavqLEBVFMKLubITnCA4bh2fI9iH9tMF95nXnPt7xxY');</script></body>

</html>
