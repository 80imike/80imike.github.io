<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="Linux,运维,Nginx,Zabbix,Centos,Ansible,MySQL,Python,Docker,Kubernetes,K3s,AI,WireGuard,ELK,Haproxy,Git,Nodejs,安全,技术">
    <link rel="shortcut icon" href="/img/ironman-draw.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <title>
        
          Prometheus 入门 - 奇妙的 Linux 世界
        
    </title>

    <link rel="canonical" href="https://www.hi-linux.com/posts/25047.html">

    <!-- Bootstrap Core CSS -->
    
<link rel="stylesheet" href="/css/bootstrap.min.css">


    <!-- Custom CSS --> 
    
<link rel="stylesheet" href="/css/beantech.min.css">

    
    <!-- Pygments Highlight CSS -->
    
<link rel="stylesheet" href="/css/highlight.css">


    
<link rel="stylesheet" href="/css/widget.css">


    
<link rel="stylesheet" href="/css/rocket.css">


    
<link rel="stylesheet" href="/css/signature.css">


    
<link rel="stylesheet" href="/css/toc.css">


    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="奇妙的 Linux 世界" type="application/atom+xml">
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('/img/header_img/article.jpg')
            /*post*/
        
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#Docker" title="Docker">Docker</a>
                            
                              <a class="tag" href="/tags/#Prometheus" title="Prometheus">Prometheus</a>
                            
                        </div>
                        <h1>Prometheus 入门</h1>
                        <h2 class="subheading"></h2>
                        <span class="meta">
                            Posted by Mike on
                            2017-05-22
                        </span>
                    </div>
                


                </div>
            </div>
        </div>
    </div>
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">奇妙的 Linux 世界</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Modify by Yu-Hsuan Yen -->

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <div id="vip-container"><h3><span id="什么是tsdb">什么是TSDB？</span></h3>
<p>TSDB(Time Series Database)时序列数据库，我们可以简单的理解为一个优化后用来处理时间序列数据的软件，并且数据中的数组是由时间进行索引的。</p>
<p><strong>时间序列数据库的特点</strong></p>
<ul>
<li>大部分时间都是写入操作。</li>
<li>写入操作几乎是顺序添加，大多数时候数据到达后都以时间排序。</li>
<li>写操作很少写入很久之前的数据，也很少更新数据。大多数情况在数据被采集到数秒或者数分钟后就会被写入数据库。</li>
<li>删除操作一般为区块删除，选定开始的历史时间并指定后续的区块。很少单独删除某个时间或者分开的随机时间的数据。</li>
<li>基本数据大，一般超过内存大小。一般选取的只是其一小部分且没有规律，缓存几乎不起任何作用。</li>
<li>读操作是十分典型的升序或者降序的顺序读。</li>
<li>高并发的读操作十分常见。</li>
</ul>
<a id="more"></a>
<p><strong>常见的时间序列数据库</strong></p>
<table>
<thead>
<tr>
<th>TSDB项目</th>
<th>官网</th>
</tr>
</thead>
<tbody>
<tr>
<td>influxDB</td>
<td><a href="https://influxdata.com/" target="_blank" rel="noopener">https://influxdata.com/</a></td>
</tr>
<tr>
<td>RRDtool</td>
<td><a href="http://oss.oetiker.ch/rrdtool/" target="_blank" rel="noopener">http://oss.oetiker.ch/rrdtool/</a></td>
</tr>
<tr>
<td>Graphite</td>
<td><a href="http://graphiteapp.org/" target="_blank" rel="noopener">http://graphiteapp.org/</a></td>
</tr>
<tr>
<td>OpenTSDB</td>
<td><a href="http://opentsdb.net/" target="_blank" rel="noopener">http://opentsdb.net/</a></td>
</tr>
<tr>
<td>Kdb+</td>
<td><a href="http://kx.com/" target="_blank" rel="noopener">http://kx.com/</a></td>
</tr>
<tr>
<td>Druid</td>
<td><a href="http://druid.io/" target="_blank" rel="noopener">http://druid.io/</a></td>
</tr>
<tr>
<td>KairosDB</td>
<td><a href="http://kairosdb.github.io/" target="_blank" rel="noopener">http://kairosdb.github.io/</a></td>
</tr>
<tr>
<td>Prometheus</td>
<td><a href="https://prometheus.io/" target="_blank" rel="noopener">https://prometheus.io/</a></td>
</tr>
</tbody>
</table>
<h3><span id="什么是prometheus">什么是Prometheus?</span></h3>
<p>Prometheus是由SoundCloud开发的开源监控报警系统和时序列数据库(TSDB)。Prometheus使用Go语言开发，是Google BorgMon监控系统的开源版本。</p>
<p>2016年由Google发起Linux基金会旗下的原生云基金会(Cloud Native Computing Foundation), 将Prometheus纳入其下第二大开源项目。Prometheus目前在开源社区相当活跃。</p>
<p>Prometheus和Heapster(Heapster是K8S的一个子项目，用于获取集群的性能数据。)相比功能更完善、更全面。Prometheus性能也足够支撑上万台规模的集群。</p>
<h4><span id="prometheus的特点">Prometheus的特点</span></h4>
<ul>
<li>多维度数据模型。</li>
<li>灵活的查询语言。</li>
<li>不依赖分布式存储，单个服务器节点是自主的。</li>
<li>通过基于HTTP的pull方式采集时序数据。</li>
<li>可以通过中间网关进行时序列数据推送。</li>
<li>通过服务发现或者静态配置来发现目标服务对象。</li>
<li>支持多种多样的图表和界面展示，比如Grafana等。</li>
</ul>
<h4><span id="prometheus相关组件">Prometheus相关组件</span></h4>
<p>Prometheus生态系统由多个组件组成，它们中的一些是可选的。多数Prometheus组件是Go语言写的，这使得这些组件很容易编译和部署。</p>
<ul>
<li>Prometheus Server</li>
</ul>
<p>主要负责数据采集和存储，提供PromQL查询语言的支持。</p>
<ul>
<li>客户端SDK</li>
</ul>
<p>官方提供的客户端类库有go、java、scala、python、ruby，其他还有很多第三方开发的类库，支持nodejs、php、erlang等。</p>
<ul>
<li>Push Gateway</li>
</ul>
<p>支持临时性Job主动推送指标的中间网关。</p>
<ul>
<li>PromDash</li>
</ul>
<p>使用Rails开发可视化的Dashboard，用于可视化指标数据。</p>
<ul>
<li>Exporter</li>
</ul>
<p>Exporter是Prometheus的一类数据采集组件的总称。它负责从目标处搜集数据，并将其转化为Prometheus支持的格式。与传统的数据采集组件不同的是，它并不向中央服务器发送数据，而是等待中央服务器主动前来抓取。</p>
<p>Prometheus提供多种类型的Exporter用于采集各种不同服务的运行状态。目前支持的有数据库、硬件、消息中间件、存储系统、HTTP服务器、JMX等。</p>
<ul>
<li>alertmanager</li>
</ul>
<p>警告管理器，用来进行报警。</p>
<ul>
<li>prometheus_cli</li>
</ul>
<p>命令行工具。</p>
<ul>
<li>其他辅助性工具</li>
</ul>
<p>多种导出工具，可以支持Prometheus存储数据转化为HAProxy、StatsD、Graphite等工具所需要的数据存储格式。</p>
<h4><span id="prometheus的架构">Prometheus的架构</span></h4>
<p>下面这张图说明了Prometheus的整体架构，以及生态中的一些组件作用:</p>
<p><img src="https://www.hi-linux.com/img/linux/prometheus-arch.png" alt></p>
<p>Prometheus的基本原理是通过HTTP协议周期性抓取被监控组件的状态，任意组件只要提供对应的HTTP接口就可以接入监控。不需要任何SDK或者其他的集成过程。这样做非常适合做虚拟化环境监控系统，比如VM、Docker、Kubernetes等。输出被监控组件信息的HTTP接口被叫做exporter 。目前互联网公司常用的组件大部分都有exporter可以直接使用，比如Varnish、Haproxy、Nginx、MySQL、Linux系统信息(包括磁盘、内存、CPU、网络等等)。</p>
<p>Prometheus服务过程大概是这样：</p>
<ul>
<li>
<p>Prometheus Daemon负责定时去目标上抓取metrics(指标)数据，每个抓取目标需要暴露一个http服务的接口给它定时抓取。Prometheus支持通过配置文件、文本文件、Zookeeper、Consul、DNS SRV Lookup等方式指定抓取目标。Prometheus采用PULL的方式进行监控，即服务器可以直接通过目标PULL数据或者间接地通过中间网关来Push数据。</p>
</li>
<li>
<p>Prometheus在本地存储抓取的所有数据，并通过一定规则进行清理和整理数据，并把得到的结果存储到新的时间序列中。</p>
</li>
<li>
<p>Prometheus通过PromQL和其他API可视化地展示收集的数据。Prometheus支持很多方式的图表可视化，例如Grafana、自带的Promdash以及自身提供的模版引擎等等。Prometheus还提供HTTP API的查询方式，自定义所需要的输出。</p>
</li>
<li>
<p>PushGateway支持Client主动推送metrics到PushGateway，而Prometheus只是定时去Gateway上抓取数据。</p>
</li>
<li>
<p>Alertmanager是独立于Prometheus的一个组件，可以支持Prometheus的查询语句，提供十分灵活的报警方式。</p>
</li>
</ul>
<h4><span id="prometheus适用的场景">Prometheus适用的场景</span></h4>
<p>Prometheus在记录纯数字时间序列方面表现非常好。它既适用于面向服务器等硬件指标的监控，也适用于高动态的面向服务架构的监控。对于现在流行的微服务，Prometheus的多维度数据收集和数据筛选查询语言也是非常的强大。Prometheus是为服务的可靠性而设计的，当服务出现故障时，它可以使你快速定位和诊断问题。它的搭建过程对硬件和服务没有很强的依赖关系。</p>
<h4><span id="prometheus不适用的场景">Prometheus不适用的场景</span></h4>
<p>Prometheus它的价值在于可靠性，甚至在很恶劣的环境下，你都可以随时访问它和查看系统服务各种指标的统计信息。 如果你对统计数据需要100%的精确，它并不适用，例如：它不适用于实时计费系统。</p>
<p>Prometheus官网：<a href="https://prometheus.io/" target="_blank" rel="noopener">https://prometheus.io/</a></p>
<h3><span id="安装prometheus">安装Prometheus</span></h3>
<p>Prometheus官方给出了多重部署方案，比如：Docker容器、Ansible、Chef、Puppet、Saltstack等。</p>
<p>Prometheus用Golang实现，因此具有天然可移植性(支持Linux、Windows、macOS和Freebsd)。这里直接使用预编译的二进制文件部署，开箱即用。</p>
<ul>
<li>Prometheus安装</li>
</ul>
<p>这里以Linux系统为例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ wget  https:&#x2F;&#x2F;github.com&#x2F;prometheus&#x2F;prometheus&#x2F;releases&#x2F;download&#x2F;v1.6.3&#x2F;prometheus-1.6.3.linux-amd64.tar.gz</span><br><span class="line">$ tar xzvf prometheus-1.6.3.linux-amd64.tar.gz</span><br><span class="line">$ mv prometheus-1.6.3.linux-amd64 &#x2F;usr&#x2F;local&#x2F;prometheus</span><br></pre></td></tr></table></figure>
<p>其它系统版本可在这里下载：<a href="https://prometheus.io/download/" target="_blank" rel="noopener">https://prometheus.io/download/</a></p>
<ul>
<li>验证安装</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ cd &#x2F;usr&#x2F;local&#x2F;prometheus</span><br><span class="line">$ .&#x2F;prometheus --version</span><br><span class="line">prometheus, version 1.6.3 (branch: master, revision: c580b60c67f2c5f6b638c3322161bcdf6d68d7fc)</span><br><span class="line">  build user:       root@e54b06e0b22f</span><br><span class="line">  build date:       20170519-08:00:43</span><br><span class="line">  go version:       go1.8.1</span><br></pre></td></tr></table></figure>
<ul>
<li>配置Prometheus</li>
</ul>
<p>在prometheus目录下有一个名为<code>prometheus.yml</code>的主配置文件。其中包含大多数标准配置及prometheus的自检控配置，默认配置文件如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">$ cat &#x2F;usr&#x2F;local&#x2F;prometheus&#x2F;prometheus.yml</span><br><span class="line"></span><br><span class="line"># 全局配置</span><br><span class="line">global:</span><br><span class="line">  scrape_interval:     15s # 默认抓取间隔, 15秒向目标抓取一次数据。</span><br><span class="line">  evaluation_interval: 15s # Evaluate rules every 15 seconds. The default is every 1 minute.</span><br><span class="line">  # scrape_timeout is set to the global default (10s).</span><br><span class="line"></span><br><span class="line">  # 这个标签是在本机上每一条时间序列上都会默认产生的，主要可以用于联合查询、远程存储、Alertmanger时使用。</span><br><span class="line">  external_labels:</span><br><span class="line">      monitor: &#39;codelab-monitor&#39;</span><br><span class="line"></span><br><span class="line"># Load rules once and periodically evaluate them according to the global &#39;evaluation_interval&#39;.</span><br><span class="line">rule_files:</span><br><span class="line">  # - &quot;first.rules&quot;</span><br><span class="line">  # - &quot;second.rules&quot;</span><br><span class="line"></span><br><span class="line"># 这里就表示抓取对象的配置</span><br><span class="line"># 这里是抓去promethues自身的配置</span><br><span class="line">scrape_configs:</span><br><span class="line"># job name 这个配置是表示在这个配置内的时间序例，每一条都会自动添加上这个&#123;job_name:&quot;prometheus&quot;&#125;的标签。</span><br><span class="line">  - job_name: &#39;prometheus&#39;</span><br><span class="line"></span><br><span class="line">    # metrics_path defaults to &#39;&#x2F;metrics&#39;</span><br><span class="line">    # scheme defaults to &#39;http&#39;.</span><br><span class="line"></span><br><span class="line">    # 重写了全局抓取间隔时间，由15秒重写成5秒。</span><br><span class="line">    scrape_interval: 5s</span><br><span class="line"></span><br><span class="line">    static_configs:</span><br><span class="line">      - targets: [&#39;localhost:9090&#39;]</span><br></pre></td></tr></table></figure>
<ul>
<li>创建用户</li>
</ul>
<p>这里单独创建一个专门用于运行prometheus的用户，不用root运行程序是一种好习惯。主目录为<code>/var/lib/prometheus</code>，用作prometheus的数据目录。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ groupadd prometheus</span><br><span class="line">$ useradd -g prometheus -m -d &#x2F;var&#x2F;lib&#x2F;prometheus -s &#x2F;sbin&#x2F;nologin prometheus</span><br></pre></td></tr></table></figure>
<ul>
<li>创建Systemd服务</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ vim &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;prometheus.service</span><br><span class="line"></span><br><span class="line">[Unit]</span><br><span class="line">Description&#x3D;prometheus</span><br><span class="line">After&#x3D;network.target</span><br><span class="line">[Service]</span><br><span class="line">Type&#x3D;simple</span><br><span class="line">User&#x3D;prometheus</span><br><span class="line">ExecStart&#x3D;&#x2F;usr&#x2F;local&#x2F;prometheus&#x2F;prometheus -config.file&#x3D;&#x2F;usr&#x2F;local&#x2F;prometheus&#x2F;prometheus.yml -storage.local.path&#x3D;&#x2F;var&#x2F;lib&#x2F;prometheus</span><br><span class="line">Restart&#x3D;on-failure</span><br><span class="line">[Install]</span><br><span class="line">WantedBy&#x3D;multi-user.target</span><br></pre></td></tr></table></figure>
<ul>
<li>启动Prometheus</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl start prometheus</span><br></pre></td></tr></table></figure>
<ul>
<li>验证Prometheus是否启动成功</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl status prometheus</span><br><span class="line">● prometheus.service - prometheus</span><br><span class="line">   Loaded: loaded (&#x2F;etc&#x2F;systemd&#x2F;system&#x2F;prometheus.service; disabled; vendor preset: enabled)</span><br><span class="line">   Active: active (running) since Mon 2017-05-22 11:13:36 CST; 18s ago</span><br><span class="line"> Main PID: 9175 (prometheus)</span><br><span class="line">    Tasks: 9</span><br><span class="line">   Memory: 15.8M</span><br><span class="line">      CPU: 207ms</span><br><span class="line">   CGroup: &#x2F;system.slice&#x2F;prometheus.service</span><br><span class="line">           └─9175 &#x2F;usr&#x2F;local&#x2F;prometheus&#x2F;prometheus -config.file&#x3D;&#x2F;usr&#x2F;local&#x2F;prometheus&#x2F;prometheus.yml -storage.local.path&#x3D;&#x2F;var&#x2F;lib&#x2F;prometheus</span><br></pre></td></tr></table></figure>
<ul>
<li>访问自带Web</li>
</ul>
<p>Prometheus自带一个比较简单的Web，可以查看表达式搜索结果、报警配置、prometheus配置,exporter状态等。自带Web默认在<code>http://ip:9090</code>。</p>
<p><img src="https://www.hi-linux.com/img/linux/prometheus1.png" alt></p>
<p>Prometheus本身也是自带exporter的,我们通过请求 <code>http://ip:9090/metrics</code> 可以查看从exporter中能具体抓到哪些数据。</p>
<p><img src="https://www.hi-linux.com/img/linux/prometheus2.png" alt></p>
<p>这里以Prometheus本身数据为例，简单演示下在Web中查询指定表达式及图形化显示查询结果。</p>
<p><img src="https://www.hi-linux.com/img/linux/prometheus3.png" alt></p>
<h3><span id="使用prometheus监控服务器">使用Prometheus监控服务器</span></h3>
<p>上面用Prometheus本身的数据简单演示了监控数据的查询，这里我们用一个监控服务器状态的例子来更加直观说明。</p>
<p>为监控服务器CPU、内存、磁盘、I/O等信息，首先需要安装node_exporter。node_exporter的作用是用于机器系统数据收集。</p>
<ul>
<li>安装node_exporter</li>
</ul>
<p>node_exporter也是用Golang实现，直接使用预编译的二进制文件部署，开箱即用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ wget https:&#x2F;&#x2F;github.com&#x2F;prometheus&#x2F;node_exporter&#x2F;releases&#x2F;download&#x2F;v0.14.0&#x2F;node_exporter-0.14.0.linux-amd64.tar.gz</span><br><span class="line">$ tar -zxvf node_exporter-0.14.0.linux-amd64.tar.gz</span><br><span class="line">$ mv node_exporter-0.14.0.linux-amd64 &#x2F;usr&#x2F;local&#x2F;prometheus&#x2F;node_exporter</span><br></pre></td></tr></table></figure>
<ul>
<li>创建Systemd服务</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ vim &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;node_exporter.service</span><br><span class="line"></span><br><span class="line">[Unit]</span><br><span class="line">Description&#x3D;node_exporter</span><br><span class="line">After&#x3D;network.target</span><br><span class="line">[Service]</span><br><span class="line">Type&#x3D;simple</span><br><span class="line">User&#x3D;prometheus</span><br><span class="line">ExecStart&#x3D;&#x2F;usr&#x2F;local&#x2F;prometheus&#x2F;node_exporter&#x2F;node_exporter</span><br><span class="line">Restart&#x3D;on-failure</span><br><span class="line">[Install]</span><br><span class="line">WantedBy&#x3D;multi-user.target</span><br></pre></td></tr></table></figure>
<ul>
<li>启动Node exporter</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl start node_exporter</span><br></pre></td></tr></table></figure>
<ul>
<li>验证Node exporter是否启动成功</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl status node_exporter</span><br><span class="line">● node_exporter.service - node_exporter</span><br><span class="line">   Loaded: loaded (&#x2F;etc&#x2F;systemd&#x2F;system&#x2F;node_exporter.service; disabled; vendor preset: enabled)</span><br><span class="line">   Active: active (running) since Mon 2017-05-22 12:13:43 CST; 6s ago</span><br><span class="line"> Main PID: 11776 (node_exporter)</span><br><span class="line">    Tasks: 4</span><br><span class="line">   Memory: 1.5M</span><br><span class="line">      CPU: 24ms</span><br><span class="line">   CGroup: &#x2F;system.slice&#x2F;node_exporter.service</span><br><span class="line">           └─11776 &#x2F;usr&#x2F;local&#x2F;prometheus&#x2F;node_exporter&#x2F;node_exporter</span><br></pre></td></tr></table></figure>
<ul>
<li>修改prometheus.yml，加入下面的监控目标：</li>
</ul>
<p>Node Exporter默认的抓取地址为<code>http://IP:9100/metrics</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ vim  &#x2F;usr&#x2F;local&#x2F;prometheus&#x2F;prometheus.yml</span><br><span class="line"></span><br><span class="line">  - job_name: &#39;linux&#39;</span><br><span class="line">    static_configs:</span><br><span class="line">      - targets: [&#39;localhost:9100&#39;]</span><br><span class="line">        labels:</span><br><span class="line">          instance: node1</span><br></pre></td></tr></table></figure>
<p>prometheus.yml中一共定义了两个监控：一个是监控prometheus自身服务，另一个是监控Linux服务器。这里给个完整的示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">scrape_configs:</span><br><span class="line"></span><br><span class="line">  - job_name: &#39;prometheus&#39;</span><br><span class="line">    static_configs:</span><br><span class="line">      - targets: [&#39;localhost:9090&#39;]</span><br><span class="line"></span><br><span class="line">  - job_name: &#39;linux&#39;</span><br><span class="line">    static_configs:</span><br><span class="line">      - targets: [&#39;localhost:9100&#39;]</span><br><span class="line">        labels:</span><br><span class="line">          instance: node1</span><br></pre></td></tr></table></figure>
<ul>
<li>重启Prometheus</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl restart prometheus</span><br></pre></td></tr></table></figure>
<ul>
<li>在Prometheus Web查看监控的目标</li>
</ul>
<p>访问Prometheus Web，在Status-&gt;Targets页面下，我们可以看到我们配置的两个Target，它们的State为UP。</p>
<p><img src="https://www.hi-linux.com/img/linux/prometheus4.png" alt></p>
<p>使用Prometheus Web来验证Node Exporter的数据已经被正确的采集。</p>
<p>a) 查看当前主机的CPU使用情况</p>
<p><img src="https://www.hi-linux.com/img/linux/prometheus5.png" alt></p>
<p>b) 查看当前主机的CPU负载情况</p>
<p><img src="https://www.hi-linux.com/img/linux/prometheus6.png" alt></p>
<p>Prometheus Web界面自带的图表是非常基础的，比较适合用来做测试。如果要构建强大的Dashboard，还是需要更加专业的工具才行。接下来我们将使用Grafana来对Prometheus采集到的数据进行可视化展示。</p>
<h3><span id="给prometheus添加一个强大的仪表盘">给Prometheus添加一个强大的仪表盘</span></h3>
<p>Grafana是用于可视化大型测量数据的开源程序，它提供了强大和优雅的方式去创建、共享、浏览数据。Dashboard中显示了你不同metric数据源中的数据。</p>
<p>Grafana最常用于因特网基础设施和应用分析，但在其他领域也有用到，比如：工业传感器、家庭自动化、过程控制等等。Grafana支持热插拔控制面板和可扩展的数据源，目前已经支持Graphite、InfluxDB、OpenTSDB、Elasticsearch、Prometheus等。</p>
<ul>
<li>Grafana安装</li>
</ul>
<p>软件源里是比较旧的2.6版本，并且还需要单独打补丁才能正常使用Prometheus的数据源。这里直接下载4.2版本安装包进行安装。</p>
<p>以Ubutu系统为例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ wget https:&#x2F;&#x2F;s3-us-west-2.amazonaws.com&#x2F;grafana-releases&#x2F;release&#x2F;grafana_4.2.0_amd64.deb</span><br><span class="line">$ dpkg -i grafana_4.2.0_amd64.deb</span><br></pre></td></tr></table></figure>
<p>其它系统可在这里下载：<a href="https://grafana.com/grafana/download" target="_blank" rel="noopener">https://grafana.com/grafana/download</a></p>
<ul>
<li>启动Grafana</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl start grafana-server</span><br></pre></td></tr></table></figure>
<ul>
<li>查看Grafana是否启动成功</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl status grafana-server</span><br><span class="line">● grafana-server.service - Grafana instance</span><br><span class="line">   Loaded: loaded (&#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;grafana-server.service; masked; vendor preset: enabled)</span><br><span class="line">   Active: active (running) since Mon 2017-05-22 14:57:29 CST; 49min ago</span><br><span class="line">     Docs: http:&#x2F;&#x2F;docs.grafana.org</span><br><span class="line"> Main PID: 21735 (grafana-server)</span><br><span class="line">   CGroup: &#x2F;system.slice&#x2F;grafana-server.service</span><br><span class="line">           └─21735 &#x2F;usr&#x2F;sbin&#x2F;grafana-server --config&#x3D;&#x2F;etc&#x2F;grafana&#x2F;grafana.ini --pidfile&#x3D; cfg:default.paths.logs&#x3D;&#x2F;var&#x2F;log&#x2F;grafana cfg:default.paths.data&#x3D;&#x2F;var&#x2F;lib&#x2F;grafana cfg:default.paths.plugins&#x3D;&#x2F;var&#x2F;lib&#x2F;grafana&#x2F;plugins</span><br></pre></td></tr></table></figure>
<ul>
<li>访问Grafana</li>
</ul>
<p>通过<code>http://ip:3000</code>访问Grafana Web界面(缺省帐号/密码为admin/admin)</p>
<p><img src="https://www.hi-linux.com/img/linux/prometheus7.png" alt></p>
<ul>
<li>在Grafana中添加Prometheus数据源</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Name:Prometheus</span><br><span class="line">Type:Prometheus</span><br><span class="line">Url:http:&#x2F;&#x2F;localhost:9090&#x2F;</span><br><span class="line">Access:proxy</span><br></pre></td></tr></table></figure>
<p><img src="https://www.hi-linux.com/img/linux/prometheus8.png" alt></p>
<p>在Dashboards页面导入自带的Prometheus Status模板</p>
<p><img src="https://www.hi-linux.com/img/linux/prometheus9.png" alt></p>
<ul>
<li>导入Node Exporter Server Metrics模板</li>
</ul>
<p>访问<code>https://grafana.com/dashboards/405</code>，从这里下载Node Exporter Server Metrics模板的JSON文件。</p>
<p>在<code>Grafana--Dashboard</code>中导入这个文件，数据源选择Prometheus。</p>
<p><img src="https://www.hi-linux.com/img/linux/prometheus10.png" alt></p>
<ul>
<li>访问Dashboards</li>
</ul>
<p>在Dashboards上选Node Exporter Server Metrics模板，就可以看到被监控服务器的CPU, 内存, 磁盘等统计信息。</p>
<p><img src="https://www.hi-linux.com/img/linux/prometheus11.png" alt></p>
<p>如果想具体查看某一项指标也是可以的。</p>
<p><img src="https://www.hi-linux.com/img/linux/prometheus12.png" alt></p>
<p>在Dashboards上选Prometheus Status模板，查看Prometheus各项指标数据。</p>
<p><img src="https://www.hi-linux.com/img/linux/prometheus13.png" alt></p>
<h3><span id="参考文档">参考文档</span></h3>
<p><a href="http://www.google.com" target="_blank" rel="noopener">http://www.google.com</a><br>
<a href="https://github.com/1046102779/prometheus" target="_blank" rel="noopener">https://github.com/1046102779/prometheus</a><br>
<a href="http://liubin.org/blog/2016/02/18/tsdb-intro/" target="_blank" rel="noopener">http://liubin.org/blog/2016/02/18/tsdb-intro/</a><br>
<a href="http://www.cnblogs.com/vovlie/p/Prometheus_install.html" target="_blank" rel="noopener">http://www.cnblogs.com/vovlie/p/Prometheus_install.html</a><br>
<a href="https://www.addops.cn/post/Prometheus-first-exploration.html" target="_blank" rel="noopener">https://www.addops.cn/post/Prometheus-first-exploration.html</a><br>
<a href="http://blog.frognew.com/2017/02/use-prometheus-on-centos7.html" target="_blank" rel="noopener">http://blog.frognew.com/2017/02/use-prometheus-on-centos7.html</a></p>
</div>

			<script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script>
			<script>
			var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);
			if (!isMobile) {
			    var btw = new BTWPlugin();
			    btw.init({
			        "id": "vip-container",
			        "blogId": "10135-1588830050631-449",
			        "name": "「奇妙的 Linux 世界」",
			        "qrcode": "https://www.hi-linux.com/img/wechat/mp_qrcode_12.jpg",
			        "keyword": "VIP"
			    });
			}
			</script>
		
                

                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/posts/27014.html" data-toggle="tooltip" data-placement="top" title="Prometheus 进阶">&larr; Previous Post</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/posts/45101.html" data-toggle="tooltip" data-placement="top" title="最牛最暴力的开源协议 WTFPL">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                <!-- duoshuo Share start -->
                
                <!-- 多说 Share end-->

                <!-- 多说评论框 start -->
                
                <!-- 多说评论框 end -->

                <!-- disqus comment start -->
                
                <!-- disqus comment end -->

                
                    <!-- disqus 评论框 start -->
                    <div class="comment">
                        <div id="lv-container" data-id="city" data-uid="MTAyMC8yNzg2My80NDQw"></div>
                    </div>
                    <!-- disqus 评论框 end -->
                

            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

  
    <style>
      span.toc-nav-number{
        display: none
      }
    </style>
  
    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">什么是TSDB？</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">什么是Prometheus?</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">2.1.</span> <span class="toc-nav-text">Prometheus的特点</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">2.2.</span> <span class="toc-nav-text">Prometheus相关组件</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">2.3.</span> <span class="toc-nav-text">Prometheus的架构</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">2.4.</span> <span class="toc-nav-text">Prometheus适用的场景</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">2.5.</span> <span class="toc-nav-text">Prometheus不适用的场景</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">安装Prometheus</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">使用Prometheus监控服务器</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">给Prometheus添加一个强大的仪表盘</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#vip-container"><span class="toc-nav-number">6.</span> <span class="toc-nav-text">参考文档</span></a></li></ol>
        
        </div>
      </aside>
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#Docker" title="Docker">Docker</a>
                        
                          <a class="tag" href="/tags/#Prometheus" title="Prometheus">Prometheus</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">

                    
                        <li><a href="https://bestgeek.org/" target="_blank">极客视界</a></li>
                    
                        <li><a href="https://666666.dev/" target="_blank">IT 人必备工具箱</a></li>
                    
                        <li><a href="https://mp.weixin.qq.com/s/ZgoeD1FBp7eouyxBte4MWw" target="_blank">Linux 技术交流群</a></li>
                    
                        <li><a href="" target="_blank"></a></li>
                    
                        <li><a href="" target="_blank"></a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>






    <!-- 来必力City版公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
       (function(d, s) {
           var j, e = d.getElementsByTagName(s)[0];
    
           if (typeof LivereTower === 'function') { return; }
    
           j = d.createElement(s);
           j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
           j.async = true;
    
           e.parentNode.insertBefore(j, e);
       })(document, 'script');
    </script>
    <noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
    <!-- 来必力City版 公共JS代码 end -->



<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'ℬ'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                    <li>
                        <a href="/atom.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                
                
                
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/80imike">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="http://weibo.com/2093524665">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Mike 2025 | Hosted by <a href="https://pages.coding.me" target="_blank" rel="noopener" style="font-weight: bold">Coding Pages</a>
                    <br>
                    Theme by <a href="http://beantech.org" target="_blank" rel="noopener">BeanTech</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                        <i class="fa fa-heart"></i>
                    </span> 
                    re-Ported by <a href="http://www.huweihuang.com" target="_blank" rel="noopener">胡伟煌</a> | 
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="91px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=huweihuang&repo=hexo-theme-huweihuang&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->

<script src="/js/jquery.min.js"></script>


<!-- Bootstrap Core JavaScript -->

<script src="/js/bootstrap.min.js"></script>


<!-- Custom Theme JavaScript -->

<script src="/js/hux-blog.min.js"></script>



<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://www.hi-linux.com/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->




<!-- Baidu Tongji -->



<script defer src="https://umami.hi-linux.com/script.js"
    data-website-id="db99ccfc-f114-4595-8f3b-9dd1fbd3bf19"></script>


	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>
<!-- Image to hack wechat -->
<img src="https://www.hi-linux.com/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

<script>(function(w,d, s, id) {w.webpushr=w.webpushr||function(){(w.webpushr.q=w.webpushr.q||[]).push(arguments)};var js, fjs = d.getElementsByTagName(s)[0];js = d.createElement(s); js.id = id;js.src = 'https://cdn.webpushr.com/app.min.js';fjs.parentNode.appendChild(js);}(window,document, 'script', 'webpushr-jssdk'));webpushr('init','BF9JK7xV9kjWTdMx2lr6RWaPfXV7wNuZaVAJ1bfIGoBNJavqLEBVFMKLubITnCA4bh2fI9iH9tMF95nXnPt7xxY');</script></body>

</html>
